globalThis.datascript = {};SHADOW_ENV.evalLoad("datascript.lru.js", true , "goog.provide(\x27datascript.lru\x27);


/**
* @constructor
 * @implements {cljs.core.IPrintWithWriter}
 * @implements {cljs.core.IAssociative}
 * @implements {cljs.core.ILookup}
*/
datascript.lru.LRU \x3d (function (key_value,gen_key,key_gen,gen,limit){
this.key_value \x3d key_value;
this.gen_key \x3d gen_key;
this.key_gen \x3d key_gen;
this.gen \x3d gen;
this.limit \x3d limit;
this.cljs$lang$protocol_mask$partition0$ \x3d 2147484416;
this.cljs$lang$protocol_mask$partition1$ \x3d 0;
});
(datascript.lru.LRU.prototype.cljs$core$IAssociative$_assoc$arity$3 \x3d (function (this$,k,v){
var self__ \x3d this;
var this$__$1 \x3d this;
return (datascript.lru.assoc_lru.cljs$core$IFn$_invoke$arity$3 ? datascript.lru.assoc_lru.cljs$core$IFn$_invoke$arity$3(this$__$1,k,v) : datascript.lru.assoc_lru.call(null,this$__$1,k,v));
}));

(datascript.lru.LRU.prototype.cljs$core$IAssociative$_contains_key_QMARK_$arity$2 \x3d (function (_,k){
var self__ \x3d this;
var ___$1 \x3d this;
return cljs.core._contains_key_QMARK_(self__.key_value,k);
}));

(datascript.lru.LRU.prototype.cljs$core$ILookup$_lookup$arity$2 \x3d (function (_,k){
var self__ \x3d this;
var ___$1 \x3d this;
return cljs.core._lookup(self__.key_value,k,null);
}));

(datascript.lru.LRU.prototype.cljs$core$ILookup$_lookup$arity$3 \x3d (function (_,k,nf){
var self__ \x3d this;
var ___$1 \x3d this;
return cljs.core._lookup(self__.key_value,k,nf);
}));

(datascript.lru.LRU.prototype.cljs$core$IPrintWithWriter$_pr_writer$arity$3 \x3d (function (_,writer,opts){
var self__ \x3d this;
var ___$1 \x3d this;
return cljs.core._pr_writer(self__.key_value,writer,opts);
}));

(datascript.lru.LRU.getBasis \x3d (function (){
return new cljs.core.PersistentVector(null, 5, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22key-value\x22,\x22key-value\x22,1605624688,null),new cljs.core.Symbol(null,\x22gen-key\x22,\x22gen-key\x22,392707442,null),new cljs.core.Symbol(null,\x22key-gen\x22,\x22key-gen\x22,415199034,null),new cljs.core.Symbol(null,\x22gen\x22,\x22gen\x22,1783106829,null),new cljs.core.Symbol(null,\x22limit\x22,\x22limit\x22,284709164,null)], null);
}));

(datascript.lru.LRU.cljs$lang$type \x3d true);

(datascript.lru.LRU.cljs$lang$ctorStr \x3d \x22datascript.lru/LRU\x22);

(datascript.lru.LRU.cljs$lang$ctorPrWriter \x3d (function (this__5330__auto__,writer__5331__auto__,opt__5332__auto__){
return cljs.core._write(writer__5331__auto__,\x22datascript.lru/LRU\x22);
}));

/**
 * Positional factory function for datascript.lru/LRU.
 */
datascript.lru.__GT_LRU \x3d (function datascript$lru$__GT_LRU(key_value,gen_key,key_gen,gen,limit){
return (new datascript.lru.LRU(key_value,gen_key,key_gen,gen,limit));
});

datascript.lru.assoc_lru \x3d (function datascript$lru$assoc_lru(lru,k,v){
var key_value \x3d lru.key_value;
var gen_key \x3d lru.gen_key;
var key_gen \x3d lru.key_gen;
var gen \x3d lru.gen;
var limit \x3d lru.limit;
var temp__5802__auto__ \x3d (key_gen.cljs$core$IFn$_invoke$arity$2 ? key_gen.cljs$core$IFn$_invoke$arity$2(k,null) : key_gen.call(null,k,null));
if(cljs.core.truth_(temp__5802__auto__)){
var g \x3d temp__5802__auto__;
return (new datascript.lru.LRU(key_value,cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(gen_key,g),gen,k),cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(key_gen,k,gen),(gen + (1)),limit));
} else {
var G__50667 \x3d (new datascript.lru.LRU(cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(key_value,k,v),cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(gen_key,gen,k),cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(key_gen,k,gen),(gen + (1)),limit));
return (datascript.lru.cleanup_lru.cljs$core$IFn$_invoke$arity$1 ? datascript.lru.cleanup_lru.cljs$core$IFn$_invoke$arity$1(G__50667) : datascript.lru.cleanup_lru.call(null,G__50667));
}
});
datascript.lru.cleanup_lru \x3d (function datascript$lru$cleanup_lru(lru){
if((cljs.core.count(lru.key_value) \x3e lru.limit)){
var key_value \x3d lru.key_value;
var gen_key \x3d lru.gen_key;
var key_gen \x3d lru.key_gen;
var gen \x3d lru.gen;
var limit \x3d lru.limit;
var vec__50668 \x3d cljs.core.first(gen_key);
var g \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__50668,(0),null);
var k \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__50668,(1),null);
return (new datascript.lru.LRU(cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(key_value,k),cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(gen_key,g),cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(key_gen,k),gen,limit));
} else {
return lru;
}
});
datascript.lru.lru \x3d (function datascript$lru$lru(limit){
return (new datascript.lru.LRU(cljs.core.PersistentArrayMap.EMPTY,cljs.core.sorted_map(),cljs.core.PersistentArrayMap.EMPTY,(0),limit));
});

/**
 * @interface
 */
datascript.lru.ICache \x3d function(){};

var datascript$lru$ICache$_get$dyn_50675 \x3d (function (this$,key,compute_fn){
var x__5393__auto__ \x3d (((this$ \x3d\x3d null))?null:this$);
var m__5394__auto__ \x3d (datascript.lru._get[goog.typeOf(x__5393__auto__)]);
if((!((m__5394__auto__ \x3d\x3d null)))){
return (m__5394__auto__.cljs$core$IFn$_invoke$arity$3 ? m__5394__auto__.cljs$core$IFn$_invoke$arity$3(this$,key,compute_fn) : m__5394__auto__.call(null,this$,key,compute_fn));
} else {
var m__5392__auto__ \x3d (datascript.lru._get[\x22_\x22]);
if((!((m__5392__auto__ \x3d\x3d null)))){
return (m__5392__auto__.cljs$core$IFn$_invoke$arity$3 ? m__5392__auto__.cljs$core$IFn$_invoke$arity$3(this$,key,compute_fn) : m__5392__auto__.call(null,this$,key,compute_fn));
} else {
throw cljs.core.missing_protocol(\x22ICache.-get\x22,this$);
}
}
});
datascript.lru._get \x3d (function datascript$lru$_get(this$,key,compute_fn){
if((((!((this$ \x3d\x3d null)))) \x26\x26 ((!((this$.datascript$lru$ICache$_get$arity$3 \x3d\x3d null)))))){
return this$.datascript$lru$ICache$_get$arity$3(this$,key,compute_fn);
} else {
return datascript$lru$ICache$_get$dyn_50675(this$,key,compute_fn);
}
});

datascript.lru.cache \x3d (function datascript$lru$cache(limit){
var _STAR_impl \x3d cljs.core.volatile_BANG_(datascript.lru.lru(limit));
if((typeof datascript !\x3d\x3d \x27undefined\x27) \x26\x26 (typeof datascript.lru !\x3d\x3d \x27undefined\x27) \x26\x26 (typeof datascript.lru.t_datascript$lru50672 !\x3d\x3d \x27undefined\x27)){
} else {

/**
* @constructor
 * @implements {cljs.core.IMeta}
 * @implements {datascript.lru.ICache}
 * @implements {cljs.core.IWithMeta}
*/
datascript.lru.t_datascript$lru50672 \x3d (function (limit,_STAR_impl,meta50673){
this.limit \x3d limit;
this._STAR_impl \x3d _STAR_impl;
this.meta50673 \x3d meta50673;
this.cljs$lang$protocol_mask$partition0$ \x3d 393216;
this.cljs$lang$protocol_mask$partition1$ \x3d 0;
});
(datascript.lru.t_datascript$lru50672.prototype.cljs$core$IWithMeta$_with_meta$arity$2 \x3d (function (_50674,meta50673__$1){
var self__ \x3d this;
var _50674__$1 \x3d this;
return (new datascript.lru.t_datascript$lru50672(self__.limit,self__._STAR_impl,meta50673__$1));
}));

(datascript.lru.t_datascript$lru50672.prototype.cljs$core$IMeta$_meta$arity$1 \x3d (function (_50674){
var self__ \x3d this;
var _50674__$1 \x3d this;
return self__.meta50673;
}));

(datascript.lru.t_datascript$lru50672.prototype.datascript$lru$ICache$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.lru.t_datascript$lru50672.prototype.datascript$lru$ICache$_get$arity$3 \x3d (function (this$,key,compute_fn){
var self__ \x3d this;
var this$__$1 \x3d this;
var temp__5806__auto__ \x3d cljs.core.get.cljs$core$IFn$_invoke$arity$3(cljs.core.deref(self__._STAR_impl),key,null);
if((temp__5806__auto__ \x3d\x3d null)){
var computed \x3d (compute_fn.cljs$core$IFn$_invoke$arity$0 ? compute_fn.cljs$core$IFn$_invoke$arity$0() : compute_fn.call(null));
cljs.core._vreset_BANG_(self__._STAR_impl,cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(cljs.core._deref(self__._STAR_impl),key,computed));

return computed;
} else {
var cached \x3d temp__5806__auto__;
return cached;
}
}));

(datascript.lru.t_datascript$lru50672.getBasis \x3d (function (){
return new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22limit\x22,\x22limit\x22,284709164,null),new cljs.core.Symbol(null,\x22*impl\x22,\x22*impl\x22,1858309677,null),new cljs.core.Symbol(null,\x22meta50673\x22,\x22meta50673\x22,-2090283877,null)], null);
}));

(datascript.lru.t_datascript$lru50672.cljs$lang$type \x3d true);

(datascript.lru.t_datascript$lru50672.cljs$lang$ctorStr \x3d \x22datascript.lru/t_datascript$lru50672\x22);

(datascript.lru.t_datascript$lru50672.cljs$lang$ctorPrWriter \x3d (function (this__5330__auto__,writer__5331__auto__,opt__5332__auto__){
return cljs.core._write(writer__5331__auto__,\x22datascript.lru/t_datascript$lru50672\x22);
}));

/**
 * Positional factory function for datascript.lru/t_datascript$lru50672.
 */
datascript.lru.__GT_t_datascript$lru50672 \x3d (function datascript$lru$cache_$___GT_t_datascript$lru50672(limit__$1,_STAR_impl__$1,meta50673){
return (new datascript.lru.t_datascript$lru50672(limit__$1,_STAR_impl__$1,meta50673));
});

}

return (new datascript.lru.t_datascript$lru50672(limit,_STAR_impl,cljs.core.PersistentArrayMap.EMPTY));
});
");
SHADOW_ENV.evalLoad("me.tonsky.persistent_sorted_set.arrays.js", true , "goog.provide(\x27me.tonsky.persistent_sorted_set.arrays\x27);
me.tonsky.persistent_sorted_set.arrays.if_cljs \x3d (function me$tonsky$persistent_sorted_set$arrays$if_cljs(env,then,else$){
if(cljs.core.truth_(new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760).cljs$core$IFn$_invoke$arity$1(env))){
return then;
} else {
return else$;
}
});
me.tonsky.persistent_sorted_set.arrays.make_array \x3d (function me$tonsky$persistent_sorted_set$arrays$make_array(size){
return (new Array(size));
});
me.tonsky.persistent_sorted_set.arrays.into_array \x3d (function me$tonsky$persistent_sorted_set$arrays$into_array(aseq){
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (a,x){
a.push(x);

return a;
}),(new Array()),aseq);
});
me.tonsky.persistent_sorted_set.arrays.aclone \x3d (function me$tonsky$persistent_sorted_set$arrays$aclone(from){
return from.slice((0));
});
me.tonsky.persistent_sorted_set.arrays.aconcat \x3d (function me$tonsky$persistent_sorted_set$arrays$aconcat(a,b){
return a.concat(b);
});
me.tonsky.persistent_sorted_set.arrays.amap \x3d (function me$tonsky$persistent_sorted_set$arrays$amap(f,arr){
return arr.map(f);
});
me.tonsky.persistent_sorted_set.arrays.asort \x3d (function me$tonsky$persistent_sorted_set$arrays$asort(arr,cmp){
return arr.sort(cmp);
});
me.tonsky.persistent_sorted_set.arrays.array_QMARK_ \x3d (function me$tonsky$persistent_sorted_set$arrays$array_QMARK_(x){
if((cljs.core._STAR_target_STAR_ \x3d\x3d\x3d \x22nodejs\x22)){
return Array.isArray(x);
} else {
return (x instanceof Array);
}
});
");
SHADOW_ENV.evalLoad("me.tonsky.persistent_sorted_set.js", true , "goog.provide(\x27me.tonsky.persistent_sorted_set\x27);
me.tonsky.persistent_sorted_set.min_len \x3d (16);
me.tonsky.persistent_sorted_set.max_len \x3d (32);
me.tonsky.persistent_sorted_set.avg_len \x3d (((32) + (16)) \x3e\x3e\x3e (1));
me.tonsky.persistent_sorted_set.level_shift \x3d (cljs.core.first(cljs.core.filter.cljs$core$IFn$_invoke$arity$2((function (p1__50795_SHARP_){
return (((32) \x26 (1 \x3c\x3c p1__50795_SHARP_)) !\x3d 0);
}),cljs.core.range.cljs$core$IFn$_invoke$arity$3((31),(-1),(-1)))) + (1));
me.tonsky.persistent_sorted_set.path_mask \x3d (((1) \x3c\x3c me.tonsky.persistent_sorted_set.level_shift) - (1));
me.tonsky.persistent_sorted_set.empty_path \x3d (0);
me.tonsky.persistent_sorted_set.path_get \x3d (function me$tonsky$persistent_sorted_set$path_get(path,level){
return (me.tonsky.persistent_sorted_set.path_mask \x26 (path \x3e\x3e\x3e level));
});
me.tonsky.persistent_sorted_set.path_set \x3d (function me$tonsky$persistent_sorted_set$path_set(path,level,idx){
return (path | (idx \x3c\x3c level));
});
me.tonsky.persistent_sorted_set.binary_search_l \x3d (function me$tonsky$persistent_sorted_set$binary_search_l(cmp,arr,r,k){
var l \x3d (0);
var r__$1 \x3d cljs.core.long$(r);
while(true){
if((l \x3c\x3d r__$1)){
var m \x3d ((l + r__$1) \x3e\x3e\x3e (1));
var mk \x3d (arr[m]);
if(((cmp.cljs$core$IFn$_invoke$arity$2 ? cmp.cljs$core$IFn$_invoke$arity$2(mk,k) : cmp.call(null,mk,k)) \x3c (0))){
var G__50844 \x3d (m + (1));
var G__50845 \x3d r__$1;
l \x3d G__50844;
r__$1 \x3d G__50845;
continue;
} else {
var G__50846 \x3d l;
var G__50847 \x3d (m - (1));
l \x3d G__50846;
r__$1 \x3d G__50847;
continue;
}
} else {
return l;
}
break;
}
});
me.tonsky.persistent_sorted_set.binary_search_r \x3d (function me$tonsky$persistent_sorted_set$binary_search_r(cmp,arr,r,k){
var l \x3d (0);
var r__$1 \x3d cljs.core.long$(r);
while(true){
if((l \x3c\x3d r__$1)){
var m \x3d ((l + r__$1) \x3e\x3e\x3e (1));
var mk \x3d (arr[m]);
if(((cmp.cljs$core$IFn$_invoke$arity$2 ? cmp.cljs$core$IFn$_invoke$arity$2(mk,k) : cmp.call(null,mk,k)) \x3e (0))){
var G__50848 \x3d l;
var G__50849 \x3d (m - (1));
l \x3d G__50848;
r__$1 \x3d G__50849;
continue;
} else {
var G__50850 \x3d (m + (1));
var G__50851 \x3d r__$1;
l \x3d G__50850;
r__$1 \x3d G__50851;
continue;
}
} else {
return l;
}
break;
}
});
me.tonsky.persistent_sorted_set.lookup_exact \x3d (function me$tonsky$persistent_sorted_set$lookup_exact(cmp,arr,key){
var arr_l \x3d arr.length;
var idx \x3d me.tonsky.persistent_sorted_set.binary_search_l(cmp,arr,(arr_l - (1)),key);
if((((idx \x3c arr_l)) \x26\x26 (((0) \x3d\x3d\x3d (function (){var G__50796 \x3d (arr[idx]);
var G__50797 \x3d key;
return (cmp.cljs$core$IFn$_invoke$arity$2 ? cmp.cljs$core$IFn$_invoke$arity$2(G__50796,G__50797) : cmp.call(null,G__50796,G__50797));
})())))){
return idx;
} else {
return (-1);
}
});
me.tonsky.persistent_sorted_set.lookup_range \x3d (function me$tonsky$persistent_sorted_set$lookup_range(cmp,arr,key){
var arr_l \x3d arr.length;
var idx \x3d me.tonsky.persistent_sorted_set.binary_search_l(cmp,arr,(arr_l - (1)),key);
if((idx \x3d\x3d\x3d arr_l)){
return (-1);
} else {
return idx;
}
});
me.tonsky.persistent_sorted_set.cut_n_splice \x3d (function me$tonsky$persistent_sorted_set$cut_n_splice(arr,cut_from,cut_to,splice_from,splice_to,xs){
var xs_l \x3d xs.length;
var l1 \x3d (splice_from - cut_from);
var l2 \x3d (cut_to - splice_to);
var l1xs \x3d (l1 + xs_l);
var new_arr \x3d me.tonsky.persistent_sorted_set.arrays.make_array(((l1 + xs_l) + l2));
var l__50731__auto___50854 \x3d (splice_from - cut_from);
var n__5636__auto___50856 \x3d l__50731__auto___50854;
var i__50732__auto___50857 \x3d (0);
while(true){
if((i__50732__auto___50857 \x3c n__5636__auto___50856)){
(new_arr[(i__50732__auto___50857 + (0))] \x3d (arr[(i__50732__auto___50857 + cut_from)]));

var G__50859 \x3d (i__50732__auto___50857 + (1));
i__50732__auto___50857 \x3d G__50859;
continue;
} else {
}
break;
}

var l__50731__auto___50860 \x3d (xs_l - (0));
var n__5636__auto___50861 \x3d l__50731__auto___50860;
var i__50732__auto___50862 \x3d (0);
while(true){
if((i__50732__auto___50862 \x3c n__5636__auto___50861)){
(new_arr[(i__50732__auto___50862 + l1)] \x3d (xs[(i__50732__auto___50862 + (0))]));

var G__50863 \x3d (i__50732__auto___50862 + (1));
i__50732__auto___50862 \x3d G__50863;
continue;
} else {
}
break;
}

var l__50731__auto___50864 \x3d (cut_to - splice_to);
var n__5636__auto___50865 \x3d l__50731__auto___50864;
var i__50732__auto___50866 \x3d (0);
while(true){
if((i__50732__auto___50866 \x3c n__5636__auto___50865)){
(new_arr[(i__50732__auto___50866 + l1xs)] \x3d (arr[(i__50732__auto___50866 + splice_to)]));

var G__50868 \x3d (i__50732__auto___50866 + (1));
i__50732__auto___50866 \x3d G__50868;
continue;
} else {
}
break;
}

return new_arr;
});
me.tonsky.persistent_sorted_set.splice \x3d (function me$tonsky$persistent_sorted_set$splice(arr,splice_from,splice_to,xs){
return me.tonsky.persistent_sorted_set.cut_n_splice(arr,(0),arr.length,splice_from,splice_to,xs);
});
me.tonsky.persistent_sorted_set.insert \x3d (function me$tonsky$persistent_sorted_set$insert(arr,idx,xs){
return me.tonsky.persistent_sorted_set.cut_n_splice(arr,(0),arr.length,idx,idx,xs);
});
me.tonsky.persistent_sorted_set.merge_n_split \x3d (function me$tonsky$persistent_sorted_set$merge_n_split(a1,a2){
var a1_l \x3d a1.length;
var a2_l \x3d a2.length;
var total_l \x3d (a1_l + a2_l);
var r1_l \x3d (total_l \x3e\x3e\x3e (1));
var r2_l \x3d (total_l - r1_l);
var r1 \x3d me.tonsky.persistent_sorted_set.arrays.make_array(r1_l);
var r2 \x3d me.tonsky.persistent_sorted_set.arrays.make_array(r2_l);
if((a1_l \x3c\x3d r1_l)){
var l__50731__auto___50870 \x3d (a1_l - (0));
var n__5636__auto___50871 \x3d l__50731__auto___50870;
var i__50732__auto___50872 \x3d (0);
while(true){
if((i__50732__auto___50872 \x3c n__5636__auto___50871)){
(r1[(i__50732__auto___50872 + (0))] \x3d (a1[(i__50732__auto___50872 + (0))]));

var G__50873 \x3d (i__50732__auto___50872 + (1));
i__50732__auto___50872 \x3d G__50873;
continue;
} else {
}
break;
}

var l__50731__auto___50874 \x3d ((r1_l - a1_l) - (0));
var n__5636__auto___50875 \x3d l__50731__auto___50874;
var i__50732__auto___50876 \x3d (0);
while(true){
if((i__50732__auto___50876 \x3c n__5636__auto___50875)){
(r1[(i__50732__auto___50876 + a1_l)] \x3d (a2[(i__50732__auto___50876 + (0))]));

var G__50877 \x3d (i__50732__auto___50876 + (1));
i__50732__auto___50876 \x3d G__50877;
continue;
} else {
}
break;
}

var l__50731__auto___50878 \x3d (a2_l - (r1_l - a1_l));
var n__5636__auto___50879 \x3d l__50731__auto___50878;
var i__50732__auto___50880 \x3d (0);
while(true){
if((i__50732__auto___50880 \x3c n__5636__auto___50879)){
(r2[(i__50732__auto___50880 + (0))] \x3d (a2[(i__50732__auto___50880 + (r1_l - a1_l))]));

var G__50881 \x3d (i__50732__auto___50880 + (1));
i__50732__auto___50880 \x3d G__50881;
continue;
} else {
}
break;
}
} else {
var l__50731__auto___50882 \x3d (r1_l - (0));
var n__5636__auto___50883 \x3d l__50731__auto___50882;
var i__50732__auto___50884 \x3d (0);
while(true){
if((i__50732__auto___50884 \x3c n__5636__auto___50883)){
(r1[(i__50732__auto___50884 + (0))] \x3d (a1[(i__50732__auto___50884 + (0))]));

var G__50885 \x3d (i__50732__auto___50884 + (1));
i__50732__auto___50884 \x3d G__50885;
continue;
} else {
}
break;
}

var l__50731__auto___50886 \x3d (a1_l - r1_l);
var n__5636__auto___50887 \x3d l__50731__auto___50886;
var i__50732__auto___50888 \x3d (0);
while(true){
if((i__50732__auto___50888 \x3c n__5636__auto___50887)){
(r2[(i__50732__auto___50888 + (0))] \x3d (a1[(i__50732__auto___50888 + r1_l)]));

var G__50889 \x3d (i__50732__auto___50888 + (1));
i__50732__auto___50888 \x3d G__50889;
continue;
} else {
}
break;
}

var l__50731__auto___50890 \x3d (a2_l - (0));
var n__5636__auto___50891 \x3d l__50731__auto___50890;
var i__50732__auto___50892 \x3d (0);
while(true){
if((i__50732__auto___50892 \x3c n__5636__auto___50891)){
(r2[(i__50732__auto___50892 + (a1_l - r1_l))] \x3d (a2[(i__50732__auto___50892 + (0))]));

var G__50893 \x3d (i__50732__auto___50892 + (1));
i__50732__auto___50892 \x3d G__50893;
continue;
} else {
}
break;
}
}

return [r1,r2];
});
me.tonsky.persistent_sorted_set.eq_arr \x3d (function me$tonsky$persistent_sorted_set$eq_arr(cmp,a1,a1_from,a1_to,a2,a2_from,a2_to){
var len \x3d (a1_to - a1_from);
var and__5043__auto__ \x3d (len \x3d\x3d\x3d (a2_to - a2_from));
if(and__5043__auto__){
var i \x3d (0);
while(true){
if((i \x3d\x3d\x3d len)){
return true;
} else {
if((!(((0) \x3d\x3d\x3d (function (){var G__50798 \x3d (a1[(i + a1_from)]);
var G__50799 \x3d (a2[(i + a2_from)]);
return (cmp.cljs$core$IFn$_invoke$arity$2 ? cmp.cljs$core$IFn$_invoke$arity$2(G__50798,G__50799) : cmp.call(null,G__50798,G__50799));
})())))){
return false;
} else {
var G__50894 \x3d (i + (1));
i \x3d G__50894;
continue;

}
}
break;
}
} else {
return and__5043__auto__;
}
});
me.tonsky.persistent_sorted_set.check_n_splice \x3d (function me$tonsky$persistent_sorted_set$check_n_splice(cmp,arr,from,to,new_arr){
if(me.tonsky.persistent_sorted_set.eq_arr(cmp,arr,from,to,new_arr,(0),new_arr.length)){
return arr;
} else {
return me.tonsky.persistent_sorted_set.splice(arr,from,to,new_arr);
}
});
/**
 * Drop non-nil references and return array of arguments
 */
me.tonsky.persistent_sorted_set.return_array \x3d (function me$tonsky$persistent_sorted_set$return_array(var_args){
var G__50801 \x3d arguments.length;
switch (G__50801) {
case 1:
return me.tonsky.persistent_sorted_set.return_array.cljs$core$IFn$_invoke$arity$1((arguments[(0)]));

break;
case 2:
return me.tonsky.persistent_sorted_set.return_array.cljs$core$IFn$_invoke$arity$2((arguments[(0)]),(arguments[(1)]));

break;
case 3:
return me.tonsky.persistent_sorted_set.return_array.cljs$core$IFn$_invoke$arity$3((arguments[(0)]),(arguments[(1)]),(arguments[(2)]));

break;
default:
throw (new Error([\x22Invalid arity: \x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1(arguments.length)].join(\x27\x27)));

}
});

(me.tonsky.persistent_sorted_set.return_array.cljs$core$IFn$_invoke$arity$1 \x3d (function (a1){
return [a1];
}));

(me.tonsky.persistent_sorted_set.return_array.cljs$core$IFn$_invoke$arity$2 \x3d (function (a1,a2){
if(cljs.core.truth_(a1)){
if(cljs.core.truth_(a2)){
return [a1,a2];
} else {
return [a1];
}
} else {
return [a2];
}
}));

(me.tonsky.persistent_sorted_set.return_array.cljs$core$IFn$_invoke$arity$3 \x3d (function (a1,a2,a3){
if(cljs.core.truth_(a1)){
if(cljs.core.truth_(a2)){
if(cljs.core.truth_(a3)){
return [a1,a2,a3];
} else {
return [a1,a2];
}
} else {
if(cljs.core.truth_(a3)){
return [a1,a3];
} else {
return [a1];
}
}
} else {
if(cljs.core.truth_(a2)){
if(cljs.core.truth_(a3)){
return [a2,a3];
} else {
return [a2];
}
} else {
return [a3];
}
}
}));

(me.tonsky.persistent_sorted_set.return_array.cljs$lang$maxFixedArity \x3d 3);


/**
 * @interface
 */
me.tonsky.persistent_sorted_set.INode \x3d function(){};

var me$tonsky$persistent_sorted_set$INode$node_lim_key$dyn_50896 \x3d (function (_){
var x__5393__auto__ \x3d (((_ \x3d\x3d null))?null:_);
var m__5394__auto__ \x3d (me.tonsky.persistent_sorted_set.node_lim_key[goog.typeOf(x__5393__auto__)]);
if((!((m__5394__auto__ \x3d\x3d null)))){
return (m__5394__auto__.cljs$core$IFn$_invoke$arity$1 ? m__5394__auto__.cljs$core$IFn$_invoke$arity$1(_) : m__5394__auto__.call(null,_));
} else {
var m__5392__auto__ \x3d (me.tonsky.persistent_sorted_set.node_lim_key[\x22_\x22]);
if((!((m__5392__auto__ \x3d\x3d null)))){
return (m__5392__auto__.cljs$core$IFn$_invoke$arity$1 ? m__5392__auto__.cljs$core$IFn$_invoke$arity$1(_) : m__5392__auto__.call(null,_));
} else {
throw cljs.core.missing_protocol(\x22INode.node-lim-key\x22,_);
}
}
});
me.tonsky.persistent_sorted_set.node_lim_key \x3d (function me$tonsky$persistent_sorted_set$node_lim_key(_){
if((((!((_ \x3d\x3d null)))) \x26\x26 ((!((_.me$tonsky$persistent_sorted_set$INode$node_lim_key$arity$1 \x3d\x3d null)))))){
return _.me$tonsky$persistent_sorted_set$INode$node_lim_key$arity$1(_);
} else {
return me$tonsky$persistent_sorted_set$INode$node_lim_key$dyn_50896(_);
}
});

var me$tonsky$persistent_sorted_set$INode$node_len$dyn_50897 \x3d (function (_){
var x__5393__auto__ \x3d (((_ \x3d\x3d null))?null:_);
var m__5394__auto__ \x3d (me.tonsky.persistent_sorted_set.node_len[goog.typeOf(x__5393__auto__)]);
if((!((m__5394__auto__ \x3d\x3d null)))){
return (m__5394__auto__.cljs$core$IFn$_invoke$arity$1 ? m__5394__auto__.cljs$core$IFn$_invoke$arity$1(_) : m__5394__auto__.call(null,_));
} else {
var m__5392__auto__ \x3d (me.tonsky.persistent_sorted_set.node_len[\x22_\x22]);
if((!((m__5392__auto__ \x3d\x3d null)))){
return (m__5392__auto__.cljs$core$IFn$_invoke$arity$1 ? m__5392__auto__.cljs$core$IFn$_invoke$arity$1(_) : m__5392__auto__.call(null,_));
} else {
throw cljs.core.missing_protocol(\x22INode.node-len\x22,_);
}
}
});
me.tonsky.persistent_sorted_set.node_len \x3d (function me$tonsky$persistent_sorted_set$node_len(_){
if((((!((_ \x3d\x3d null)))) \x26\x26 ((!((_.me$tonsky$persistent_sorted_set$INode$node_len$arity$1 \x3d\x3d null)))))){
return _.me$tonsky$persistent_sorted_set$INode$node_len$arity$1(_);
} else {
return me$tonsky$persistent_sorted_set$INode$node_len$dyn_50897(_);
}
});

var me$tonsky$persistent_sorted_set$INode$node_merge$dyn_50898 \x3d (function (_,next){
var x__5393__auto__ \x3d (((_ \x3d\x3d null))?null:_);
var m__5394__auto__ \x3d (me.tonsky.persistent_sorted_set.node_merge[goog.typeOf(x__5393__auto__)]);
if((!((m__5394__auto__ \x3d\x3d null)))){
return (m__5394__auto__.cljs$core$IFn$_invoke$arity$2 ? m__5394__auto__.cljs$core$IFn$_invoke$arity$2(_,next) : m__5394__auto__.call(null,_,next));
} else {
var m__5392__auto__ \x3d (me.tonsky.persistent_sorted_set.node_merge[\x22_\x22]);
if((!((m__5392__auto__ \x3d\x3d null)))){
return (m__5392__auto__.cljs$core$IFn$_invoke$arity$2 ? m__5392__auto__.cljs$core$IFn$_invoke$arity$2(_,next) : m__5392__auto__.call(null,_,next));
} else {
throw cljs.core.missing_protocol(\x22INode.node-merge\x22,_);
}
}
});
me.tonsky.persistent_sorted_set.node_merge \x3d (function me$tonsky$persistent_sorted_set$node_merge(_,next){
if((((!((_ \x3d\x3d null)))) \x26\x26 ((!((_.me$tonsky$persistent_sorted_set$INode$node_merge$arity$2 \x3d\x3d null)))))){
return _.me$tonsky$persistent_sorted_set$INode$node_merge$arity$2(_,next);
} else {
return me$tonsky$persistent_sorted_set$INode$node_merge$dyn_50898(_,next);
}
});

var me$tonsky$persistent_sorted_set$INode$node_merge_n_split$dyn_50899 \x3d (function (_,next){
var x__5393__auto__ \x3d (((_ \x3d\x3d null))?null:_);
var m__5394__auto__ \x3d (me.tonsky.persistent_sorted_set.node_merge_n_split[goog.typeOf(x__5393__auto__)]);
if((!((m__5394__auto__ \x3d\x3d null)))){
return (m__5394__auto__.cljs$core$IFn$_invoke$arity$2 ? m__5394__auto__.cljs$core$IFn$_invoke$arity$2(_,next) : m__5394__auto__.call(null,_,next));
} else {
var m__5392__auto__ \x3d (me.tonsky.persistent_sorted_set.node_merge_n_split[\x22_\x22]);
if((!((m__5392__auto__ \x3d\x3d null)))){
return (m__5392__auto__.cljs$core$IFn$_invoke$arity$2 ? m__5392__auto__.cljs$core$IFn$_invoke$arity$2(_,next) : m__5392__auto__.call(null,_,next));
} else {
throw cljs.core.missing_protocol(\x22INode.node-merge-n-split\x22,_);
}
}
});
me.tonsky.persistent_sorted_set.node_merge_n_split \x3d (function me$tonsky$persistent_sorted_set$node_merge_n_split(_,next){
if((((!((_ \x3d\x3d null)))) \x26\x26 ((!((_.me$tonsky$persistent_sorted_set$INode$node_merge_n_split$arity$2 \x3d\x3d null)))))){
return _.me$tonsky$persistent_sorted_set$INode$node_merge_n_split$arity$2(_,next);
} else {
return me$tonsky$persistent_sorted_set$INode$node_merge_n_split$dyn_50899(_,next);
}
});

var me$tonsky$persistent_sorted_set$INode$node_lookup$dyn_50900 \x3d (function (_,cmp,key){
var x__5393__auto__ \x3d (((_ \x3d\x3d null))?null:_);
var m__5394__auto__ \x3d (me.tonsky.persistent_sorted_set.node_lookup[goog.typeOf(x__5393__auto__)]);
if((!((m__5394__auto__ \x3d\x3d null)))){
return (m__5394__auto__.cljs$core$IFn$_invoke$arity$3 ? m__5394__auto__.cljs$core$IFn$_invoke$arity$3(_,cmp,key) : m__5394__auto__.call(null,_,cmp,key));
} else {
var m__5392__auto__ \x3d (me.tonsky.persistent_sorted_set.node_lookup[\x22_\x22]);
if((!((m__5392__auto__ \x3d\x3d null)))){
return (m__5392__auto__.cljs$core$IFn$_invoke$arity$3 ? m__5392__auto__.cljs$core$IFn$_invoke$arity$3(_,cmp,key) : m__5392__auto__.call(null,_,cmp,key));
} else {
throw cljs.core.missing_protocol(\x22INode.node-lookup\x22,_);
}
}
});
me.tonsky.persistent_sorted_set.node_lookup \x3d (function me$tonsky$persistent_sorted_set$node_lookup(_,cmp,key){
if((((!((_ \x3d\x3d null)))) \x26\x26 ((!((_.me$tonsky$persistent_sorted_set$INode$node_lookup$arity$3 \x3d\x3d null)))))){
return _.me$tonsky$persistent_sorted_set$INode$node_lookup$arity$3(_,cmp,key);
} else {
return me$tonsky$persistent_sorted_set$INode$node_lookup$dyn_50900(_,cmp,key);
}
});

var me$tonsky$persistent_sorted_set$INode$node_conj$dyn_50901 \x3d (function (_,cmp,key){
var x__5393__auto__ \x3d (((_ \x3d\x3d null))?null:_);
var m__5394__auto__ \x3d (me.tonsky.persistent_sorted_set.node_conj[goog.typeOf(x__5393__auto__)]);
if((!((m__5394__auto__ \x3d\x3d null)))){
return (m__5394__auto__.cljs$core$IFn$_invoke$arity$3 ? m__5394__auto__.cljs$core$IFn$_invoke$arity$3(_,cmp,key) : m__5394__auto__.call(null,_,cmp,key));
} else {
var m__5392__auto__ \x3d (me.tonsky.persistent_sorted_set.node_conj[\x22_\x22]);
if((!((m__5392__auto__ \x3d\x3d null)))){
return (m__5392__auto__.cljs$core$IFn$_invoke$arity$3 ? m__5392__auto__.cljs$core$IFn$_invoke$arity$3(_,cmp,key) : m__5392__auto__.call(null,_,cmp,key));
} else {
throw cljs.core.missing_protocol(\x22INode.node-conj\x22,_);
}
}
});
me.tonsky.persistent_sorted_set.node_conj \x3d (function me$tonsky$persistent_sorted_set$node_conj(_,cmp,key){
if((((!((_ \x3d\x3d null)))) \x26\x26 ((!((_.me$tonsky$persistent_sorted_set$INode$node_conj$arity$3 \x3d\x3d null)))))){
return _.me$tonsky$persistent_sorted_set$INode$node_conj$arity$3(_,cmp,key);
} else {
return me$tonsky$persistent_sorted_set$INode$node_conj$dyn_50901(_,cmp,key);
}
});

var me$tonsky$persistent_sorted_set$INode$node_disj$dyn_50902 \x3d (function (_,cmp,key,root_QMARK_,left,right){
var x__5393__auto__ \x3d (((_ \x3d\x3d null))?null:_);
var m__5394__auto__ \x3d (me.tonsky.persistent_sorted_set.node_disj[goog.typeOf(x__5393__auto__)]);
if((!((m__5394__auto__ \x3d\x3d null)))){
return (m__5394__auto__.cljs$core$IFn$_invoke$arity$6 ? m__5394__auto__.cljs$core$IFn$_invoke$arity$6(_,cmp,key,root_QMARK_,left,right) : m__5394__auto__.call(null,_,cmp,key,root_QMARK_,left,right));
} else {
var m__5392__auto__ \x3d (me.tonsky.persistent_sorted_set.node_disj[\x22_\x22]);
if((!((m__5392__auto__ \x3d\x3d null)))){
return (m__5392__auto__.cljs$core$IFn$_invoke$arity$6 ? m__5392__auto__.cljs$core$IFn$_invoke$arity$6(_,cmp,key,root_QMARK_,left,right) : m__5392__auto__.call(null,_,cmp,key,root_QMARK_,left,right));
} else {
throw cljs.core.missing_protocol(\x22INode.node-disj\x22,_);
}
}
});
me.tonsky.persistent_sorted_set.node_disj \x3d (function me$tonsky$persistent_sorted_set$node_disj(_,cmp,key,root_QMARK_,left,right){
if((((!((_ \x3d\x3d null)))) \x26\x26 ((!((_.me$tonsky$persistent_sorted_set$INode$node_disj$arity$6 \x3d\x3d null)))))){
return _.me$tonsky$persistent_sorted_set$INode$node_disj$arity$6(_,cmp,key,root_QMARK_,left,right);
} else {
return me$tonsky$persistent_sorted_set$INode$node_disj$dyn_50902(_,cmp,key,root_QMARK_,left,right);
}
});

me.tonsky.persistent_sorted_set.rotate \x3d (function me$tonsky$persistent_sorted_set$rotate(node,root_QMARK_,left,right){
if(cljs.core.truth_(root_QMARK_)){
return me.tonsky.persistent_sorted_set.return_array.cljs$core$IFn$_invoke$arity$1(node);
} else {
if((me.tonsky.persistent_sorted_set.node_len(node) \x3e (16))){
return me.tonsky.persistent_sorted_set.return_array.cljs$core$IFn$_invoke$arity$3(left,node,right);
} else {
if(cljs.core.truth_((function (){var and__5043__auto__ \x3d left;
if(cljs.core.truth_(and__5043__auto__)){
return (me.tonsky.persistent_sorted_set.node_len(left) \x3c\x3d (16));
} else {
return and__5043__auto__;
}
})())){
return me.tonsky.persistent_sorted_set.return_array.cljs$core$IFn$_invoke$arity$2(me.tonsky.persistent_sorted_set.node_merge(left,node),right);
} else {
if(cljs.core.truth_((function (){var and__5043__auto__ \x3d right;
if(cljs.core.truth_(and__5043__auto__)){
return (me.tonsky.persistent_sorted_set.node_len(right) \x3c\x3d (16));
} else {
return and__5043__auto__;
}
})())){
return me.tonsky.persistent_sorted_set.return_array.cljs$core$IFn$_invoke$arity$2(left,me.tonsky.persistent_sorted_set.node_merge(node,right));
} else {
if(cljs.core.truth_((function (){var and__5043__auto__ \x3d left;
if(cljs.core.truth_(and__5043__auto__)){
return (((right \x3d\x3d null)) || ((me.tonsky.persistent_sorted_set.node_len(left) \x3c me.tonsky.persistent_sorted_set.node_len(right))));
} else {
return and__5043__auto__;
}
})())){
var nodes \x3d me.tonsky.persistent_sorted_set.node_merge_n_split(left,node);
return me.tonsky.persistent_sorted_set.return_array.cljs$core$IFn$_invoke$arity$3((nodes[(0)]),(nodes[(1)]),right);
} else {
var nodes \x3d me.tonsky.persistent_sorted_set.node_merge_n_split(node,right);
return me.tonsky.persistent_sorted_set.return_array.cljs$core$IFn$_invoke$arity$3(left,(nodes[(0)]),(nodes[(1)]));

}
}
}
}
}
});

/**
* @constructor
 * @implements {me.tonsky.persistent_sorted_set.INode}
*/
me.tonsky.persistent_sorted_set.Node \x3d (function (keys,pointers){
this.keys \x3d keys;
this.pointers \x3d pointers;
});
(me.tonsky.persistent_sorted_set.Node.prototype.me$tonsky$persistent_sorted_set$INode$ \x3d cljs.core.PROTOCOL_SENTINEL);

(me.tonsky.persistent_sorted_set.Node.prototype.me$tonsky$persistent_sorted_set$INode$node_lim_key$arity$1 \x3d (function (_){
var self__ \x3d this;
var ___$1 \x3d this;
var arr__50758__auto__ \x3d self__.keys;
return (arr__50758__auto__[(arr__50758__auto__.length - (1))]);
}));

(me.tonsky.persistent_sorted_set.Node.prototype.me$tonsky$persistent_sorted_set$INode$node_len$arity$1 \x3d (function (_){
var self__ \x3d this;
var ___$1 \x3d this;
return self__.keys.length;
}));

(me.tonsky.persistent_sorted_set.Node.prototype.me$tonsky$persistent_sorted_set$INode$node_merge$arity$2 \x3d (function (_,next){
var self__ \x3d this;
var ___$1 \x3d this;
return (new me.tonsky.persistent_sorted_set.Node(me.tonsky.persistent_sorted_set.arrays.aconcat(self__.keys,next.keys),me.tonsky.persistent_sorted_set.arrays.aconcat(self__.pointers,next.pointers)));
}));

(me.tonsky.persistent_sorted_set.Node.prototype.me$tonsky$persistent_sorted_set$INode$node_merge_n_split$arity$2 \x3d (function (_,next){
var self__ \x3d this;
var ___$1 \x3d this;
var ks \x3d me.tonsky.persistent_sorted_set.merge_n_split(self__.keys,next.keys);
var ps \x3d me.tonsky.persistent_sorted_set.merge_n_split(self__.pointers,next.pointers);
return me.tonsky.persistent_sorted_set.return_array.cljs$core$IFn$_invoke$arity$2((new me.tonsky.persistent_sorted_set.Node((ks[(0)]),(ps[(0)]))),(new me.tonsky.persistent_sorted_set.Node((ks[(1)]),(ps[(1)]))));
}));

(me.tonsky.persistent_sorted_set.Node.prototype.me$tonsky$persistent_sorted_set$INode$node_lookup$arity$3 \x3d (function (_,cmp,key){
var self__ \x3d this;
var ___$1 \x3d this;
var idx \x3d me.tonsky.persistent_sorted_set.lookup_range(cmp,self__.keys,key);
if(((-1) \x3d\x3d\x3d idx)){
return null;
} else {
return me.tonsky.persistent_sorted_set.node_lookup((self__.pointers[idx]),cmp,key);
}
}));

(me.tonsky.persistent_sorted_set.Node.prototype.me$tonsky$persistent_sorted_set$INode$node_conj$arity$3 \x3d (function (_,cmp,key){
var self__ \x3d this;
var ___$1 \x3d this;
var idx \x3d me.tonsky.persistent_sorted_set.binary_search_l(cmp,self__.keys,(self__.keys.length - (2)),key);
var nodes \x3d me.tonsky.persistent_sorted_set.node_conj((self__.pointers[idx]),cmp,key);
if(cljs.core.truth_(nodes)){
var new_keys \x3d me.tonsky.persistent_sorted_set.check_n_splice(cmp,self__.keys,idx,(idx + (1)),me.tonsky.persistent_sorted_set.arrays.amap(me.tonsky.persistent_sorted_set.node_lim_key,nodes));
var new_pointers \x3d me.tonsky.persistent_sorted_set.splice(self__.pointers,idx,(idx + (1)),nodes);
if((new_pointers.length \x3c\x3d (32))){
return [(new me.tonsky.persistent_sorted_set.Node(new_keys,new_pointers))];
} else {
var middle \x3d (new_pointers.length \x3e\x3e\x3e (1));
return [(new me.tonsky.persistent_sorted_set.Node(new_keys.slice((0),middle),new_pointers.slice((0),middle))),(new me.tonsky.persistent_sorted_set.Node(new_keys.slice(middle),new_pointers.slice(middle)))];
}
} else {
return null;
}
}));

(me.tonsky.persistent_sorted_set.Node.prototype.me$tonsky$persistent_sorted_set$INode$node_disj$arity$6 \x3d (function (_,cmp,key,root_QMARK_,left,right){
var self__ \x3d this;
var ___$1 \x3d this;
var idx \x3d me.tonsky.persistent_sorted_set.lookup_range(cmp,self__.keys,key);
if(((-1) \x3d\x3d\x3d idx)){
return null;
} else {
var child \x3d (self__.pointers[idx]);
var left_child \x3d ((((idx - (1)) \x3e\x3d (0)))?(self__.pointers[(idx - (1))]):null);
var right_child \x3d ((((idx + (1)) \x3c self__.pointers.length))?(self__.pointers[(idx + (1))]):null);
var disjned \x3d me.tonsky.persistent_sorted_set.node_disj(child,cmp,key,false,left_child,right_child);
if(cljs.core.truth_(disjned)){
var left_idx \x3d (cljs.core.truth_(left_child)?(idx - (1)):idx);
var right_idx \x3d (cljs.core.truth_(right_child)?((2) + idx):((1) + idx));
var new_keys \x3d me.tonsky.persistent_sorted_set.check_n_splice(cmp,self__.keys,left_idx,right_idx,me.tonsky.persistent_sorted_set.arrays.amap(me.tonsky.persistent_sorted_set.node_lim_key,disjned));
var new_pointers \x3d me.tonsky.persistent_sorted_set.splice(self__.pointers,left_idx,right_idx,disjned);
return me.tonsky.persistent_sorted_set.rotate((new me.tonsky.persistent_sorted_set.Node(new_keys,new_pointers)),root_QMARK_,left,right);
} else {
return null;
}
}
}));

(me.tonsky.persistent_sorted_set.Node.getBasis \x3d (function (){
return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22keys\x22,\x22keys\x22,-1586012071,null),new cljs.core.Symbol(null,\x22pointers\x22,\x22pointers\x22,-1669058356,null)], null);
}));

(me.tonsky.persistent_sorted_set.Node.cljs$lang$type \x3d true);

(me.tonsky.persistent_sorted_set.Node.cljs$lang$ctorStr \x3d \x22me.tonsky.persistent-sorted-set/Node\x22);

(me.tonsky.persistent_sorted_set.Node.cljs$lang$ctorPrWriter \x3d (function (this__5330__auto__,writer__5331__auto__,opt__5332__auto__){
return cljs.core._write(writer__5331__auto__,\x22me.tonsky.persistent-sorted-set/Node\x22);
}));

/**
 * Positional factory function for me.tonsky.persistent-sorted-set/Node.
 */
me.tonsky.persistent_sorted_set.__GT_Node \x3d (function me$tonsky$persistent_sorted_set$__GT_Node(keys,pointers){
return (new me.tonsky.persistent_sorted_set.Node(keys,pointers));
});


/**
* @constructor
 * @implements {me.tonsky.persistent_sorted_set.INode}
*/
me.tonsky.persistent_sorted_set.Leaf \x3d (function (keys){
this.keys \x3d keys;
});
(me.tonsky.persistent_sorted_set.Leaf.prototype.me$tonsky$persistent_sorted_set$INode$ \x3d cljs.core.PROTOCOL_SENTINEL);

(me.tonsky.persistent_sorted_set.Leaf.prototype.me$tonsky$persistent_sorted_set$INode$node_lim_key$arity$1 \x3d (function (_){
var self__ \x3d this;
var ___$1 \x3d this;
var arr__50758__auto__ \x3d self__.keys;
return (arr__50758__auto__[(arr__50758__auto__.length - (1))]);
}));

(me.tonsky.persistent_sorted_set.Leaf.prototype.me$tonsky$persistent_sorted_set$INode$node_len$arity$1 \x3d (function (_){
var self__ \x3d this;
var ___$1 \x3d this;
return self__.keys.length;
}));

(me.tonsky.persistent_sorted_set.Leaf.prototype.me$tonsky$persistent_sorted_set$INode$node_merge$arity$2 \x3d (function (_,next){
var self__ \x3d this;
var ___$1 \x3d this;
return (new me.tonsky.persistent_sorted_set.Leaf(me.tonsky.persistent_sorted_set.arrays.aconcat(self__.keys,next.keys)));
}));

(me.tonsky.persistent_sorted_set.Leaf.prototype.me$tonsky$persistent_sorted_set$INode$node_merge_n_split$arity$2 \x3d (function (_,next){
var self__ \x3d this;
var ___$1 \x3d this;
var ks \x3d me.tonsky.persistent_sorted_set.merge_n_split(self__.keys,next.keys);
return me.tonsky.persistent_sorted_set.return_array.cljs$core$IFn$_invoke$arity$2((new me.tonsky.persistent_sorted_set.Leaf((ks[(0)]))),(new me.tonsky.persistent_sorted_set.Leaf((ks[(1)]))));
}));

(me.tonsky.persistent_sorted_set.Leaf.prototype.me$tonsky$persistent_sorted_set$INode$node_lookup$arity$3 \x3d (function (_,cmp,key){
var self__ \x3d this;
var ___$1 \x3d this;
var idx \x3d me.tonsky.persistent_sorted_set.lookup_exact(cmp,self__.keys,key);
if(((-1) \x3d\x3d\x3d idx)){
return null;
} else {
return (self__.keys[idx]);
}
}));

(me.tonsky.persistent_sorted_set.Leaf.prototype.me$tonsky$persistent_sorted_set$INode$node_conj$arity$3 \x3d (function (_,cmp,key){
var self__ \x3d this;
var ___$1 \x3d this;
var idx \x3d me.tonsky.persistent_sorted_set.binary_search_l(cmp,self__.keys,(self__.keys.length - (1)),key);
var keys_l \x3d self__.keys.length;
if((((idx \x3c keys_l)) \x26\x26 (((0) \x3d\x3d\x3d (function (){var G__50802 \x3d key;
var G__50803 \x3d (self__.keys[idx]);
return (cmp.cljs$core$IFn$_invoke$arity$2 ? cmp.cljs$core$IFn$_invoke$arity$2(G__50802,G__50803) : cmp.call(null,G__50802,G__50803));
})())))){
return null;
} else {
if((keys_l \x3d\x3d\x3d (32))){
var middle \x3d ((keys_l + (1)) \x3e\x3e\x3e (1));
if((idx \x3e middle)){
return [(new me.tonsky.persistent_sorted_set.Leaf(self__.keys.slice((0),middle))),(new me.tonsky.persistent_sorted_set.Leaf(me.tonsky.persistent_sorted_set.cut_n_splice(self__.keys,middle,keys_l,idx,idx,[key])))];
} else {
return [(new me.tonsky.persistent_sorted_set.Leaf(me.tonsky.persistent_sorted_set.cut_n_splice(self__.keys,(0),middle,idx,idx,[key]))),(new me.tonsky.persistent_sorted_set.Leaf(self__.keys.slice(middle,keys_l)))];
}
} else {
return [(new me.tonsky.persistent_sorted_set.Leaf(me.tonsky.persistent_sorted_set.splice(self__.keys,idx,idx,[key])))];

}
}
}));

(me.tonsky.persistent_sorted_set.Leaf.prototype.me$tonsky$persistent_sorted_set$INode$node_disj$arity$6 \x3d (function (_,cmp,key,root_QMARK_,left,right){
var self__ \x3d this;
var ___$1 \x3d this;
var idx \x3d me.tonsky.persistent_sorted_set.lookup_exact(cmp,self__.keys,key);
if(((-1) \x3d\x3d\x3d idx)){
return null;
} else {
var new_keys \x3d me.tonsky.persistent_sorted_set.splice(self__.keys,idx,(idx + (1)),[]);
return me.tonsky.persistent_sorted_set.rotate((new me.tonsky.persistent_sorted_set.Leaf(new_keys)),root_QMARK_,left,right);
}
}));

(me.tonsky.persistent_sorted_set.Leaf.getBasis \x3d (function (){
return new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22keys\x22,\x22keys\x22,-1586012071,null)], null);
}));

(me.tonsky.persistent_sorted_set.Leaf.cljs$lang$type \x3d true);

(me.tonsky.persistent_sorted_set.Leaf.cljs$lang$ctorStr \x3d \x22me.tonsky.persistent-sorted-set/Leaf\x22);

(me.tonsky.persistent_sorted_set.Leaf.cljs$lang$ctorPrWriter \x3d (function (this__5330__auto__,writer__5331__auto__,opt__5332__auto__){
return cljs.core._write(writer__5331__auto__,\x22me.tonsky.persistent-sorted-set/Leaf\x22);
}));

/**
 * Positional factory function for me.tonsky.persistent-sorted-set/Leaf.
 */
me.tonsky.persistent_sorted_set.__GT_Leaf \x3d (function me$tonsky$persistent_sorted_set$__GT_Leaf(keys){
return (new me.tonsky.persistent_sorted_set.Leaf(keys));
});



me.tonsky.persistent_sorted_set.uninitialized_hash \x3d null;

/**
* @constructor
 * @implements {cljs.core.IReversible}
 * @implements {cljs.core.ITransientSet}
 * @implements {cljs.core.IEquiv}
 * @implements {cljs.core.IHash}
 * @implements {cljs.core.IFn}
 * @implements {cljs.core.ICollection}
 * @implements {cljs.core.IEditableCollection}
 * @implements {cljs.core.ISet}
 * @implements {cljs.core.IEmptyableCollection}
 * @implements {cljs.core.ICounted}
 * @implements {cljs.core.ISeqable}
 * @implements {cljs.core.IMeta}
 * @implements {cljs.core.ICloneable}
 * @implements {cljs.core.ITransientCollection}
 * @implements {cljs.core.IPrintWithWriter}
 * @implements {cljs.core.IWithMeta}
 * @implements {cljs.core.ILookup}
 * @implements {cljs.core.IReduce}
*/
me.tonsky.persistent_sorted_set.BTSet \x3d (function (root,shift,cnt,comparator,meta,_hash){
this.root \x3d root;
this.shift \x3d shift;
this.cnt \x3d cnt;
this.comparator \x3d comparator;
this.meta \x3d meta;
this._hash \x3d _hash;
this.cljs$lang$protocol_mask$partition0$ \x3d 2297303311;
this.cljs$lang$protocol_mask$partition1$ \x3d 8332;
});
(me.tonsky.persistent_sorted_set.BTSet.prototype.toString \x3d (function (){
var self__ \x3d this;
var this$ \x3d this;
return cljs.core.pr_str_STAR_(this$);
}));

(me.tonsky.persistent_sorted_set.BTSet.prototype.cljs$core$ILookup$_lookup$arity$2 \x3d (function (_,k){
var self__ \x3d this;
var ___$1 \x3d this;
return me.tonsky.persistent_sorted_set.node_lookup(self__.root,self__.comparator,k);
}));

(me.tonsky.persistent_sorted_set.BTSet.prototype.cljs$core$ILookup$_lookup$arity$3 \x3d (function (_,k,not_found){
var self__ \x3d this;
var ___$1 \x3d this;
var or__5045__auto__ \x3d me.tonsky.persistent_sorted_set.node_lookup(self__.root,self__.comparator,k);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return not_found;
}
}));

(me.tonsky.persistent_sorted_set.BTSet.prototype.cljs$core$IPrintWithWriter$_pr_writer$arity$3 \x3d (function (this$,writer,opts){
var self__ \x3d this;
var this$__$1 \x3d this;
return cljs.core.pr_sequential_writer(writer,cljs.core.pr_writer,\x22#{\x22,\x22 \x22,\x22}\x22,opts,cljs.core.seq(this$__$1));
}));

(me.tonsky.persistent_sorted_set.BTSet.prototype.cljs$core$IMeta$_meta$arity$1 \x3d (function (_){
var self__ \x3d this;
var ___$1 \x3d this;
return self__.meta;
}));

(me.tonsky.persistent_sorted_set.BTSet.prototype.cljs$core$ICloneable$_clone$arity$1 \x3d (function (_){
var self__ \x3d this;
var ___$1 \x3d this;
return (new me.tonsky.persistent_sorted_set.BTSet(self__.root,self__.shift,self__.cnt,self__.comparator,self__.meta,self__._hash));
}));

(me.tonsky.persistent_sorted_set.BTSet.prototype.cljs$core$ICounted$_count$arity$1 \x3d (function (_){
var self__ \x3d this;
var ___$1 \x3d this;
return self__.cnt;
}));

(me.tonsky.persistent_sorted_set.BTSet.prototype.cljs$core$IReversible$_rseq$arity$1 \x3d (function (this$){
var self__ \x3d this;
var this$__$1 \x3d this;
return cljs.core.rseq((me.tonsky.persistent_sorted_set.btset_iter.cljs$core$IFn$_invoke$arity$1 ? me.tonsky.persistent_sorted_set.btset_iter.cljs$core$IFn$_invoke$arity$1(this$__$1) : me.tonsky.persistent_sorted_set.btset_iter.call(null,this$__$1)));
}));

(me.tonsky.persistent_sorted_set.BTSet.prototype.cljs$core$IHash$_hash$arity$1 \x3d (function (this$){
var self__ \x3d this;
var this$__$1 \x3d this;
var h__5154__auto__ \x3d self__._hash;
if((!((h__5154__auto__ \x3d\x3d null)))){
return h__5154__auto__;
} else {
var h__5154__auto____$1 \x3d cljs.core.hash_unordered_coll(this$__$1);
(self__._hash \x3d h__5154__auto____$1);

return h__5154__auto____$1;
}
}));

(me.tonsky.persistent_sorted_set.BTSet.prototype.cljs$core$IEquiv$_equiv$arity$2 \x3d (function (this$,other){
var self__ \x3d this;
var this$__$1 \x3d this;
return ((cljs.core.set_QMARK_(other)) \x26\x26 ((((self__.cnt \x3d\x3d\x3d cljs.core.count(other))) \x26\x26 (cljs.core.every_QMARK_((function (p1__50804_SHARP_){
return cljs.core.contains_QMARK_(this$__$1,p1__50804_SHARP_);
}),other)))));
}));

(me.tonsky.persistent_sorted_set.BTSet.prototype.cljs$core$IEditableCollection$_as_transient$arity$1 \x3d (function (this$){
var self__ \x3d this;
var this$__$1 \x3d this;
return this$__$1;
}));

(me.tonsky.persistent_sorted_set.BTSet.prototype.cljs$core$IEmptyableCollection$_empty$arity$1 \x3d (function (_){
var self__ \x3d this;
var ___$1 \x3d this;
return (new me.tonsky.persistent_sorted_set.BTSet((new me.tonsky.persistent_sorted_set.Leaf([])),(0),(0),self__.comparator,self__.meta,null));
}));

(me.tonsky.persistent_sorted_set.BTSet.prototype.cljs$core$ISet$_disjoin$arity$2 \x3d (function (this$,key){
var self__ \x3d this;
var this$__$1 \x3d this;
return (me.tonsky.persistent_sorted_set.disj.cljs$core$IFn$_invoke$arity$3 ? me.tonsky.persistent_sorted_set.disj.cljs$core$IFn$_invoke$arity$3(this$__$1,key,self__.comparator) : me.tonsky.persistent_sorted_set.disj.call(null,this$__$1,key,self__.comparator));
}));

(me.tonsky.persistent_sorted_set.BTSet.prototype.cljs$core$IReduce$_reduce$arity$2 \x3d (function (this$,f){
var self__ \x3d this;
var this$__$1 \x3d this;
var temp__5802__auto__ \x3d (me.tonsky.persistent_sorted_set.btset_iter.cljs$core$IFn$_invoke$arity$1 ? me.tonsky.persistent_sorted_set.btset_iter.cljs$core$IFn$_invoke$arity$1(this$__$1) : me.tonsky.persistent_sorted_set.btset_iter.call(null,this$__$1));
if(cljs.core.truth_(temp__5802__auto__)){
var i \x3d temp__5802__auto__;
return cljs.core._reduce(i,f);
} else {
return (f.cljs$core$IFn$_invoke$arity$0 ? f.cljs$core$IFn$_invoke$arity$0() : f.call(null));
}
}));

(me.tonsky.persistent_sorted_set.BTSet.prototype.cljs$core$IReduce$_reduce$arity$3 \x3d (function (this$,f,start){
var self__ \x3d this;
var this$__$1 \x3d this;
var temp__5802__auto__ \x3d (me.tonsky.persistent_sorted_set.btset_iter.cljs$core$IFn$_invoke$arity$1 ? me.tonsky.persistent_sorted_set.btset_iter.cljs$core$IFn$_invoke$arity$1(this$__$1) : me.tonsky.persistent_sorted_set.btset_iter.call(null,this$__$1));
if(cljs.core.truth_(temp__5802__auto__)){
var i \x3d temp__5802__auto__;
return cljs.core._reduce(i,f,start);
} else {
return start;
}
}));

(me.tonsky.persistent_sorted_set.BTSet.prototype.cljs$core$ITransientCollection$_conj_BANG_$arity$2 \x3d (function (this$,key){
var self__ \x3d this;
var this$__$1 \x3d this;
return (me.tonsky.persistent_sorted_set.conj.cljs$core$IFn$_invoke$arity$3 ? me.tonsky.persistent_sorted_set.conj.cljs$core$IFn$_invoke$arity$3(this$__$1,key,self__.comparator) : me.tonsky.persistent_sorted_set.conj.call(null,this$__$1,key,self__.comparator));
}));

(me.tonsky.persistent_sorted_set.BTSet.prototype.cljs$core$ITransientCollection$_persistent_BANG_$arity$1 \x3d (function (this$){
var self__ \x3d this;
var this$__$1 \x3d this;
return this$__$1;
}));

(me.tonsky.persistent_sorted_set.BTSet.prototype.cljs$core$ISeqable$_seq$arity$1 \x3d (function (this$){
var self__ \x3d this;
var this$__$1 \x3d this;
return (me.tonsky.persistent_sorted_set.btset_iter.cljs$core$IFn$_invoke$arity$1 ? me.tonsky.persistent_sorted_set.btset_iter.cljs$core$IFn$_invoke$arity$1(this$__$1) : me.tonsky.persistent_sorted_set.btset_iter.call(null,this$__$1));
}));

(me.tonsky.persistent_sorted_set.BTSet.prototype.cljs$core$ITransientSet$_disjoin_BANG_$arity$2 \x3d (function (this$,key){
var self__ \x3d this;
var this$__$1 \x3d this;
return (me.tonsky.persistent_sorted_set.disj.cljs$core$IFn$_invoke$arity$3 ? me.tonsky.persistent_sorted_set.disj.cljs$core$IFn$_invoke$arity$3(this$__$1,key,self__.comparator) : me.tonsky.persistent_sorted_set.disj.call(null,this$__$1,key,self__.comparator));
}));

(me.tonsky.persistent_sorted_set.BTSet.prototype.cljs$core$IWithMeta$_with_meta$arity$2 \x3d (function (_,new_meta){
var self__ \x3d this;
var ___$1 \x3d this;
return (new me.tonsky.persistent_sorted_set.BTSet(self__.root,self__.shift,self__.cnt,self__.comparator,new_meta,self__._hash));
}));

(me.tonsky.persistent_sorted_set.BTSet.prototype.cljs$core$ICollection$_conj$arity$2 \x3d (function (this$,key){
var self__ \x3d this;
var this$__$1 \x3d this;
return (me.tonsky.persistent_sorted_set.conj.cljs$core$IFn$_invoke$arity$3 ? me.tonsky.persistent_sorted_set.conj.cljs$core$IFn$_invoke$arity$3(this$__$1,key,self__.comparator) : me.tonsky.persistent_sorted_set.conj.call(null,this$__$1,key,self__.comparator));
}));

(me.tonsky.persistent_sorted_set.BTSet.prototype.call \x3d (function (unused__11785__auto__){
var self__ \x3d this;
var self__ \x3d this;
var G__50806 \x3d (arguments.length - (1));
switch (G__50806) {
case (1):
return self__.cljs$core$IFn$_invoke$arity$1((arguments[(1)]));

break;
case (2):
return self__.cljs$core$IFn$_invoke$arity$2((arguments[(1)]),(arguments[(2)]));

break;
default:
throw (new Error([\x22Invalid arity: \x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1((arguments.length - (1)))].join(\x27\x27)));

}
}));

(me.tonsky.persistent_sorted_set.BTSet.prototype.apply \x3d (function (self__,args50805){
var self__ \x3d this;
var self____$1 \x3d this;
return self____$1.call.apply(self____$1,[self____$1].concat(cljs.core.aclone(args50805)));
}));

(me.tonsky.persistent_sorted_set.BTSet.prototype.cljs$core$IFn$_invoke$arity$1 \x3d (function (k){
var self__ \x3d this;
var this$ \x3d this;
return this$.cljs$core$ILookup$_lookup$arity$2(null,k);
}));

(me.tonsky.persistent_sorted_set.BTSet.prototype.cljs$core$IFn$_invoke$arity$2 \x3d (function (k,not_found){
var self__ \x3d this;
var this$ \x3d this;
return this$.cljs$core$ILookup$_lookup$arity$3(null,k,not_found);
}));

(me.tonsky.persistent_sorted_set.BTSet.getBasis \x3d (function (){
return new cljs.core.PersistentVector(null, 6, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22root\x22,\x22root\x22,1191874074,null),new cljs.core.Symbol(null,\x22shift\x22,\x22shift\x22,-1657295705,null),new cljs.core.Symbol(null,\x22cnt\x22,\x22cnt\x22,1924510325,null),new cljs.core.Symbol(null,\x22comparator\x22,\x22comparator\x22,-509539107,null),new cljs.core.Symbol(null,\x22meta\x22,\x22meta\x22,-1154898805,null),cljs.core.with_meta(new cljs.core.Symbol(null,\x22_hash\x22,\x22_hash\x22,-2130838312,null),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,\x22mutable\x22,\x22mutable\x22,875778266),true], null))], null);
}));

(me.tonsky.persistent_sorted_set.BTSet.cljs$lang$type \x3d true);

(me.tonsky.persistent_sorted_set.BTSet.cljs$lang$ctorStr \x3d \x22me.tonsky.persistent-sorted-set/BTSet\x22);

(me.tonsky.persistent_sorted_set.BTSet.cljs$lang$ctorPrWriter \x3d (function (this__5330__auto__,writer__5331__auto__,opt__5332__auto__){
return cljs.core._write(writer__5331__auto__,\x22me.tonsky.persistent-sorted-set/BTSet\x22);
}));

/**
 * Positional factory function for me.tonsky.persistent-sorted-set/BTSet.
 */
me.tonsky.persistent_sorted_set.__GT_BTSet \x3d (function me$tonsky$persistent_sorted_set$__GT_BTSet(root,shift,cnt,comparator,meta,_hash){
return (new me.tonsky.persistent_sorted_set.BTSet(root,shift,cnt,comparator,meta,_hash));
});

me.tonsky.persistent_sorted_set.keys_for \x3d (function me$tonsky$persistent_sorted_set$keys_for(set,path){
var level \x3d set.shift;
var node \x3d set.root;
while(true){
if((level \x3e (0))){
var G__50923 \x3d (level - me.tonsky.persistent_sorted_set.level_shift);
var G__50924 \x3d (node.pointers[me.tonsky.persistent_sorted_set.path_get(path,level)]);
level \x3d G__50923;
node \x3d G__50924;
continue;
} else {
return node.keys;
}
break;
}
});
me.tonsky.persistent_sorted_set.alter_btset \x3d (function me$tonsky$persistent_sorted_set$alter_btset(set,root,shift,cnt){
return (new me.tonsky.persistent_sorted_set.BTSet(root,shift,cnt,set.comparator,set.meta,null));
});
me.tonsky.persistent_sorted_set._next_path \x3d (function me$tonsky$persistent_sorted_set$_next_path(node,path,level){
var idx \x3d me.tonsky.persistent_sorted_set.path_get(path,level);
if((level \x3e (0))){
var sub_path \x3d (function (){var G__50807 \x3d (node.pointers[idx]);
var G__50808 \x3d path;
var G__50809 \x3d (level - me.tonsky.persistent_sorted_set.level_shift);
return (me.tonsky.persistent_sorted_set._next_path.cljs$core$IFn$_invoke$arity$3 ? me.tonsky.persistent_sorted_set._next_path.cljs$core$IFn$_invoke$arity$3(G__50807,G__50808,G__50809) : me.tonsky.persistent_sorted_set._next_path.call(null,G__50807,G__50808,G__50809));
})();
if(((-1) \x3d\x3d\x3d sub_path)){
if(((idx + (1)) \x3c node.pointers.length)){
return me.tonsky.persistent_sorted_set.path_set((0),level,(idx + (1)));
} else {
return (-1);
}
} else {
return me.tonsky.persistent_sorted_set.path_set(sub_path,level,idx);
}
} else {
if(((idx + (1)) \x3c node.keys.length)){
return me.tonsky.persistent_sorted_set.path_set((0),(0),(idx + (1)));
} else {
return (-1);
}
}
});
/**
 * Returns path representing next item after `path` in natural traversal order,
 * or -1 if end of tree has been reached
 */
me.tonsky.persistent_sorted_set.next_path \x3d (function me$tonsky$persistent_sorted_set$next_path(set,path){
return me.tonsky.persistent_sorted_set._next_path(set.root,path,set.shift);
});
/**
 * Returns rightmost path possible starting from node and going deeper
 */
me.tonsky.persistent_sorted_set._rpath \x3d (function me$tonsky$persistent_sorted_set$_rpath(node,level){
var node__$1 \x3d node;
var path \x3d (0);
var level__$1 \x3d level;
while(true){
if((level__$1 \x3e (0))){
var G__50929 \x3d (function (){var arr__50758__auto__ \x3d node__$1.pointers;
return (arr__50758__auto__[(arr__50758__auto__.length - (1))]);
})();
var G__50930 \x3d me.tonsky.persistent_sorted_set.path_set(path,level__$1,(node__$1.pointers.length - (1)));
var G__50931 \x3d (level__$1 - me.tonsky.persistent_sorted_set.level_shift);
node__$1 \x3d G__50929;
path \x3d G__50930;
level__$1 \x3d G__50931;
continue;
} else {
return me.tonsky.persistent_sorted_set.path_set(path,(0),(node__$1.keys.length - (1)));
}
break;
}
});
me.tonsky.persistent_sorted_set._prev_path \x3d (function me$tonsky$persistent_sorted_set$_prev_path(node,path,level){
var idx \x3d me.tonsky.persistent_sorted_set.path_get(path,level);
if((level \x3e (0))){
var sub_level \x3d (level - me.tonsky.persistent_sorted_set.level_shift);
var sub_path \x3d (function (){var G__50810 \x3d (node.pointers[idx]);
var G__50811 \x3d path;
var G__50812 \x3d sub_level;
return (me.tonsky.persistent_sorted_set._prev_path.cljs$core$IFn$_invoke$arity$3 ? me.tonsky.persistent_sorted_set._prev_path.cljs$core$IFn$_invoke$arity$3(G__50810,G__50811,G__50812) : me.tonsky.persistent_sorted_set._prev_path.call(null,G__50810,G__50811,G__50812));
})();
if(((-1) \x3d\x3d\x3d sub_path)){
if(((idx - (1)) \x3e\x3d (0))){
var idx__$1 \x3d (idx - (1));
var sub_path__$1 \x3d me.tonsky.persistent_sorted_set._rpath((node.pointers[idx__$1]),sub_level);
return me.tonsky.persistent_sorted_set.path_set(sub_path__$1,level,idx__$1);
} else {
return (-1);
}
} else {
return me.tonsky.persistent_sorted_set.path_set(sub_path,level,idx);
}
} else {
if(((idx - (1)) \x3e\x3d (0))){
return me.tonsky.persistent_sorted_set.path_set((0),(0),(idx - (1)));
} else {
return (-1);
}
}
});
/**
 * Returns path representing previous item before `path` in natural traversal order,
 * or -1 if `path` was already beginning of a tree
 */
me.tonsky.persistent_sorted_set.prev_path \x3d (function me$tonsky$persistent_sorted_set$prev_path(set,path){
return me.tonsky.persistent_sorted_set._prev_path(set.root,path,set.shift);
});

/**
 * Iterator that represents the whole set
 */
me.tonsky.persistent_sorted_set.btset_iter \x3d (function me$tonsky$persistent_sorted_set$btset_iter(set){
if((me.tonsky.persistent_sorted_set.node_len(set.root) \x3e (0))){
var left \x3d (0);
var right \x3d (me.tonsky.persistent_sorted_set._rpath(set.root,set.shift) + (1));
return (me.tonsky.persistent_sorted_set.iter.cljs$core$IFn$_invoke$arity$3 ? me.tonsky.persistent_sorted_set.iter.cljs$core$IFn$_invoke$arity$3(set,left,right) : me.tonsky.persistent_sorted_set.iter.call(null,set,left,right));
} else {
return null;
}
});

/**
* @constructor
 * @implements {cljs.core.IIndexed}
 * @implements {cljs.core.ICounted}
 * @implements {cljs.core.IChunk}
 * @implements {cljs.core.IReduce}
*/
me.tonsky.persistent_sorted_set.Chunk \x3d (function (arr,off,end){
this.arr \x3d arr;
this.off \x3d off;
this.end \x3d end;
this.cljs$lang$protocol_mask$partition0$ \x3d 524306;
this.cljs$lang$protocol_mask$partition1$ \x3d 0;
});
(me.tonsky.persistent_sorted_set.Chunk.prototype.cljs$core$ICounted$_count$arity$1 \x3d (function (_){
var self__ \x3d this;
var ___$1 \x3d this;
return (self__.end - self__.off);
}));

(me.tonsky.persistent_sorted_set.Chunk.prototype.cljs$core$IIndexed$_nth$arity$2 \x3d (function (this$,i){
var self__ \x3d this;
var this$__$1 \x3d this;
return (self__.arr[(self__.off + i)]);
}));

(me.tonsky.persistent_sorted_set.Chunk.prototype.cljs$core$IIndexed$_nth$arity$3 \x3d (function (this$,i,not_found){
var self__ \x3d this;
var this$__$1 \x3d this;
if((((i \x3e\x3d (0))) \x26\x26 ((i \x3c (self__.end - self__.off))))){
return (self__.arr[(self__.off + i)]);
} else {
return not_found;
}
}));

(me.tonsky.persistent_sorted_set.Chunk.prototype.cljs$core$IChunk$ \x3d cljs.core.PROTOCOL_SENTINEL);

(me.tonsky.persistent_sorted_set.Chunk.prototype.cljs$core$IChunk$_drop_first$arity$1 \x3d (function (this$){
var self__ \x3d this;
var this$__$1 \x3d this;
if((self__.off \x3d\x3d\x3d self__.end)){
throw (new Error(\x22-drop-first of empty chunk\x22));
} else {
return (new cljs.core.ArrayChunk(self__.arr,(self__.off + (1)),self__.end));
}
}));

(me.tonsky.persistent_sorted_set.Chunk.prototype.cljs$core$IReduce$_reduce$arity$2 \x3d (function (this$,f){
var self__ \x3d this;
var this$__$1 \x3d this;
if((self__.off \x3d\x3d\x3d self__.end)){
return (f.cljs$core$IFn$_invoke$arity$0 ? f.cljs$core$IFn$_invoke$arity$0() : f.call(null));
} else {
return cljs.core._reduce(this$__$1.cljs$core$IChunk$_drop_first$arity$1(null),f,(self__.arr[self__.off]));
}
}));

(me.tonsky.persistent_sorted_set.Chunk.prototype.cljs$core$IReduce$_reduce$arity$3 \x3d (function (this$,f,start){
var self__ \x3d this;
var this$__$1 \x3d this;
var val \x3d start;
var n \x3d self__.off;
while(true){
if((n \x3c self__.end)){
var val_SINGLEQUOTE_ \x3d (function (){var G__50813 \x3d val;
var G__50814 \x3d (self__.arr[n]);
return (f.cljs$core$IFn$_invoke$arity$2 ? f.cljs$core$IFn$_invoke$arity$2(G__50813,G__50814) : f.call(null,G__50813,G__50814));
})();
if(cljs.core.reduced_QMARK_(val_SINGLEQUOTE_)){
return cljs.core.deref(val_SINGLEQUOTE_);
} else {
var G__50943 \x3d val_SINGLEQUOTE_;
var G__50944 \x3d (n + (1));
val \x3d G__50943;
n \x3d G__50944;
continue;
}
} else {
return val;
}
break;
}
}));

(me.tonsky.persistent_sorted_set.Chunk.getBasis \x3d (function (){
return new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22arr\x22,\x22arr\x22,2115492975,null),new cljs.core.Symbol(null,\x22off\x22,\x22off\x22,-2047994980,null),new cljs.core.Symbol(null,\x22end\x22,\x22end\x22,1372345569,null)], null);
}));

(me.tonsky.persistent_sorted_set.Chunk.cljs$lang$type \x3d true);

(me.tonsky.persistent_sorted_set.Chunk.cljs$lang$ctorStr \x3d \x22me.tonsky.persistent-sorted-set/Chunk\x22);

(me.tonsky.persistent_sorted_set.Chunk.cljs$lang$ctorPrWriter \x3d (function (this__5330__auto__,writer__5331__auto__,opt__5332__auto__){
return cljs.core._write(writer__5331__auto__,\x22me.tonsky.persistent-sorted-set/Chunk\x22);
}));

/**
 * Positional factory function for me.tonsky.persistent-sorted-set/Chunk.
 */
me.tonsky.persistent_sorted_set.__GT_Chunk \x3d (function me$tonsky$persistent_sorted_set$__GT_Chunk(arr,off,end){
return (new me.tonsky.persistent_sorted_set.Chunk(arr,off,end));
});


/**
 * @interface
 */
me.tonsky.persistent_sorted_set.IIter \x3d function(){};

var me$tonsky$persistent_sorted_set$IIter$_copy$dyn_50954 \x3d (function (this$,left,right){
var x__5393__auto__ \x3d (((this$ \x3d\x3d null))?null:this$);
var m__5394__auto__ \x3d (me.tonsky.persistent_sorted_set._copy[goog.typeOf(x__5393__auto__)]);
if((!((m__5394__auto__ \x3d\x3d null)))){
return (m__5394__auto__.cljs$core$IFn$_invoke$arity$3 ? m__5394__auto__.cljs$core$IFn$_invoke$arity$3(this$,left,right) : m__5394__auto__.call(null,this$,left,right));
} else {
var m__5392__auto__ \x3d (me.tonsky.persistent_sorted_set._copy[\x22_\x22]);
if((!((m__5392__auto__ \x3d\x3d null)))){
return (m__5392__auto__.cljs$core$IFn$_invoke$arity$3 ? m__5392__auto__.cljs$core$IFn$_invoke$arity$3(this$,left,right) : m__5392__auto__.call(null,this$,left,right));
} else {
throw cljs.core.missing_protocol(\x22IIter.-copy\x22,this$);
}
}
});
me.tonsky.persistent_sorted_set._copy \x3d (function me$tonsky$persistent_sorted_set$_copy(this$,left,right){
if((((!((this$ \x3d\x3d null)))) \x26\x26 ((!((this$.me$tonsky$persistent_sorted_set$IIter$_copy$arity$3 \x3d\x3d null)))))){
return this$.me$tonsky$persistent_sorted_set$IIter$_copy$arity$3(this$,left,right);
} else {
return me$tonsky$persistent_sorted_set$IIter$_copy$dyn_50954(this$,left,right);
}
});


/**
* @constructor
 * @implements {me.tonsky.persistent_sorted_set.IIter}
 * @implements {cljs.core.IReversible}
 * @implements {cljs.core.IEquiv}
 * @implements {cljs.core.IChunkedNext}
 * @implements {cljs.core.ISeq}
 * @implements {cljs.core.INext}
 * @implements {cljs.core.ISeqable}
 * @implements {cljs.core.IPrintWithWriter}
 * @implements {cljs.core.IChunkedSeq}
 * @implements {cljs.core.ISequential}
 * @implements {cljs.core.IReduce}
*/
me.tonsky.persistent_sorted_set.Iter \x3d (function (set,left,right,keys,idx){
this.set \x3d set;
this.left \x3d left;
this.right \x3d right;
this.keys \x3d keys;
this.idx \x3d idx;
this.cljs$lang$protocol_mask$partition0$ \x3d 2309488832;
this.cljs$lang$protocol_mask$partition1$ \x3d 1536;
});
(me.tonsky.persistent_sorted_set.Iter.prototype.toString \x3d (function (){
var self__ \x3d this;
var this$ \x3d this;
return cljs.core.pr_str_STAR_(this$);
}));

(me.tonsky.persistent_sorted_set.Iter.prototype.cljs$core$IPrintWithWriter$_pr_writer$arity$3 \x3d (function (this$,writer,opts){
var self__ \x3d this;
var this$__$1 \x3d this;
return cljs.core.pr_sequential_writer(writer,cljs.core.pr_writer,\x22(\x22,\x22 \x22,\x22)\x22,opts,cljs.core.seq(this$__$1));
}));

(me.tonsky.persistent_sorted_set.Iter.prototype.cljs$core$INext$_next$arity$1 \x3d (function (this$){
var self__ \x3d this;
var this$__$1 \x3d this;
if(cljs.core.truth_(self__.keys)){
if(((self__.idx + (1)) \x3c self__.keys.length)){
if(((self__.left + (1)) \x3c self__.right)){
return (new me.tonsky.persistent_sorted_set.Iter(self__.set,(self__.left + (1)),self__.right,self__.keys,(self__.idx + (1))));
} else {
return null;
}
} else {
var left_SINGLEQUOTE_ \x3d me.tonsky.persistent_sorted_set.next_path(self__.set,self__.left);
if(((cljs.core.not_EQ_.cljs$core$IFn$_invoke$arity$2((-1),left_SINGLEQUOTE_)) \x26\x26 ((left_SINGLEQUOTE_ \x3c self__.right)))){
return this$__$1.me$tonsky$persistent_sorted_set$IIter$_copy$arity$3(null,left_SINGLEQUOTE_,self__.right);
} else {
return null;
}
}
} else {
return null;
}
}));

(me.tonsky.persistent_sorted_set.Iter.prototype.cljs$core$IReversible$_rseq$arity$1 \x3d (function (this$){
var self__ \x3d this;
var this$__$1 \x3d this;
if(cljs.core.truth_(self__.keys)){
var G__50815 \x3d self__.set;
var G__50816 \x3d me.tonsky.persistent_sorted_set.prev_path(self__.set,self__.left);
var G__50817 \x3d me.tonsky.persistent_sorted_set.prev_path(self__.set,self__.right);
return (me.tonsky.persistent_sorted_set.riter.cljs$core$IFn$_invoke$arity$3 ? me.tonsky.persistent_sorted_set.riter.cljs$core$IFn$_invoke$arity$3(G__50815,G__50816,G__50817) : me.tonsky.persistent_sorted_set.riter.call(null,G__50815,G__50816,G__50817));
} else {
return null;
}
}));

(me.tonsky.persistent_sorted_set.Iter.prototype.cljs$core$IEquiv$_equiv$arity$2 \x3d (function (this$,other){
var self__ \x3d this;
var this$__$1 \x3d this;
return cljs.core.equiv_sequential(this$__$1,other);
}));

(me.tonsky.persistent_sorted_set.Iter.prototype.cljs$core$IReduce$_reduce$arity$2 \x3d (function (this$,f){
var self__ \x3d this;
var this$__$1 \x3d this;
if((self__.keys \x3d\x3d null)){
return (f.cljs$core$IFn$_invoke$arity$0 ? f.cljs$core$IFn$_invoke$arity$0() : f.call(null));
} else {
var first \x3d this$__$1.cljs$core$ISeq$_first$arity$1(null);
var temp__5806__auto__ \x3d this$__$1.cljs$core$INext$_next$arity$1(null);
if((temp__5806__auto__ \x3d\x3d null)){
return first;
} else {
var next \x3d temp__5806__auto__;
return cljs.core._reduce(next,f,first);
}
}
}));

(me.tonsky.persistent_sorted_set.Iter.prototype.cljs$core$IReduce$_reduce$arity$3 \x3d (function (this$,f,start){
var self__ \x3d this;
var this$__$1 \x3d this;
var left__$1 \x3d self__.left;
var keys__$1 \x3d self__.keys;
var idx__$1 \x3d self__.idx;
var acc \x3d start;
while(true){
if((keys__$1 \x3d\x3d null)){
return acc;
} else {
var new_acc \x3d (function (){var G__50818 \x3d acc;
var G__50819 \x3d (keys__$1[idx__$1]);
return (f.cljs$core$IFn$_invoke$arity$2 ? f.cljs$core$IFn$_invoke$arity$2(G__50818,G__50819) : f.call(null,G__50818,G__50819));
})();
if(cljs.core.reduced_QMARK_(new_acc)){
return cljs.core.deref(new_acc);
} else {
if(((idx__$1 + (1)) \x3c keys__$1.length)){
if(((left__$1 + (1)) \x3c self__.right)){
var G__50967 \x3d (left__$1 + (1));
var G__50968 \x3d keys__$1;
var G__50969 \x3d (idx__$1 + (1));
var G__50970 \x3d new_acc;
left__$1 \x3d G__50967;
keys__$1 \x3d G__50968;
idx__$1 \x3d G__50969;
acc \x3d G__50970;
continue;
} else {
return new_acc;
}
} else {
var new_left \x3d me.tonsky.persistent_sorted_set.next_path(self__.set,left__$1);
if((((!(((-1) \x3d\x3d\x3d new_left)))) \x26\x26 ((new_left \x3c self__.right)))){
var G__50971 \x3d new_left;
var G__50972 \x3d me.tonsky.persistent_sorted_set.keys_for(self__.set,new_left);
var G__50973 \x3d me.tonsky.persistent_sorted_set.path_get(new_left,(0));
var G__50974 \x3d new_acc;
left__$1 \x3d G__50971;
keys__$1 \x3d G__50972;
idx__$1 \x3d G__50973;
acc \x3d G__50974;
continue;
} else {
return new_acc;
}

}
}
}
break;
}
}));

(me.tonsky.persistent_sorted_set.Iter.prototype.cljs$core$ISeq$_first$arity$1 \x3d (function (this$){
var self__ \x3d this;
var this$__$1 \x3d this;
if(cljs.core.truth_(self__.keys)){
return (self__.keys[self__.idx]);
} else {
return null;
}
}));

(me.tonsky.persistent_sorted_set.Iter.prototype.cljs$core$ISeq$_rest$arity$1 \x3d (function (this$){
var self__ \x3d this;
var this$__$1 \x3d this;
var or__5045__auto__ \x3d this$__$1.cljs$core$INext$_next$arity$1(null);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return cljs.core.List.EMPTY;
}
}));

(me.tonsky.persistent_sorted_set.Iter.prototype.cljs$core$ISeqable$_seq$arity$1 \x3d (function (this$){
var self__ \x3d this;
var this$__$1 \x3d this;
if(cljs.core.truth_(self__.keys)){
return this$__$1;
} else {
return null;
}
}));

(me.tonsky.persistent_sorted_set.Iter.prototype.cljs$core$IChunkedSeq$_chunked_first$arity$1 \x3d (function (this$){
var self__ \x3d this;
var this$__$1 \x3d this;
var end_idx \x3d ((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2((self__.left | me.tonsky.persistent_sorted_set.path_mask),(self__.right | me.tonsky.persistent_sorted_set.path_mask)))?(self__.right \x26 me.tonsky.persistent_sorted_set.path_mask):self__.keys.length);
return (new me.tonsky.persistent_sorted_set.Chunk(self__.keys,self__.idx,end_idx));
}));

(me.tonsky.persistent_sorted_set.Iter.prototype.cljs$core$IChunkedSeq$_chunked_rest$arity$1 \x3d (function (this$){
var self__ \x3d this;
var this$__$1 \x3d this;
var or__5045__auto__ \x3d this$__$1.cljs$core$IChunkedNext$_chunked_next$arity$1(null);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return cljs.core.List.EMPTY;
}
}));

(me.tonsky.persistent_sorted_set.Iter.prototype.me$tonsky$persistent_sorted_set$IIter$ \x3d cljs.core.PROTOCOL_SENTINEL);

(me.tonsky.persistent_sorted_set.Iter.prototype.me$tonsky$persistent_sorted_set$IIter$_copy$arity$3 \x3d (function (_,l,r){
var self__ \x3d this;
var ___$1 \x3d this;
return (new me.tonsky.persistent_sorted_set.Iter(self__.set,l,r,me.tonsky.persistent_sorted_set.keys_for(self__.set,l),me.tonsky.persistent_sorted_set.path_get(l,(0))));
}));

(me.tonsky.persistent_sorted_set.Iter.prototype.cljs$core$IChunkedNext$_chunked_next$arity$1 \x3d (function (this$){
var self__ \x3d this;
var this$__$1 \x3d this;
var left_SINGLEQUOTE_ \x3d me.tonsky.persistent_sorted_set.next_path(self__.set,(self__.left + ((self__.keys.length - self__.idx) - (1))));
if(((cljs.core.not_EQ_.cljs$core$IFn$_invoke$arity$2((-1),left_SINGLEQUOTE_)) \x26\x26 ((left_SINGLEQUOTE_ \x3c self__.right)))){
return this$__$1.me$tonsky$persistent_sorted_set$IIter$_copy$arity$3(null,left_SINGLEQUOTE_,self__.right);
} else {
return null;
}
}));

(me.tonsky.persistent_sorted_set.Iter.getBasis \x3d (function (){
return new cljs.core.PersistentVector(null, 5, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22set\x22,\x22set\x22,1945134081,null),new cljs.core.Symbol(null,\x22left\x22,\x22left\x22,1241415590,null),new cljs.core.Symbol(null,\x22right\x22,\x22right\x22,1187949694,null),new cljs.core.Symbol(null,\x22keys\x22,\x22keys\x22,-1586012071,null),new cljs.core.Symbol(null,\x22idx\x22,\x22idx\x22,-1600747296,null)], null);
}));

(me.tonsky.persistent_sorted_set.Iter.cljs$lang$type \x3d true);

(me.tonsky.persistent_sorted_set.Iter.cljs$lang$ctorStr \x3d \x22me.tonsky.persistent-sorted-set/Iter\x22);

(me.tonsky.persistent_sorted_set.Iter.cljs$lang$ctorPrWriter \x3d (function (this__5330__auto__,writer__5331__auto__,opt__5332__auto__){
return cljs.core._write(writer__5331__auto__,\x22me.tonsky.persistent-sorted-set/Iter\x22);
}));

/**
 * Positional factory function for me.tonsky.persistent-sorted-set/Iter.
 */
me.tonsky.persistent_sorted_set.__GT_Iter \x3d (function me$tonsky$persistent_sorted_set$__GT_Iter(set,left,right,keys,idx){
return (new me.tonsky.persistent_sorted_set.Iter(set,left,right,keys,idx));
});

me.tonsky.persistent_sorted_set.iter \x3d (function me$tonsky$persistent_sorted_set$iter(set,left,right){
return (new me.tonsky.persistent_sorted_set.Iter(set,left,right,me.tonsky.persistent_sorted_set.keys_for(set,left),me.tonsky.persistent_sorted_set.path_get(left,(0))));
});

/**
* @constructor
 * @implements {me.tonsky.persistent_sorted_set.IIter}
 * @implements {cljs.core.IReversible}
 * @implements {cljs.core.IEquiv}
 * @implements {cljs.core.ISeq}
 * @implements {cljs.core.INext}
 * @implements {cljs.core.ISeqable}
 * @implements {cljs.core.IPrintWithWriter}
 * @implements {cljs.core.ISequential}
*/
me.tonsky.persistent_sorted_set.ReverseIter \x3d (function (set,left,right,keys,idx){
this.set \x3d set;
this.left \x3d left;
this.right \x3d right;
this.keys \x3d keys;
this.idx \x3d idx;
this.cljs$lang$protocol_mask$partition0$ \x3d 2308964544;
this.cljs$lang$protocol_mask$partition1$ \x3d 0;
});
(me.tonsky.persistent_sorted_set.ReverseIter.prototype.toString \x3d (function (){
var self__ \x3d this;
var this$ \x3d this;
return cljs.core.pr_str_STAR_(this$);
}));

(me.tonsky.persistent_sorted_set.ReverseIter.prototype.cljs$core$IPrintWithWriter$_pr_writer$arity$3 \x3d (function (this$,writer,opts){
var self__ \x3d this;
var this$__$1 \x3d this;
return cljs.core.pr_sequential_writer(writer,cljs.core.pr_writer,\x22(\x22,\x22 \x22,\x22)\x22,opts,cljs.core.seq(this$__$1));
}));

(me.tonsky.persistent_sorted_set.ReverseIter.prototype.cljs$core$INext$_next$arity$1 \x3d (function (this$){
var self__ \x3d this;
var this$__$1 \x3d this;
if(cljs.core.truth_(self__.keys)){
if(((self__.idx - (1)) \x3e\x3d (0))){
if(((self__.right - (1)) \x3e self__.left)){
return (new me.tonsky.persistent_sorted_set.ReverseIter(self__.set,self__.left,(self__.right - (1)),self__.keys,(self__.idx - (1))));
} else {
return null;
}
} else {
var right__$1 \x3d me.tonsky.persistent_sorted_set.prev_path(self__.set,self__.right);
if(((cljs.core.not_EQ_.cljs$core$IFn$_invoke$arity$2((-1),right__$1)) \x26\x26 ((right__$1 \x3e self__.left)))){
return this$__$1.me$tonsky$persistent_sorted_set$IIter$_copy$arity$3(null,self__.left,right__$1);
} else {
return null;
}
}
} else {
return null;
}
}));

(me.tonsky.persistent_sorted_set.ReverseIter.prototype.cljs$core$IReversible$_rseq$arity$1 \x3d (function (this$){
var self__ \x3d this;
var this$__$1 \x3d this;
if(cljs.core.truth_(self__.keys)){
var new_left \x3d (((self__.left \x3d\x3d\x3d (-1)))?(0):me.tonsky.persistent_sorted_set.next_path(self__.set,self__.left));
var new_right \x3d me.tonsky.persistent_sorted_set.next_path(self__.set,self__.right);
var new_right__$1 \x3d (((new_right \x3d\x3d\x3d (-1)))?(self__.right + (1)):new_right);
return me.tonsky.persistent_sorted_set.iter(self__.set,new_left,new_right__$1);
} else {
return null;
}
}));

(me.tonsky.persistent_sorted_set.ReverseIter.prototype.cljs$core$IEquiv$_equiv$arity$2 \x3d (function (this$,other){
var self__ \x3d this;
var this$__$1 \x3d this;
return cljs.core.equiv_sequential(this$__$1,other);
}));

(me.tonsky.persistent_sorted_set.ReverseIter.prototype.cljs$core$ISeq$_first$arity$1 \x3d (function (this$){
var self__ \x3d this;
var this$__$1 \x3d this;
if(cljs.core.truth_(self__.keys)){
return (self__.keys[self__.idx]);
} else {
return null;
}
}));

(me.tonsky.persistent_sorted_set.ReverseIter.prototype.cljs$core$ISeq$_rest$arity$1 \x3d (function (this$){
var self__ \x3d this;
var this$__$1 \x3d this;
var or__5045__auto__ \x3d this$__$1.cljs$core$INext$_next$arity$1(null);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return cljs.core.List.EMPTY;
}
}));

(me.tonsky.persistent_sorted_set.ReverseIter.prototype.cljs$core$ISeqable$_seq$arity$1 \x3d (function (this$){
var self__ \x3d this;
var this$__$1 \x3d this;
if(cljs.core.truth_(self__.keys)){
return this$__$1;
} else {
return null;
}
}));

(me.tonsky.persistent_sorted_set.ReverseIter.prototype.me$tonsky$persistent_sorted_set$IIter$ \x3d cljs.core.PROTOCOL_SENTINEL);

(me.tonsky.persistent_sorted_set.ReverseIter.prototype.me$tonsky$persistent_sorted_set$IIter$_copy$arity$3 \x3d (function (_,l,r){
var self__ \x3d this;
var ___$1 \x3d this;
return (new me.tonsky.persistent_sorted_set.ReverseIter(self__.set,l,r,me.tonsky.persistent_sorted_set.keys_for(self__.set,r),me.tonsky.persistent_sorted_set.path_get(r,(0))));
}));

(me.tonsky.persistent_sorted_set.ReverseIter.getBasis \x3d (function (){
return new cljs.core.PersistentVector(null, 5, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22set\x22,\x22set\x22,1945134081,null),new cljs.core.Symbol(null,\x22left\x22,\x22left\x22,1241415590,null),new cljs.core.Symbol(null,\x22right\x22,\x22right\x22,1187949694,null),new cljs.core.Symbol(null,\x22keys\x22,\x22keys\x22,-1586012071,null),new cljs.core.Symbol(null,\x22idx\x22,\x22idx\x22,-1600747296,null)], null);
}));

(me.tonsky.persistent_sorted_set.ReverseIter.cljs$lang$type \x3d true);

(me.tonsky.persistent_sorted_set.ReverseIter.cljs$lang$ctorStr \x3d \x22me.tonsky.persistent-sorted-set/ReverseIter\x22);

(me.tonsky.persistent_sorted_set.ReverseIter.cljs$lang$ctorPrWriter \x3d (function (this__5330__auto__,writer__5331__auto__,opt__5332__auto__){
return cljs.core._write(writer__5331__auto__,\x22me.tonsky.persistent-sorted-set/ReverseIter\x22);
}));

/**
 * Positional factory function for me.tonsky.persistent-sorted-set/ReverseIter.
 */
me.tonsky.persistent_sorted_set.__GT_ReverseIter \x3d (function me$tonsky$persistent_sorted_set$__GT_ReverseIter(set,left,right,keys,idx){
return (new me.tonsky.persistent_sorted_set.ReverseIter(set,left,right,keys,idx));
});

me.tonsky.persistent_sorted_set.riter \x3d (function me$tonsky$persistent_sorted_set$riter(set,left,right){
return (new me.tonsky.persistent_sorted_set.ReverseIter(set,left,right,me.tonsky.persistent_sorted_set.keys_for(set,right),me.tonsky.persistent_sorted_set.path_get(right,(0))));
});
me.tonsky.persistent_sorted_set._distance \x3d (function me$tonsky$persistent_sorted_set$_distance(node,left,right,level){
var idx_l \x3d me.tonsky.persistent_sorted_set.path_get(left,level);
var idx_r \x3d me.tonsky.persistent_sorted_set.path_get(right,level);
if((level \x3e (0))){
if((idx_l \x3d\x3d\x3d idx_r)){
var G__50820 \x3d (node.pointers[idx_l]);
var G__50821 \x3d left;
var G__50822 \x3d right;
var G__50823 \x3d (level - me.tonsky.persistent_sorted_set.level_shift);
return (me.tonsky.persistent_sorted_set._distance.cljs$core$IFn$_invoke$arity$4 ? me.tonsky.persistent_sorted_set._distance.cljs$core$IFn$_invoke$arity$4(G__50820,G__50821,G__50822,G__50823) : me.tonsky.persistent_sorted_set._distance.call(null,G__50820,G__50821,G__50822,G__50823));
} else {
var level__$1 \x3d level;
var res \x3d (idx_r - idx_l);
while(true){
if(((0) \x3d\x3d\x3d level__$1)){
return res;
} else {
var G__50985 \x3d (level__$1 - me.tonsky.persistent_sorted_set.level_shift);
var G__50986 \x3d (res * me.tonsky.persistent_sorted_set.avg_len);
level__$1 \x3d G__50985;
res \x3d G__50986;
continue;
}
break;
}
}
} else {
return (idx_r - idx_l);
}
});
me.tonsky.persistent_sorted_set.distance \x3d (function me$tonsky$persistent_sorted_set$distance(set,path_l,path_r){
if((path_l \x3d\x3d\x3d path_r)){
return (0);
} else {
if(((path_l + (1)) \x3d\x3d\x3d path_r)){
return (1);
} else {
if((me.tonsky.persistent_sorted_set.next_path(set,path_l) \x3d\x3d\x3d path_r)){
return (1);
} else {
return me.tonsky.persistent_sorted_set._distance(set.root,path_l,path_r,set.shift);

}
}
}
});
me.tonsky.persistent_sorted_set.est_count \x3d (function me$tonsky$persistent_sorted_set$est_count(iter){
return me.tonsky.persistent_sorted_set.distance(iter.set,iter.left,iter.right);
});
/**
 * Returns path to first element \x3e\x3d key,
 * or -1 if all elements in a set \x3c key
 */
me.tonsky.persistent_sorted_set._seek \x3d (function me$tonsky$persistent_sorted_set$_seek(set,key,comparator){
if((key \x3d\x3d null)){
return (0);
} else {
var node \x3d set.root;
var path \x3d (0);
var level \x3d set.shift;
while(true){
var keys_l \x3d me.tonsky.persistent_sorted_set.node_len(node);
if(((0) \x3d\x3d\x3d level)){
var keys \x3d node.keys;
var idx \x3d me.tonsky.persistent_sorted_set.binary_search_l(comparator,keys,(keys_l - (1)),key);
if((keys_l \x3d\x3d\x3d idx)){
return (-1);
} else {
return me.tonsky.persistent_sorted_set.path_set(path,(0),idx);
}
} else {
var keys \x3d node.keys;
var idx \x3d me.tonsky.persistent_sorted_set.binary_search_l(comparator,keys,(keys_l - (2)),key);
var G__50988 \x3d (node.pointers[idx]);
var G__50989 \x3d me.tonsky.persistent_sorted_set.path_set(path,level,idx);
var G__50990 \x3d (level - me.tonsky.persistent_sorted_set.level_shift);
node \x3d G__50988;
path \x3d G__50989;
level \x3d G__50990;
continue;
}
break;
}
}
});
/**
 * Returns path to the first element that is \x3e key.
 * If all elements in a set are \x3c\x3d key, returns `(-rpath set) + 1`.
 * It\u2019s a virtual path that is bigger than any path in a tree
 */
me.tonsky.persistent_sorted_set._rseek \x3d (function me$tonsky$persistent_sorted_set$_rseek(set,key,comparator){
if((key \x3d\x3d null)){
return (me.tonsky.persistent_sorted_set._rpath(set.root,set.shift) + (1));
} else {
var node \x3d set.root;
var path \x3d (0);
var level \x3d set.shift;
while(true){
var keys_l \x3d me.tonsky.persistent_sorted_set.node_len(node);
if(((0) \x3d\x3d\x3d level)){
var keys \x3d node.keys;
var idx \x3d me.tonsky.persistent_sorted_set.binary_search_r(comparator,keys,(keys_l - (1)),key);
return me.tonsky.persistent_sorted_set.path_set(path,(0),idx);
} else {
var keys \x3d node.keys;
var idx \x3d me.tonsky.persistent_sorted_set.binary_search_r(comparator,keys,(keys_l - (2)),key);
var G__50991 \x3d (node.pointers[idx]);
var G__50992 \x3d me.tonsky.persistent_sorted_set.path_set(path,level,idx);
var G__50993 \x3d (level - me.tonsky.persistent_sorted_set.level_shift);
node \x3d G__50991;
path \x3d G__50992;
level \x3d G__50993;
continue;
}
break;
}
}
});
me.tonsky.persistent_sorted_set._slice \x3d (function me$tonsky$persistent_sorted_set$_slice(set,key_from,key_to,comparator){
var path \x3d me.tonsky.persistent_sorted_set._seek(set,key_from,comparator);
if((path \x3c (0))){
return null;
} else {
var till_path \x3d me.tonsky.persistent_sorted_set._rseek(set,key_to,comparator);
if((till_path \x3e path)){
return (new me.tonsky.persistent_sorted_set.Iter(set,path,till_path,me.tonsky.persistent_sorted_set.keys_for(set,path),me.tonsky.persistent_sorted_set.path_get(path,(0))));
} else {
return null;
}
}
});
me.tonsky.persistent_sorted_set.arr_map_inplace \x3d (function me$tonsky$persistent_sorted_set$arr_map_inplace(f,arr){
var len \x3d arr.length;
var i_50994 \x3d (0);
while(true){
if((i_50994 \x3c len)){
(arr[i_50994] \x3d (function (){var G__50824 \x3d (arr[i_50994]);
return (f.cljs$core$IFn$_invoke$arity$1 ? f.cljs$core$IFn$_invoke$arity$1(G__50824) : f.call(null,G__50824));
})());

var G__50995 \x3d (i_50994 + (1));
i_50994 \x3d G__50995;
continue;
} else {
}
break;
}

return arr;
});
/**
 * Splits `arr` into arrays of size between min-len and max-len,
 * trying to stick to (min+max)/2
 */
me.tonsky.persistent_sorted_set.arr_partition_approx \x3d (function me$tonsky$persistent_sorted_set$arr_partition_approx(min_len,max_len,arr){
var chunk_len \x3d me.tonsky.persistent_sorted_set.avg_len;
var len \x3d arr.length;
var acc \x3d cljs.core.transient$(cljs.core.PersistentVector.EMPTY);
if((len \x3e (0))){
var pos_50996 \x3d (0);
while(true){
var rest_50997 \x3d (len - pos_50996);
if((rest_50997 \x3c\x3d max_len)){
cljs.core.conj_BANG_.cljs$core$IFn$_invoke$arity$2(acc,arr.slice(pos_50996));
} else {
if((rest_50997 \x3e\x3d (chunk_len + min_len))){
cljs.core.conj_BANG_.cljs$core$IFn$_invoke$arity$2(acc,arr.slice(pos_50996,(pos_50996 + chunk_len)));

var G__50998 \x3d (pos_50996 + chunk_len);
pos_50996 \x3d G__50998;
continue;
} else {
var piece_len_50999 \x3d (rest_50997 \x3e\x3e\x3e (1));
cljs.core.conj_BANG_.cljs$core$IFn$_invoke$arity$2(acc,arr.slice(pos_50996,(pos_50996 + piece_len_50999)));

var G__51000 \x3d (pos_50996 + piece_len_50999);
pos_50996 \x3d G__51000;
continue;

}
}
break;
}
} else {
}

return cljs.core.to_array(cljs.core.persistent_BANG_(acc));
});
me.tonsky.persistent_sorted_set.sorted_arr_distinct_QMARK_ \x3d (function me$tonsky$persistent_sorted_set$sorted_arr_distinct_QMARK_(arr,cmp){
var al \x3d arr.length;
if((al \x3c\x3d (1))){
return true;
} else {
var i \x3d (1);
var p \x3d (arr[(0)]);
while(true){
if((i \x3e\x3d al)){
return true;
} else {
var e \x3d (arr[i]);
if(((0) \x3d\x3d\x3d (cmp.cljs$core$IFn$_invoke$arity$2 ? cmp.cljs$core$IFn$_invoke$arity$2(e,p) : cmp.call(null,e,p)))){
return false;
} else {
var G__51001 \x3d (i + (1));
var G__51002 \x3d e;
i \x3d G__51001;
p \x3d G__51002;
continue;
}
}
break;
}
}
});
/**
 * Filter out repetitive values in a sorted array.
 * Optimized for no-duplicates case
 */
me.tonsky.persistent_sorted_set.sorted_arr_distinct \x3d (function me$tonsky$persistent_sorted_set$sorted_arr_distinct(arr,cmp){
if(me.tonsky.persistent_sorted_set.sorted_arr_distinct_QMARK_(arr,cmp)){
return arr;
} else {
var al \x3d arr.length;
var acc \x3d cljs.core.transient$(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [(arr[(0)])], null));
var i \x3d (1);
var p \x3d (arr[(0)]);
while(true){
if((i \x3e\x3d al)){
return cljs.core.into_array.cljs$core$IFn$_invoke$arity$1(cljs.core.persistent_BANG_(acc));
} else {
var e \x3d (arr[i]);
if(((0) \x3d\x3d\x3d (cmp.cljs$core$IFn$_invoke$arity$2 ? cmp.cljs$core$IFn$_invoke$arity$2(e,p) : cmp.call(null,e,p)))){
var G__51003 \x3d acc;
var G__51004 \x3d (i + (1));
var G__51005 \x3d e;
acc \x3d G__51003;
i \x3d G__51004;
p \x3d G__51005;
continue;
} else {
var G__51006 \x3d cljs.core.conj_BANG_.cljs$core$IFn$_invoke$arity$2(acc,e);
var G__51007 \x3d (i + (1));
var G__51008 \x3d e;
acc \x3d G__51006;
i \x3d G__51007;
p \x3d G__51008;
continue;
}
}
break;
}
}
});
/**
 * Analogue to [[clojure.core/conj]] with comparator that overrides the one stored in set.
 */
me.tonsky.persistent_sorted_set.conj \x3d (function me$tonsky$persistent_sorted_set$conj(set,key,cmp){
var roots \x3d me.tonsky.persistent_sorted_set.node_conj(set.root,cmp,key);
if((roots \x3d\x3d null)){
return set;
} else {
if((roots.length \x3d\x3d\x3d (1))){
return me.tonsky.persistent_sorted_set.alter_btset(set,(roots[(0)]),set.shift,(set.cnt + (1)));
} else {
return me.tonsky.persistent_sorted_set.alter_btset(set,(new me.tonsky.persistent_sorted_set.Node(me.tonsky.persistent_sorted_set.arrays.amap(me.tonsky.persistent_sorted_set.node_lim_key,roots),roots)),(set.shift + me.tonsky.persistent_sorted_set.level_shift),(set.cnt + (1)));

}
}
});
/**
 * Analogue to [[clojure.core/disj]] with comparator that overrides the one stored in set.
 */
me.tonsky.persistent_sorted_set.disj \x3d (function me$tonsky$persistent_sorted_set$disj(set,key,cmp){
var new_roots \x3d me.tonsky.persistent_sorted_set.node_disj(set.root,cmp,key,true,null,null);
if((new_roots \x3d\x3d null)){
return set;
} else {
var new_root \x3d (new_roots[(0)]);
if((((new_root instanceof me.tonsky.persistent_sorted_set.Node)) \x26\x26 (((1) \x3d\x3d\x3d new_root.pointers.length)))){
return me.tonsky.persistent_sorted_set.alter_btset(set,(new_root.pointers[(0)]),(set.shift - me.tonsky.persistent_sorted_set.level_shift),(set.cnt - (1)));
} else {
return me.tonsky.persistent_sorted_set.alter_btset(set,new_root,set.shift,(set.cnt - (1)));
}
}
});
/**
 * An iterator for part of the set with provided boundaries.
 * `(slice set from to)` returns iterator for all Xs where from \x3c\x3d X \x3c\x3d to.
 * Optionally pass in comparator that will override the one that set uses. Supports efficient [[clojure.core/rseq]].
 */
me.tonsky.persistent_sorted_set.slice \x3d (function me$tonsky$persistent_sorted_set$slice(var_args){
var G__50826 \x3d arguments.length;
switch (G__50826) {
case 3:
return me.tonsky.persistent_sorted_set.slice.cljs$core$IFn$_invoke$arity$3((arguments[(0)]),(arguments[(1)]),(arguments[(2)]));

break;
case 4:
return me.tonsky.persistent_sorted_set.slice.cljs$core$IFn$_invoke$arity$4((arguments[(0)]),(arguments[(1)]),(arguments[(2)]),(arguments[(3)]));

break;
default:
throw (new Error([\x22Invalid arity: \x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1(arguments.length)].join(\x27\x27)));

}
});

(me.tonsky.persistent_sorted_set.slice.cljs$core$IFn$_invoke$arity$3 \x3d (function (set,key_from,key_to){
return me.tonsky.persistent_sorted_set._slice(set,key_from,key_to,set.comparator);
}));

(me.tonsky.persistent_sorted_set.slice.cljs$core$IFn$_invoke$arity$4 \x3d (function (set,key_from,key_to,comparator){
return me.tonsky.persistent_sorted_set._slice(set,key_from,key_to,comparator);
}));

(me.tonsky.persistent_sorted_set.slice.cljs$lang$maxFixedArity \x3d 4);

/**
 * A reverse iterator for part of the set with provided boundaries.
 * `(rslice set from to)` returns backwards iterator for all Xs where from \x3c\x3d X \x3c\x3d to.
 * Optionally pass in comparator that will override the one that set uses. Supports efficient [[clojure.core/rseq]].
 */
me.tonsky.persistent_sorted_set.rslice \x3d (function me$tonsky$persistent_sorted_set$rslice(var_args){
var G__50828 \x3d arguments.length;
switch (G__50828) {
case 2:
return me.tonsky.persistent_sorted_set.rslice.cljs$core$IFn$_invoke$arity$2((arguments[(0)]),(arguments[(1)]));

break;
case 3:
return me.tonsky.persistent_sorted_set.rslice.cljs$core$IFn$_invoke$arity$3((arguments[(0)]),(arguments[(1)]),(arguments[(2)]));

break;
case 4:
return me.tonsky.persistent_sorted_set.rslice.cljs$core$IFn$_invoke$arity$4((arguments[(0)]),(arguments[(1)]),(arguments[(2)]),(arguments[(3)]));

break;
default:
throw (new Error([\x22Invalid arity: \x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1(arguments.length)].join(\x27\x27)));

}
});

(me.tonsky.persistent_sorted_set.rslice.cljs$core$IFn$_invoke$arity$2 \x3d (function (set,key){
var G__50829 \x3d me.tonsky.persistent_sorted_set._slice(set,key,key,set.comparator);
if((G__50829 \x3d\x3d null)){
return null;
} else {
return cljs.core.rseq(G__50829);
}
}));

(me.tonsky.persistent_sorted_set.rslice.cljs$core$IFn$_invoke$arity$3 \x3d (function (set,key_from,key_to){
var G__50830 \x3d me.tonsky.persistent_sorted_set._slice(set,key_to,key_from,set.comparator);
if((G__50830 \x3d\x3d null)){
return null;
} else {
return cljs.core.rseq(G__50830);
}
}));

(me.tonsky.persistent_sorted_set.rslice.cljs$core$IFn$_invoke$arity$4 \x3d (function (set,key_from,key_to,comparator){
var G__50831 \x3d me.tonsky.persistent_sorted_set._slice(set,key_to,key_from,comparator);
if((G__50831 \x3d\x3d null)){
return null;
} else {
return cljs.core.rseq(G__50831);
}
}));

(me.tonsky.persistent_sorted_set.rslice.cljs$lang$maxFixedArity \x3d 4);

/**
 * Fast path to create a set if you already have a sorted array of elements on your hands.
 */
me.tonsky.persistent_sorted_set.from_sorted_array \x3d (function me$tonsky$persistent_sorted_set$from_sorted_array(cmp,arr){
var leaves \x3d me.tonsky.persistent_sorted_set.arr_map_inplace((function (p1__50832_SHARP_){
return (new me.tonsky.persistent_sorted_set.Leaf(p1__50832_SHARP_));
}),me.tonsky.persistent_sorted_set.arr_partition_approx((16),(32),arr));
var current_level \x3d leaves;
var shift \x3d (0);
while(true){
var G__50834 \x3d cljs.core.count(current_level);
switch (G__50834) {
case (0):
return (new me.tonsky.persistent_sorted_set.BTSet((new me.tonsky.persistent_sorted_set.Leaf([])),(0),(0),cmp,null,null));

break;
case (1):
return (new me.tonsky.persistent_sorted_set.BTSet(cljs.core.first(current_level),shift,arr.length,cmp,null,null));

break;
default:
var G__51013 \x3d me.tonsky.persistent_sorted_set.arr_map_inplace(((function (current_level,shift,G__50834,leaves){
return (function (p1__50833_SHARP_){
return (new me.tonsky.persistent_sorted_set.Node(me.tonsky.persistent_sorted_set.arrays.amap(me.tonsky.persistent_sorted_set.node_lim_key,p1__50833_SHARP_),p1__50833_SHARP_));
});})(current_level,shift,G__50834,leaves))
,me.tonsky.persistent_sorted_set.arr_partition_approx((16),(32),current_level));
var G__51014 \x3d (shift + me.tonsky.persistent_sorted_set.level_shift);
current_level \x3d G__51013;
shift \x3d G__51014;
continue;

}
break;
}
});
/**
 * Create a set with custom comparator and a collection of keys. Useful when you don\u2019t want to call [[clojure.core/apply]] on [[sorted-set-by]].
 */
me.tonsky.persistent_sorted_set.from_sequential \x3d (function me$tonsky$persistent_sorted_set$from_sequential(cmp,seq){
var arr \x3d me.tonsky.persistent_sorted_set.sorted_arr_distinct(me.tonsky.persistent_sorted_set.arrays.asort(cljs.core.into_array.cljs$core$IFn$_invoke$arity$1(seq),cmp),cmp);
return me.tonsky.persistent_sorted_set.from_sorted_array(cmp,arr);
});
me.tonsky.persistent_sorted_set.sorted_set_by \x3d (function me$tonsky$persistent_sorted_set$sorted_set_by(var_args){
var G__50838 \x3d arguments.length;
switch (G__50838) {
case 1:
return me.tonsky.persistent_sorted_set.sorted_set_by.cljs$core$IFn$_invoke$arity$1((arguments[(0)]));

break;
default:
var args_arr__5794__auto__ \x3d [];
var len__5769__auto___51017 \x3d arguments.length;
var i__5770__auto___51018 \x3d (0);
while(true){
if((i__5770__auto___51018 \x3c len__5769__auto___51017)){
args_arr__5794__auto__.push((arguments[i__5770__auto___51018]));

var G__51019 \x3d (i__5770__auto___51018 + (1));
i__5770__auto___51018 \x3d G__51019;
continue;
} else {
}
break;
}

var argseq__5795__auto__ \x3d (new cljs.core.IndexedSeq(args_arr__5794__auto__.slice((1)),(0),null));
return me.tonsky.persistent_sorted_set.sorted_set_by.cljs$core$IFn$_invoke$arity$variadic((arguments[(0)]),argseq__5795__auto__);

}
});

(me.tonsky.persistent_sorted_set.sorted_set_by.cljs$core$IFn$_invoke$arity$1 \x3d (function (cmp){
return (new me.tonsky.persistent_sorted_set.BTSet((new me.tonsky.persistent_sorted_set.Leaf([])),(0),(0),cmp,null,null));
}));

(me.tonsky.persistent_sorted_set.sorted_set_by.cljs$core$IFn$_invoke$arity$variadic \x3d (function (cmp,keys){
return me.tonsky.persistent_sorted_set.from_sequential(cmp,keys);
}));

/** @this {Function} */
(me.tonsky.persistent_sorted_set.sorted_set_by.cljs$lang$applyTo \x3d (function (seq50836){
var G__50837 \x3d cljs.core.first(seq50836);
var seq50836__$1 \x3d cljs.core.next(seq50836);
var self__5754__auto__ \x3d this;
return self__5754__auto__.cljs$core$IFn$_invoke$arity$variadic(G__50837,seq50836__$1);
}));

(me.tonsky.persistent_sorted_set.sorted_set_by.cljs$lang$maxFixedArity \x3d (1));

me.tonsky.persistent_sorted_set.sorted_set \x3d (function me$tonsky$persistent_sorted_set$sorted_set(var_args){
var G__50841 \x3d arguments.length;
switch (G__50841) {
case 0:
return me.tonsky.persistent_sorted_set.sorted_set.cljs$core$IFn$_invoke$arity$0();

break;
default:
var args_arr__5794__auto__ \x3d [];
var len__5769__auto___51023 \x3d arguments.length;
var i__5770__auto___51024 \x3d (0);
while(true){
if((i__5770__auto___51024 \x3c len__5769__auto___51023)){
args_arr__5794__auto__.push((arguments[i__5770__auto___51024]));

var G__51025 \x3d (i__5770__auto___51024 + (1));
i__5770__auto___51024 \x3d G__51025;
continue;
} else {
}
break;
}

var argseq__5795__auto__ \x3d (new cljs.core.IndexedSeq(args_arr__5794__auto__.slice((0)),(0),null));
return me.tonsky.persistent_sorted_set.sorted_set.cljs$core$IFn$_invoke$arity$variadic(argseq__5795__auto__);

}
});

(me.tonsky.persistent_sorted_set.sorted_set.cljs$core$IFn$_invoke$arity$0 \x3d (function (){
return me.tonsky.persistent_sorted_set.sorted_set_by.cljs$core$IFn$_invoke$arity$1(cljs.core.compare);
}));

(me.tonsky.persistent_sorted_set.sorted_set.cljs$core$IFn$_invoke$arity$variadic \x3d (function (keys){
return me.tonsky.persistent_sorted_set.from_sequential(cljs.core.compare,keys);
}));

/** @this {Function} */
(me.tonsky.persistent_sorted_set.sorted_set.cljs$lang$applyTo \x3d (function (seq50840){
var self__5755__auto__ \x3d this;
return self__5755__auto__.cljs$core$IFn$_invoke$arity$variadic(cljs.core.seq(seq50840));
}));

(me.tonsky.persistent_sorted_set.sorted_set.cljs$lang$maxFixedArity \x3d (0));

");
SHADOW_ENV.evalLoad("datascript.db.js", true , "goog.provide(\x27datascript.db\x27);
goog.scope(function(){
  datascript.db.goog$module$goog$array \x3d goog.module.get(\x27goog.array\x27);
});
datascript.db.Exception \x3d Error;

datascript.db.IllegalArgumentException \x3d Error;

datascript.db.UnsupportedOperationException \x3d Error;
datascript.db.e0 \x3d (0);
datascript.db.tx0 \x3d (536870912);
datascript.db.emax \x3d (2147483647);
datascript.db.txmax \x3d (2147483647);
datascript.db.implicit_schema \x3d new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(\x22db\x22,\x22ident\x22,\x22db/ident\x22,-737096),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(\x22db\x22,\x22unique\x22,\x22db/unique\x22,329396388),new cljs.core.Keyword(\x22db.unique\x22,\x22identity\x22,\x22db.unique/identity\x22,1675950722)], null)], null);
datascript.db.seqable_QMARK_ \x3d (function datascript$db$seqable_QMARK_(x){
return (((!(typeof x \x3d\x3d\x3d \x27string\x27))) \x26\x26 (((cljs.core.seqable_QMARK_(x)) || (me.tonsky.persistent_sorted_set.arrays.array_QMARK_(x)))));
});
datascript.db.conjv \x3d cljs.core.fnil.cljs$core$IFn$_invoke$arity$2(cljs.core.conj,cljs.core.PersistentVector.EMPTY);
datascript.db.conjs \x3d cljs.core.fnil.cljs$core$IFn$_invoke$arity$2(cljs.core.conj,cljs.core.PersistentHashSet.EMPTY);
/**
 * Same as reduce, but `f` takes [acc el idx]
 */
datascript.db.reduce_indexed \x3d (function datascript$db$reduce_indexed(f,init,xs){
return cljs.core.first(cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (p__51855,x){
var vec__51856 \x3d p__51855;
var acc \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__51856,(0),null);
var idx \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__51856,(1),null);
var res \x3d (f.cljs$core$IFn$_invoke$arity$3 ? f.cljs$core$IFn$_invoke$arity$3(acc,x,idx) : f.call(null,acc,x,idx));
if(cljs.core.reduced_QMARK_(res)){
return cljs.core.reduced(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [res,idx], null));
} else {
return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [res,(idx + (1))], null);
}
}),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [init,(0)], null),xs));
});
/**
 * Take the \x26env from a macro, and tell whether we are expanding into cljs.
 */
datascript.db.cljs_env_QMARK_ \x3d (function datascript$db$cljs_env_QMARK_(env){
return cljs.core.boolean$(new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760).cljs$core$IFn$_invoke$arity$1(env));
});
datascript.db.combine_hashes \x3d (function datascript$db$combine_hashes(x,y){
return cljs.core.hash_combine(x,y);
});






/**
 * @interface
 */
datascript.db.IDatom \x3d function(){};

var datascript$db$IDatom$datom_tx$dyn_52090 \x3d (function (this$){
var x__5393__auto__ \x3d (((this$ \x3d\x3d null))?null:this$);
var m__5394__auto__ \x3d (datascript.db.datom_tx[goog.typeOf(x__5393__auto__)]);
if((!((m__5394__auto__ \x3d\x3d null)))){
return (m__5394__auto__.cljs$core$IFn$_invoke$arity$1 ? m__5394__auto__.cljs$core$IFn$_invoke$arity$1(this$) : m__5394__auto__.call(null,this$));
} else {
var m__5392__auto__ \x3d (datascript.db.datom_tx[\x22_\x22]);
if((!((m__5392__auto__ \x3d\x3d null)))){
return (m__5392__auto__.cljs$core$IFn$_invoke$arity$1 ? m__5392__auto__.cljs$core$IFn$_invoke$arity$1(this$) : m__5392__auto__.call(null,this$));
} else {
throw cljs.core.missing_protocol(\x22IDatom.datom-tx\x22,this$);
}
}
});
datascript.db.datom_tx \x3d (function datascript$db$datom_tx(this$){
if((((!((this$ \x3d\x3d null)))) \x26\x26 ((!((this$.datascript$db$IDatom$datom_tx$arity$1 \x3d\x3d null)))))){
return this$.datascript$db$IDatom$datom_tx$arity$1(this$);
} else {
return datascript$db$IDatom$datom_tx$dyn_52090(this$);
}
});

var datascript$db$IDatom$datom_added$dyn_52091 \x3d (function (this$){
var x__5393__auto__ \x3d (((this$ \x3d\x3d null))?null:this$);
var m__5394__auto__ \x3d (datascript.db.datom_added[goog.typeOf(x__5393__auto__)]);
if((!((m__5394__auto__ \x3d\x3d null)))){
return (m__5394__auto__.cljs$core$IFn$_invoke$arity$1 ? m__5394__auto__.cljs$core$IFn$_invoke$arity$1(this$) : m__5394__auto__.call(null,this$));
} else {
var m__5392__auto__ \x3d (datascript.db.datom_added[\x22_\x22]);
if((!((m__5392__auto__ \x3d\x3d null)))){
return (m__5392__auto__.cljs$core$IFn$_invoke$arity$1 ? m__5392__auto__.cljs$core$IFn$_invoke$arity$1(this$) : m__5392__auto__.call(null,this$));
} else {
throw cljs.core.missing_protocol(\x22IDatom.datom-added\x22,this$);
}
}
});
datascript.db.datom_added \x3d (function datascript$db$datom_added(this$){
if((((!((this$ \x3d\x3d null)))) \x26\x26 ((!((this$.datascript$db$IDatom$datom_added$arity$1 \x3d\x3d null)))))){
return this$.datascript$db$IDatom$datom_added$arity$1(this$);
} else {
return datascript$db$IDatom$datom_added$dyn_52091(this$);
}
});

var datascript$db$IDatom$datom_get_idx$dyn_52092 \x3d (function (this$){
var x__5393__auto__ \x3d (((this$ \x3d\x3d null))?null:this$);
var m__5394__auto__ \x3d (datascript.db.datom_get_idx[goog.typeOf(x__5393__auto__)]);
if((!((m__5394__auto__ \x3d\x3d null)))){
return (m__5394__auto__.cljs$core$IFn$_invoke$arity$1 ? m__5394__auto__.cljs$core$IFn$_invoke$arity$1(this$) : m__5394__auto__.call(null,this$));
} else {
var m__5392__auto__ \x3d (datascript.db.datom_get_idx[\x22_\x22]);
if((!((m__5392__auto__ \x3d\x3d null)))){
return (m__5392__auto__.cljs$core$IFn$_invoke$arity$1 ? m__5392__auto__.cljs$core$IFn$_invoke$arity$1(this$) : m__5392__auto__.call(null,this$));
} else {
throw cljs.core.missing_protocol(\x22IDatom.datom-get-idx\x22,this$);
}
}
});
datascript.db.datom_get_idx \x3d (function datascript$db$datom_get_idx(this$){
if((((!((this$ \x3d\x3d null)))) \x26\x26 ((!((this$.datascript$db$IDatom$datom_get_idx$arity$1 \x3d\x3d null)))))){
return this$.datascript$db$IDatom$datom_get_idx$arity$1(this$);
} else {
return datascript$db$IDatom$datom_get_idx$dyn_52092(this$);
}
});

var datascript$db$IDatom$datom_set_idx$dyn_52103 \x3d (function (this$,value){
var x__5393__auto__ \x3d (((this$ \x3d\x3d null))?null:this$);
var m__5394__auto__ \x3d (datascript.db.datom_set_idx[goog.typeOf(x__5393__auto__)]);
if((!((m__5394__auto__ \x3d\x3d null)))){
return (m__5394__auto__.cljs$core$IFn$_invoke$arity$2 ? m__5394__auto__.cljs$core$IFn$_invoke$arity$2(this$,value) : m__5394__auto__.call(null,this$,value));
} else {
var m__5392__auto__ \x3d (datascript.db.datom_set_idx[\x22_\x22]);
if((!((m__5392__auto__ \x3d\x3d null)))){
return (m__5392__auto__.cljs$core$IFn$_invoke$arity$2 ? m__5392__auto__.cljs$core$IFn$_invoke$arity$2(this$,value) : m__5392__auto__.call(null,this$,value));
} else {
throw cljs.core.missing_protocol(\x22IDatom.datom-set-idx\x22,this$);
}
}
});
datascript.db.datom_set_idx \x3d (function datascript$db$datom_set_idx(this$,value){
if((((!((this$ \x3d\x3d null)))) \x26\x26 ((!((this$.datascript$db$IDatom$datom_set_idx$arity$2 \x3d\x3d null)))))){
return this$.datascript$db$IDatom$datom_set_idx$arity$2(this$,value);
} else {
return datascript$db$IDatom$datom_set_idx$dyn_52103(this$,value);
}
});


/**
* @constructor
 * @implements {cljs.core.IIndexed}
 * @implements {datascript.db.IDatom}
 * @implements {cljs.core.IEquiv}
 * @implements {cljs.core.IHash}
 * @implements {cljs.core.ISeqable}
 * @implements {cljs.core.IPrintWithWriter}
 * @implements {cljs.core.IAssociative}
 * @implements {cljs.core.ILookup}
*/
datascript.db.Datom \x3d (function (e,a,v,tx,idx,_hash){
this.e \x3d e;
this.a \x3d a;
this.v \x3d v;
this.tx \x3d tx;
this.idx \x3d idx;
this._hash \x3d _hash;
this.cljs$lang$protocol_mask$partition0$ \x3d 2162164496;
this.cljs$lang$protocol_mask$partition1$ \x3d 0;
});
(datascript.db.Datom.prototype.datascript$db$IDatom$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.db.Datom.prototype.datascript$db$IDatom$datom_tx$arity$1 \x3d (function (d){
var self__ \x3d this;
var d__$1 \x3d this;
if((self__.tx \x3e (0))){
return self__.tx;
} else {
return (- self__.tx);
}
}));

(datascript.db.Datom.prototype.datascript$db$IDatom$datom_added$arity$1 \x3d (function (d){
var self__ \x3d this;
var d__$1 \x3d this;
return (self__.tx \x3e (0));
}));

(datascript.db.Datom.prototype.datascript$db$IDatom$datom_get_idx$arity$1 \x3d (function (_){
var self__ \x3d this;
var ___$1 \x3d this;
return self__.idx;
}));

(datascript.db.Datom.prototype.datascript$db$IDatom$datom_set_idx$arity$2 \x3d (function (_,value){
var self__ \x3d this;
var ___$1 \x3d this;
return (self__.idx \x3d (value | (0)));
}));

(datascript.db.Datom.prototype.cljs$core$IHash$_hash$arity$1 \x3d (function (d){
var self__ \x3d this;
var d__$1 \x3d this;
if((self__._hash \x3d\x3d\x3d (0))){
return (self__._hash \x3d (datascript.db.hash_datom.cljs$core$IFn$_invoke$arity$1 ? datascript.db.hash_datom.cljs$core$IFn$_invoke$arity$1(d__$1) : datascript.db.hash_datom.call(null,d__$1)));
} else {
return self__._hash;
}
}));

(datascript.db.Datom.prototype.cljs$core$IEquiv$_equiv$arity$2 \x3d (function (d,o){
var self__ \x3d this;
var d__$1 \x3d this;
var and__5043__auto__ \x3d (o instanceof datascript.db.Datom);
if(and__5043__auto__){
return (datascript.db.equiv_datom.cljs$core$IFn$_invoke$arity$2 ? datascript.db.equiv_datom.cljs$core$IFn$_invoke$arity$2(d__$1,o) : datascript.db.equiv_datom.call(null,d__$1,o));
} else {
return and__5043__auto__;
}
}));

(datascript.db.Datom.prototype.cljs$core$ISeqable$_seq$arity$1 \x3d (function (d){
var self__ \x3d this;
var d__$1 \x3d this;
return (datascript.db.seq_datom.cljs$core$IFn$_invoke$arity$1 ? datascript.db.seq_datom.cljs$core$IFn$_invoke$arity$1(d__$1) : datascript.db.seq_datom.call(null,d__$1));
}));

(datascript.db.Datom.prototype.cljs$core$ILookup$_lookup$arity$2 \x3d (function (d,k){
var self__ \x3d this;
var d__$1 \x3d this;
return (datascript.db.val_at_datom.cljs$core$IFn$_invoke$arity$3 ? datascript.db.val_at_datom.cljs$core$IFn$_invoke$arity$3(d__$1,k,null) : datascript.db.val_at_datom.call(null,d__$1,k,null));
}));

(datascript.db.Datom.prototype.cljs$core$ILookup$_lookup$arity$3 \x3d (function (d,k,nf){
var self__ \x3d this;
var d__$1 \x3d this;
return (datascript.db.val_at_datom.cljs$core$IFn$_invoke$arity$3 ? datascript.db.val_at_datom.cljs$core$IFn$_invoke$arity$3(d__$1,k,nf) : datascript.db.val_at_datom.call(null,d__$1,k,nf));
}));

(datascript.db.Datom.prototype.cljs$core$IIndexed$_nth$arity$2 \x3d (function (this$,i){
var self__ \x3d this;
var this$__$1 \x3d this;
return (datascript.db.nth_datom.cljs$core$IFn$_invoke$arity$2 ? datascript.db.nth_datom.cljs$core$IFn$_invoke$arity$2(this$__$1,i) : datascript.db.nth_datom.call(null,this$__$1,i));
}));

(datascript.db.Datom.prototype.cljs$core$IIndexed$_nth$arity$3 \x3d (function (this$,i,not_found){
var self__ \x3d this;
var this$__$1 \x3d this;
return (datascript.db.nth_datom.cljs$core$IFn$_invoke$arity$3 ? datascript.db.nth_datom.cljs$core$IFn$_invoke$arity$3(this$__$1,i,not_found) : datascript.db.nth_datom.call(null,this$__$1,i,not_found));
}));

(datascript.db.Datom.prototype.cljs$core$IAssociative$_assoc$arity$3 \x3d (function (d,k,v__$1){
var self__ \x3d this;
var d__$1 \x3d this;
return (datascript.db.assoc_datom.cljs$core$IFn$_invoke$arity$3 ? datascript.db.assoc_datom.cljs$core$IFn$_invoke$arity$3(d__$1,k,v__$1) : datascript.db.assoc_datom.call(null,d__$1,k,v__$1));
}));

(datascript.db.Datom.prototype.cljs$core$IPrintWithWriter$_pr_writer$arity$3 \x3d (function (d,writer,opts){
var self__ \x3d this;
var d__$1 \x3d this;
return cljs.core.pr_sequential_writer(writer,cljs.core.pr_writer,\x22#datascript/Datom [\x22,\x22 \x22,\x22]\x22,opts,new cljs.core.PersistentVector(null, 5, 5, cljs.core.PersistentVector.EMPTY_NODE, [d__$1.e,d__$1.a,d__$1.v,d__$1.datascript$db$IDatom$datom_tx$arity$1(null),d__$1.datascript$db$IDatom$datom_added$arity$1(null)], null));
}));

(datascript.db.Datom.getBasis \x3d (function (){
return new cljs.core.PersistentVector(null, 6, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.with_meta(new cljs.core.Symbol(null,\x22e\x22,\x22e\x22,-1273166571,null),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,\x22tag\x22,\x22tag\x22,-1290361223),new cljs.core.Symbol(null,\x22number\x22,\x22number\x22,-1084057331,null)], null)),new cljs.core.Symbol(null,\x22a\x22,\x22a\x22,-482876059,null),new cljs.core.Symbol(null,\x22v\x22,\x22v\x22,1661996586,null),cljs.core.with_meta(new cljs.core.Symbol(null,\x22tx\x22,\x22tx\x22,2107161945,null),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,\x22tag\x22,\x22tag\x22,-1290361223),new cljs.core.Symbol(null,\x22number\x22,\x22number\x22,-1084057331,null)], null)),cljs.core.with_meta(new cljs.core.Symbol(null,\x22idx\x22,\x22idx\x22,-1600747296,null),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22tag\x22,\x22tag\x22,-1290361223),new cljs.core.Symbol(null,\x22number\x22,\x22number\x22,-1084057331,null),new cljs.core.Keyword(null,\x22mutable\x22,\x22mutable\x22,875778266),true], null)),cljs.core.with_meta(new cljs.core.Symbol(null,\x22_hash\x22,\x22_hash\x22,-2130838312,null),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22tag\x22,\x22tag\x22,-1290361223),new cljs.core.Symbol(null,\x22number\x22,\x22number\x22,-1084057331,null),new cljs.core.Keyword(null,\x22mutable\x22,\x22mutable\x22,875778266),true], null))], null);
}));

(datascript.db.Datom.cljs$lang$type \x3d true);

(datascript.db.Datom.cljs$lang$ctorStr \x3d \x22datascript.db/Datom\x22);

(datascript.db.Datom.cljs$lang$ctorPrWriter \x3d (function (this__5330__auto__,writer__5331__auto__,opt__5332__auto__){
return cljs.core._write(writer__5331__auto__,\x22datascript.db/Datom\x22);
}));

/**
 * Positional factory function for datascript.db/Datom.
 */
datascript.db.__GT_Datom \x3d (function datascript$db$__GT_Datom(e,a,v,tx,idx,_hash){
return (new datascript.db.Datom(e,a,v,tx,idx,_hash));
});

goog.exportSymbol(\x22datascript.db.Datom\x22,datascript.db.Datom);
datascript.db.datom \x3d (function datascript$db$datom(var_args){
var G__51860 \x3d arguments.length;
switch (G__51860) {
case 3:
return datascript.db.datom.cljs$core$IFn$_invoke$arity$3((arguments[(0)]),(arguments[(1)]),(arguments[(2)]));

break;
case 4:
return datascript.db.datom.cljs$core$IFn$_invoke$arity$4((arguments[(0)]),(arguments[(1)]),(arguments[(2)]),(arguments[(3)]));

break;
case 5:
return datascript.db.datom.cljs$core$IFn$_invoke$arity$5((arguments[(0)]),(arguments[(1)]),(arguments[(2)]),(arguments[(3)]),(arguments[(4)]));

break;
default:
throw (new Error([\x22Invalid arity: \x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1(arguments.length)].join(\x27\x27)));

}
});

(datascript.db.datom.cljs$core$IFn$_invoke$arity$3 \x3d (function (e,a,v){
return (new datascript.db.Datom(e,a,v,(536870912),(0),(0)));
}));

(datascript.db.datom.cljs$core$IFn$_invoke$arity$4 \x3d (function (e,a,v,tx){
return (new datascript.db.Datom(e,a,v,tx,(0),(0)));
}));

(datascript.db.datom.cljs$core$IFn$_invoke$arity$5 \x3d (function (e,a,v,tx,added){
return (new datascript.db.Datom(e,a,v,(cljs.core.truth_(added)?tx:(- tx)),(0),(0)));
}));

(datascript.db.datom.cljs$lang$maxFixedArity \x3d 5);

datascript.db.datom_QMARK_ \x3d (function datascript$db$datom_QMARK_(x){
return (x instanceof datascript.db.Datom);
});
datascript.db.hash_datom \x3d (function datascript$db$hash_datom(d){
return datascript.db.combine_hashes(datascript.db.combine_hashes(cljs.core.hash(d.e),cljs.core.hash(d.a)),cljs.core.hash(d.v));
});
datascript.db.equiv_datom \x3d (function datascript$db$equiv_datom(d,o){
return (((d.e \x3d\x3d\x3d o.e)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(d.a,o.a)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(d.v,o.v)))));
});
datascript.db.seq_datom \x3d (function datascript$db$seq_datom(d){
return (new cljs.core.List(null,d.e,(new cljs.core.List(null,d.a,(new cljs.core.List(null,d.v,(new cljs.core.List(null,d.datascript$db$IDatom$datom_tx$arity$1(null),(new cljs.core.List(null,d.datascript$db$IDatom$datom_added$arity$1(null),null,(1),null)),(2),null)),(3),null)),(4),null)),(5),null));
});
datascript.db.val_at_datom \x3d (function datascript$db$val_at_datom(d,k,not_found){
var G__51861 \x3d k;
if(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22v\x22,\x22v\x22,21465059),G__51861)){
return d.v;
} else {
if(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(\x22e\x22,G__51861)){
return d.e;
} else {
if(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22added\x22,\x22added\x22,2057651688),G__51861)){
return d.datascript$db$IDatom$datom_added$arity$1(null);
} else {
if(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(\x22v\x22,G__51861)){
return d.v;
} else {
if(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22e\x22,\x22e\x22,1381269198),G__51861)){
return d.e;
} else {
if(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(\x22a\x22,G__51861)){
return d.a;
} else {
if(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22tx\x22,\x22tx\x22,466630418),G__51861)){
return d.datascript$db$IDatom$datom_tx$arity$1(null);
} else {
if(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(\x22added\x22,G__51861)){
return d.datascript$db$IDatom$datom_added$arity$1(null);
} else {
if(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(\x22tx\x22,G__51861)){
return d.datascript$db$IDatom$datom_tx$arity$1(null);
} else {
if(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22a\x22,\x22a\x22,-2123407586),G__51861)){
return d.a;
} else {
return not_found;

}
}
}
}
}
}
}
}
}
}
});
datascript.db.nth_datom \x3d (function datascript$db$nth_datom(var_args){
var G__51863 \x3d arguments.length;
switch (G__51863) {
case 2:
return datascript.db.nth_datom.cljs$core$IFn$_invoke$arity$2((arguments[(0)]),(arguments[(1)]));

break;
case 3:
return datascript.db.nth_datom.cljs$core$IFn$_invoke$arity$3((arguments[(0)]),(arguments[(1)]),(arguments[(2)]));

break;
default:
throw (new Error([\x22Invalid arity: \x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1(arguments.length)].join(\x27\x27)));

}
});

(datascript.db.nth_datom.cljs$core$IFn$_invoke$arity$2 \x3d (function (d,i){
var G__51864 \x3d i;
switch (G__51864) {
case (0):
return d.e;

break;
case (1):
return d.a;

break;
case (2):
return d.v;

break;
case (3):
return d.datascript$db$IDatom$datom_tx$arity$1(null);

break;
case (4):
return d.datascript$db$IDatom$datom_added$arity$1(null);

break;
default:
throw (new Error([\x22Datom/-nth: Index out of bounds: \x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1(i)].join(\x27\x27)));

}
}));

(datascript.db.nth_datom.cljs$core$IFn$_invoke$arity$3 \x3d (function (d,i,not_found){
var G__51865 \x3d i;
switch (G__51865) {
case (0):
return d.e;

break;
case (1):
return d.a;

break;
case (2):
return d.v;

break;
case (3):
return d.datascript$db$IDatom$datom_tx$arity$1(null);

break;
case (4):
return d.datascript$db$IDatom$datom_added$arity$1(null);

break;
default:
return not_found;

}
}));

(datascript.db.nth_datom.cljs$lang$maxFixedArity \x3d 3);

datascript.db.assoc_datom \x3d (function datascript$db$assoc_datom(d,k,v){
var G__51866 \x3d k;
var G__51866__$1 \x3d (((G__51866 instanceof cljs.core.Keyword))?G__51866.fqn:null);
switch (G__51866__$1) {
case \x22e\x22:
return datascript.db.datom.cljs$core$IFn$_invoke$arity$5(v,d.a,d.v,d.datascript$db$IDatom$datom_tx$arity$1(null),d.datascript$db$IDatom$datom_added$arity$1(null));

break;
case \x22a\x22:
return datascript.db.datom.cljs$core$IFn$_invoke$arity$5(d.e,v,d.v,d.datascript$db$IDatom$datom_tx$arity$1(null),d.datascript$db$IDatom$datom_added$arity$1(null));

break;
case \x22v\x22:
return datascript.db.datom.cljs$core$IFn$_invoke$arity$5(d.e,d.a,v,d.datascript$db$IDatom$datom_tx$arity$1(null),d.datascript$db$IDatom$datom_added$arity$1(null));

break;
case \x22tx\x22:
return datascript.db.datom.cljs$core$IFn$_invoke$arity$5(d.e,d.a,d.v,v,d.datascript$db$IDatom$datom_added$arity$1(null));

break;
case \x22added\x22:
return datascript.db.datom.cljs$core$IFn$_invoke$arity$5(d.e,d.a,d.v,d.datascript$db$IDatom$datom_tx$arity$1(null),v);

break;
default:
throw (new datascript.db.IllegalArgumentException([\x22invalid key for #datascript/Datom: \x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1(k)].join(\x27\x27)));

}
});
datascript.db.datom_from_reader \x3d (function datascript$db$datom_from_reader(vec){
return cljs.core.apply.cljs$core$IFn$_invoke$arity$2(datascript.db.datom,vec);
});
datascript.db.cmp \x3d (function datascript$db$cmp(x,y){
if((x \x3d\x3d null)){
return (0);
} else {
if((y \x3d\x3d null)){
return (0);
} else {
return cljs.core.compare(x,y);
}
}
});
datascript.db.class_identical_QMARK_ \x3d (function datascript$db$class_identical_QMARK_(x,y){
return (cljs.core.type(x) \x3d\x3d\x3d cljs.core.type(y));
});
datascript.db.class_compare \x3d (function datascript$db$class_compare(x,y){
return datascript.db.goog$module$goog$array.defaultCompare(cljs.core.type__GT_str(cljs.core.type(x)),cljs.core.type__GT_str(cljs.core.type(y)));
});
datascript.db.value_compare \x3d (function datascript$db$value_compare(x,y){
try{if(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(x,y)){
return (0);
} else {
if((((!((x \x3d\x3d null))))?(((((x.cljs$lang$protocol_mask$partition1$ \x26 (2048))) || ((cljs.core.PROTOCOL_SENTINEL \x3d\x3d\x3d x.cljs$core$IComparable$))))?true:(((!x.cljs$lang$protocol_mask$partition1$))?cljs.core.native_satisfies_QMARK_(cljs.core.IComparable,x):false)):cljs.core.native_satisfies_QMARK_(cljs.core.IComparable,x))){
return cljs.core._compare(x,y);
} else {
if((!(datascript.db.class_identical_QMARK_(x,y)))){
return datascript.db.class_compare(x,y);
} else {
if(((typeof x \x3d\x3d\x3d \x27number\x27) || (((typeof x \x3d\x3d\x3d \x27string\x27) || (((cljs.core.array_QMARK_(x)) || (((x \x3d\x3d\x3d true) || (x \x3d\x3d\x3d false))))))))){
return datascript.db.goog$module$goog$array.defaultCompare(x,y);
} else {
return (cljs.core.hash(x) - cljs.core.hash(y));

}
}
}
}
}catch (e51868){if((e51868 instanceof Error)){
var e \x3d e51868;
if((!(datascript.db.class_identical_QMARK_(x,y)))){
return datascript.db.class_compare(x,y);
} else {
throw e;
}
} else {
throw e51868;

}
}});
datascript.db.value_cmp \x3d (function datascript$db$value_cmp(x,y){
if((x \x3d\x3d null)){
return (0);
} else {
if((y \x3d\x3d null)){
return (0);
} else {
return datascript.db.value_compare(x,y);

}
}
});
datascript.db.cmp_datoms_eavt \x3d (function datascript$db$cmp_datoms_eavt(d1,d2){
var c__51213__auto__ \x3d (d1.e - d2.e);
if(((0) \x3d\x3d\x3d c__51213__auto__)){
var c__51213__auto____$1 \x3d datascript.db.cmp(d1.a,d2.a);
if(((0) \x3d\x3d\x3d c__51213__auto____$1)){
var c__51213__auto____$2 \x3d datascript.db.value_cmp(d1.v,d2.v);
if(((0) \x3d\x3d\x3d c__51213__auto____$2)){
var c__51213__auto____$3 \x3d (d1.datascript$db$IDatom$datom_tx$arity$1(null) - d2.datascript$db$IDatom$datom_tx$arity$1(null));
if(((0) \x3d\x3d\x3d c__51213__auto____$3)){
return (0);
} else {
return c__51213__auto____$3;
}
} else {
return c__51213__auto____$2;
}
} else {
return c__51213__auto____$1;
}
} else {
return c__51213__auto__;
}
});
datascript.db.cmp_datoms_aevt \x3d (function datascript$db$cmp_datoms_aevt(d1,d2){
var c__51213__auto__ \x3d datascript.db.cmp(d1.a,d2.a);
if(((0) \x3d\x3d\x3d c__51213__auto__)){
var c__51213__auto____$1 \x3d (d1.e - d2.e);
if(((0) \x3d\x3d\x3d c__51213__auto____$1)){
var c__51213__auto____$2 \x3d datascript.db.value_cmp(d1.v,d2.v);
if(((0) \x3d\x3d\x3d c__51213__auto____$2)){
var c__51213__auto____$3 \x3d (d1.datascript$db$IDatom$datom_tx$arity$1(null) - d2.datascript$db$IDatom$datom_tx$arity$1(null));
if(((0) \x3d\x3d\x3d c__51213__auto____$3)){
return (0);
} else {
return c__51213__auto____$3;
}
} else {
return c__51213__auto____$2;
}
} else {
return c__51213__auto____$1;
}
} else {
return c__51213__auto__;
}
});
datascript.db.cmp_datoms_avet \x3d (function datascript$db$cmp_datoms_avet(d1,d2){
var c__51213__auto__ \x3d datascript.db.cmp(d1.a,d2.a);
if(((0) \x3d\x3d\x3d c__51213__auto__)){
var c__51213__auto____$1 \x3d datascript.db.value_cmp(d1.v,d2.v);
if(((0) \x3d\x3d\x3d c__51213__auto____$1)){
var c__51213__auto____$2 \x3d (d1.e - d2.e);
if(((0) \x3d\x3d\x3d c__51213__auto____$2)){
var c__51213__auto____$3 \x3d (d1.datascript$db$IDatom$datom_tx$arity$1(null) - d2.datascript$db$IDatom$datom_tx$arity$1(null));
if(((0) \x3d\x3d\x3d c__51213__auto____$3)){
return (0);
} else {
return c__51213__auto____$3;
}
} else {
return c__51213__auto____$2;
}
} else {
return c__51213__auto____$1;
}
} else {
return c__51213__auto__;
}
});
datascript.db.cmp_attr_quick \x3d (function datascript$db$cmp_attr_quick(a1,a2){
if((a1 instanceof cljs.core.Keyword)){
return cljs.core._compare(a1,a2);
} else {
return datascript.db.goog$module$goog$array.defaultCompare(a1,a2);
}
});
datascript.db.cmp_datoms_eav_quick \x3d (function datascript$db$cmp_datoms_eav_quick(d1,d2){
var c__51213__auto__ \x3d (d1.e - d2.e);
if(((0) \x3d\x3d\x3d c__51213__auto__)){
var c__51213__auto____$1 \x3d datascript.db.cmp_attr_quick(d1.a,d2.a);
if(((0) \x3d\x3d\x3d c__51213__auto____$1)){
var c__51213__auto____$2 \x3d datascript.db.value_compare(d1.v,d2.v);
if(((0) \x3d\x3d\x3d c__51213__auto____$2)){
return (0);
} else {
return c__51213__auto____$2;
}
} else {
return c__51213__auto____$1;
}
} else {
return c__51213__auto__;
}
});
datascript.db.cmp_datoms_eavt_quick \x3d (function datascript$db$cmp_datoms_eavt_quick(d1,d2){
var c__51213__auto__ \x3d (d1.e - d2.e);
if(((0) \x3d\x3d\x3d c__51213__auto__)){
var c__51213__auto____$1 \x3d datascript.db.cmp_attr_quick(d1.a,d2.a);
if(((0) \x3d\x3d\x3d c__51213__auto____$1)){
var c__51213__auto____$2 \x3d datascript.db.value_compare(d1.v,d2.v);
if(((0) \x3d\x3d\x3d c__51213__auto____$2)){
var c__51213__auto____$3 \x3d (d1.datascript$db$IDatom$datom_tx$arity$1(null) - d2.datascript$db$IDatom$datom_tx$arity$1(null));
if(((0) \x3d\x3d\x3d c__51213__auto____$3)){
return (0);
} else {
return c__51213__auto____$3;
}
} else {
return c__51213__auto____$2;
}
} else {
return c__51213__auto____$1;
}
} else {
return c__51213__auto__;
}
});
datascript.db.cmp_datoms_aevt_quick \x3d (function datascript$db$cmp_datoms_aevt_quick(d1,d2){
var c__51213__auto__ \x3d datascript.db.cmp_attr_quick(d1.a,d2.a);
if(((0) \x3d\x3d\x3d c__51213__auto__)){
var c__51213__auto____$1 \x3d (d1.e - d2.e);
if(((0) \x3d\x3d\x3d c__51213__auto____$1)){
var c__51213__auto____$2 \x3d datascript.db.value_compare(d1.v,d2.v);
if(((0) \x3d\x3d\x3d c__51213__auto____$2)){
var c__51213__auto____$3 \x3d (d1.datascript$db$IDatom$datom_tx$arity$1(null) - d2.datascript$db$IDatom$datom_tx$arity$1(null));
if(((0) \x3d\x3d\x3d c__51213__auto____$3)){
return (0);
} else {
return c__51213__auto____$3;
}
} else {
return c__51213__auto____$2;
}
} else {
return c__51213__auto____$1;
}
} else {
return c__51213__auto__;
}
});
datascript.db.cmp_datoms_avet_quick \x3d (function datascript$db$cmp_datoms_avet_quick(d1,d2){
var c__51213__auto__ \x3d datascript.db.cmp_attr_quick(d1.a,d2.a);
if(((0) \x3d\x3d\x3d c__51213__auto__)){
var c__51213__auto____$1 \x3d datascript.db.value_compare(d1.v,d2.v);
if(((0) \x3d\x3d\x3d c__51213__auto____$1)){
var c__51213__auto____$2 \x3d (d1.e - d2.e);
if(((0) \x3d\x3d\x3d c__51213__auto____$2)){
var c__51213__auto____$3 \x3d (d1.datascript$db$IDatom$datom_tx$arity$1(null) - d2.datascript$db$IDatom$datom_tx$arity$1(null));
if(((0) \x3d\x3d\x3d c__51213__auto____$3)){
return (0);
} else {
return c__51213__auto____$3;
}
} else {
return c__51213__auto____$2;
}
} else {
return c__51213__auto____$1;
}
} else {
return c__51213__auto__;
}
});
datascript.db.diff_sorted \x3d (function datascript$db$diff_sorted(a,b,cmp){
var only_a \x3d cljs.core.PersistentVector.EMPTY;
var only_b \x3d cljs.core.PersistentVector.EMPTY;
var both \x3d cljs.core.PersistentVector.EMPTY;
var a__$1 \x3d a;
var b__$1 \x3d b;
while(true){
if(cljs.core.empty_QMARK_(a__$1)){
return new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.not_empty(only_a),cljs.core.not_empty(cljs.core.into.cljs$core$IFn$_invoke$arity$2(only_b,b__$1)),cljs.core.not_empty(both)], null);
} else {
if(cljs.core.empty_QMARK_(b__$1)){
return new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.not_empty(cljs.core.into.cljs$core$IFn$_invoke$arity$2(only_a,a__$1)),cljs.core.not_empty(only_b),cljs.core.not_empty(both)], null);
} else {
var first_a \x3d cljs.core.first(a__$1);
var first_b \x3d cljs.core.first(b__$1);
var diff \x3d (function (){try{return (cmp.cljs$core$IFn$_invoke$arity$2 ? cmp.cljs$core$IFn$_invoke$arity$2(first_a,first_b) : cmp.call(null,first_a,first_b));
}catch (e51871){if((e51871 instanceof Error)){
var _ \x3d e51871;
return new cljs.core.Keyword(null,\x22incomparable\x22,\x22incomparable\x22,1634329662);
} else {
throw e51871;

}
}})();
if(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(diff,new cljs.core.Keyword(null,\x22incomparable\x22,\x22incomparable\x22,1634329662))){
var G__52199 \x3d cljs.core.conj.cljs$core$IFn$_invoke$arity$2(only_a,first_a);
var G__52200 \x3d cljs.core.conj.cljs$core$IFn$_invoke$arity$2(only_b,first_b);
var G__52201 \x3d both;
var G__52202 \x3d cljs.core.next(a__$1);
var G__52203 \x3d cljs.core.next(b__$1);
only_a \x3d G__52199;
only_b \x3d G__52200;
both \x3d G__52201;
a__$1 \x3d G__52202;
b__$1 \x3d G__52203;
continue;
} else {
if((diff \x3d\x3d\x3d (0))){
var G__52205 \x3d only_a;
var G__52206 \x3d only_b;
var G__52207 \x3d cljs.core.conj.cljs$core$IFn$_invoke$arity$2(both,first_a);
var G__52208 \x3d cljs.core.next(a__$1);
var G__52209 \x3d cljs.core.next(b__$1);
only_a \x3d G__52205;
only_b \x3d G__52206;
both \x3d G__52207;
a__$1 \x3d G__52208;
b__$1 \x3d G__52209;
continue;
} else {
if((diff \x3c (0))){
var G__52211 \x3d cljs.core.conj.cljs$core$IFn$_invoke$arity$2(only_a,first_a);
var G__52212 \x3d only_b;
var G__52213 \x3d both;
var G__52214 \x3d cljs.core.next(a__$1);
var G__52215 \x3d b__$1;
only_a \x3d G__52211;
only_b \x3d G__52212;
both \x3d G__52213;
a__$1 \x3d G__52214;
b__$1 \x3d G__52215;
continue;
} else {
if((diff \x3e (0))){
var G__52217 \x3d only_a;
var G__52218 \x3d cljs.core.conj.cljs$core$IFn$_invoke$arity$2(only_b,first_b);
var G__52219 \x3d both;
var G__52220 \x3d a__$1;
var G__52221 \x3d cljs.core.next(b__$1);
only_a \x3d G__52217;
only_b \x3d G__52218;
both \x3d G__52219;
a__$1 \x3d G__52220;
b__$1 \x3d G__52221;
continue;
} else {
return null;
}
}
}
}

}
}
break;
}
});








/**
 * @interface
 */
datascript.db.ISearch \x3d function(){};

var datascript$db$ISearch$_search$dyn_52225 \x3d (function (data,pattern){
var x__5393__auto__ \x3d (((data \x3d\x3d null))?null:data);
var m__5394__auto__ \x3d (datascript.db._search[goog.typeOf(x__5393__auto__)]);
if((!((m__5394__auto__ \x3d\x3d null)))){
return (m__5394__auto__.cljs$core$IFn$_invoke$arity$2 ? m__5394__auto__.cljs$core$IFn$_invoke$arity$2(data,pattern) : m__5394__auto__.call(null,data,pattern));
} else {
var m__5392__auto__ \x3d (datascript.db._search[\x22_\x22]);
if((!((m__5392__auto__ \x3d\x3d null)))){
return (m__5392__auto__.cljs$core$IFn$_invoke$arity$2 ? m__5392__auto__.cljs$core$IFn$_invoke$arity$2(data,pattern) : m__5392__auto__.call(null,data,pattern));
} else {
throw cljs.core.missing_protocol(\x22ISearch.-search\x22,data);
}
}
});
datascript.db._search \x3d (function datascript$db$_search(data,pattern){
if((((!((data \x3d\x3d null)))) \x26\x26 ((!((data.datascript$db$ISearch$_search$arity$2 \x3d\x3d null)))))){
return data.datascript$db$ISearch$_search$arity$2(data,pattern);
} else {
return datascript$db$ISearch$_search$dyn_52225(data,pattern);
}
});

datascript.db.fsearch \x3d (function datascript$db$fsearch(data,pattern){
return cljs.core.first(datascript.db._search(data,pattern));
});

/**
 * @interface
 */
datascript.db.IIndexAccess \x3d function(){};

var datascript$db$IIndexAccess$_datoms$dyn_52227 \x3d (function (db,index,components){
var x__5393__auto__ \x3d (((db \x3d\x3d null))?null:db);
var m__5394__auto__ \x3d (datascript.db._datoms[goog.typeOf(x__5393__auto__)]);
if((!((m__5394__auto__ \x3d\x3d null)))){
return (m__5394__auto__.cljs$core$IFn$_invoke$arity$3 ? m__5394__auto__.cljs$core$IFn$_invoke$arity$3(db,index,components) : m__5394__auto__.call(null,db,index,components));
} else {
var m__5392__auto__ \x3d (datascript.db._datoms[\x22_\x22]);
if((!((m__5392__auto__ \x3d\x3d null)))){
return (m__5392__auto__.cljs$core$IFn$_invoke$arity$3 ? m__5392__auto__.cljs$core$IFn$_invoke$arity$3(db,index,components) : m__5392__auto__.call(null,db,index,components));
} else {
throw cljs.core.missing_protocol(\x22IIndexAccess.-datoms\x22,db);
}
}
});
datascript.db._datoms \x3d (function datascript$db$_datoms(db,index,components){
if((((!((db \x3d\x3d null)))) \x26\x26 ((!((db.datascript$db$IIndexAccess$_datoms$arity$3 \x3d\x3d null)))))){
return db.datascript$db$IIndexAccess$_datoms$arity$3(db,index,components);
} else {
return datascript$db$IIndexAccess$_datoms$dyn_52227(db,index,components);
}
});

var datascript$db$IIndexAccess$_seek_datoms$dyn_52230 \x3d (function (db,index,components){
var x__5393__auto__ \x3d (((db \x3d\x3d null))?null:db);
var m__5394__auto__ \x3d (datascript.db._seek_datoms[goog.typeOf(x__5393__auto__)]);
if((!((m__5394__auto__ \x3d\x3d null)))){
return (m__5394__auto__.cljs$core$IFn$_invoke$arity$3 ? m__5394__auto__.cljs$core$IFn$_invoke$arity$3(db,index,components) : m__5394__auto__.call(null,db,index,components));
} else {
var m__5392__auto__ \x3d (datascript.db._seek_datoms[\x22_\x22]);
if((!((m__5392__auto__ \x3d\x3d null)))){
return (m__5392__auto__.cljs$core$IFn$_invoke$arity$3 ? m__5392__auto__.cljs$core$IFn$_invoke$arity$3(db,index,components) : m__5392__auto__.call(null,db,index,components));
} else {
throw cljs.core.missing_protocol(\x22IIndexAccess.-seek-datoms\x22,db);
}
}
});
datascript.db._seek_datoms \x3d (function datascript$db$_seek_datoms(db,index,components){
if((((!((db \x3d\x3d null)))) \x26\x26 ((!((db.datascript$db$IIndexAccess$_seek_datoms$arity$3 \x3d\x3d null)))))){
return db.datascript$db$IIndexAccess$_seek_datoms$arity$3(db,index,components);
} else {
return datascript$db$IIndexAccess$_seek_datoms$dyn_52230(db,index,components);
}
});

var datascript$db$IIndexAccess$_rseek_datoms$dyn_52237 \x3d (function (db,index,components){
var x__5393__auto__ \x3d (((db \x3d\x3d null))?null:db);
var m__5394__auto__ \x3d (datascript.db._rseek_datoms[goog.typeOf(x__5393__auto__)]);
if((!((m__5394__auto__ \x3d\x3d null)))){
return (m__5394__auto__.cljs$core$IFn$_invoke$arity$3 ? m__5394__auto__.cljs$core$IFn$_invoke$arity$3(db,index,components) : m__5394__auto__.call(null,db,index,components));
} else {
var m__5392__auto__ \x3d (datascript.db._rseek_datoms[\x22_\x22]);
if((!((m__5392__auto__ \x3d\x3d null)))){
return (m__5392__auto__.cljs$core$IFn$_invoke$arity$3 ? m__5392__auto__.cljs$core$IFn$_invoke$arity$3(db,index,components) : m__5392__auto__.call(null,db,index,components));
} else {
throw cljs.core.missing_protocol(\x22IIndexAccess.-rseek-datoms\x22,db);
}
}
});
datascript.db._rseek_datoms \x3d (function datascript$db$_rseek_datoms(db,index,components){
if((((!((db \x3d\x3d null)))) \x26\x26 ((!((db.datascript$db$IIndexAccess$_rseek_datoms$arity$3 \x3d\x3d null)))))){
return db.datascript$db$IIndexAccess$_rseek_datoms$arity$3(db,index,components);
} else {
return datascript$db$IIndexAccess$_rseek_datoms$dyn_52237(db,index,components);
}
});

var datascript$db$IIndexAccess$_index_range$dyn_52241 \x3d (function (db,attr,start,end){
var x__5393__auto__ \x3d (((db \x3d\x3d null))?null:db);
var m__5394__auto__ \x3d (datascript.db._index_range[goog.typeOf(x__5393__auto__)]);
if((!((m__5394__auto__ \x3d\x3d null)))){
return (m__5394__auto__.cljs$core$IFn$_invoke$arity$4 ? m__5394__auto__.cljs$core$IFn$_invoke$arity$4(db,attr,start,end) : m__5394__auto__.call(null,db,attr,start,end));
} else {
var m__5392__auto__ \x3d (datascript.db._index_range[\x22_\x22]);
if((!((m__5392__auto__ \x3d\x3d null)))){
return (m__5392__auto__.cljs$core$IFn$_invoke$arity$4 ? m__5392__auto__.cljs$core$IFn$_invoke$arity$4(db,attr,start,end) : m__5392__auto__.call(null,db,attr,start,end));
} else {
throw cljs.core.missing_protocol(\x22IIndexAccess.-index-range\x22,db);
}
}
});
datascript.db._index_range \x3d (function datascript$db$_index_range(db,attr,start,end){
if((((!((db \x3d\x3d null)))) \x26\x26 ((!((db.datascript$db$IIndexAccess$_index_range$arity$4 \x3d\x3d null)))))){
return db.datascript$db$IIndexAccess$_index_range$arity$4(db,attr,start,end);
} else {
return datascript$db$IIndexAccess$_index_range$dyn_52241(db,attr,start,end);
}
});

datascript.db.validate_indexed \x3d (function datascript$db$validate_indexed(db,index,components){
if(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(index,new cljs.core.Keyword(null,\x22avet\x22,\x22avet\x22,1383857032))){
var temp__5808__auto__ \x3d cljs.core.first(components);
if((temp__5808__auto__ \x3d\x3d null)){
return null;
} else {
var attr \x3d temp__5808__auto__;
if(cljs.core.truth_((datascript.db.indexing_QMARK_.cljs$core$IFn$_invoke$arity$2 ? datascript.db.indexing_QMARK_.cljs$core$IFn$_invoke$arity$2(db,attr) : datascript.db.indexing_QMARK_.call(null,db,attr)))){
return null;
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22Attribute \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([attr], 0)),\x22 should be marked as :db/index true\x22].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(null,\x22index-access\x22,\x22index-access\x22,-1548960265),new cljs.core.Keyword(null,\x22index\x22,\x22index\x22,-1531685915),new cljs.core.Keyword(null,\x22avet\x22,\x22avet\x22,1383857032),new cljs.core.Keyword(null,\x22components\x22,\x22components\x22,-1073188942),components], null));
}
}
} else {
return null;
}
});

/**
 * @interface
 */
datascript.db.IDB \x3d function(){};

var datascript$db$IDB$_schema$dyn_52248 \x3d (function (db){
var x__5393__auto__ \x3d (((db \x3d\x3d null))?null:db);
var m__5394__auto__ \x3d (datascript.db._schema[goog.typeOf(x__5393__auto__)]);
if((!((m__5394__auto__ \x3d\x3d null)))){
return (m__5394__auto__.cljs$core$IFn$_invoke$arity$1 ? m__5394__auto__.cljs$core$IFn$_invoke$arity$1(db) : m__5394__auto__.call(null,db));
} else {
var m__5392__auto__ \x3d (datascript.db._schema[\x22_\x22]);
if((!((m__5392__auto__ \x3d\x3d null)))){
return (m__5392__auto__.cljs$core$IFn$_invoke$arity$1 ? m__5392__auto__.cljs$core$IFn$_invoke$arity$1(db) : m__5392__auto__.call(null,db));
} else {
throw cljs.core.missing_protocol(\x22IDB.-schema\x22,db);
}
}
});
datascript.db._schema \x3d (function datascript$db$_schema(db){
if((((!((db \x3d\x3d null)))) \x26\x26 ((!((db.datascript$db$IDB$_schema$arity$1 \x3d\x3d null)))))){
return db.datascript$db$IDB$_schema$arity$1(db);
} else {
return datascript$db$IDB$_schema$dyn_52248(db);
}
});

var datascript$db$IDB$_attrs_by$dyn_52254 \x3d (function (db,property){
var x__5393__auto__ \x3d (((db \x3d\x3d null))?null:db);
var m__5394__auto__ \x3d (datascript.db._attrs_by[goog.typeOf(x__5393__auto__)]);
if((!((m__5394__auto__ \x3d\x3d null)))){
return (m__5394__auto__.cljs$core$IFn$_invoke$arity$2 ? m__5394__auto__.cljs$core$IFn$_invoke$arity$2(db,property) : m__5394__auto__.call(null,db,property));
} else {
var m__5392__auto__ \x3d (datascript.db._attrs_by[\x22_\x22]);
if((!((m__5392__auto__ \x3d\x3d null)))){
return (m__5392__auto__.cljs$core$IFn$_invoke$arity$2 ? m__5392__auto__.cljs$core$IFn$_invoke$arity$2(db,property) : m__5392__auto__.call(null,db,property));
} else {
throw cljs.core.missing_protocol(\x22IDB.-attrs-by\x22,db);
}
}
});
datascript.db._attrs_by \x3d (function datascript$db$_attrs_by(db,property){
if((((!((db \x3d\x3d null)))) \x26\x26 ((!((db.datascript$db$IDB$_attrs_by$arity$2 \x3d\x3d null)))))){
return db.datascript$db$IDB$_attrs_by$arity$2(db,property);
} else {
return datascript$db$IDB$_attrs_by$dyn_52254(db,property);
}
});

datascript.db.db_transient \x3d (function datascript$db$db_transient(db){
return cljs.core.update.cljs$core$IFn$_invoke$arity$3(cljs.core.update.cljs$core$IFn$_invoke$arity$3(cljs.core.update.cljs$core$IFn$_invoke$arity$3(db,new cljs.core.Keyword(null,\x22eavt\x22,\x22eavt\x22,-666437073),cljs.core.transient$),new cljs.core.Keyword(null,\x22aevt\x22,\x22aevt\x22,-585148059),cljs.core.transient$),new cljs.core.Keyword(null,\x22avet\x22,\x22avet\x22,1383857032),cljs.core.transient$);
});
datascript.db.db_persistent_BANG_ \x3d (function datascript$db$db_persistent_BANG_(db){
return cljs.core.update.cljs$core$IFn$_invoke$arity$3(cljs.core.update.cljs$core$IFn$_invoke$arity$3(cljs.core.update.cljs$core$IFn$_invoke$arity$3(db,new cljs.core.Keyword(null,\x22eavt\x22,\x22eavt\x22,-666437073),cljs.core.persistent_BANG_),new cljs.core.Keyword(null,\x22aevt\x22,\x22aevt\x22,-585148059),cljs.core.persistent_BANG_),new cljs.core.Keyword(null,\x22avet\x22,\x22avet\x22,1383857032),cljs.core.persistent_BANG_);
});

/**
* @constructor
 * @implements {cljs.core.IRecord}
 * @implements {cljs.core.IKVReduce}
 * @implements {cljs.core.IEquiv}
 * @implements {cljs.core.IHash}
 * @implements {cljs.core.ICollection}
 * @implements {cljs.core.ICounted}
 * @implements {cljs.core.ISeqable}
 * @implements {cljs.core.IMeta}
 * @implements {cljs.core.ICloneable}
 * @implements {cljs.core.IPrintWithWriter}
 * @implements {cljs.core.IIterable}
 * @implements {cljs.core.IWithMeta}
 * @implements {cljs.core.IAssociative}
 * @implements {cljs.core.IMap}
 * @implements {cljs.core.ILookup}
*/
datascript.db.DB \x3d (function (schema,eavt,aevt,avet,max_eid,max_tx,rschema,pull_patterns,pull_attrs,hash,__meta,__extmap,__hash){
this.schema \x3d schema;
this.eavt \x3d eavt;
this.aevt \x3d aevt;
this.avet \x3d avet;
this.max_eid \x3d max_eid;
this.max_tx \x3d max_tx;
this.rschema \x3d rschema;
this.pull_patterns \x3d pull_patterns;
this.pull_attrs \x3d pull_attrs;
this.hash \x3d hash;
this.__meta \x3d __meta;
this.__extmap \x3d __extmap;
this.__hash \x3d __hash;
this.cljs$lang$protocol_mask$partition0$ \x3d 2230716170;
this.cljs$lang$protocol_mask$partition1$ \x3d 139264;
});
(datascript.db.DB.prototype.cljs$core$ILookup$_lookup$arity$2 \x3d (function (this__5343__auto__,k__5344__auto__){
var self__ \x3d this;
var this__5343__auto____$1 \x3d this;
return this__5343__auto____$1.cljs$core$ILookup$_lookup$arity$3(null,k__5344__auto__,null);
}));

(datascript.db.DB.prototype.cljs$core$ILookup$_lookup$arity$3 \x3d (function (this__5345__auto__,k51874,else__5346__auto__){
var self__ \x3d this;
var this__5345__auto____$1 \x3d this;
var G__51878 \x3d k51874;
var G__51878__$1 \x3d (((G__51878 instanceof cljs.core.Keyword))?G__51878.fqn:null);
switch (G__51878__$1) {
case \x22schema\x22:
return self__.schema;

break;
case \x22eavt\x22:
return self__.eavt;

break;
case \x22aevt\x22:
return self__.aevt;

break;
case \x22avet\x22:
return self__.avet;

break;
case \x22max-eid\x22:
return self__.max_eid;

break;
case \x22max-tx\x22:
return self__.max_tx;

break;
case \x22rschema\x22:
return self__.rschema;

break;
case \x22pull-patterns\x22:
return self__.pull_patterns;

break;
case \x22pull-attrs\x22:
return self__.pull_attrs;

break;
case \x22hash\x22:
return self__.hash;

break;
default:
return cljs.core.get.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k51874,else__5346__auto__);

}
}));

(datascript.db.DB.prototype.cljs$core$IKVReduce$_kv_reduce$arity$3 \x3d (function (this__5363__auto__,f__5364__auto__,init__5365__auto__){
var self__ \x3d this;
var this__5363__auto____$1 \x3d this;
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (ret__5366__auto__,p__51879){
var vec__51880 \x3d p__51879;
var k__5367__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__51880,(0),null);
var v__5368__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__51880,(1),null);
return (f__5364__auto__.cljs$core$IFn$_invoke$arity$3 ? f__5364__auto__.cljs$core$IFn$_invoke$arity$3(ret__5366__auto__,k__5367__auto__,v__5368__auto__) : f__5364__auto__.call(null,ret__5366__auto__,k__5367__auto__,v__5368__auto__));
}),init__5365__auto__,this__5363__auto____$1);
}));

(datascript.db.DB.prototype.cljs$core$IPrintWithWriter$_pr_writer$arity$3 \x3d (function (this__5358__auto__,writer__5359__auto__,opts__5360__auto__){
var self__ \x3d this;
var this__5358__auto____$1 \x3d this;
var pr_pair__5361__auto__ \x3d (function (keyval__5362__auto__){
return cljs.core.pr_sequential_writer(writer__5359__auto__,cljs.core.pr_writer,\x22\x22,\x22 \x22,\x22\x22,opts__5360__auto__,keyval__5362__auto__);
});
return cljs.core.pr_sequential_writer(writer__5359__auto__,pr_pair__5361__auto__,\x22#datascript.db.DB{\x22,\x22, \x22,\x22}\x22,opts__5360__auto__,cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 10, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22schema\x22,\x22schema\x22,-1582001791),self__.schema],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22eavt\x22,\x22eavt\x22,-666437073),self__.eavt],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22aevt\x22,\x22aevt\x22,-585148059),self__.aevt],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22avet\x22,\x22avet\x22,1383857032),self__.avet],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22max-eid\x22,\x22max-eid\x22,2134868075),self__.max_eid],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22max-tx\x22,\x22max-tx\x22,1119558339),self__.max_tx],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22rschema\x22,\x22rschema\x22,-1196134054),self__.rschema],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22pull-patterns\x22,\x22pull-patterns\x22,-343695048),self__.pull_patterns],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22pull-attrs\x22,\x22pull-attrs\x22,-974863177),self__.pull_attrs],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22hash\x22,\x22hash\x22,-13781596),self__.hash],null))], null),self__.__extmap));
}));

(datascript.db.DB.prototype.cljs$core$IIterable$_iterator$arity$1 \x3d (function (G__51873){
var self__ \x3d this;
var G__51873__$1 \x3d this;
return (new cljs.core.RecordIter((0),G__51873__$1,10,new cljs.core.PersistentVector(null, 10, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22schema\x22,\x22schema\x22,-1582001791),new cljs.core.Keyword(null,\x22eavt\x22,\x22eavt\x22,-666437073),new cljs.core.Keyword(null,\x22aevt\x22,\x22aevt\x22,-585148059),new cljs.core.Keyword(null,\x22avet\x22,\x22avet\x22,1383857032),new cljs.core.Keyword(null,\x22max-eid\x22,\x22max-eid\x22,2134868075),new cljs.core.Keyword(null,\x22max-tx\x22,\x22max-tx\x22,1119558339),new cljs.core.Keyword(null,\x22rschema\x22,\x22rschema\x22,-1196134054),new cljs.core.Keyword(null,\x22pull-patterns\x22,\x22pull-patterns\x22,-343695048),new cljs.core.Keyword(null,\x22pull-attrs\x22,\x22pull-attrs\x22,-974863177),new cljs.core.Keyword(null,\x22hash\x22,\x22hash\x22,-13781596)], null),(cljs.core.truth_(self__.__extmap)?cljs.core._iterator(self__.__extmap):cljs.core.nil_iter())));
}));

(datascript.db.DB.prototype.cljs$core$IMeta$_meta$arity$1 \x3d (function (this__5341__auto__){
var self__ \x3d this;
var this__5341__auto____$1 \x3d this;
return self__.__meta;
}));

(datascript.db.DB.prototype.cljs$core$ICloneable$_clone$arity$1 \x3d (function (this__5338__auto__){
var self__ \x3d this;
var this__5338__auto____$1 \x3d this;
return (new datascript.db.DB(self__.schema,self__.eavt,self__.aevt,self__.avet,self__.max_eid,self__.max_tx,self__.rschema,self__.pull_patterns,self__.pull_attrs,self__.hash,self__.__meta,self__.__extmap,self__.__hash));
}));

(datascript.db.DB.prototype.cljs$core$ICounted$_count$arity$1 \x3d (function (this__5347__auto__){
var self__ \x3d this;
var this__5347__auto____$1 \x3d this;
return (10 + cljs.core.count(self__.__extmap));
}));

(datascript.db.DB.prototype.cljs$core$IHash$_hash$arity$1 \x3d (function (this__5339__auto__){
var self__ \x3d this;
var this__5339__auto____$1 \x3d this;
var h__5154__auto__ \x3d self__.__hash;
if((!((h__5154__auto__ \x3d\x3d null)))){
return h__5154__auto__;
} else {
var h__5154__auto____$1 \x3d (function (coll__5340__auto__){
return (-1515640948 ^ cljs.core.hash_unordered_coll(coll__5340__auto__));
})(this__5339__auto____$1);
(self__.__hash \x3d h__5154__auto____$1);

return h__5154__auto____$1;
}
}));

(datascript.db.DB.prototype.cljs$core$IEquiv$_equiv$arity$2 \x3d (function (this51875,other51876){
var self__ \x3d this;
var this51875__$1 \x3d this;
return (((!((other51876 \x3d\x3d null)))) \x26\x26 ((((this51875__$1.constructor \x3d\x3d\x3d other51876.constructor)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this51875__$1.schema,other51876.schema)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this51875__$1.eavt,other51876.eavt)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this51875__$1.aevt,other51876.aevt)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this51875__$1.avet,other51876.avet)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this51875__$1.max_eid,other51876.max_eid)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this51875__$1.max_tx,other51876.max_tx)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this51875__$1.rschema,other51876.rschema)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this51875__$1.pull_patterns,other51876.pull_patterns)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this51875__$1.pull_attrs,other51876.pull_attrs)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this51875__$1.hash,other51876.hash)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this51875__$1.__extmap,other51876.__extmap)))))))))))))))))))))))));
}));

(datascript.db.DB.prototype.cljs$core$IMap$_dissoc$arity$2 \x3d (function (this__5353__auto__,k__5354__auto__){
var self__ \x3d this;
var this__5353__auto____$1 \x3d this;
if(cljs.core.contains_QMARK_(new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 10, [new cljs.core.Keyword(null,\x22schema\x22,\x22schema\x22,-1582001791),null,new cljs.core.Keyword(null,\x22max-tx\x22,\x22max-tx\x22,1119558339),null,new cljs.core.Keyword(null,\x22hash\x22,\x22hash\x22,-13781596),null,new cljs.core.Keyword(null,\x22aevt\x22,\x22aevt\x22,-585148059),null,new cljs.core.Keyword(null,\x22avet\x22,\x22avet\x22,1383857032),null,new cljs.core.Keyword(null,\x22max-eid\x22,\x22max-eid\x22,2134868075),null,new cljs.core.Keyword(null,\x22eavt\x22,\x22eavt\x22,-666437073),null,new cljs.core.Keyword(null,\x22pull-attrs\x22,\x22pull-attrs\x22,-974863177),null,new cljs.core.Keyword(null,\x22pull-patterns\x22,\x22pull-patterns\x22,-343695048),null,new cljs.core.Keyword(null,\x22rschema\x22,\x22rschema\x22,-1196134054),null], null), null),k__5354__auto__)){
return cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(cljs.core._with_meta(cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,this__5353__auto____$1),self__.__meta),k__5354__auto__);
} else {
return (new datascript.db.DB(self__.schema,self__.eavt,self__.aevt,self__.avet,self__.max_eid,self__.max_tx,self__.rschema,self__.pull_patterns,self__.pull_attrs,self__.hash,self__.__meta,cljs.core.not_empty(cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(self__.__extmap,k__5354__auto__)),null));
}
}));

(datascript.db.DB.prototype.cljs$core$IAssociative$_contains_key_QMARK_$arity$2 \x3d (function (this__5350__auto__,k51874){
var self__ \x3d this;
var this__5350__auto____$1 \x3d this;
var G__51883 \x3d k51874;
var G__51883__$1 \x3d (((G__51883 instanceof cljs.core.Keyword))?G__51883.fqn:null);
switch (G__51883__$1) {
case \x22schema\x22:
case \x22eavt\x22:
case \x22aevt\x22:
case \x22avet\x22:
case \x22max-eid\x22:
case \x22max-tx\x22:
case \x22rschema\x22:
case \x22pull-patterns\x22:
case \x22pull-attrs\x22:
case \x22hash\x22:
return true;

break;
default:
return cljs.core.contains_QMARK_(self__.__extmap,k51874);

}
}));

(datascript.db.DB.prototype.cljs$core$IAssociative$_assoc$arity$3 \x3d (function (this__5351__auto__,k__5352__auto__,G__51873){
var self__ \x3d this;
var this__5351__auto____$1 \x3d this;
var pred__51884 \x3d cljs.core.keyword_identical_QMARK_;
var expr__51885 \x3d k__5352__auto__;
if(cljs.core.truth_((pred__51884.cljs$core$IFn$_invoke$arity$2 ? pred__51884.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22schema\x22,\x22schema\x22,-1582001791),expr__51885) : pred__51884.call(null,new cljs.core.Keyword(null,\x22schema\x22,\x22schema\x22,-1582001791),expr__51885)))){
return (new datascript.db.DB(G__51873,self__.eavt,self__.aevt,self__.avet,self__.max_eid,self__.max_tx,self__.rschema,self__.pull_patterns,self__.pull_attrs,self__.hash,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__51884.cljs$core$IFn$_invoke$arity$2 ? pred__51884.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22eavt\x22,\x22eavt\x22,-666437073),expr__51885) : pred__51884.call(null,new cljs.core.Keyword(null,\x22eavt\x22,\x22eavt\x22,-666437073),expr__51885)))){
return (new datascript.db.DB(self__.schema,G__51873,self__.aevt,self__.avet,self__.max_eid,self__.max_tx,self__.rschema,self__.pull_patterns,self__.pull_attrs,self__.hash,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__51884.cljs$core$IFn$_invoke$arity$2 ? pred__51884.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22aevt\x22,\x22aevt\x22,-585148059),expr__51885) : pred__51884.call(null,new cljs.core.Keyword(null,\x22aevt\x22,\x22aevt\x22,-585148059),expr__51885)))){
return (new datascript.db.DB(self__.schema,self__.eavt,G__51873,self__.avet,self__.max_eid,self__.max_tx,self__.rschema,self__.pull_patterns,self__.pull_attrs,self__.hash,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__51884.cljs$core$IFn$_invoke$arity$2 ? pred__51884.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22avet\x22,\x22avet\x22,1383857032),expr__51885) : pred__51884.call(null,new cljs.core.Keyword(null,\x22avet\x22,\x22avet\x22,1383857032),expr__51885)))){
return (new datascript.db.DB(self__.schema,self__.eavt,self__.aevt,G__51873,self__.max_eid,self__.max_tx,self__.rschema,self__.pull_patterns,self__.pull_attrs,self__.hash,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__51884.cljs$core$IFn$_invoke$arity$2 ? pred__51884.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22max-eid\x22,\x22max-eid\x22,2134868075),expr__51885) : pred__51884.call(null,new cljs.core.Keyword(null,\x22max-eid\x22,\x22max-eid\x22,2134868075),expr__51885)))){
return (new datascript.db.DB(self__.schema,self__.eavt,self__.aevt,self__.avet,G__51873,self__.max_tx,self__.rschema,self__.pull_patterns,self__.pull_attrs,self__.hash,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__51884.cljs$core$IFn$_invoke$arity$2 ? pred__51884.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22max-tx\x22,\x22max-tx\x22,1119558339),expr__51885) : pred__51884.call(null,new cljs.core.Keyword(null,\x22max-tx\x22,\x22max-tx\x22,1119558339),expr__51885)))){
return (new datascript.db.DB(self__.schema,self__.eavt,self__.aevt,self__.avet,self__.max_eid,G__51873,self__.rschema,self__.pull_patterns,self__.pull_attrs,self__.hash,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__51884.cljs$core$IFn$_invoke$arity$2 ? pred__51884.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22rschema\x22,\x22rschema\x22,-1196134054),expr__51885) : pred__51884.call(null,new cljs.core.Keyword(null,\x22rschema\x22,\x22rschema\x22,-1196134054),expr__51885)))){
return (new datascript.db.DB(self__.schema,self__.eavt,self__.aevt,self__.avet,self__.max_eid,self__.max_tx,G__51873,self__.pull_patterns,self__.pull_attrs,self__.hash,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__51884.cljs$core$IFn$_invoke$arity$2 ? pred__51884.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22pull-patterns\x22,\x22pull-patterns\x22,-343695048),expr__51885) : pred__51884.call(null,new cljs.core.Keyword(null,\x22pull-patterns\x22,\x22pull-patterns\x22,-343695048),expr__51885)))){
return (new datascript.db.DB(self__.schema,self__.eavt,self__.aevt,self__.avet,self__.max_eid,self__.max_tx,self__.rschema,G__51873,self__.pull_attrs,self__.hash,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__51884.cljs$core$IFn$_invoke$arity$2 ? pred__51884.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22pull-attrs\x22,\x22pull-attrs\x22,-974863177),expr__51885) : pred__51884.call(null,new cljs.core.Keyword(null,\x22pull-attrs\x22,\x22pull-attrs\x22,-974863177),expr__51885)))){
return (new datascript.db.DB(self__.schema,self__.eavt,self__.aevt,self__.avet,self__.max_eid,self__.max_tx,self__.rschema,self__.pull_patterns,G__51873,self__.hash,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__51884.cljs$core$IFn$_invoke$arity$2 ? pred__51884.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22hash\x22,\x22hash\x22,-13781596),expr__51885) : pred__51884.call(null,new cljs.core.Keyword(null,\x22hash\x22,\x22hash\x22,-13781596),expr__51885)))){
return (new datascript.db.DB(self__.schema,self__.eavt,self__.aevt,self__.avet,self__.max_eid,self__.max_tx,self__.rschema,self__.pull_patterns,self__.pull_attrs,G__51873,self__.__meta,self__.__extmap,null));
} else {
return (new datascript.db.DB(self__.schema,self__.eavt,self__.aevt,self__.avet,self__.max_eid,self__.max_tx,self__.rschema,self__.pull_patterns,self__.pull_attrs,self__.hash,self__.__meta,cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k__5352__auto__,G__51873),null));
}
}
}
}
}
}
}
}
}
}
}));

(datascript.db.DB.prototype.cljs$core$ISeqable$_seq$arity$1 \x3d (function (this__5356__auto__){
var self__ \x3d this;
var this__5356__auto____$1 \x3d this;
return cljs.core.seq(cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 10, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22schema\x22,\x22schema\x22,-1582001791),self__.schema,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22eavt\x22,\x22eavt\x22,-666437073),self__.eavt,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22aevt\x22,\x22aevt\x22,-585148059),self__.aevt,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22avet\x22,\x22avet\x22,1383857032),self__.avet,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22max-eid\x22,\x22max-eid\x22,2134868075),self__.max_eid,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22max-tx\x22,\x22max-tx\x22,1119558339),self__.max_tx,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22rschema\x22,\x22rschema\x22,-1196134054),self__.rschema,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22pull-patterns\x22,\x22pull-patterns\x22,-343695048),self__.pull_patterns,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22pull-attrs\x22,\x22pull-attrs\x22,-974863177),self__.pull_attrs,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22hash\x22,\x22hash\x22,-13781596),self__.hash,null))], null),self__.__extmap));
}));

(datascript.db.DB.prototype.cljs$core$IWithMeta$_with_meta$arity$2 \x3d (function (this__5342__auto__,G__51873){
var self__ \x3d this;
var this__5342__auto____$1 \x3d this;
return (new datascript.db.DB(self__.schema,self__.eavt,self__.aevt,self__.avet,self__.max_eid,self__.max_tx,self__.rschema,self__.pull_patterns,self__.pull_attrs,self__.hash,G__51873,self__.__extmap,self__.__hash));
}));

(datascript.db.DB.prototype.cljs$core$ICollection$_conj$arity$2 \x3d (function (this__5348__auto__,entry__5349__auto__){
var self__ \x3d this;
var this__5348__auto____$1 \x3d this;
if(cljs.core.vector_QMARK_(entry__5349__auto__)){
return this__5348__auto____$1.cljs$core$IAssociative$_assoc$arity$3(null,cljs.core._nth(entry__5349__auto__,(0)),cljs.core._nth(entry__5349__auto__,(1)));
} else {
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(cljs.core._conj,this__5348__auto____$1,entry__5349__auto__);
}
}));

(datascript.db.DB.getBasis \x3d (function (){
return new cljs.core.PersistentVector(null, 10, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22schema\x22,\x22schema\x22,58529736,null),new cljs.core.Symbol(null,\x22eavt\x22,\x22eavt\x22,974094454,null),new cljs.core.Symbol(null,\x22aevt\x22,\x22aevt\x22,1055383468,null),new cljs.core.Symbol(null,\x22avet\x22,\x22avet\x22,-1270578737,null),new cljs.core.Symbol(null,\x22max-eid\x22,\x22max-eid\x22,-519567694,null),new cljs.core.Symbol(null,\x22max-tx\x22,\x22max-tx\x22,-1534877430,null),new cljs.core.Symbol(null,\x22rschema\x22,\x22rschema\x22,444397473,null),new cljs.core.Symbol(null,\x22pull-patterns\x22,\x22pull-patterns\x22,1296836479,null),new cljs.core.Symbol(null,\x22pull-attrs\x22,\x22pull-attrs\x22,665668350,null),new cljs.core.Symbol(null,\x22hash\x22,\x22hash\x22,1626749931,null)], null);
}));

(datascript.db.DB.cljs$lang$type \x3d true);

(datascript.db.DB.cljs$lang$ctorPrSeq \x3d (function (this__5389__auto__){
return (new cljs.core.List(null,\x22datascript.db/DB\x22,null,(1),null));
}));

(datascript.db.DB.cljs$lang$ctorPrWriter \x3d (function (this__5389__auto__,writer__5390__auto__){
return cljs.core._write(writer__5390__auto__,\x22datascript.db/DB\x22);
}));

/**
 * Positional factory function for datascript.db/DB.
 */
datascript.db.__GT_DB \x3d (function datascript$db$__GT_DB(schema,eavt,aevt,avet,max_eid,max_tx,rschema,pull_patterns,pull_attrs,hash){
return (new datascript.db.DB(schema,eavt,aevt,avet,max_eid,max_tx,rschema,pull_patterns,pull_attrs,hash,null,null,null));
});

/**
 * Factory function for datascript.db/DB, taking a map of keywords to field values.
 */
datascript.db.map__GT_DB \x3d (function datascript$db$map__GT_DB(G__51877){
var extmap__5385__auto__ \x3d (function (){var G__51887 \x3d cljs.core.dissoc.cljs$core$IFn$_invoke$arity$variadic(G__51877,new cljs.core.Keyword(null,\x22schema\x22,\x22schema\x22,-1582001791),cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,\x22eavt\x22,\x22eavt\x22,-666437073),new cljs.core.Keyword(null,\x22aevt\x22,\x22aevt\x22,-585148059),new cljs.core.Keyword(null,\x22avet\x22,\x22avet\x22,1383857032),new cljs.core.Keyword(null,\x22max-eid\x22,\x22max-eid\x22,2134868075),new cljs.core.Keyword(null,\x22max-tx\x22,\x22max-tx\x22,1119558339),new cljs.core.Keyword(null,\x22rschema\x22,\x22rschema\x22,-1196134054),new cljs.core.Keyword(null,\x22pull-patterns\x22,\x22pull-patterns\x22,-343695048),new cljs.core.Keyword(null,\x22pull-attrs\x22,\x22pull-attrs\x22,-974863177),new cljs.core.Keyword(null,\x22hash\x22,\x22hash\x22,-13781596)], 0));
if(cljs.core.record_QMARK_(G__51877)){
return cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,G__51887);
} else {
return G__51887;
}
})();
return (new datascript.db.DB(new cljs.core.Keyword(null,\x22schema\x22,\x22schema\x22,-1582001791).cljs$core$IFn$_invoke$arity$1(G__51877),new cljs.core.Keyword(null,\x22eavt\x22,\x22eavt\x22,-666437073).cljs$core$IFn$_invoke$arity$1(G__51877),new cljs.core.Keyword(null,\x22aevt\x22,\x22aevt\x22,-585148059).cljs$core$IFn$_invoke$arity$1(G__51877),new cljs.core.Keyword(null,\x22avet\x22,\x22avet\x22,1383857032).cljs$core$IFn$_invoke$arity$1(G__51877),new cljs.core.Keyword(null,\x22max-eid\x22,\x22max-eid\x22,2134868075).cljs$core$IFn$_invoke$arity$1(G__51877),new cljs.core.Keyword(null,\x22max-tx\x22,\x22max-tx\x22,1119558339).cljs$core$IFn$_invoke$arity$1(G__51877),new cljs.core.Keyword(null,\x22rschema\x22,\x22rschema\x22,-1196134054).cljs$core$IFn$_invoke$arity$1(G__51877),new cljs.core.Keyword(null,\x22pull-patterns\x22,\x22pull-patterns\x22,-343695048).cljs$core$IFn$_invoke$arity$1(G__51877),new cljs.core.Keyword(null,\x22pull-attrs\x22,\x22pull-attrs\x22,-974863177).cljs$core$IFn$_invoke$arity$1(G__51877),new cljs.core.Keyword(null,\x22hash\x22,\x22hash\x22,-13781596).cljs$core$IFn$_invoke$arity$1(G__51877),null,cljs.core.not_empty(extmap__5385__auto__),null));
});


(datascript.db.DB.prototype.clojure$data$Diff$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.db.DB.prototype.clojure$data$Diff$diff_similar$arity$2 \x3d (function (a,b){
var a__$1 \x3d this;
return datascript.db.diff_sorted(a__$1.eavt,new cljs.core.Keyword(null,\x22eavt\x22,\x22eavt\x22,-666437073).cljs$core$IFn$_invoke$arity$1(b),datascript.db.cmp_datoms_eav_quick);
}));

(datascript.db.DB.prototype.cljs$core$IPrintWithWriter$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.db.DB.prototype.cljs$core$IPrintWithWriter$_pr_writer$arity$3 \x3d (function (db,w,opts){
var db__$1 \x3d this;
return (datascript.db.pr_db.cljs$core$IFn$_invoke$arity$3 ? datascript.db.pr_db.cljs$core$IFn$_invoke$arity$3(db__$1,w,opts) : datascript.db.pr_db.call(null,db__$1,w,opts));
}));

(datascript.db.DB.prototype.cljs$core$ICounted$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.db.DB.prototype.cljs$core$ICounted$_count$arity$1 \x3d (function (db){
var db__$1 \x3d this;
return cljs.core.count(db__$1.eavt);
}));

(datascript.db.DB.prototype.cljs$core$IReversible$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.db.DB.prototype.cljs$core$IReversible$_rseq$arity$1 \x3d (function (db){
var db__$1 \x3d this;
return cljs.core._rseq(db__$1.eavt);
}));

(datascript.db.DB.prototype.cljs$core$IHash$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.db.DB.prototype.cljs$core$IHash$_hash$arity$1 \x3d (function (db){
var db__$1 \x3d this;
return (datascript.db.hash_db.cljs$core$IFn$_invoke$arity$1 ? datascript.db.hash_db.cljs$core$IFn$_invoke$arity$1(db__$1) : datascript.db.hash_db.call(null,db__$1));
}));

(datascript.db.DB.prototype.cljs$core$IEquiv$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.db.DB.prototype.cljs$core$IEquiv$_equiv$arity$2 \x3d (function (db,other){
var db__$1 \x3d this;
return (datascript.db.equiv_db.cljs$core$IFn$_invoke$arity$2 ? datascript.db.equiv_db.cljs$core$IFn$_invoke$arity$2(db__$1,other) : datascript.db.equiv_db.call(null,db__$1,other));
}));

(datascript.db.DB.prototype.cljs$core$IEditableCollection$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.db.DB.prototype.cljs$core$IEditableCollection$_as_transient$arity$1 \x3d (function (db){
var db__$1 \x3d this;
return datascript.db.db_transient(db__$1);
}));

(datascript.db.DB.prototype.cljs$core$IEmptyableCollection$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.db.DB.prototype.cljs$core$IEmptyableCollection$_empty$arity$1 \x3d (function (db){
var db__$1 \x3d this;
return cljs.core.with_meta((function (){var G__51888 \x3d db__$1.schema;
return (datascript.db.empty_db.cljs$core$IFn$_invoke$arity$1 ? datascript.db.empty_db.cljs$core$IFn$_invoke$arity$1(G__51888) : datascript.db.empty_db.call(null,G__51888));
})(),cljs.core.meta(db__$1));
}));

(datascript.db.DB.prototype.cljs$core$ITransientCollection$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.db.DB.prototype.cljs$core$ITransientCollection$_conj_BANG_$arity$2 \x3d (function (db,key){
var db__$1 \x3d this;
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2(\x22datascript.DB/conj! is not supported\x22,cljs.core.PersistentArrayMap.EMPTY);
}));

(datascript.db.DB.prototype.cljs$core$ITransientCollection$_persistent_BANG_$arity$1 \x3d (function (db){
var db__$1 \x3d this;
return datascript.db.db_persistent_BANG_(db__$1);
}));

(datascript.db.DB.prototype.clojure$data$EqualityPartition$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.db.DB.prototype.clojure$data$EqualityPartition$equality_partition$arity$1 \x3d (function (x){
var x__$1 \x3d this;
return new cljs.core.Keyword(\x22datascript\x22,\x22db\x22,\x22datascript/db\x22,-1190971692);
}));

(datascript.db.DB.prototype.datascript$db$IIndexAccess$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.db.DB.prototype.datascript$db$IIndexAccess$_datoms$arity$3 \x3d (function (db,index,cs){
var db__$1 \x3d this;
datascript.db.validate_indexed(db__$1,index,cs);

return me.tonsky.persistent_sorted_set.slice.cljs$core$IFn$_invoke$arity$3(cljs.core.get.cljs$core$IFn$_invoke$arity$2(db__$1,index),(datascript.db.components__GT_pattern.cljs$core$IFn$_invoke$arity$5 ? datascript.db.components__GT_pattern.cljs$core$IFn$_invoke$arity$5(db__$1,index,cs,(0),(536870912)) : datascript.db.components__GT_pattern.call(null,db__$1,index,cs,(0),(536870912))),(datascript.db.components__GT_pattern.cljs$core$IFn$_invoke$arity$5 ? datascript.db.components__GT_pattern.cljs$core$IFn$_invoke$arity$5(db__$1,index,cs,(2147483647),(2147483647)) : datascript.db.components__GT_pattern.call(null,db__$1,index,cs,(2147483647),(2147483647))));
}));

(datascript.db.DB.prototype.datascript$db$IIndexAccess$_seek_datoms$arity$3 \x3d (function (db,index,cs){
var db__$1 \x3d this;
datascript.db.validate_indexed(db__$1,index,cs);

return me.tonsky.persistent_sorted_set.slice.cljs$core$IFn$_invoke$arity$3(cljs.core.get.cljs$core$IFn$_invoke$arity$2(db__$1,index),(datascript.db.components__GT_pattern.cljs$core$IFn$_invoke$arity$5 ? datascript.db.components__GT_pattern.cljs$core$IFn$_invoke$arity$5(db__$1,index,cs,(0),(536870912)) : datascript.db.components__GT_pattern.call(null,db__$1,index,cs,(0),(536870912))),datascript.db.datom.cljs$core$IFn$_invoke$arity$4((2147483647),null,null,(2147483647)));
}));

(datascript.db.DB.prototype.datascript$db$IIndexAccess$_rseek_datoms$arity$3 \x3d (function (db,index,cs){
var db__$1 \x3d this;
datascript.db.validate_indexed(db__$1,index,cs);

return me.tonsky.persistent_sorted_set.rslice.cljs$core$IFn$_invoke$arity$3(cljs.core.get.cljs$core$IFn$_invoke$arity$2(db__$1,index),(datascript.db.components__GT_pattern.cljs$core$IFn$_invoke$arity$5 ? datascript.db.components__GT_pattern.cljs$core$IFn$_invoke$arity$5(db__$1,index,cs,(2147483647),(2147483647)) : datascript.db.components__GT_pattern.call(null,db__$1,index,cs,(2147483647),(2147483647))),datascript.db.datom.cljs$core$IFn$_invoke$arity$4((0),null,null,(536870912)));
}));

(datascript.db.DB.prototype.datascript$db$IIndexAccess$_index_range$arity$4 \x3d (function (db,attr,start,end){
var db__$1 \x3d this;
datascript.db.validate_indexed(db__$1,new cljs.core.Keyword(null,\x22avet\x22,\x22avet\x22,1383857032),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [attr], null));

var G__51889_52315 \x3d attr;
var G__51890_52316 \x3d (new cljs.core.List(null,new cljs.core.Symbol(null,\x22-index-range\x22,\x22-index-range\x22,898114142,null),(new cljs.core.List(null,new cljs.core.Symbol(null,\x22db\x22,\x22db\x22,-1661185010,null),(new cljs.core.List(null,attr,(new cljs.core.List(null,start,(new cljs.core.List(null,end,null,(1),null)),(2),null)),(3),null)),(4),null)),(5),null));
(datascript.db.validate_attr.cljs$core$IFn$_invoke$arity$2 ? datascript.db.validate_attr.cljs$core$IFn$_invoke$arity$2(G__51889_52315,G__51890_52316) : datascript.db.validate_attr.call(null,G__51889_52315,G__51890_52316));

return me.tonsky.persistent_sorted_set.slice.cljs$core$IFn$_invoke$arity$3(db__$1.avet,(datascript.db.resolve_datom.cljs$core$IFn$_invoke$arity$7 ? datascript.db.resolve_datom.cljs$core$IFn$_invoke$arity$7(db__$1,null,attr,start,null,(0),(536870912)) : datascript.db.resolve_datom.call(null,db__$1,null,attr,start,null,(0),(536870912))),(datascript.db.resolve_datom.cljs$core$IFn$_invoke$arity$7 ? datascript.db.resolve_datom.cljs$core$IFn$_invoke$arity$7(db__$1,null,attr,end,null,(2147483647),(2147483647)) : datascript.db.resolve_datom.call(null,db__$1,null,attr,end,null,(2147483647),(2147483647))));
}));

(datascript.db.DB.prototype.datascript$db$IDB$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.db.DB.prototype.datascript$db$IDB$_schema$arity$1 \x3d (function (db){
var db__$1 \x3d this;
return db__$1.schema;
}));

(datascript.db.DB.prototype.datascript$db$IDB$_attrs_by$arity$2 \x3d (function (db,property){
var db__$1 \x3d this;
var fexpr__51891 \x3d db__$1.rschema;
return (fexpr__51891.cljs$core$IFn$_invoke$arity$1 ? fexpr__51891.cljs$core$IFn$_invoke$arity$1(property) : fexpr__51891.call(null,property));
}));

(datascript.db.DB.prototype.datascript$db$ISearch$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.db.DB.prototype.datascript$db$ISearch$_search$arity$2 \x3d (function (db,pattern){
var db__$1 \x3d this;
var vec__51892 \x3d pattern;
var e \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__51892,(0),null);
var a \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__51892,(1),null);
var v \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__51892,(2),null);
var tx \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__51892,(3),null);
var eavt \x3d db__$1.eavt;
var aevt \x3d db__$1.aevt;
var avet \x3d db__$1.avet;
var multival_QMARK_ \x3d cljs.core.contains_QMARK_(datascript.db._attrs_by(db__$1,new cljs.core.Keyword(\x22db.cardinality\x22,\x22many\x22,\x22db.cardinality/many\x22,772806234)),a);
if(cljs.core.truth_(e)){
if(cljs.core.truth_(a)){
if((!((v \x3d\x3d null)))){
if(cljs.core.truth_(tx)){
return me.tonsky.persistent_sorted_set.slice.cljs$core$IFn$_invoke$arity$3(eavt,datascript.db.datom.cljs$core$IFn$_invoke$arity$4(e,a,v,tx),datascript.db.datom.cljs$core$IFn$_invoke$arity$4(e,a,v,tx));
} else {
return me.tonsky.persistent_sorted_set.slice.cljs$core$IFn$_invoke$arity$3(eavt,datascript.db.datom.cljs$core$IFn$_invoke$arity$4(e,a,v,(536870912)),datascript.db.datom.cljs$core$IFn$_invoke$arity$4(e,a,v,(2147483647)));
}
} else {
if(cljs.core.truth_(tx)){
return cljs.core.filter.cljs$core$IFn$_invoke$arity$2((function (d){
return cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(tx,d.datascript$db$IDatom$datom_tx$arity$1(null));
}),me.tonsky.persistent_sorted_set.slice.cljs$core$IFn$_invoke$arity$3(eavt,datascript.db.datom.cljs$core$IFn$_invoke$arity$4(e,a,null,(536870912)),datascript.db.datom.cljs$core$IFn$_invoke$arity$4(e,a,null,(2147483647))));
} else {
return me.tonsky.persistent_sorted_set.slice.cljs$core$IFn$_invoke$arity$3(eavt,datascript.db.datom.cljs$core$IFn$_invoke$arity$4(e,a,null,(536870912)),datascript.db.datom.cljs$core$IFn$_invoke$arity$4(e,a,null,(2147483647)));
}
}
} else {
if((!((v \x3d\x3d null)))){
if(cljs.core.truth_(tx)){
return cljs.core.filter.cljs$core$IFn$_invoke$arity$2((function (d){
return ((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(v,d.v)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(tx,d.datascript$db$IDatom$datom_tx$arity$1(null))));
}),me.tonsky.persistent_sorted_set.slice.cljs$core$IFn$_invoke$arity$3(eavt,datascript.db.datom.cljs$core$IFn$_invoke$arity$4(e,null,null,(536870912)),datascript.db.datom.cljs$core$IFn$_invoke$arity$4(e,null,null,(2147483647))));
} else {
return cljs.core.filter.cljs$core$IFn$_invoke$arity$2((function (d){
return cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(v,d.v);
}),me.tonsky.persistent_sorted_set.slice.cljs$core$IFn$_invoke$arity$3(eavt,datascript.db.datom.cljs$core$IFn$_invoke$arity$4(e,null,null,(536870912)),datascript.db.datom.cljs$core$IFn$_invoke$arity$4(e,null,null,(2147483647))));
}
} else {
if(cljs.core.truth_(tx)){
return cljs.core.filter.cljs$core$IFn$_invoke$arity$2((function (d){
return cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(tx,d.datascript$db$IDatom$datom_tx$arity$1(null));
}),me.tonsky.persistent_sorted_set.slice.cljs$core$IFn$_invoke$arity$3(eavt,datascript.db.datom.cljs$core$IFn$_invoke$arity$4(e,null,null,(536870912)),datascript.db.datom.cljs$core$IFn$_invoke$arity$4(e,null,null,(2147483647))));
} else {
return me.tonsky.persistent_sorted_set.slice.cljs$core$IFn$_invoke$arity$3(eavt,datascript.db.datom.cljs$core$IFn$_invoke$arity$4(e,null,null,(536870912)),datascript.db.datom.cljs$core$IFn$_invoke$arity$4(e,null,null,(2147483647)));
}
}
}
} else {
if(cljs.core.truth_(a)){
if((!((v \x3d\x3d null)))){
if(cljs.core.truth_(tx)){
if(cljs.core.truth_((datascript.db.indexing_QMARK_.cljs$core$IFn$_invoke$arity$2 ? datascript.db.indexing_QMARK_.cljs$core$IFn$_invoke$arity$2(db__$1,a) : datascript.db.indexing_QMARK_.call(null,db__$1,a)))){
return cljs.core.filter.cljs$core$IFn$_invoke$arity$2((function (d){
return cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(tx,d.datascript$db$IDatom$datom_tx$arity$1(null));
}),me.tonsky.persistent_sorted_set.slice.cljs$core$IFn$_invoke$arity$3(avet,datascript.db.datom.cljs$core$IFn$_invoke$arity$4((0),a,v,(536870912)),datascript.db.datom.cljs$core$IFn$_invoke$arity$4((2147483647),a,v,(2147483647))));
} else {
return cljs.core.filter.cljs$core$IFn$_invoke$arity$2((function (d){
return ((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(v,d.v)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(tx,d.datascript$db$IDatom$datom_tx$arity$1(null))));
}),me.tonsky.persistent_sorted_set.slice.cljs$core$IFn$_invoke$arity$3(aevt,datascript.db.datom.cljs$core$IFn$_invoke$arity$4((0),a,null,(536870912)),datascript.db.datom.cljs$core$IFn$_invoke$arity$4((2147483647),a,null,(2147483647))));
}
} else {
if(cljs.core.truth_((datascript.db.indexing_QMARK_.cljs$core$IFn$_invoke$arity$2 ? datascript.db.indexing_QMARK_.cljs$core$IFn$_invoke$arity$2(db__$1,a) : datascript.db.indexing_QMARK_.call(null,db__$1,a)))){
return me.tonsky.persistent_sorted_set.slice.cljs$core$IFn$_invoke$arity$3(avet,datascript.db.datom.cljs$core$IFn$_invoke$arity$4((0),a,v,(536870912)),datascript.db.datom.cljs$core$IFn$_invoke$arity$4((2147483647),a,v,(2147483647)));
} else {
return cljs.core.filter.cljs$core$IFn$_invoke$arity$2((function (d){
return cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(v,d.v);
}),me.tonsky.persistent_sorted_set.slice.cljs$core$IFn$_invoke$arity$3(aevt,datascript.db.datom.cljs$core$IFn$_invoke$arity$4((0),a,null,(536870912)),datascript.db.datom.cljs$core$IFn$_invoke$arity$4((2147483647),a,null,(2147483647))));
}
}
} else {
if(cljs.core.truth_(tx)){
return cljs.core.filter.cljs$core$IFn$_invoke$arity$2((function (d){
return cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(tx,d.datascript$db$IDatom$datom_tx$arity$1(null));
}),me.tonsky.persistent_sorted_set.slice.cljs$core$IFn$_invoke$arity$3(aevt,datascript.db.datom.cljs$core$IFn$_invoke$arity$4((0),a,null,(536870912)),datascript.db.datom.cljs$core$IFn$_invoke$arity$4((2147483647),a,null,(2147483647))));
} else {
return me.tonsky.persistent_sorted_set.slice.cljs$core$IFn$_invoke$arity$3(aevt,datascript.db.datom.cljs$core$IFn$_invoke$arity$4((0),a,null,(536870912)),datascript.db.datom.cljs$core$IFn$_invoke$arity$4((2147483647),a,null,(2147483647)));
}
}
} else {
if((!((v \x3d\x3d null)))){
if(cljs.core.truth_(tx)){
return cljs.core.filter.cljs$core$IFn$_invoke$arity$2((function (d){
return ((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(v,d.v)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(tx,d.datascript$db$IDatom$datom_tx$arity$1(null))));
}),eavt);
} else {
return cljs.core.filter.cljs$core$IFn$_invoke$arity$2((function (d){
return cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(v,d.v);
}),eavt);
}
} else {
if(cljs.core.truth_(tx)){
return cljs.core.filter.cljs$core$IFn$_invoke$arity$2((function (d){
return cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(tx,d.datascript$db$IDatom$datom_tx$arity$1(null));
}),eavt);
} else {
return eavt;
}
}
}
}
}));
datascript.db.db_QMARK_ \x3d (function datascript$db$db_QMARK_(x){
var and__5043__auto__ \x3d (((!((x \x3d\x3d null))))?((((false) || ((cljs.core.PROTOCOL_SENTINEL \x3d\x3d\x3d x.datascript$db$ISearch$))))?true:(((!x.cljs$lang$protocol_mask$partition$))?cljs.core.native_satisfies_QMARK_(datascript.db.ISearch,x):false)):cljs.core.native_satisfies_QMARK_(datascript.db.ISearch,x));
if(and__5043__auto__){
var and__5043__auto____$1 \x3d (((!((x \x3d\x3d null))))?((((false) || ((cljs.core.PROTOCOL_SENTINEL \x3d\x3d\x3d x.datascript$db$IIndexAccess$))))?true:(((!x.cljs$lang$protocol_mask$partition$))?cljs.core.native_satisfies_QMARK_(datascript.db.IIndexAccess,x):false)):cljs.core.native_satisfies_QMARK_(datascript.db.IIndexAccess,x));
if(and__5043__auto____$1){
if((!((x \x3d\x3d null)))){
if(((false) || ((cljs.core.PROTOCOL_SENTINEL \x3d\x3d\x3d x.datascript$db$IDB$)))){
return true;
} else {
if((!x.cljs$lang$protocol_mask$partition$)){
return cljs.core.native_satisfies_QMARK_(datascript.db.IDB,x);
} else {
return false;
}
}
} else {
return cljs.core.native_satisfies_QMARK_(datascript.db.IDB,x);
}
} else {
return and__5043__auto____$1;
}
} else {
return and__5043__auto__;
}
});

/**
* @constructor
 * @implements {cljs.core.IRecord}
 * @implements {cljs.core.IKVReduce}
 * @implements {cljs.core.IEquiv}
 * @implements {cljs.core.IHash}
 * @implements {cljs.core.ICollection}
 * @implements {cljs.core.ICounted}
 * @implements {cljs.core.ISeqable}
 * @implements {cljs.core.IMeta}
 * @implements {cljs.core.ICloneable}
 * @implements {cljs.core.IPrintWithWriter}
 * @implements {cljs.core.IIterable}
 * @implements {cljs.core.IWithMeta}
 * @implements {cljs.core.IAssociative}
 * @implements {cljs.core.IMap}
 * @implements {cljs.core.ILookup}
*/
datascript.db.FilteredDB \x3d (function (unfiltered_db,pred,hash,__meta,__extmap,__hash){
this.unfiltered_db \x3d unfiltered_db;
this.pred \x3d pred;
this.hash \x3d hash;
this.__meta \x3d __meta;
this.__extmap \x3d __extmap;
this.__hash \x3d __hash;
this.cljs$lang$protocol_mask$partition0$ \x3d 2230716170;
this.cljs$lang$protocol_mask$partition1$ \x3d 139264;
});
(datascript.db.FilteredDB.prototype.cljs$core$ILookup$_lookup$arity$2 \x3d (function (this__5343__auto__,k__5344__auto__){
var self__ \x3d this;
var this__5343__auto____$1 \x3d this;
return this__5343__auto____$1.cljs$core$ILookup$_lookup$arity$3(null,k__5344__auto__,null);
}));

(datascript.db.FilteredDB.prototype.cljs$core$ILookup$_lookup$arity$3 \x3d (function (this__5345__auto__,k51902,else__5346__auto__){
var self__ \x3d this;
var this__5345__auto____$1 \x3d this;
var G__51906 \x3d k51902;
var G__51906__$1 \x3d (((G__51906 instanceof cljs.core.Keyword))?G__51906.fqn:null);
switch (G__51906__$1) {
case \x22unfiltered-db\x22:
return self__.unfiltered_db;

break;
case \x22pred\x22:
return self__.pred;

break;
case \x22hash\x22:
return self__.hash;

break;
default:
return cljs.core.get.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k51902,else__5346__auto__);

}
}));

(datascript.db.FilteredDB.prototype.cljs$core$IKVReduce$_kv_reduce$arity$3 \x3d (function (this__5363__auto__,f__5364__auto__,init__5365__auto__){
var self__ \x3d this;
var this__5363__auto____$1 \x3d this;
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (ret__5366__auto__,p__51907){
var vec__51908 \x3d p__51907;
var k__5367__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__51908,(0),null);
var v__5368__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__51908,(1),null);
return (f__5364__auto__.cljs$core$IFn$_invoke$arity$3 ? f__5364__auto__.cljs$core$IFn$_invoke$arity$3(ret__5366__auto__,k__5367__auto__,v__5368__auto__) : f__5364__auto__.call(null,ret__5366__auto__,k__5367__auto__,v__5368__auto__));
}),init__5365__auto__,this__5363__auto____$1);
}));

(datascript.db.FilteredDB.prototype.cljs$core$IPrintWithWriter$_pr_writer$arity$3 \x3d (function (this__5358__auto__,writer__5359__auto__,opts__5360__auto__){
var self__ \x3d this;
var this__5358__auto____$1 \x3d this;
var pr_pair__5361__auto__ \x3d (function (keyval__5362__auto__){
return cljs.core.pr_sequential_writer(writer__5359__auto__,cljs.core.pr_writer,\x22\x22,\x22 \x22,\x22\x22,opts__5360__auto__,keyval__5362__auto__);
});
return cljs.core.pr_sequential_writer(writer__5359__auto__,pr_pair__5361__auto__,\x22#datascript.db.FilteredDB{\x22,\x22, \x22,\x22}\x22,opts__5360__auto__,cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22unfiltered-db\x22,\x22unfiltered-db\x22,-1363720391),self__.unfiltered_db],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22pred\x22,\x22pred\x22,1927423397),self__.pred],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22hash\x22,\x22hash\x22,-13781596),self__.hash],null))], null),self__.__extmap));
}));

(datascript.db.FilteredDB.prototype.cljs$core$IIterable$_iterator$arity$1 \x3d (function (G__51901){
var self__ \x3d this;
var G__51901__$1 \x3d this;
return (new cljs.core.RecordIter((0),G__51901__$1,3,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22unfiltered-db\x22,\x22unfiltered-db\x22,-1363720391),new cljs.core.Keyword(null,\x22pred\x22,\x22pred\x22,1927423397),new cljs.core.Keyword(null,\x22hash\x22,\x22hash\x22,-13781596)], null),(cljs.core.truth_(self__.__extmap)?cljs.core._iterator(self__.__extmap):cljs.core.nil_iter())));
}));

(datascript.db.FilteredDB.prototype.cljs$core$IMeta$_meta$arity$1 \x3d (function (this__5341__auto__){
var self__ \x3d this;
var this__5341__auto____$1 \x3d this;
return self__.__meta;
}));

(datascript.db.FilteredDB.prototype.cljs$core$ICloneable$_clone$arity$1 \x3d (function (this__5338__auto__){
var self__ \x3d this;
var this__5338__auto____$1 \x3d this;
return (new datascript.db.FilteredDB(self__.unfiltered_db,self__.pred,self__.hash,self__.__meta,self__.__extmap,self__.__hash));
}));

(datascript.db.FilteredDB.prototype.cljs$core$ICounted$_count$arity$1 \x3d (function (this__5347__auto__){
var self__ \x3d this;
var this__5347__auto____$1 \x3d this;
return (3 + cljs.core.count(self__.__extmap));
}));

(datascript.db.FilteredDB.prototype.cljs$core$IHash$_hash$arity$1 \x3d (function (this__5339__auto__){
var self__ \x3d this;
var this__5339__auto____$1 \x3d this;
var h__5154__auto__ \x3d self__.__hash;
if((!((h__5154__auto__ \x3d\x3d null)))){
return h__5154__auto__;
} else {
var h__5154__auto____$1 \x3d (function (coll__5340__auto__){
return (-351969977 ^ cljs.core.hash_unordered_coll(coll__5340__auto__));
})(this__5339__auto____$1);
(self__.__hash \x3d h__5154__auto____$1);

return h__5154__auto____$1;
}
}));

(datascript.db.FilteredDB.prototype.cljs$core$IEquiv$_equiv$arity$2 \x3d (function (this51903,other51904){
var self__ \x3d this;
var this51903__$1 \x3d this;
return (((!((other51904 \x3d\x3d null)))) \x26\x26 ((((this51903__$1.constructor \x3d\x3d\x3d other51904.constructor)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this51903__$1.unfiltered_db,other51904.unfiltered_db)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this51903__$1.pred,other51904.pred)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this51903__$1.hash,other51904.hash)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this51903__$1.__extmap,other51904.__extmap)))))))))));
}));

(datascript.db.FilteredDB.prototype.cljs$core$IMap$_dissoc$arity$2 \x3d (function (this__5353__auto__,k__5354__auto__){
var self__ \x3d this;
var this__5353__auto____$1 \x3d this;
if(cljs.core.contains_QMARK_(new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,\x22hash\x22,\x22hash\x22,-13781596),null,new cljs.core.Keyword(null,\x22pred\x22,\x22pred\x22,1927423397),null,new cljs.core.Keyword(null,\x22unfiltered-db\x22,\x22unfiltered-db\x22,-1363720391),null], null), null),k__5354__auto__)){
return cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(cljs.core._with_meta(cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,this__5353__auto____$1),self__.__meta),k__5354__auto__);
} else {
return (new datascript.db.FilteredDB(self__.unfiltered_db,self__.pred,self__.hash,self__.__meta,cljs.core.not_empty(cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(self__.__extmap,k__5354__auto__)),null));
}
}));

(datascript.db.FilteredDB.prototype.cljs$core$IAssociative$_contains_key_QMARK_$arity$2 \x3d (function (this__5350__auto__,k51902){
var self__ \x3d this;
var this__5350__auto____$1 \x3d this;
var G__51911 \x3d k51902;
var G__51911__$1 \x3d (((G__51911 instanceof cljs.core.Keyword))?G__51911.fqn:null);
switch (G__51911__$1) {
case \x22unfiltered-db\x22:
case \x22pred\x22:
case \x22hash\x22:
return true;

break;
default:
return cljs.core.contains_QMARK_(self__.__extmap,k51902);

}
}));

(datascript.db.FilteredDB.prototype.cljs$core$IAssociative$_assoc$arity$3 \x3d (function (this__5351__auto__,k__5352__auto__,G__51901){
var self__ \x3d this;
var this__5351__auto____$1 \x3d this;
var pred__51912 \x3d cljs.core.keyword_identical_QMARK_;
var expr__51913 \x3d k__5352__auto__;
if(cljs.core.truth_((pred__51912.cljs$core$IFn$_invoke$arity$2 ? pred__51912.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22unfiltered-db\x22,\x22unfiltered-db\x22,-1363720391),expr__51913) : pred__51912.call(null,new cljs.core.Keyword(null,\x22unfiltered-db\x22,\x22unfiltered-db\x22,-1363720391),expr__51913)))){
return (new datascript.db.FilteredDB(G__51901,self__.pred,self__.hash,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__51912.cljs$core$IFn$_invoke$arity$2 ? pred__51912.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22pred\x22,\x22pred\x22,1927423397),expr__51913) : pred__51912.call(null,new cljs.core.Keyword(null,\x22pred\x22,\x22pred\x22,1927423397),expr__51913)))){
return (new datascript.db.FilteredDB(self__.unfiltered_db,G__51901,self__.hash,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__51912.cljs$core$IFn$_invoke$arity$2 ? pred__51912.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22hash\x22,\x22hash\x22,-13781596),expr__51913) : pred__51912.call(null,new cljs.core.Keyword(null,\x22hash\x22,\x22hash\x22,-13781596),expr__51913)))){
return (new datascript.db.FilteredDB(self__.unfiltered_db,self__.pred,G__51901,self__.__meta,self__.__extmap,null));
} else {
return (new datascript.db.FilteredDB(self__.unfiltered_db,self__.pred,self__.hash,self__.__meta,cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k__5352__auto__,G__51901),null));
}
}
}
}));

(datascript.db.FilteredDB.prototype.cljs$core$ISeqable$_seq$arity$1 \x3d (function (this__5356__auto__){
var self__ \x3d this;
var this__5356__auto____$1 \x3d this;
return cljs.core.seq(cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22unfiltered-db\x22,\x22unfiltered-db\x22,-1363720391),self__.unfiltered_db,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22pred\x22,\x22pred\x22,1927423397),self__.pred,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22hash\x22,\x22hash\x22,-13781596),self__.hash,null))], null),self__.__extmap));
}));

(datascript.db.FilteredDB.prototype.cljs$core$IWithMeta$_with_meta$arity$2 \x3d (function (this__5342__auto__,G__51901){
var self__ \x3d this;
var this__5342__auto____$1 \x3d this;
return (new datascript.db.FilteredDB(self__.unfiltered_db,self__.pred,self__.hash,G__51901,self__.__extmap,self__.__hash));
}));

(datascript.db.FilteredDB.prototype.cljs$core$ICollection$_conj$arity$2 \x3d (function (this__5348__auto__,entry__5349__auto__){
var self__ \x3d this;
var this__5348__auto____$1 \x3d this;
if(cljs.core.vector_QMARK_(entry__5349__auto__)){
return this__5348__auto____$1.cljs$core$IAssociative$_assoc$arity$3(null,cljs.core._nth(entry__5349__auto__,(0)),cljs.core._nth(entry__5349__auto__,(1)));
} else {
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(cljs.core._conj,this__5348__auto____$1,entry__5349__auto__);
}
}));

(datascript.db.FilteredDB.getBasis \x3d (function (){
return new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22unfiltered-db\x22,\x22unfiltered-db\x22,276811136,null),new cljs.core.Symbol(null,\x22pred\x22,\x22pred\x22,-727012372,null),new cljs.core.Symbol(null,\x22hash\x22,\x22hash\x22,1626749931,null)], null);
}));

(datascript.db.FilteredDB.cljs$lang$type \x3d true);

(datascript.db.FilteredDB.cljs$lang$ctorPrSeq \x3d (function (this__5389__auto__){
return (new cljs.core.List(null,\x22datascript.db/FilteredDB\x22,null,(1),null));
}));

(datascript.db.FilteredDB.cljs$lang$ctorPrWriter \x3d (function (this__5389__auto__,writer__5390__auto__){
return cljs.core._write(writer__5390__auto__,\x22datascript.db/FilteredDB\x22);
}));

/**
 * Positional factory function for datascript.db/FilteredDB.
 */
datascript.db.__GT_FilteredDB \x3d (function datascript$db$__GT_FilteredDB(unfiltered_db,pred,hash){
return (new datascript.db.FilteredDB(unfiltered_db,pred,hash,null,null,null));
});

/**
 * Factory function for datascript.db/FilteredDB, taking a map of keywords to field values.
 */
datascript.db.map__GT_FilteredDB \x3d (function datascript$db$map__GT_FilteredDB(G__51905){
var extmap__5385__auto__ \x3d (function (){var G__51915 \x3d cljs.core.dissoc.cljs$core$IFn$_invoke$arity$variadic(G__51905,new cljs.core.Keyword(null,\x22unfiltered-db\x22,\x22unfiltered-db\x22,-1363720391),cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,\x22pred\x22,\x22pred\x22,1927423397),new cljs.core.Keyword(null,\x22hash\x22,\x22hash\x22,-13781596)], 0));
if(cljs.core.record_QMARK_(G__51905)){
return cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,G__51915);
} else {
return G__51915;
}
})();
return (new datascript.db.FilteredDB(new cljs.core.Keyword(null,\x22unfiltered-db\x22,\x22unfiltered-db\x22,-1363720391).cljs$core$IFn$_invoke$arity$1(G__51905),new cljs.core.Keyword(null,\x22pred\x22,\x22pred\x22,1927423397).cljs$core$IFn$_invoke$arity$1(G__51905),new cljs.core.Keyword(null,\x22hash\x22,\x22hash\x22,-13781596).cljs$core$IFn$_invoke$arity$1(G__51905),null,cljs.core.not_empty(extmap__5385__auto__),null));
});


(datascript.db.FilteredDB.prototype.cljs$core$ILookup$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.db.FilteredDB.prototype.cljs$core$ILookup$_lookup$arity$2 \x3d (function (_,___$1){
var ___$2 \x3d this;
throw (new Error(\x22-lookup is not supported on FilteredDB\x22));
}));

(datascript.db.FilteredDB.prototype.cljs$core$ILookup$_lookup$arity$3 \x3d (function (_,___$1,___$2){
var ___$3 \x3d this;
throw (new Error(\x22-lookup is not supported on FilteredDB\x22));
}));

(datascript.db.FilteredDB.prototype.cljs$core$IPrintWithWriter$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.db.FilteredDB.prototype.cljs$core$IPrintWithWriter$_pr_writer$arity$3 \x3d (function (db,w,opts){
var db__$1 \x3d this;
return (datascript.db.pr_db.cljs$core$IFn$_invoke$arity$3 ? datascript.db.pr_db.cljs$core$IFn$_invoke$arity$3(db__$1,w,opts) : datascript.db.pr_db.call(null,db__$1,w,opts));
}));

(datascript.db.FilteredDB.prototype.cljs$core$ICounted$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.db.FilteredDB.prototype.cljs$core$ICounted$_count$arity$1 \x3d (function (db){
var db__$1 \x3d this;
return cljs.core.count(datascript.db._datoms(db__$1,new cljs.core.Keyword(null,\x22eavt\x22,\x22eavt\x22,-666437073),cljs.core.PersistentVector.EMPTY));
}));

(datascript.db.FilteredDB.prototype.cljs$core$IHash$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.db.FilteredDB.prototype.cljs$core$IHash$_hash$arity$1 \x3d (function (db){
var db__$1 \x3d this;
return (datascript.db.hash_fdb.cljs$core$IFn$_invoke$arity$1 ? datascript.db.hash_fdb.cljs$core$IFn$_invoke$arity$1(db__$1) : datascript.db.hash_fdb.call(null,db__$1));
}));

(datascript.db.FilteredDB.prototype.cljs$core$IEquiv$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.db.FilteredDB.prototype.cljs$core$IEquiv$_equiv$arity$2 \x3d (function (db,other){
var db__$1 \x3d this;
return (datascript.db.equiv_db.cljs$core$IFn$_invoke$arity$2 ? datascript.db.equiv_db.cljs$core$IFn$_invoke$arity$2(db__$1,other) : datascript.db.equiv_db.call(null,db__$1,other));
}));

(datascript.db.FilteredDB.prototype.cljs$core$IEmptyableCollection$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.db.FilteredDB.prototype.cljs$core$IEmptyableCollection$_empty$arity$1 \x3d (function (_){
var ___$1 \x3d this;
throw (new Error(\x22-empty is not supported on FilteredDB\x22));
}));

(datascript.db.FilteredDB.prototype.cljs$core$IAssociative$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.db.FilteredDB.prototype.cljs$core$IAssociative$_contains_key_QMARK_$arity$2 \x3d (function (_,___$1){
var ___$2 \x3d this;
throw (new Error(\x22-contains-key? is not supported on FilteredDB\x22));
}));

(datascript.db.FilteredDB.prototype.cljs$core$IAssociative$_assoc$arity$3 \x3d (function (_,___$1,___$2){
var ___$3 \x3d this;
throw (new Error(\x22-assoc is not supported on FilteredDB\x22));
}));

(datascript.db.FilteredDB.prototype.datascript$db$IIndexAccess$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.db.FilteredDB.prototype.datascript$db$IIndexAccess$_datoms$arity$3 \x3d (function (db,index,cs){
var db__$1 \x3d this;
return cljs.core.filter.cljs$core$IFn$_invoke$arity$2(db__$1.pred,datascript.db._datoms(db__$1.unfiltered_db,index,cs));
}));

(datascript.db.FilteredDB.prototype.datascript$db$IIndexAccess$_seek_datoms$arity$3 \x3d (function (db,index,cs){
var db__$1 \x3d this;
return cljs.core.filter.cljs$core$IFn$_invoke$arity$2(db__$1.pred,datascript.db._seek_datoms(db__$1.unfiltered_db,index,cs));
}));

(datascript.db.FilteredDB.prototype.datascript$db$IIndexAccess$_rseek_datoms$arity$3 \x3d (function (db,index,cs){
var db__$1 \x3d this;
return cljs.core.filter.cljs$core$IFn$_invoke$arity$2(db__$1.pred,datascript.db._rseek_datoms(db__$1.unfiltered_db,index,cs));
}));

(datascript.db.FilteredDB.prototype.datascript$db$IIndexAccess$_index_range$arity$4 \x3d (function (db,attr,start,end){
var db__$1 \x3d this;
return cljs.core.filter.cljs$core$IFn$_invoke$arity$2(db__$1.pred,datascript.db._index_range(db__$1.unfiltered_db,attr,start,end));
}));

(datascript.db.FilteredDB.prototype.datascript$db$IDB$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.db.FilteredDB.prototype.datascript$db$IDB$_schema$arity$1 \x3d (function (db){
var db__$1 \x3d this;
return datascript.db._schema(db__$1.unfiltered_db);
}));

(datascript.db.FilteredDB.prototype.datascript$db$IDB$_attrs_by$arity$2 \x3d (function (db,property){
var db__$1 \x3d this;
return datascript.db._attrs_by(db__$1.unfiltered_db,property);
}));

(datascript.db.FilteredDB.prototype.datascript$db$ISearch$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.db.FilteredDB.prototype.datascript$db$ISearch$_search$arity$2 \x3d (function (db,pattern){
var db__$1 \x3d this;
return cljs.core.filter.cljs$core$IFn$_invoke$arity$2(db__$1.pred,datascript.db._search(db__$1.unfiltered_db,pattern));
}));
datascript.db.unfiltered_db \x3d (function datascript$db$unfiltered_db(db){
if((db instanceof datascript.db.FilteredDB)){
return db.unfiltered_db;
} else {
return db;
}
});
datascript.db.attr__GT_properties \x3d (function datascript$db$attr__GT_properties(k,v){
var G__51916 \x3d v;
var G__51916__$1 \x3d (((G__51916 instanceof cljs.core.Keyword))?G__51916.fqn:null);
switch (G__51916__$1) {
case \x22db.unique/identity\x22:
return new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22db\x22,\x22unique\x22,\x22db/unique\x22,329396388),new cljs.core.Keyword(\x22db.unique\x22,\x22identity\x22,\x22db.unique/identity\x22,1675950722),new cljs.core.Keyword(\x22db\x22,\x22index\x22,\x22db/index\x22,-1531680669)], null);

break;
case \x22db.unique/value\x22:
return new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22db\x22,\x22unique\x22,\x22db/unique\x22,329396388),new cljs.core.Keyword(\x22db.unique\x22,\x22value\x22,\x22db.unique/value\x22,276903088),new cljs.core.Keyword(\x22db\x22,\x22index\x22,\x22db/index\x22,-1531680669)], null);

break;
case \x22db.cardinality/many\x22:
return new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22db.cardinality\x22,\x22many\x22,\x22db.cardinality/many\x22,772806234)], null);

break;
case \x22db.type/ref\x22:
return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22db.type\x22,\x22ref\x22,\x22db.type/ref\x22,-1728373079),new cljs.core.Keyword(\x22db\x22,\x22index\x22,\x22db/index\x22,-1531680669)], null);

break;
default:
if(((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(\x22db\x22,\x22isComponent\x22,\x22db/isComponent\x22,423352398),k)) \x26\x26 (v \x3d\x3d\x3d true))){
return new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22db\x22,\x22isComponent\x22,\x22db/isComponent\x22,423352398)], null);
} else {
if(((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(\x22db\x22,\x22index\x22,\x22db/index\x22,-1531680669),k)) \x26\x26 (v \x3d\x3d\x3d true))){
return new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22db\x22,\x22index\x22,\x22db/index\x22,-1531680669)], null);
} else {
if(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(\x22db\x22,\x22tupleAttrs\x22,\x22db/tupleAttrs\x22,250080092),k)){
return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22db.type\x22,\x22tuple\x22,\x22db.type/tuple\x22,938234914),new cljs.core.Keyword(\x22db\x22,\x22index\x22,\x22db/index\x22,-1531680669)], null);
} else {
return cljs.core.PersistentVector.EMPTY;

}
}
}

}
});
/**
 * e.g. :reg/semester \x3d\x3e #{:reg/semester+course+student ...}
 */
datascript.db.attr_tuples \x3d (function datascript$db$attr_tuples(schema,rschema){
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (m,tuple_attr){
return datascript.db.reduce_indexed((function (m__$1,src_attr,idx){
return cljs.core.update.cljs$core$IFn$_invoke$arity$5(m__$1,src_attr,cljs.core.assoc,tuple_attr,idx);
}),m,new cljs.core.Keyword(\x22db\x22,\x22tupleAttrs\x22,\x22db/tupleAttrs\x22,250080092).cljs$core$IFn$_invoke$arity$1(cljs.core.get.cljs$core$IFn$_invoke$arity$2(schema,tuple_attr)));
}),cljs.core.PersistentArrayMap.EMPTY,new cljs.core.Keyword(\x22db.type\x22,\x22tuple\x22,\x22db.type/tuple\x22,938234914).cljs$core$IFn$_invoke$arity$1(rschema));
});
/**
 * :db/unique           \x3d\x3e #{attr ...}
 * :db.unique/identity  \x3d\x3e #{attr ...}
 * :db.unique/value     \x3d\x3e #{attr ...}
 * :db/index            \x3d\x3e #{attr ...}
 * :db.cardinality/many \x3d\x3e #{attr ...}
 * :db.type/ref         \x3d\x3e #{attr ...}
 * :db/isComponent      \x3d\x3e #{attr ...}
 * :db.type/tuple       \x3d\x3e #{attr ...}
 * :db/attrTuples       \x3d\x3e {attr \x3d\x3e {tuple-attr \x3d\x3e idx}}
 */
datascript.db.rschema \x3d (function datascript$db$rschema(schema){
var rschema \x3d cljs.core.reduce_kv((function (rschema,attr,attr_schema){
return cljs.core.reduce_kv((function (rschema__$1,key,value){
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (rschema__$2,prop){
return cljs.core.update.cljs$core$IFn$_invoke$arity$4(rschema__$2,prop,datascript.db.conjs,attr);
}),rschema__$1,datascript.db.attr__GT_properties(key,value));
}),rschema,attr_schema);
}),cljs.core.PersistentArrayMap.EMPTY,schema);
return cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(rschema,new cljs.core.Keyword(\x22db\x22,\x22attrTuples\x22,\x22db/attrTuples\x22,860541631),datascript.db.attr_tuples(schema,rschema));
});
datascript.db.validate_schema_key \x3d (function datascript$db$validate_schema_key(a,k,v,expected){
if((((v \x3d\x3d null)) || (cljs.core.contains_QMARK_(expected,v)))){
return null;
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22Bad attribute specification for \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([cljs.core.PersistentArrayMap.createAsIfByAssoc([a,cljs.core.PersistentArrayMap.createAsIfByAssoc([k,v])])], 0)),\x22, expected one of \x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1(expected)].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22schema\x22,\x22validation\x22,\x22schema/validation\x22,1178447161),new cljs.core.Keyword(null,\x22attribute\x22,\x22attribute\x22,-2074029119),a,new cljs.core.Keyword(null,\x22key\x22,\x22key\x22,-1516042587),k,new cljs.core.Keyword(null,\x22value\x22,\x22value\x22,305978217),v], null));
}
});
datascript.db.validate_schema \x3d (function datascript$db$validate_schema(schema){
var seq__51917 \x3d cljs.core.seq(schema);
var chunk__51918 \x3d null;
var count__51919 \x3d (0);
var i__51920 \x3d (0);
while(true){
if((i__51920 \x3c count__51919)){
var vec__51939 \x3d chunk__51918.cljs$core$IIndexed$_nth$arity$2(null,i__51920);
var a \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__51939,(0),null);
var kv \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__51939,(1),null);
var comp_QMARK__52468 \x3d new cljs.core.Keyword(\x22db\x22,\x22isComponent\x22,\x22db/isComponent\x22,423352398).cljs$core$IFn$_invoke$arity$2(kv,false);
datascript.db.validate_schema_key(a,new cljs.core.Keyword(\x22db\x22,\x22isComponent\x22,\x22db/isComponent\x22,423352398),new cljs.core.Keyword(\x22db\x22,\x22isComponent\x22,\x22db/isComponent\x22,423352398).cljs$core$IFn$_invoke$arity$1(kv),new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 2, [true,null,false,null], null), null));

if(cljs.core.truth_((function (){var and__5043__auto__ \x3d comp_QMARK__52468;
if(cljs.core.truth_(and__5043__auto__)){
return cljs.core.not_EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(\x22db\x22,\x22valueType\x22,\x22db/valueType\x22,1827971944).cljs$core$IFn$_invoke$arity$1(kv),new cljs.core.Keyword(\x22db.type\x22,\x22ref\x22,\x22db.type/ref\x22,-1728373079));
} else {
return and__5043__auto__;
}
})())){
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22Bad attribute specification for \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([a], 0)),\x22: {:db/isComponent true} should also have {:db/valueType :db.type/ref}\x22].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22schema\x22,\x22validation\x22,\x22schema/validation\x22,1178447161),new cljs.core.Keyword(null,\x22attribute\x22,\x22attribute\x22,-2074029119),a,new cljs.core.Keyword(null,\x22key\x22,\x22key\x22,-1516042587),new cljs.core.Keyword(\x22db\x22,\x22isComponent\x22,\x22db/isComponent\x22,423352398)], null));
} else {
}

datascript.db.validate_schema_key(a,new cljs.core.Keyword(\x22db\x22,\x22unique\x22,\x22db/unique\x22,329396388),new cljs.core.Keyword(\x22db\x22,\x22unique\x22,\x22db/unique\x22,329396388).cljs$core$IFn$_invoke$arity$1(kv),new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(\x22db.unique\x22,\x22identity\x22,\x22db.unique/identity\x22,1675950722),null,new cljs.core.Keyword(\x22db.unique\x22,\x22value\x22,\x22db.unique/value\x22,276903088),null], null), null));

datascript.db.validate_schema_key(a,new cljs.core.Keyword(\x22db\x22,\x22valueType\x22,\x22db/valueType\x22,1827971944),new cljs.core.Keyword(\x22db\x22,\x22valueType\x22,\x22db/valueType\x22,1827971944).cljs$core$IFn$_invoke$arity$1(kv),new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(\x22db.type\x22,\x22tuple\x22,\x22db.type/tuple\x22,938234914),null,new cljs.core.Keyword(\x22db.type\x22,\x22ref\x22,\x22db.type/ref\x22,-1728373079),null], null), null));

datascript.db.validate_schema_key(a,new cljs.core.Keyword(\x22db\x22,\x22cardinality\x22,\x22db/cardinality\x22,-104975659),new cljs.core.Keyword(\x22db\x22,\x22cardinality\x22,\x22db/cardinality\x22,-104975659).cljs$core$IFn$_invoke$arity$1(kv),new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(\x22db.cardinality\x22,\x22many\x22,\x22db.cardinality/many\x22,772806234),null,new cljs.core.Keyword(\x22db.cardinality\x22,\x22one\x22,\x22db.cardinality/one\x22,1428352190),null], null), null));

if(((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(\x22db.type\x22,\x22tuple\x22,\x22db.type/tuple\x22,938234914),new cljs.core.Keyword(\x22db\x22,\x22valueType\x22,\x22db/valueType\x22,1827971944).cljs$core$IFn$_invoke$arity$1(kv))) \x26\x26 ((!(cljs.core.contains_QMARK_(kv,new cljs.core.Keyword(\x22db\x22,\x22tupleAttrs\x22,\x22db/tupleAttrs\x22,250080092))))))){
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22Bad attribute specification for \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([a], 0)),\x22: {:db/valueType :db.type/tuple} should also have :db/tupleAttrs\x22].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22schema\x22,\x22validation\x22,\x22schema/validation\x22,1178447161),new cljs.core.Keyword(null,\x22attribute\x22,\x22attribute\x22,-2074029119),a,new cljs.core.Keyword(null,\x22key\x22,\x22key\x22,-1516042587),new cljs.core.Keyword(\x22db\x22,\x22valueType\x22,\x22db/valueType\x22,1827971944)], null));
} else {
}

if(cljs.core.contains_QMARK_(kv,new cljs.core.Keyword(\x22db\x22,\x22tupleAttrs\x22,\x22db/tupleAttrs\x22,250080092))){
var ex_data_52473 \x3d new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22schema\x22,\x22validation\x22,\x22schema/validation\x22,1178447161),new cljs.core.Keyword(null,\x22attribute\x22,\x22attribute\x22,-2074029119),a,new cljs.core.Keyword(null,\x22key\x22,\x22key\x22,-1516042587),new cljs.core.Keyword(\x22db\x22,\x22tupleAttrs\x22,\x22db/tupleAttrs\x22,250080092)], null);
if(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(\x22db.cardinality\x22,\x22many\x22,\x22db.cardinality/many\x22,772806234),new cljs.core.Keyword(\x22db\x22,\x22cardinality\x22,\x22db/cardinality\x22,-104975659).cljs$core$IFn$_invoke$arity$1(kv))){
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([a], 0)),\x22 has :db/tupleAttrs, must be :db.cardinality/one\x22].join(\x27\x27),ex_data_52473);
} else {
}

var attrs_52475 \x3d new cljs.core.Keyword(\x22db\x22,\x22tupleAttrs\x22,\x22db/tupleAttrs\x22,250080092).cljs$core$IFn$_invoke$arity$1(kv);
if(cljs.core.sequential_QMARK_(attrs_52475)){
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([a], 0)),\x22 :db/tupleAttrs must be a sequential collection, got: \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([attrs_52475], 0))].join(\x27\x27),ex_data_52473);
}

if(cljs.core.empty_QMARK_(attrs_52475)){
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([a], 0)),\x22 :db/tupleAttrs can\\u2019t be empty\x22].join(\x27\x27),ex_data_52473);
} else {
}

var seq__51942_52477 \x3d cljs.core.seq(attrs_52475);
var chunk__51944_52478 \x3d null;
var count__51945_52479 \x3d (0);
var i__51946_52480 \x3d (0);
while(true){
if((i__51946_52480 \x3c count__51945_52479)){
var attr_52481 \x3d chunk__51944_52478.cljs$core$IIndexed$_nth$arity$2(null,i__51946_52480);
var ex_data_52482__$1 \x3d cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(ex_data_52473,new cljs.core.Keyword(null,\x22value\x22,\x22value\x22,305978217),attr_52481);
if(cljs.core.contains_QMARK_(cljs.core.get.cljs$core$IFn$_invoke$arity$2(schema,attr_52481),new cljs.core.Keyword(\x22db\x22,\x22tupleAttrs\x22,\x22db/tupleAttrs\x22,250080092))){
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([a], 0)),\x22 :db/tupleAttrs can\\u2019t depend on another tuple attribute: \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([attr_52481], 0))].join(\x27\x27),ex_data_52482__$1);
} else {
}

if(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(\x22db.cardinality\x22,\x22many\x22,\x22db.cardinality/many\x22,772806234),new cljs.core.Keyword(\x22db\x22,\x22cardinality\x22,\x22db/cardinality\x22,-104975659).cljs$core$IFn$_invoke$arity$1(cljs.core.get.cljs$core$IFn$_invoke$arity$2(schema,attr_52481)))){
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([a], 0)),\x22 :db/tupleAttrs can\\u2019t depend on :db.cardinality/many attribute: \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([attr_52481], 0))].join(\x27\x27),ex_data_52482__$1);
} else {
}


var G__52491 \x3d seq__51942_52477;
var G__52492 \x3d chunk__51944_52478;
var G__52493 \x3d count__51945_52479;
var G__52494 \x3d (i__51946_52480 + (1));
seq__51942_52477 \x3d G__52491;
chunk__51944_52478 \x3d G__52492;
count__51945_52479 \x3d G__52493;
i__51946_52480 \x3d G__52494;
continue;
} else {
var temp__5804__auto___52498 \x3d cljs.core.seq(seq__51942_52477);
if(temp__5804__auto___52498){
var seq__51942_52499__$1 \x3d temp__5804__auto___52498;
if(cljs.core.chunked_seq_QMARK_(seq__51942_52499__$1)){
var c__5568__auto___52500 \x3d cljs.core.chunk_first(seq__51942_52499__$1);
var G__52501 \x3d cljs.core.chunk_rest(seq__51942_52499__$1);
var G__52502 \x3d c__5568__auto___52500;
var G__52503 \x3d cljs.core.count(c__5568__auto___52500);
var G__52504 \x3d (0);
seq__51942_52477 \x3d G__52501;
chunk__51944_52478 \x3d G__52502;
count__51945_52479 \x3d G__52503;
i__51946_52480 \x3d G__52504;
continue;
} else {
var attr_52505 \x3d cljs.core.first(seq__51942_52499__$1);
var ex_data_52506__$1 \x3d cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(ex_data_52473,new cljs.core.Keyword(null,\x22value\x22,\x22value\x22,305978217),attr_52505);
if(cljs.core.contains_QMARK_(cljs.core.get.cljs$core$IFn$_invoke$arity$2(schema,attr_52505),new cljs.core.Keyword(\x22db\x22,\x22tupleAttrs\x22,\x22db/tupleAttrs\x22,250080092))){
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([a], 0)),\x22 :db/tupleAttrs can\\u2019t depend on another tuple attribute: \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([attr_52505], 0))].join(\x27\x27),ex_data_52506__$1);
} else {
}

if(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(\x22db.cardinality\x22,\x22many\x22,\x22db.cardinality/many\x22,772806234),new cljs.core.Keyword(\x22db\x22,\x22cardinality\x22,\x22db/cardinality\x22,-104975659).cljs$core$IFn$_invoke$arity$1(cljs.core.get.cljs$core$IFn$_invoke$arity$2(schema,attr_52505)))){
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([a], 0)),\x22 :db/tupleAttrs can\\u2019t depend on :db.cardinality/many attribute: \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([attr_52505], 0))].join(\x27\x27),ex_data_52506__$1);
} else {
}


var G__52508 \x3d cljs.core.next(seq__51942_52499__$1);
var G__52509 \x3d null;
var G__52510 \x3d (0);
var G__52511 \x3d (0);
seq__51942_52477 \x3d G__52508;
chunk__51944_52478 \x3d G__52509;
count__51945_52479 \x3d G__52510;
i__51946_52480 \x3d G__52511;
continue;
}
} else {
}
}
break;
}
} else {
}


var G__52512 \x3d seq__51917;
var G__52513 \x3d chunk__51918;
var G__52514 \x3d count__51919;
var G__52515 \x3d (i__51920 + (1));
seq__51917 \x3d G__52512;
chunk__51918 \x3d G__52513;
count__51919 \x3d G__52514;
i__51920 \x3d G__52515;
continue;
} else {
var temp__5804__auto__ \x3d cljs.core.seq(seq__51917);
if(temp__5804__auto__){
var seq__51917__$1 \x3d temp__5804__auto__;
if(cljs.core.chunked_seq_QMARK_(seq__51917__$1)){
var c__5568__auto__ \x3d cljs.core.chunk_first(seq__51917__$1);
var G__52517 \x3d cljs.core.chunk_rest(seq__51917__$1);
var G__52518 \x3d c__5568__auto__;
var G__52519 \x3d cljs.core.count(c__5568__auto__);
var G__52520 \x3d (0);
seq__51917 \x3d G__52517;
chunk__51918 \x3d G__52518;
count__51919 \x3d G__52519;
i__51920 \x3d G__52520;
continue;
} else {
var vec__51948 \x3d cljs.core.first(seq__51917__$1);
var a \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__51948,(0),null);
var kv \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__51948,(1),null);
var comp_QMARK__52522 \x3d new cljs.core.Keyword(\x22db\x22,\x22isComponent\x22,\x22db/isComponent\x22,423352398).cljs$core$IFn$_invoke$arity$2(kv,false);
datascript.db.validate_schema_key(a,new cljs.core.Keyword(\x22db\x22,\x22isComponent\x22,\x22db/isComponent\x22,423352398),new cljs.core.Keyword(\x22db\x22,\x22isComponent\x22,\x22db/isComponent\x22,423352398).cljs$core$IFn$_invoke$arity$1(kv),new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 2, [true,null,false,null], null), null));

if(cljs.core.truth_((function (){var and__5043__auto__ \x3d comp_QMARK__52522;
if(cljs.core.truth_(and__5043__auto__)){
return cljs.core.not_EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(\x22db\x22,\x22valueType\x22,\x22db/valueType\x22,1827971944).cljs$core$IFn$_invoke$arity$1(kv),new cljs.core.Keyword(\x22db.type\x22,\x22ref\x22,\x22db.type/ref\x22,-1728373079));
} else {
return and__5043__auto__;
}
})())){
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22Bad attribute specification for \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([a], 0)),\x22: {:db/isComponent true} should also have {:db/valueType :db.type/ref}\x22].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22schema\x22,\x22validation\x22,\x22schema/validation\x22,1178447161),new cljs.core.Keyword(null,\x22attribute\x22,\x22attribute\x22,-2074029119),a,new cljs.core.Keyword(null,\x22key\x22,\x22key\x22,-1516042587),new cljs.core.Keyword(\x22db\x22,\x22isComponent\x22,\x22db/isComponent\x22,423352398)], null));
} else {
}

datascript.db.validate_schema_key(a,new cljs.core.Keyword(\x22db\x22,\x22unique\x22,\x22db/unique\x22,329396388),new cljs.core.Keyword(\x22db\x22,\x22unique\x22,\x22db/unique\x22,329396388).cljs$core$IFn$_invoke$arity$1(kv),new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(\x22db.unique\x22,\x22identity\x22,\x22db.unique/identity\x22,1675950722),null,new cljs.core.Keyword(\x22db.unique\x22,\x22value\x22,\x22db.unique/value\x22,276903088),null], null), null));

datascript.db.validate_schema_key(a,new cljs.core.Keyword(\x22db\x22,\x22valueType\x22,\x22db/valueType\x22,1827971944),new cljs.core.Keyword(\x22db\x22,\x22valueType\x22,\x22db/valueType\x22,1827971944).cljs$core$IFn$_invoke$arity$1(kv),new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(\x22db.type\x22,\x22tuple\x22,\x22db.type/tuple\x22,938234914),null,new cljs.core.Keyword(\x22db.type\x22,\x22ref\x22,\x22db.type/ref\x22,-1728373079),null], null), null));

datascript.db.validate_schema_key(a,new cljs.core.Keyword(\x22db\x22,\x22cardinality\x22,\x22db/cardinality\x22,-104975659),new cljs.core.Keyword(\x22db\x22,\x22cardinality\x22,\x22db/cardinality\x22,-104975659).cljs$core$IFn$_invoke$arity$1(kv),new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(\x22db.cardinality\x22,\x22many\x22,\x22db.cardinality/many\x22,772806234),null,new cljs.core.Keyword(\x22db.cardinality\x22,\x22one\x22,\x22db.cardinality/one\x22,1428352190),null], null), null));

if(((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(\x22db.type\x22,\x22tuple\x22,\x22db.type/tuple\x22,938234914),new cljs.core.Keyword(\x22db\x22,\x22valueType\x22,\x22db/valueType\x22,1827971944).cljs$core$IFn$_invoke$arity$1(kv))) \x26\x26 ((!(cljs.core.contains_QMARK_(kv,new cljs.core.Keyword(\x22db\x22,\x22tupleAttrs\x22,\x22db/tupleAttrs\x22,250080092))))))){
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22Bad attribute specification for \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([a], 0)),\x22: {:db/valueType :db.type/tuple} should also have :db/tupleAttrs\x22].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22schema\x22,\x22validation\x22,\x22schema/validation\x22,1178447161),new cljs.core.Keyword(null,\x22attribute\x22,\x22attribute\x22,-2074029119),a,new cljs.core.Keyword(null,\x22key\x22,\x22key\x22,-1516042587),new cljs.core.Keyword(\x22db\x22,\x22valueType\x22,\x22db/valueType\x22,1827971944)], null));
} else {
}

if(cljs.core.contains_QMARK_(kv,new cljs.core.Keyword(\x22db\x22,\x22tupleAttrs\x22,\x22db/tupleAttrs\x22,250080092))){
var ex_data_52530 \x3d new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22schema\x22,\x22validation\x22,\x22schema/validation\x22,1178447161),new cljs.core.Keyword(null,\x22attribute\x22,\x22attribute\x22,-2074029119),a,new cljs.core.Keyword(null,\x22key\x22,\x22key\x22,-1516042587),new cljs.core.Keyword(\x22db\x22,\x22tupleAttrs\x22,\x22db/tupleAttrs\x22,250080092)], null);
if(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(\x22db.cardinality\x22,\x22many\x22,\x22db.cardinality/many\x22,772806234),new cljs.core.Keyword(\x22db\x22,\x22cardinality\x22,\x22db/cardinality\x22,-104975659).cljs$core$IFn$_invoke$arity$1(kv))){
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([a], 0)),\x22 has :db/tupleAttrs, must be :db.cardinality/one\x22].join(\x27\x27),ex_data_52530);
} else {
}

var attrs_52531 \x3d new cljs.core.Keyword(\x22db\x22,\x22tupleAttrs\x22,\x22db/tupleAttrs\x22,250080092).cljs$core$IFn$_invoke$arity$1(kv);
if(cljs.core.sequential_QMARK_(attrs_52531)){
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([a], 0)),\x22 :db/tupleAttrs must be a sequential collection, got: \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([attrs_52531], 0))].join(\x27\x27),ex_data_52530);
}

if(cljs.core.empty_QMARK_(attrs_52531)){
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([a], 0)),\x22 :db/tupleAttrs can\\u2019t be empty\x22].join(\x27\x27),ex_data_52530);
} else {
}

var seq__51951_52532 \x3d cljs.core.seq(attrs_52531);
var chunk__51953_52533 \x3d null;
var count__51954_52534 \x3d (0);
var i__51955_52535 \x3d (0);
while(true){
if((i__51955_52535 \x3c count__51954_52534)){
var attr_52536 \x3d chunk__51953_52533.cljs$core$IIndexed$_nth$arity$2(null,i__51955_52535);
var ex_data_52537__$1 \x3d cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(ex_data_52530,new cljs.core.Keyword(null,\x22value\x22,\x22value\x22,305978217),attr_52536);
if(cljs.core.contains_QMARK_(cljs.core.get.cljs$core$IFn$_invoke$arity$2(schema,attr_52536),new cljs.core.Keyword(\x22db\x22,\x22tupleAttrs\x22,\x22db/tupleAttrs\x22,250080092))){
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([a], 0)),\x22 :db/tupleAttrs can\\u2019t depend on another tuple attribute: \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([attr_52536], 0))].join(\x27\x27),ex_data_52537__$1);
} else {
}

if(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(\x22db.cardinality\x22,\x22many\x22,\x22db.cardinality/many\x22,772806234),new cljs.core.Keyword(\x22db\x22,\x22cardinality\x22,\x22db/cardinality\x22,-104975659).cljs$core$IFn$_invoke$arity$1(cljs.core.get.cljs$core$IFn$_invoke$arity$2(schema,attr_52536)))){
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([a], 0)),\x22 :db/tupleAttrs can\\u2019t depend on :db.cardinality/many attribute: \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([attr_52536], 0))].join(\x27\x27),ex_data_52537__$1);
} else {
}


var G__52540 \x3d seq__51951_52532;
var G__52541 \x3d chunk__51953_52533;
var G__52542 \x3d count__51954_52534;
var G__52543 \x3d (i__51955_52535 + (1));
seq__51951_52532 \x3d G__52540;
chunk__51953_52533 \x3d G__52541;
count__51954_52534 \x3d G__52542;
i__51955_52535 \x3d G__52543;
continue;
} else {
var temp__5804__auto___52544__$1 \x3d cljs.core.seq(seq__51951_52532);
if(temp__5804__auto___52544__$1){
var seq__51951_52545__$1 \x3d temp__5804__auto___52544__$1;
if(cljs.core.chunked_seq_QMARK_(seq__51951_52545__$1)){
var c__5568__auto___52546 \x3d cljs.core.chunk_first(seq__51951_52545__$1);
var G__52547 \x3d cljs.core.chunk_rest(seq__51951_52545__$1);
var G__52548 \x3d c__5568__auto___52546;
var G__52549 \x3d cljs.core.count(c__5568__auto___52546);
var G__52550 \x3d (0);
seq__51951_52532 \x3d G__52547;
chunk__51953_52533 \x3d G__52548;
count__51954_52534 \x3d G__52549;
i__51955_52535 \x3d G__52550;
continue;
} else {
var attr_52551 \x3d cljs.core.first(seq__51951_52545__$1);
var ex_data_52552__$1 \x3d cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(ex_data_52530,new cljs.core.Keyword(null,\x22value\x22,\x22value\x22,305978217),attr_52551);
if(cljs.core.contains_QMARK_(cljs.core.get.cljs$core$IFn$_invoke$arity$2(schema,attr_52551),new cljs.core.Keyword(\x22db\x22,\x22tupleAttrs\x22,\x22db/tupleAttrs\x22,250080092))){
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([a], 0)),\x22 :db/tupleAttrs can\\u2019t depend on another tuple attribute: \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([attr_52551], 0))].join(\x27\x27),ex_data_52552__$1);
} else {
}

if(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(\x22db.cardinality\x22,\x22many\x22,\x22db.cardinality/many\x22,772806234),new cljs.core.Keyword(\x22db\x22,\x22cardinality\x22,\x22db/cardinality\x22,-104975659).cljs$core$IFn$_invoke$arity$1(cljs.core.get.cljs$core$IFn$_invoke$arity$2(schema,attr_52551)))){
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([a], 0)),\x22 :db/tupleAttrs can\\u2019t depend on :db.cardinality/many attribute: \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([attr_52551], 0))].join(\x27\x27),ex_data_52552__$1);
} else {
}


var G__52557 \x3d cljs.core.next(seq__51951_52545__$1);
var G__52558 \x3d null;
var G__52559 \x3d (0);
var G__52560 \x3d (0);
seq__51951_52532 \x3d G__52557;
chunk__51953_52533 \x3d G__52558;
count__51954_52534 \x3d G__52559;
i__51955_52535 \x3d G__52560;
continue;
}
} else {
}
}
break;
}
} else {
}


var G__52561 \x3d cljs.core.next(seq__51917__$1);
var G__52562 \x3d null;
var G__52563 \x3d (0);
var G__52564 \x3d (0);
seq__51917 \x3d G__52561;
chunk__51918 \x3d G__52562;
count__51919 \x3d G__52563;
i__51920 \x3d G__52564;
continue;
}
} else {
return null;
}
}
break;
}
});
datascript.db.empty_db \x3d (function datascript$db$empty_db(var_args){
var G__51958 \x3d arguments.length;
switch (G__51958) {
case 0:
return datascript.db.empty_db.cljs$core$IFn$_invoke$arity$0();

break;
case 1:
return datascript.db.empty_db.cljs$core$IFn$_invoke$arity$1((arguments[(0)]));

break;
default:
throw (new Error([\x22Invalid arity: \x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1(arguments.length)].join(\x27\x27)));

}
});

(datascript.db.empty_db.cljs$core$IFn$_invoke$arity$0 \x3d (function (){
return datascript.db.empty_db.cljs$core$IFn$_invoke$arity$1(null);
}));

(datascript.db.empty_db.cljs$core$IFn$_invoke$arity$1 \x3d (function (schema){
if((((schema \x3d\x3d null)) || (cljs.core.map_QMARK_(schema)))){
} else {
throw (new Error(\x22Assert failed: (or (nil? schema) (map? schema))\x22));
}

datascript.db.validate_schema(schema);

return datascript.db.map__GT_DB(cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,\x22schema\x22,\x22schema\x22,-1582001791),new cljs.core.Keyword(null,\x22max-tx\x22,\x22max-tx\x22,1119558339),new cljs.core.Keyword(null,\x22hash\x22,\x22hash\x22,-13781596),new cljs.core.Keyword(null,\x22aevt\x22,\x22aevt\x22,-585148059),new cljs.core.Keyword(null,\x22avet\x22,\x22avet\x22,1383857032),new cljs.core.Keyword(null,\x22max-eid\x22,\x22max-eid\x22,2134868075),new cljs.core.Keyword(null,\x22eavt\x22,\x22eavt\x22,-666437073),new cljs.core.Keyword(null,\x22pull-attrs\x22,\x22pull-attrs\x22,-974863177),new cljs.core.Keyword(null,\x22pull-patterns\x22,\x22pull-patterns\x22,-343695048),new cljs.core.Keyword(null,\x22rschema\x22,\x22rschema\x22,-1196134054)],[schema,(536870912),cljs.core.atom.cljs$core$IFn$_invoke$arity$1((0)),me.tonsky.persistent_sorted_set.sorted_set_by.cljs$core$IFn$_invoke$arity$1(datascript.db.cmp_datoms_aevt),me.tonsky.persistent_sorted_set.sorted_set_by.cljs$core$IFn$_invoke$arity$1(datascript.db.cmp_datoms_avet),(0),me.tonsky.persistent_sorted_set.sorted_set_by.cljs$core$IFn$_invoke$arity$1(datascript.db.cmp_datoms_eavt),datascript.lru.cache((100)),datascript.lru.cache((100)),datascript.db.rschema(cljs.core.merge.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(\x22db\x22,\x22ident\x22,\x22db/ident\x22,-737096),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(\x22db\x22,\x22unique\x22,\x22db/unique\x22,329396388),new cljs.core.Keyword(\x22db.unique\x22,\x22identity\x22,\x22db.unique/identity\x22,1675950722)], null)], null),schema], 0)))]));
}));

(datascript.db.empty_db.cljs$lang$maxFixedArity \x3d 1);

datascript.db.init_max_eid \x3d (function datascript$db$init_max_eid(eavt){
var or__5045__auto__ \x3d new cljs.core.Keyword(null,\x22e\x22,\x22e\x22,1381269198).cljs$core$IFn$_invoke$arity$1(cljs.core.first(me.tonsky.persistent_sorted_set.rslice.cljs$core$IFn$_invoke$arity$3(eavt,datascript.db.datom.cljs$core$IFn$_invoke$arity$4(((536870912) - (1)),null,null,(2147483647)),datascript.db.datom.cljs$core$IFn$_invoke$arity$4((0),null,null,(536870912)))));
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return (0);
}
});
datascript.db.init_db \x3d (function datascript$db$init_db(var_args){
var G__51960 \x3d arguments.length;
switch (G__51960) {
case 1:
return datascript.db.init_db.cljs$core$IFn$_invoke$arity$1((arguments[(0)]));

break;
case 2:
return datascript.db.init_db.cljs$core$IFn$_invoke$arity$2((arguments[(0)]),(arguments[(1)]));

break;
default:
throw (new Error([\x22Invalid arity: \x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1(arguments.length)].join(\x27\x27)));

}
});

(datascript.db.init_db.cljs$core$IFn$_invoke$arity$1 \x3d (function (datoms){
return datascript.db.init_db.cljs$core$IFn$_invoke$arity$2(datoms,null);
}));

(datascript.db.init_db.cljs$core$IFn$_invoke$arity$2 \x3d (function (datoms,schema){
var temp__5808__auto___52578 \x3d cljs.core.first(cljs.core.drop_while.cljs$core$IFn$_invoke$arity$2(datascript.db.datom_QMARK_,datoms));
if((temp__5808__auto___52578 \x3d\x3d null)){
} else {
var not_datom_52580 \x3d temp__5808__auto___52578;
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22init-db expects list of Datoms, got \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([cljs.core.type(not_datom_52580)], 0))].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(null,\x22init-db\x22,\x22init-db\x22,1595181278)], null));
}

datascript.db.validate_schema(schema);

var rschema \x3d datascript.db.rschema(cljs.core.merge.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(\x22db\x22,\x22ident\x22,\x22db/ident\x22,-737096),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(\x22db\x22,\x22unique\x22,\x22db/unique\x22,329396388),new cljs.core.Keyword(\x22db.unique\x22,\x22identity\x22,\x22db.unique/identity\x22,1675950722)], null)], null),schema], 0)));
var indexed \x3d new cljs.core.Keyword(\x22db\x22,\x22index\x22,\x22db/index\x22,-1531680669).cljs$core$IFn$_invoke$arity$1(rschema);
var arr \x3d (function (){var G__51961 \x3d datoms;
if((!(me.tonsky.persistent_sorted_set.arrays.array_QMARK_(datoms)))){
return me.tonsky.persistent_sorted_set.arrays.into_array(G__51961);
} else {
return G__51961;
}
})();
var _ \x3d me.tonsky.persistent_sorted_set.arrays.asort(arr,datascript.db.cmp_datoms_eavt_quick);
var eavt \x3d me.tonsky.persistent_sorted_set.from_sorted_array(datascript.db.cmp_datoms_eavt,arr);
var ___$1 \x3d me.tonsky.persistent_sorted_set.arrays.asort(arr,datascript.db.cmp_datoms_aevt_quick);
var aevt \x3d me.tonsky.persistent_sorted_set.from_sorted_array(datascript.db.cmp_datoms_aevt,arr);
var avet_datoms \x3d cljs.core.filter.cljs$core$IFn$_invoke$arity$2((function (d){
return cljs.core.contains_QMARK_(indexed,d.a);
}),datoms);
var avet_arr \x3d cljs.core.to_array(avet_datoms);
var ___$2 \x3d me.tonsky.persistent_sorted_set.arrays.asort(avet_arr,datascript.db.cmp_datoms_avet_quick);
var avet \x3d me.tonsky.persistent_sorted_set.from_sorted_array(datascript.db.cmp_datoms_avet,avet_arr);
var max_eid \x3d datascript.db.init_max_eid(eavt);
var max_tx \x3d cljs.core.transduce.cljs$core$IFn$_invoke$arity$4(cljs.core.map.cljs$core$IFn$_invoke$arity$1((function (d){
return d.datascript$db$IDatom$datom_tx$arity$1(null);
})),cljs.core.max,(536870912),eavt);
return datascript.db.map__GT_DB(cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,\x22schema\x22,\x22schema\x22,-1582001791),new cljs.core.Keyword(null,\x22max-tx\x22,\x22max-tx\x22,1119558339),new cljs.core.Keyword(null,\x22hash\x22,\x22hash\x22,-13781596),new cljs.core.Keyword(null,\x22aevt\x22,\x22aevt\x22,-585148059),new cljs.core.Keyword(null,\x22avet\x22,\x22avet\x22,1383857032),new cljs.core.Keyword(null,\x22max-eid\x22,\x22max-eid\x22,2134868075),new cljs.core.Keyword(null,\x22eavt\x22,\x22eavt\x22,-666437073),new cljs.core.Keyword(null,\x22pull-attrs\x22,\x22pull-attrs\x22,-974863177),new cljs.core.Keyword(null,\x22pull-patterns\x22,\x22pull-patterns\x22,-343695048),new cljs.core.Keyword(null,\x22rschema\x22,\x22rschema\x22,-1196134054)],[schema,max_tx,cljs.core.atom.cljs$core$IFn$_invoke$arity$1((0)),aevt,avet,max_eid,eavt,datascript.lru.cache((100)),datascript.lru.cache((100)),rschema]));
}));

(datascript.db.init_db.cljs$lang$maxFixedArity \x3d 2);

datascript.db.equiv_db_index \x3d (function datascript$db$equiv_db_index(x,y){
var xs \x3d cljs.core.seq(x);
var ys \x3d cljs.core.seq(y);
while(true){
if((xs \x3d\x3d null)){
return (ys \x3d\x3d null);
} else {
if(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(cljs.core.first(xs),cljs.core.first(ys))){
var G__52590 \x3d cljs.core.next(xs);
var G__52591 \x3d cljs.core.next(ys);
xs \x3d G__52590;
ys \x3d G__52591;
continue;
} else {
return false;

}
}
break;
}
});
datascript.db.hash_db \x3d (function datascript$db$hash_db(db){
var h \x3d cljs.core.deref(db.hash);
if((h \x3d\x3d\x3d (0))){
return cljs.core.reset_BANG_(db.hash,datascript.db.combine_hashes(cljs.core.hash(db.schema),cljs.core.hash(db.eavt)));
} else {
return h;
}
});
datascript.db.hash_fdb \x3d (function datascript$db$hash_fdb(db){
var h \x3d cljs.core.deref(db.hash);
var datoms \x3d (function (){var or__5045__auto__ \x3d datascript.db._datoms(db,new cljs.core.Keyword(null,\x22eavt\x22,\x22eavt\x22,-666437073),cljs.core.PersistentVector.EMPTY);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return cljs.core.PersistentHashSet.EMPTY;
}
})();
if((h \x3d\x3d\x3d (0))){
var datoms__$1 \x3d (function (){var or__5045__auto__ \x3d datascript.db._datoms(db,new cljs.core.Keyword(null,\x22eavt\x22,\x22eavt\x22,-666437073),cljs.core.PersistentVector.EMPTY);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return cljs.core.PersistentHashSet.EMPTY;
}
})();
return cljs.core.reset_BANG_(db.hash,datascript.db.combine_hashes(cljs.core.hash(datascript.db._schema(db)),cljs.core.hash_unordered_coll(datoms__$1)));
} else {
return h;
}
});
datascript.db.equiv_db \x3d (function datascript$db$equiv_db(db,other){
return (((((other instanceof datascript.db.DB)) || ((other instanceof datascript.db.FilteredDB)))) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(datascript.db._schema(db),datascript.db._schema(other))) \x26\x26 (datascript.db.equiv_db_index(datascript.db._datoms(db,new cljs.core.Keyword(null,\x22eavt\x22,\x22eavt\x22,-666437073),cljs.core.PersistentVector.EMPTY),datascript.db._datoms(other,new cljs.core.Keyword(null,\x22eavt\x22,\x22eavt\x22,-666437073),cljs.core.PersistentVector.EMPTY))))));
});
datascript.db.pr_db \x3d (function datascript$db$pr_db(db,w,opts){
cljs.core._write(w,\x22#datascript/DB {\x22);

cljs.core._write(w,\x22:schema \x22);

cljs.core.pr_writer(datascript.db._schema(db),w,opts);

cljs.core._write(w,\x22, :datoms \x22);

cljs.core.pr_sequential_writer(w,(function (d,w__$1,opts__$1){
return cljs.core.pr_sequential_writer(w__$1,cljs.core.pr_writer,\x22[\x22,\x22 \x22,\x22]\x22,opts__$1,new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [d.e,d.a,d.v,datascript.db.datom_tx(d)], null));
}),\x22[\x22,\x22 \x22,\x22]\x22,opts,datascript.db._datoms(db,new cljs.core.Keyword(null,\x22eavt\x22,\x22eavt\x22,-666437073),cljs.core.PersistentVector.EMPTY));

return cljs.core._write(w,\x22}\x22);
});
datascript.db.db_from_reader \x3d (function datascript$db$db_from_reader(p__51962){
var map__51963 \x3d p__51962;
var map__51963__$1 \x3d cljs.core.__destructure_map(map__51963);
var schema \x3d cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__51963__$1,new cljs.core.Keyword(null,\x22schema\x22,\x22schema\x22,-1582001791));
var datoms \x3d cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__51963__$1,new cljs.core.Keyword(null,\x22datoms\x22,\x22datoms\x22,-290874434));
return datascript.db.init_db.cljs$core$IFn$_invoke$arity$2(cljs.core.map.cljs$core$IFn$_invoke$arity$2((function (p__51964){
var vec__51965 \x3d p__51964;
var e \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__51965,(0),null);
var a \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__51965,(1),null);
var v \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__51965,(2),null);
var tx \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__51965,(3),null);
return datascript.db.datom.cljs$core$IFn$_invoke$arity$4(e,a,v,tx);
}),datoms),schema);
});


datascript.db.resolve_datom \x3d (function datascript$db$resolve_datom(db,e,a,v,t,default_e,default_tx){
if(cljs.core.truth_(a)){
var G__51968_52596 \x3d a;
var G__51969_52597 \x3d (new cljs.core.List(null,new cljs.core.Symbol(null,\x22resolve-datom\x22,\x22resolve-datom\x22,-294110827,null),(new cljs.core.List(null,new cljs.core.Symbol(null,\x22db\x22,\x22db\x22,-1661185010,null),(new cljs.core.List(null,e,(new cljs.core.List(null,a,(new cljs.core.List(null,v,(new cljs.core.List(null,t,null,(1),null)),(2),null)),(3),null)),(4),null)),(5),null)),(6),null));
(datascript.db.validate_attr.cljs$core$IFn$_invoke$arity$2 ? datascript.db.validate_attr.cljs$core$IFn$_invoke$arity$2(G__51968_52596,G__51969_52597) : datascript.db.validate_attr.call(null,G__51968_52596,G__51969_52597));
} else {
}

return datascript.db.datom.cljs$core$IFn$_invoke$arity$4((function (){var or__5045__auto__ \x3d (datascript.db.entid_some.cljs$core$IFn$_invoke$arity$2 ? datascript.db.entid_some.cljs$core$IFn$_invoke$arity$2(db,e) : datascript.db.entid_some.call(null,db,e));
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return default_e;
}
})(),a,(cljs.core.truth_((function (){var and__5043__auto__ \x3d (!((v \x3d\x3d null)));
if(and__5043__auto__){
return (datascript.db.ref_QMARK_.cljs$core$IFn$_invoke$arity$2 ? datascript.db.ref_QMARK_.cljs$core$IFn$_invoke$arity$2(db,a) : datascript.db.ref_QMARK_.call(null,db,a));
} else {
return and__5043__auto__;
}
})())?(datascript.db.entid_strict.cljs$core$IFn$_invoke$arity$2 ? datascript.db.entid_strict.cljs$core$IFn$_invoke$arity$2(db,v) : datascript.db.entid_strict.call(null,db,v)):v),(function (){var or__5045__auto__ \x3d (datascript.db.entid_some.cljs$core$IFn$_invoke$arity$2 ? datascript.db.entid_some.cljs$core$IFn$_invoke$arity$2(db,t) : datascript.db.entid_some.call(null,db,t));
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return default_tx;
}
})());
});
datascript.db.components__GT_pattern \x3d (function datascript$db$components__GT_pattern(db,index,p__51970,default_e,default_tx){
var vec__51971 \x3d p__51970;
var c0 \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__51971,(0),null);
var c1 \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__51971,(1),null);
var c2 \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__51971,(2),null);
var c3 \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__51971,(3),null);
var G__51974 \x3d index;
var G__51974__$1 \x3d (((G__51974 instanceof cljs.core.Keyword))?G__51974.fqn:null);
switch (G__51974__$1) {
case \x22eavt\x22:
return datascript.db.resolve_datom(db,c0,c1,c2,c3,default_e,default_tx);

break;
case \x22aevt\x22:
return datascript.db.resolve_datom(db,c1,c0,c2,c3,default_e,default_tx);

break;
case \x22avet\x22:
return datascript.db.resolve_datom(db,c2,c0,c1,c3,default_e,default_tx);

break;
default:
throw (new Error([\x22No matching clause: \x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1(G__51974__$1)].join(\x27\x27)));

}
});

/**
* @constructor
 * @implements {cljs.core.IRecord}
 * @implements {cljs.core.IKVReduce}
 * @implements {cljs.core.IEquiv}
 * @implements {cljs.core.IHash}
 * @implements {cljs.core.ICollection}
 * @implements {cljs.core.ICounted}
 * @implements {cljs.core.ISeqable}
 * @implements {cljs.core.IMeta}
 * @implements {cljs.core.ICloneable}
 * @implements {cljs.core.IPrintWithWriter}
 * @implements {cljs.core.IIterable}
 * @implements {cljs.core.IWithMeta}
 * @implements {cljs.core.IAssociative}
 * @implements {cljs.core.IMap}
 * @implements {cljs.core.ILookup}
*/
datascript.db.TxReport \x3d (function (db_before,db_after,tx_data,tempids,tx_meta,__meta,__extmap,__hash){
this.db_before \x3d db_before;
this.db_after \x3d db_after;
this.tx_data \x3d tx_data;
this.tempids \x3d tempids;
this.tx_meta \x3d tx_meta;
this.__meta \x3d __meta;
this.__extmap \x3d __extmap;
this.__hash \x3d __hash;
this.cljs$lang$protocol_mask$partition0$ \x3d 2230716170;
this.cljs$lang$protocol_mask$partition1$ \x3d 139264;
});
(datascript.db.TxReport.prototype.cljs$core$ILookup$_lookup$arity$2 \x3d (function (this__5343__auto__,k__5344__auto__){
var self__ \x3d this;
var this__5343__auto____$1 \x3d this;
return this__5343__auto____$1.cljs$core$ILookup$_lookup$arity$3(null,k__5344__auto__,null);
}));

(datascript.db.TxReport.prototype.cljs$core$ILookup$_lookup$arity$3 \x3d (function (this__5345__auto__,k51976,else__5346__auto__){
var self__ \x3d this;
var this__5345__auto____$1 \x3d this;
var G__51980 \x3d k51976;
var G__51980__$1 \x3d (((G__51980 instanceof cljs.core.Keyword))?G__51980.fqn:null);
switch (G__51980__$1) {
case \x22db-before\x22:
return self__.db_before;

break;
case \x22db-after\x22:
return self__.db_after;

break;
case \x22tx-data\x22:
return self__.tx_data;

break;
case \x22tempids\x22:
return self__.tempids;

break;
case \x22tx-meta\x22:
return self__.tx_meta;

break;
default:
return cljs.core.get.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k51976,else__5346__auto__);

}
}));

(datascript.db.TxReport.prototype.cljs$core$IKVReduce$_kv_reduce$arity$3 \x3d (function (this__5363__auto__,f__5364__auto__,init__5365__auto__){
var self__ \x3d this;
var this__5363__auto____$1 \x3d this;
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (ret__5366__auto__,p__51981){
var vec__51982 \x3d p__51981;
var k__5367__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__51982,(0),null);
var v__5368__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__51982,(1),null);
return (f__5364__auto__.cljs$core$IFn$_invoke$arity$3 ? f__5364__auto__.cljs$core$IFn$_invoke$arity$3(ret__5366__auto__,k__5367__auto__,v__5368__auto__) : f__5364__auto__.call(null,ret__5366__auto__,k__5367__auto__,v__5368__auto__));
}),init__5365__auto__,this__5363__auto____$1);
}));

(datascript.db.TxReport.prototype.cljs$core$IPrintWithWriter$_pr_writer$arity$3 \x3d (function (this__5358__auto__,writer__5359__auto__,opts__5360__auto__){
var self__ \x3d this;
var this__5358__auto____$1 \x3d this;
var pr_pair__5361__auto__ \x3d (function (keyval__5362__auto__){
return cljs.core.pr_sequential_writer(writer__5359__auto__,cljs.core.pr_writer,\x22\x22,\x22 \x22,\x22\x22,opts__5360__auto__,keyval__5362__auto__);
});
return cljs.core.pr_sequential_writer(writer__5359__auto__,pr_pair__5361__auto__,\x22#datascript.db.TxReport{\x22,\x22, \x22,\x22}\x22,opts__5360__auto__,cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 5, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22db-before\x22,\x22db-before\x22,-553691536),self__.db_before],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22db-after\x22,\x22db-after\x22,-571884666),self__.db_after],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22tx-data\x22,\x22tx-data\x22,934159761),self__.tx_data],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22tempids\x22,\x22tempids\x22,1767509089),self__.tempids],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22tx-meta\x22,\x22tx-meta\x22,1159283194),self__.tx_meta],null))], null),self__.__extmap));
}));

(datascript.db.TxReport.prototype.cljs$core$IIterable$_iterator$arity$1 \x3d (function (G__51975){
var self__ \x3d this;
var G__51975__$1 \x3d this;
return (new cljs.core.RecordIter((0),G__51975__$1,5,new cljs.core.PersistentVector(null, 5, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22db-before\x22,\x22db-before\x22,-553691536),new cljs.core.Keyword(null,\x22db-after\x22,\x22db-after\x22,-571884666),new cljs.core.Keyword(null,\x22tx-data\x22,\x22tx-data\x22,934159761),new cljs.core.Keyword(null,\x22tempids\x22,\x22tempids\x22,1767509089),new cljs.core.Keyword(null,\x22tx-meta\x22,\x22tx-meta\x22,1159283194)], null),(cljs.core.truth_(self__.__extmap)?cljs.core._iterator(self__.__extmap):cljs.core.nil_iter())));
}));

(datascript.db.TxReport.prototype.cljs$core$IMeta$_meta$arity$1 \x3d (function (this__5341__auto__){
var self__ \x3d this;
var this__5341__auto____$1 \x3d this;
return self__.__meta;
}));

(datascript.db.TxReport.prototype.cljs$core$ICloneable$_clone$arity$1 \x3d (function (this__5338__auto__){
var self__ \x3d this;
var this__5338__auto____$1 \x3d this;
return (new datascript.db.TxReport(self__.db_before,self__.db_after,self__.tx_data,self__.tempids,self__.tx_meta,self__.__meta,self__.__extmap,self__.__hash));
}));

(datascript.db.TxReport.prototype.cljs$core$ICounted$_count$arity$1 \x3d (function (this__5347__auto__){
var self__ \x3d this;
var this__5347__auto____$1 \x3d this;
return (5 + cljs.core.count(self__.__extmap));
}));

(datascript.db.TxReport.prototype.cljs$core$IHash$_hash$arity$1 \x3d (function (this__5339__auto__){
var self__ \x3d this;
var this__5339__auto____$1 \x3d this;
var h__5154__auto__ \x3d self__.__hash;
if((!((h__5154__auto__ \x3d\x3d null)))){
return h__5154__auto__;
} else {
var h__5154__auto____$1 \x3d (function (coll__5340__auto__){
return (-2022644885 ^ cljs.core.hash_unordered_coll(coll__5340__auto__));
})(this__5339__auto____$1);
(self__.__hash \x3d h__5154__auto____$1);

return h__5154__auto____$1;
}
}));

(datascript.db.TxReport.prototype.cljs$core$IEquiv$_equiv$arity$2 \x3d (function (this51977,other51978){
var self__ \x3d this;
var this51977__$1 \x3d this;
return (((!((other51978 \x3d\x3d null)))) \x26\x26 ((((this51977__$1.constructor \x3d\x3d\x3d other51978.constructor)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this51977__$1.db_before,other51978.db_before)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this51977__$1.db_after,other51978.db_after)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this51977__$1.tx_data,other51978.tx_data)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this51977__$1.tempids,other51978.tempids)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this51977__$1.tx_meta,other51978.tx_meta)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this51977__$1.__extmap,other51978.__extmap)))))))))))))));
}));

(datascript.db.TxReport.prototype.cljs$core$IMap$_dissoc$arity$2 \x3d (function (this__5353__auto__,k__5354__auto__){
var self__ \x3d this;
var this__5353__auto____$1 \x3d this;
if(cljs.core.contains_QMARK_(new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 5, [new cljs.core.Keyword(null,\x22tempids\x22,\x22tempids\x22,1767509089),null,new cljs.core.Keyword(null,\x22db-after\x22,\x22db-after\x22,-571884666),null,new cljs.core.Keyword(null,\x22db-before\x22,\x22db-before\x22,-553691536),null,new cljs.core.Keyword(null,\x22tx-data\x22,\x22tx-data\x22,934159761),null,new cljs.core.Keyword(null,\x22tx-meta\x22,\x22tx-meta\x22,1159283194),null], null), null),k__5354__auto__)){
return cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(cljs.core._with_meta(cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,this__5353__auto____$1),self__.__meta),k__5354__auto__);
} else {
return (new datascript.db.TxReport(self__.db_before,self__.db_after,self__.tx_data,self__.tempids,self__.tx_meta,self__.__meta,cljs.core.not_empty(cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(self__.__extmap,k__5354__auto__)),null));
}
}));

(datascript.db.TxReport.prototype.cljs$core$IAssociative$_contains_key_QMARK_$arity$2 \x3d (function (this__5350__auto__,k51976){
var self__ \x3d this;
var this__5350__auto____$1 \x3d this;
var G__51985 \x3d k51976;
var G__51985__$1 \x3d (((G__51985 instanceof cljs.core.Keyword))?G__51985.fqn:null);
switch (G__51985__$1) {
case \x22db-before\x22:
case \x22db-after\x22:
case \x22tx-data\x22:
case \x22tempids\x22:
case \x22tx-meta\x22:
return true;

break;
default:
return cljs.core.contains_QMARK_(self__.__extmap,k51976);

}
}));

(datascript.db.TxReport.prototype.cljs$core$IAssociative$_assoc$arity$3 \x3d (function (this__5351__auto__,k__5352__auto__,G__51975){
var self__ \x3d this;
var this__5351__auto____$1 \x3d this;
var pred__51986 \x3d cljs.core.keyword_identical_QMARK_;
var expr__51987 \x3d k__5352__auto__;
if(cljs.core.truth_((pred__51986.cljs$core$IFn$_invoke$arity$2 ? pred__51986.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22db-before\x22,\x22db-before\x22,-553691536),expr__51987) : pred__51986.call(null,new cljs.core.Keyword(null,\x22db-before\x22,\x22db-before\x22,-553691536),expr__51987)))){
return (new datascript.db.TxReport(G__51975,self__.db_after,self__.tx_data,self__.tempids,self__.tx_meta,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__51986.cljs$core$IFn$_invoke$arity$2 ? pred__51986.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22db-after\x22,\x22db-after\x22,-571884666),expr__51987) : pred__51986.call(null,new cljs.core.Keyword(null,\x22db-after\x22,\x22db-after\x22,-571884666),expr__51987)))){
return (new datascript.db.TxReport(self__.db_before,G__51975,self__.tx_data,self__.tempids,self__.tx_meta,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__51986.cljs$core$IFn$_invoke$arity$2 ? pred__51986.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22tx-data\x22,\x22tx-data\x22,934159761),expr__51987) : pred__51986.call(null,new cljs.core.Keyword(null,\x22tx-data\x22,\x22tx-data\x22,934159761),expr__51987)))){
return (new datascript.db.TxReport(self__.db_before,self__.db_after,G__51975,self__.tempids,self__.tx_meta,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__51986.cljs$core$IFn$_invoke$arity$2 ? pred__51986.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22tempids\x22,\x22tempids\x22,1767509089),expr__51987) : pred__51986.call(null,new cljs.core.Keyword(null,\x22tempids\x22,\x22tempids\x22,1767509089),expr__51987)))){
return (new datascript.db.TxReport(self__.db_before,self__.db_after,self__.tx_data,G__51975,self__.tx_meta,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__51986.cljs$core$IFn$_invoke$arity$2 ? pred__51986.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22tx-meta\x22,\x22tx-meta\x22,1159283194),expr__51987) : pred__51986.call(null,new cljs.core.Keyword(null,\x22tx-meta\x22,\x22tx-meta\x22,1159283194),expr__51987)))){
return (new datascript.db.TxReport(self__.db_before,self__.db_after,self__.tx_data,self__.tempids,G__51975,self__.__meta,self__.__extmap,null));
} else {
return (new datascript.db.TxReport(self__.db_before,self__.db_after,self__.tx_data,self__.tempids,self__.tx_meta,self__.__meta,cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k__5352__auto__,G__51975),null));
}
}
}
}
}
}));

(datascript.db.TxReport.prototype.cljs$core$ISeqable$_seq$arity$1 \x3d (function (this__5356__auto__){
var self__ \x3d this;
var this__5356__auto____$1 \x3d this;
return cljs.core.seq(cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 5, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22db-before\x22,\x22db-before\x22,-553691536),self__.db_before,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22db-after\x22,\x22db-after\x22,-571884666),self__.db_after,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22tx-data\x22,\x22tx-data\x22,934159761),self__.tx_data,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22tempids\x22,\x22tempids\x22,1767509089),self__.tempids,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22tx-meta\x22,\x22tx-meta\x22,1159283194),self__.tx_meta,null))], null),self__.__extmap));
}));

(datascript.db.TxReport.prototype.cljs$core$IWithMeta$_with_meta$arity$2 \x3d (function (this__5342__auto__,G__51975){
var self__ \x3d this;
var this__5342__auto____$1 \x3d this;
return (new datascript.db.TxReport(self__.db_before,self__.db_after,self__.tx_data,self__.tempids,self__.tx_meta,G__51975,self__.__extmap,self__.__hash));
}));

(datascript.db.TxReport.prototype.cljs$core$ICollection$_conj$arity$2 \x3d (function (this__5348__auto__,entry__5349__auto__){
var self__ \x3d this;
var this__5348__auto____$1 \x3d this;
if(cljs.core.vector_QMARK_(entry__5349__auto__)){
return this__5348__auto____$1.cljs$core$IAssociative$_assoc$arity$3(null,cljs.core._nth(entry__5349__auto__,(0)),cljs.core._nth(entry__5349__auto__,(1)));
} else {
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(cljs.core._conj,this__5348__auto____$1,entry__5349__auto__);
}
}));

(datascript.db.TxReport.getBasis \x3d (function (){
return new cljs.core.PersistentVector(null, 5, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22db-before\x22,\x22db-before\x22,1086839991,null),new cljs.core.Symbol(null,\x22db-after\x22,\x22db-after\x22,1068646861,null),new cljs.core.Symbol(null,\x22tx-data\x22,\x22tx-data\x22,-1720276008,null),new cljs.core.Symbol(null,\x22tempids\x22,\x22tempids\x22,-886926680,null),new cljs.core.Symbol(null,\x22tx-meta\x22,\x22tx-meta\x22,-1495152575,null)], null);
}));

(datascript.db.TxReport.cljs$lang$type \x3d true);

(datascript.db.TxReport.cljs$lang$ctorPrSeq \x3d (function (this__5389__auto__){
return (new cljs.core.List(null,\x22datascript.db/TxReport\x22,null,(1),null));
}));

(datascript.db.TxReport.cljs$lang$ctorPrWriter \x3d (function (this__5389__auto__,writer__5390__auto__){
return cljs.core._write(writer__5390__auto__,\x22datascript.db/TxReport\x22);
}));

/**
 * Positional factory function for datascript.db/TxReport.
 */
datascript.db.__GT_TxReport \x3d (function datascript$db$__GT_TxReport(db_before,db_after,tx_data,tempids,tx_meta){
return (new datascript.db.TxReport(db_before,db_after,tx_data,tempids,tx_meta,null,null,null));
});

/**
 * Factory function for datascript.db/TxReport, taking a map of keywords to field values.
 */
datascript.db.map__GT_TxReport \x3d (function datascript$db$map__GT_TxReport(G__51979){
var extmap__5385__auto__ \x3d (function (){var G__51989 \x3d cljs.core.dissoc.cljs$core$IFn$_invoke$arity$variadic(G__51979,new cljs.core.Keyword(null,\x22db-before\x22,\x22db-before\x22,-553691536),cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,\x22db-after\x22,\x22db-after\x22,-571884666),new cljs.core.Keyword(null,\x22tx-data\x22,\x22tx-data\x22,934159761),new cljs.core.Keyword(null,\x22tempids\x22,\x22tempids\x22,1767509089),new cljs.core.Keyword(null,\x22tx-meta\x22,\x22tx-meta\x22,1159283194)], 0));
if(cljs.core.record_QMARK_(G__51979)){
return cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,G__51989);
} else {
return G__51989;
}
})();
return (new datascript.db.TxReport(new cljs.core.Keyword(null,\x22db-before\x22,\x22db-before\x22,-553691536).cljs$core$IFn$_invoke$arity$1(G__51979),new cljs.core.Keyword(null,\x22db-after\x22,\x22db-after\x22,-571884666).cljs$core$IFn$_invoke$arity$1(G__51979),new cljs.core.Keyword(null,\x22tx-data\x22,\x22tx-data\x22,934159761).cljs$core$IFn$_invoke$arity$1(G__51979),new cljs.core.Keyword(null,\x22tempids\x22,\x22tempids\x22,1767509089).cljs$core$IFn$_invoke$arity$1(G__51979),new cljs.core.Keyword(null,\x22tx-meta\x22,\x22tx-meta\x22,1159283194).cljs$core$IFn$_invoke$arity$1(G__51979),null,cljs.core.not_empty(extmap__5385__auto__),null));
});

datascript.db.is_attr_QMARK_ \x3d (function datascript$db$is_attr_QMARK_(db,attr,property){
return cljs.core.contains_QMARK_(datascript.db._attrs_by(db,property),attr);
});
datascript.db.multival_QMARK_ \x3d (function datascript$db$multival_QMARK_(db,attr){
return datascript.db.is_attr_QMARK_(db,attr,new cljs.core.Keyword(\x22db.cardinality\x22,\x22many\x22,\x22db.cardinality/many\x22,772806234));
});
datascript.db.ref_QMARK_ \x3d (function datascript$db$ref_QMARK_(db,attr){
return datascript.db.is_attr_QMARK_(db,attr,new cljs.core.Keyword(\x22db.type\x22,\x22ref\x22,\x22db.type/ref\x22,-1728373079));
});
datascript.db.component_QMARK_ \x3d (function datascript$db$component_QMARK_(db,attr){
return datascript.db.is_attr_QMARK_(db,attr,new cljs.core.Keyword(\x22db\x22,\x22isComponent\x22,\x22db/isComponent\x22,423352398));
});
datascript.db.indexing_QMARK_ \x3d (function datascript$db$indexing_QMARK_(db,attr){
return datascript.db.is_attr_QMARK_(db,attr,new cljs.core.Keyword(\x22db\x22,\x22index\x22,\x22db/index\x22,-1531680669));
});
datascript.db.tuple_QMARK_ \x3d (function datascript$db$tuple_QMARK_(db,attr){
return datascript.db.is_attr_QMARK_(db,attr,new cljs.core.Keyword(\x22db.type\x22,\x22tuple\x22,\x22db.type/tuple\x22,938234914));
});
datascript.db.tuple_source_QMARK_ \x3d (function datascript$db$tuple_source_QMARK_(db,attr){
return datascript.db.is_attr_QMARK_(db,attr,new cljs.core.Keyword(\x22db\x22,\x22attrTuples\x22,\x22db/attrTuples\x22,860541631));
});
datascript.db.entid \x3d (function datascript$db$entid(db,eid){
while(true){
if(datascript.db.db_QMARK_(db)){
} else {
throw (new Error(\x22Assert failed: (db? db)\x22));
}

if(((typeof eid \x3d\x3d\x3d \x27number\x27) \x26\x26 ((eid \x3e (0))))){
if((eid \x3e (2147483647))){
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22Highest supported entity id is \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([(2147483647)], 0)),\x22, got \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([eid], 0))].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(null,\x22entity-id\x22,\x22entity-id\x22,1485898093),new cljs.core.Keyword(null,\x22value\x22,\x22value\x22,305978217),eid], null));
} else {
return eid;
}
} else {
if(cljs.core.sequential_QMARK_(eid)){
var vec__51990 \x3d eid;
var attr \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__51990,(0),null);
var value \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__51990,(1),null);
if(cljs.core.not_EQ_.cljs$core$IFn$_invoke$arity$2(cljs.core.count(eid),(2))){
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22Lookup ref should contain 2 elements: \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([eid], 0))].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22lookup-ref\x22,\x22syntax\x22,\x22lookup-ref/syntax\x22,-317304012),new cljs.core.Keyword(null,\x22entity-id\x22,\x22entity-id\x22,1485898093),eid], null));
} else {
if((!(datascript.db.is_attr_QMARK_(db,attr,new cljs.core.Keyword(\x22db\x22,\x22unique\x22,\x22db/unique\x22,329396388))))){
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22Lookup ref attribute should be marked as :db/unique: \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([eid], 0))].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22lookup-ref\x22,\x22unique\x22,\x22lookup-ref/unique\x22,-960647710),new cljs.core.Keyword(null,\x22entity-id\x22,\x22entity-id\x22,1485898093),eid], null));
} else {
if((value \x3d\x3d null)){
return null;
} else {
return new cljs.core.Keyword(null,\x22e\x22,\x22e\x22,1381269198).cljs$core$IFn$_invoke$arity$1(cljs.core.first(datascript.db._datoms(db,new cljs.core.Keyword(null,\x22avet\x22,\x22avet\x22,1383857032),eid)));

}
}
}
} else {
if(cljs.core.array_QMARK_(eid)){
var G__52645 \x3d db;
var G__52646 \x3d cljs.core.array_seq.cljs$core$IFn$_invoke$arity$1(eid);
db \x3d G__52645;
eid \x3d G__52646;
continue;
} else {
if((eid instanceof cljs.core.Keyword)){
return new cljs.core.Keyword(null,\x22e\x22,\x22e\x22,1381269198).cljs$core$IFn$_invoke$arity$1(cljs.core.first(datascript.db._datoms(db,new cljs.core.Keyword(null,\x22avet\x22,\x22avet\x22,1383857032),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22db\x22,\x22ident\x22,\x22db/ident\x22,-737096),eid], null))));
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22Expected number or lookup ref for entity id, got \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([eid], 0))].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22entity-id\x22,\x22syntax\x22,\x22entity-id/syntax\x22,1921317045),new cljs.core.Keyword(null,\x22entity-id\x22,\x22entity-id\x22,1485898093),eid], null));

}
}
}
}
break;
}
});
datascript.db.entid_strict \x3d (function datascript$db$entid_strict(db,eid){
var or__5045__auto__ \x3d datascript.db.entid(db,eid);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22Nothing found for entity id \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([eid], 0))].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22entity-id\x22,\x22missing\x22,\x22entity-id/missing\x22,1234588374),new cljs.core.Keyword(null,\x22entity-id\x22,\x22entity-id\x22,1485898093),eid], null));
}
});
datascript.db.entid_some \x3d (function datascript$db$entid_some(db,eid){
if(cljs.core.truth_(eid)){
return datascript.db.entid_strict(db,eid);
} else {
return null;
}
});
datascript.db.validate_datom \x3d (function datascript$db$validate_datom(db,datom){
if(cljs.core.truth_((function (){var and__5043__auto__ \x3d datom.datascript$db$IDatom$datom_added$arity$1(null);
if(cljs.core.truth_(and__5043__auto__)){
return datascript.db.is_attr_QMARK_(db,datom.a,new cljs.core.Keyword(\x22db\x22,\x22unique\x22,\x22db/unique\x22,329396388));
} else {
return and__5043__auto__;
}
})())){
var temp__5808__auto__ \x3d cljs.core.not_empty(datascript.db._datoms(db,new cljs.core.Keyword(null,\x22avet\x22,\x22avet\x22,1383857032),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [datom.a,datom.v], null)));
if((temp__5808__auto__ \x3d\x3d null)){
return null;
} else {
var found \x3d temp__5808__auto__;
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22Cannot add \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([datom], 0)),\x22 because of unique constraint: \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([found], 0))].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22transact\x22,\x22unique\x22,\x22transact/unique\x22,-940992320),new cljs.core.Keyword(null,\x22attribute\x22,\x22attribute\x22,-2074029119),datom.a,new cljs.core.Keyword(null,\x22datom\x22,\x22datom\x22,-371556090),datom], null));
}
} else {
return null;
}
});
datascript.db.validate_attr \x3d (function datascript$db$validate_attr(attr,at){
if((((attr instanceof cljs.core.Keyword)) || (typeof attr \x3d\x3d\x3d \x27string\x27))){
return null;
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22Bad entity attribute \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([attr], 0)),\x22 at \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([at], 0)),\x22, expected keyword or string\x22].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22transact\x22,\x22syntax\x22,\x22transact/syntax\x22,-299207078),new cljs.core.Keyword(null,\x22attribute\x22,\x22attribute\x22,-2074029119),attr,new cljs.core.Keyword(null,\x22context\x22,\x22context\x22,-830191113),at], null));
}
});
datascript.db.validate_val \x3d (function datascript$db$validate_val(v,at){
if((v \x3d\x3d null)){
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22Cannot store nil as a value at \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([at], 0))].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22transact\x22,\x22syntax\x22,\x22transact/syntax\x22,-299207078),new cljs.core.Keyword(null,\x22value\x22,\x22value\x22,305978217),v,new cljs.core.Keyword(null,\x22context\x22,\x22context\x22,-830191113),at], null));
} else {
return null;
}
});
datascript.db.current_tx \x3d (function datascript$db$current_tx(report){
return (cljs.core.get_in.cljs$core$IFn$_invoke$arity$2(report,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22db-before\x22,\x22db-before\x22,-553691536),new cljs.core.Keyword(null,\x22max-tx\x22,\x22max-tx\x22,1119558339)], null)) + (1));
});
datascript.db.next_eid \x3d (function datascript$db$next_eid(db){
return (new cljs.core.Keyword(null,\x22max-eid\x22,\x22max-eid\x22,2134868075).cljs$core$IFn$_invoke$arity$1(db) + (1));
});
datascript.db.tx_id_QMARK_ \x3d (function datascript$db$tx_id_QMARK_(e){
return ((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(e,new cljs.core.Keyword(\x22db\x22,\x22current-tx\x22,\x22db/current-tx\x22,1600722132))) || (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(e,\x22:db/current-tx\x22)) || (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(e,\x22datomic.tx\x22)) || (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(e,\x22datascript.tx\x22)))))));
});
datascript.db.tempid_QMARK_ \x3d (function datascript$db$tempid_QMARK_(x){
return ((((typeof x \x3d\x3d\x3d \x27number\x27) \x26\x26 ((x \x3c (0))))) || (typeof x \x3d\x3d\x3d \x27string\x27));
});
datascript.db.new_eid_QMARK_ \x3d (function datascript$db$new_eid_QMARK_(db,eid){
return (((eid \x3e new cljs.core.Keyword(null,\x22max-eid\x22,\x22max-eid\x22,2134868075).cljs$core$IFn$_invoke$arity$1(db))) \x26\x26 ((eid \x3c (536870912))));
});
datascript.db.advance_max_eid \x3d (function datascript$db$advance_max_eid(db,eid){
var G__51993 \x3d db;
if(datascript.db.new_eid_QMARK_(db,eid)){
return cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(G__51993,new cljs.core.Keyword(null,\x22max-eid\x22,\x22max-eid\x22,2134868075),eid);
} else {
return G__51993;
}
});
datascript.db.allocate_eid \x3d (function datascript$db$allocate_eid(var_args){
var G__51995 \x3d arguments.length;
switch (G__51995) {
case 2:
return datascript.db.allocate_eid.cljs$core$IFn$_invoke$arity$2((arguments[(0)]),(arguments[(1)]));

break;
case 3:
return datascript.db.allocate_eid.cljs$core$IFn$_invoke$arity$3((arguments[(0)]),(arguments[(1)]),(arguments[(2)]));

break;
default:
throw (new Error([\x22Invalid arity: \x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1(arguments.length)].join(\x27\x27)));

}
});

(datascript.db.allocate_eid.cljs$core$IFn$_invoke$arity$2 \x3d (function (report,eid){
return cljs.core.update.cljs$core$IFn$_invoke$arity$4(report,new cljs.core.Keyword(null,\x22db-after\x22,\x22db-after\x22,-571884666),datascript.db.advance_max_eid,eid);
}));

(datascript.db.allocate_eid.cljs$core$IFn$_invoke$arity$3 \x3d (function (report,e,eid){
var G__51996 \x3d report;
var G__51996__$1 \x3d ((datascript.db.tx_id_QMARK_(e))?cljs.core.update.cljs$core$IFn$_invoke$arity$5(G__51996,new cljs.core.Keyword(null,\x22tempids\x22,\x22tempids\x22,1767509089),cljs.core.assoc,e,eid):G__51996);
var G__51996__$2 \x3d ((datascript.db.tempid_QMARK_(e))?cljs.core.update.cljs$core$IFn$_invoke$arity$5(G__51996__$1,new cljs.core.Keyword(null,\x22tempids\x22,\x22tempids\x22,1767509089),cljs.core.assoc,e,eid):G__51996__$1);
var G__51996__$3 \x3d (((((!(datascript.db.tempid_QMARK_(e)))) \x26\x26 (datascript.db.new_eid_QMARK_(new cljs.core.Keyword(null,\x22db-after\x22,\x22db-after\x22,-571884666).cljs$core$IFn$_invoke$arity$1(report),eid))))?cljs.core.update.cljs$core$IFn$_invoke$arity$5(G__51996__$2,new cljs.core.Keyword(null,\x22tempids\x22,\x22tempids\x22,1767509089),cljs.core.assoc,eid,eid):G__51996__$2);
return cljs.core.update.cljs$core$IFn$_invoke$arity$4(G__51996__$3,new cljs.core.Keyword(null,\x22db-after\x22,\x22db-after\x22,-571884666),datascript.db.advance_max_eid,eid);

}));

(datascript.db.allocate_eid.cljs$lang$maxFixedArity \x3d 3);

datascript.db.with_datom \x3d (function datascript$db$with_datom(db,datom){
datascript.db.validate_datom(db,datom);

var indexing_QMARK_ \x3d datascript.db.indexing_QMARK_(db,datom.a);
if(cljs.core.truth_(datom.datascript$db$IDatom$datom_added$arity$1(null))){
var G__51997 \x3d db;
var G__51997__$1 \x3d cljs.core.update.cljs$core$IFn$_invoke$arity$5(G__51997,new cljs.core.Keyword(null,\x22eavt\x22,\x22eavt\x22,-666437073),me.tonsky.persistent_sorted_set.conj,datom,datascript.db.cmp_datoms_eavt_quick)
;
var G__51997__$2 \x3d cljs.core.update.cljs$core$IFn$_invoke$arity$5(G__51997__$1,new cljs.core.Keyword(null,\x22aevt\x22,\x22aevt\x22,-585148059),me.tonsky.persistent_sorted_set.conj,datom,datascript.db.cmp_datoms_aevt_quick)
;
var G__51997__$3 \x3d ((indexing_QMARK_)?cljs.core.update.cljs$core$IFn$_invoke$arity$5(G__51997__$2,new cljs.core.Keyword(null,\x22avet\x22,\x22avet\x22,1383857032),me.tonsky.persistent_sorted_set.conj,datom,datascript.db.cmp_datoms_avet_quick):G__51997__$2);
var G__51997__$4 \x3d datascript.db.advance_max_eid(G__51997__$3,datom.e)
;
return cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(G__51997__$4,new cljs.core.Keyword(null,\x22hash\x22,\x22hash\x22,-13781596),cljs.core.atom.cljs$core$IFn$_invoke$arity$1((0)));

} else {
var temp__5806__auto__ \x3d datascript.db.fsearch(db,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [datom.e,datom.a,datom.v], null));
if((temp__5806__auto__ \x3d\x3d null)){
return db;
} else {
var removing \x3d temp__5806__auto__;
var G__51998 \x3d db;
var G__51998__$1 \x3d cljs.core.update.cljs$core$IFn$_invoke$arity$5(G__51998,new cljs.core.Keyword(null,\x22eavt\x22,\x22eavt\x22,-666437073),me.tonsky.persistent_sorted_set.disj,removing,datascript.db.cmp_datoms_eavt_quick)
;
var G__51998__$2 \x3d cljs.core.update.cljs$core$IFn$_invoke$arity$5(G__51998__$1,new cljs.core.Keyword(null,\x22aevt\x22,\x22aevt\x22,-585148059),me.tonsky.persistent_sorted_set.disj,removing,datascript.db.cmp_datoms_aevt_quick)
;
var G__51998__$3 \x3d ((indexing_QMARK_)?cljs.core.update.cljs$core$IFn$_invoke$arity$5(G__51998__$2,new cljs.core.Keyword(null,\x22avet\x22,\x22avet\x22,1383857032),me.tonsky.persistent_sorted_set.disj,removing,datascript.db.cmp_datoms_avet_quick):G__51998__$2);
return cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(G__51998__$3,new cljs.core.Keyword(null,\x22hash\x22,\x22hash\x22,-13781596),cljs.core.atom.cljs$core$IFn$_invoke$arity$1((0)));

}
}
});
datascript.db.queue_tuple \x3d (function datascript$db$queue_tuple(queue,tuple,idx,db,e,a,v){
var tuple_value \x3d (function (){var or__5045__auto__ \x3d cljs.core.get.cljs$core$IFn$_invoke$arity$2(queue,tuple);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
var or__5045__auto____$1 \x3d new cljs.core.Keyword(null,\x22v\x22,\x22v\x22,21465059).cljs$core$IFn$_invoke$arity$1(cljs.core.first(datascript.db._datoms(db,new cljs.core.Keyword(null,\x22eavt\x22,\x22eavt\x22,-666437073),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [e,tuple], null))));
if(cljs.core.truth_(or__5045__auto____$1)){
return or__5045__auto____$1;
} else {
return cljs.core.vec(cljs.core.repeat.cljs$core$IFn$_invoke$arity$2(cljs.core.count(new cljs.core.Keyword(\x22db\x22,\x22tupleAttrs\x22,\x22db/tupleAttrs\x22,250080092).cljs$core$IFn$_invoke$arity$1(cljs.core.get.cljs$core$IFn$_invoke$arity$2(datascript.db._schema(db),tuple))),null));
}
}
})();
var tuple_value_SINGLEQUOTE_ \x3d cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(tuple_value,idx,v);
return cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(queue,tuple,tuple_value_SINGLEQUOTE_);
});
datascript.db.queue_tuples \x3d (function datascript$db$queue_tuples(queue,tuples,db,e,a,v){
return cljs.core.reduce_kv((function (queue__$1,tuple,idx){
return datascript.db.queue_tuple(queue__$1,tuple,idx,db,e,a,v);
}),queue,tuples);
});
datascript.db.transact_report \x3d (function datascript$db$transact_report(report,datom){
var db \x3d new cljs.core.Keyword(null,\x22db-after\x22,\x22db-after\x22,-571884666).cljs$core$IFn$_invoke$arity$1(report);
var a \x3d new cljs.core.Keyword(null,\x22a\x22,\x22a\x22,-2123407586).cljs$core$IFn$_invoke$arity$1(datom);
var report_SINGLEQUOTE_ \x3d cljs.core.update.cljs$core$IFn$_invoke$arity$4(cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(report,new cljs.core.Keyword(null,\x22db-after\x22,\x22db-after\x22,-571884666),datascript.db.with_datom(db,datom)),new cljs.core.Keyword(null,\x22tx-data\x22,\x22tx-data\x22,934159761),cljs.core.conj,datom);
if(datascript.db.tuple_source_QMARK_(db,a)){
var e \x3d new cljs.core.Keyword(null,\x22e\x22,\x22e\x22,1381269198).cljs$core$IFn$_invoke$arity$1(datom);
var v \x3d (cljs.core.truth_(datascript.db.datom_added(datom))?new cljs.core.Keyword(null,\x22v\x22,\x22v\x22,21465059).cljs$core$IFn$_invoke$arity$1(datom):null);
var queue \x3d (function (){var or__5045__auto__ \x3d cljs.core.get.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(\x22datascript.db\x22,\x22queued-tuples\x22,\x22datascript.db/queued-tuples\x22,-762852029).cljs$core$IFn$_invoke$arity$1(report_SINGLEQUOTE_),e);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return cljs.core.PersistentArrayMap.EMPTY;
}
})();
var tuples \x3d cljs.core.get.cljs$core$IFn$_invoke$arity$2(datascript.db._attrs_by(db,new cljs.core.Keyword(\x22db\x22,\x22attrTuples\x22,\x22db/attrTuples\x22,860541631)),a);
var queue_SINGLEQUOTE_ \x3d datascript.db.queue_tuples(queue,tuples,db,e,a,v);
return cljs.core.update.cljs$core$IFn$_invoke$arity$5(report_SINGLEQUOTE_,new cljs.core.Keyword(\x22datascript.db\x22,\x22queued-tuples\x22,\x22datascript.db/queued-tuples\x22,-762852029),cljs.core.assoc,e,queue_SINGLEQUOTE_);
} else {
return report_SINGLEQUOTE_;
}
});
datascript.db.reverse_ref_QMARK_ \x3d (function datascript$db$reverse_ref_QMARK_(attr){
if((attr instanceof cljs.core.Keyword)){
return cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(\x22_\x22,cljs.core.nth.cljs$core$IFn$_invoke$arity$2(cljs.core.name(attr),(0)));
} else {
if(typeof attr \x3d\x3d\x3d \x27string\x27){
return cljs.core.boolean$(cljs.core.re_matches(/(?:([^\\/]+)\\/)?_([^\\/]+)/,attr));
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22Bad attribute type: \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([attr], 0)),\x22, expected keyword or string\x22].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22transact\x22,\x22syntax\x22,\x22transact/syntax\x22,-299207078),new cljs.core.Keyword(null,\x22attribute\x22,\x22attribute\x22,-2074029119),attr], null));

}
}
});
datascript.db.reverse_ref \x3d (function datascript$db$reverse_ref(attr){
if((attr instanceof cljs.core.Keyword)){
if(datascript.db.reverse_ref_QMARK_(attr)){
return cljs.core.keyword.cljs$core$IFn$_invoke$arity$2(cljs.core.namespace(attr),cljs.core.subs.cljs$core$IFn$_invoke$arity$2(cljs.core.name(attr),(1)));
} else {
return cljs.core.keyword.cljs$core$IFn$_invoke$arity$2(cljs.core.namespace(attr),[\x22_\x22,cljs.core.name(attr)].join(\x27\x27));
}
} else {
if(typeof attr \x3d\x3d\x3d \x27string\x27){
var vec__51999 \x3d cljs.core.re_matches(/(?:([^\\/]+)\\/)?([^\\/]+)/,attr);
var _ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__51999,(0),null);
var ns \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__51999,(1),null);
var name \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__51999,(2),null);
if(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(\x22_\x22,cljs.core.nth.cljs$core$IFn$_invoke$arity$2(name,(0)))){
if(cljs.core.truth_(ns)){
return [cljs.core.str.cljs$core$IFn$_invoke$arity$1(ns),\x22/\x22,cljs.core.subs.cljs$core$IFn$_invoke$arity$2(name,(1))].join(\x27\x27);
} else {
return cljs.core.subs.cljs$core$IFn$_invoke$arity$2(name,(1));
}
} else {
if(cljs.core.truth_(ns)){
return [cljs.core.str.cljs$core$IFn$_invoke$arity$1(ns),\x22/_\x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1(name)].join(\x27\x27);
} else {
return [\x22_\x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1(name)].join(\x27\x27);
}
}
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22Bad attribute type: \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([attr], 0)),\x22, expected keyword or string\x22].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22transact\x22,\x22syntax\x22,\x22transact/syntax\x22,-299207078),new cljs.core.Keyword(null,\x22attribute\x22,\x22attribute\x22,-2074029119),attr], null));

}
}
});
/**
 * Returns [entity\x27 upserts]. Upsert attributes that resolve to existing entities
 * are removed from entity, rest are kept in entity for insertion. No validation is performed.
 * 
 * upserts :: {:name  {\x22Ivan\x22  1}
 *             :email {\x22ivan@\x22 2}
 *             :alias {\x22abc\x22   3
 *                     \x22def\x22   4}}}
 */
datascript.db.resolve_upserts \x3d (function datascript$db$resolve_upserts(db,entity){
var temp__5806__auto__ \x3d cljs.core.not_empty(datascript.db._attrs_by(db,new cljs.core.Keyword(\x22db.unique\x22,\x22identity\x22,\x22db.unique/identity\x22,1675950722)));
if((temp__5806__auto__ \x3d\x3d null)){
return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [entity,null], null);
} else {
var idents \x3d temp__5806__auto__;
var resolve \x3d (function (a,v){
return new cljs.core.Keyword(null,\x22e\x22,\x22e\x22,1381269198).cljs$core$IFn$_invoke$arity$1(cljs.core.first(datascript.db._datoms(db,new cljs.core.Keyword(null,\x22avet\x22,\x22avet\x22,1383857032),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [a,v], null))));
});
var split \x3d (function (a,vs){
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (acc,v){
var temp__5806__auto____$1 \x3d resolve(a,v);
if((temp__5806__auto____$1 \x3d\x3d null)){
return cljs.core.update.cljs$core$IFn$_invoke$arity$4(acc,(0),cljs.core.conj,v);
} else {
var e \x3d temp__5806__auto____$1;
return cljs.core.update.cljs$core$IFn$_invoke$arity$5(acc,(1),cljs.core.assoc,v,e);
}
}),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.PersistentVector.EMPTY,cljs.core.PersistentArrayMap.EMPTY], null),vs);
});
return cljs.core.reduce_kv((function (p__52002,a,v){
var vec__52003 \x3d p__52002;
var entity__$1 \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52003,(0),null);
var upserts \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52003,(1),null);
if((!(cljs.core.contains_QMARK_(idents,a)))){
return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(entity__$1,a,v),upserts], null);
} else {
if(((datascript.db.multival_QMARK_(db,a)) \x26\x26 (((me.tonsky.persistent_sorted_set.arrays.array_QMARK_(v)) || (((cljs.core.coll_QMARK_(v)) \x26\x26 ((!(cljs.core.map_QMARK_(v)))))))))){
var vec__52006 \x3d split(a,v);
var insert \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52006,(0),null);
var upsert \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52006,(1),null);
return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(function (){var G__52009 \x3d entity__$1;
if((!(cljs.core.empty_QMARK_(insert)))){
return cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(G__52009,a,insert);
} else {
return G__52009;
}
})(),(function (){var G__52010 \x3d upserts;
if((!(cljs.core.empty_QMARK_(upsert)))){
return cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(G__52010,a,upsert);
} else {
return G__52010;
}
})()], null);
} else {
var temp__5806__auto____$1 \x3d resolve(a,v);
if((temp__5806__auto____$1 \x3d\x3d null)){
return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(entity__$1,a,v),upserts], null);
} else {
var e \x3d temp__5806__auto____$1;
return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [entity__$1,cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(upserts,a,cljs.core.PersistentArrayMap.createAsIfByAssoc([v,e]))], null);
}

}
}
}),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.PersistentArrayMap.EMPTY,cljs.core.PersistentArrayMap.EMPTY], null),entity);
}
});
/**
 * Throws if not all upserts point to the same entity. 
 * Returns single eid that all upserts point to, or null.
 */
datascript.db.validate_upserts \x3d (function datascript$db$validate_upserts(entity,upserts){
var upsert_ids \x3d cljs.core.reduce_kv((function (m,a,v__GT_e){
return cljs.core.reduce_kv((function (m__$1,v,e){
return cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(m__$1,e,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [a,v], null));
}),m,v__GT_e);
}),cljs.core.PersistentArrayMap.EMPTY,upserts);
if(((2) \x3c\x3d cljs.core.count(upsert_ids))){
var vec__52011 \x3d cljs.core.first(upsert_ids);
var e1 \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52011,(0),null);
var vec__52014 \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52011,(1),null);
var a1 \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52014,(0),null);
var v1 \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52014,(1),null);
var vec__52017 \x3d cljs.core.second(upsert_ids);
var e2 \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52017,(0),null);
var vec__52020 \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52017,(1),null);
var a2 \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52020,(0),null);
var v2 \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52020,(1),null);
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22Conflicting upserts: \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [a1,v1], null)], 0)),\x22 resolves to \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([e1], 0)),\x22, but \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [a2,v2], null)], 0)),\x22 resolves to \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([e2], 0))].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22transact\x22,\x22upsert\x22,\x22transact/upsert\x22,412688078),new cljs.core.Keyword(null,\x22assertion\x22,\x22assertion\x22,-1645134882),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [e1,a1,v1], null),new cljs.core.Keyword(null,\x22conflict\x22,\x22conflict\x22,1978796605),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [e2,a2,v2], null)], null));
} else {
var vec__52023 \x3d cljs.core.first(upsert_ids);
var upsert_id \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52023,(0),null);
var vec__52026 \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52023,(1),null);
var a \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52026,(0),null);
var v \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52026,(1),null);
var eid \x3d new cljs.core.Keyword(\x22db\x22,\x22id\x22,\x22db/id\x22,-1388397098).cljs$core$IFn$_invoke$arity$1(entity);
if((((!((upsert_id \x3d\x3d null)))) \x26\x26 ((((!((eid \x3d\x3d null)))) \x26\x26 ((((!(datascript.db.tempid_QMARK_(eid)))) \x26\x26 (cljs.core.not_EQ_.cljs$core$IFn$_invoke$arity$2(upsert_id,eid)))))))){
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22Conflicting upsert: \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [a,v], null)], 0)),\x22 resolves to \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([upsert_id], 0)),\x22, but entity already has :db/id \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([eid], 0))].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22transact\x22,\x22upsert\x22,\x22transact/upsert\x22,412688078),new cljs.core.Keyword(null,\x22assertion\x22,\x22assertion\x22,-1645134882),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [upsert_id,a,v], null),new cljs.core.Keyword(null,\x22conflict\x22,\x22conflict\x22,1978796605),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(\x22db\x22,\x22id\x22,\x22db/id\x22,-1388397098),eid], null)], null));
} else {
}

return upsert_id;
}
});
datascript.db.maybe_wrap_multival \x3d (function datascript$db$maybe_wrap_multival(db,a,vs){
if((!(((datascript.db.reverse_ref_QMARK_(a)) || (datascript.db.multival_QMARK_(db,a)))))){
return new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [vs], null);
} else {
if((!(((me.tonsky.persistent_sorted_set.arrays.array_QMARK_(vs)) || (((cljs.core.coll_QMARK_(vs)) \x26\x26 ((!(cljs.core.map_QMARK_(vs)))))))))){
return new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [vs], null);
} else {
if(((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(cljs.core.count(vs),(2))) \x26\x26 (datascript.db.is_attr_QMARK_(db,cljs.core.first(vs),new cljs.core.Keyword(\x22db.unique\x22,\x22identity\x22,\x22db.unique/identity\x22,1675950722))))){
return new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [vs], null);
} else {
return vs;

}
}
}
});
datascript.db.explode \x3d (function datascript$db$explode(db,entity){
var eid \x3d new cljs.core.Keyword(\x22db\x22,\x22id\x22,\x22db/id\x22,-1388397098).cljs$core$IFn$_invoke$arity$1(entity);
var a_PLUS_vs \x3d cljs.core.apply.cljs$core$IFn$_invoke$arity$2(cljs.core.concat,cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (acc,p__52029){
var vec__52030 \x3d p__52029;
var a \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52030,(0),null);
var vs \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52030,(1),null);
return cljs.core.update.cljs$core$IFn$_invoke$arity$4(acc,((datascript.db.tuple_QMARK_(db,a))?(1):(0)),cljs.core.conj,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [a,vs], null));
}),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.PersistentVector.EMPTY,cljs.core.PersistentVector.EMPTY], null),entity));
var iter__5523__auto__ \x3d (function datascript$db$explode_$_iter__52033(s__52034){
return (new cljs.core.LazySeq(null,(function (){
var s__52034__$1 \x3d s__52034;
while(true){
var temp__5804__auto__ \x3d cljs.core.seq(s__52034__$1);
if(temp__5804__auto__){
var xs__6360__auto__ \x3d temp__5804__auto__;
var vec__52039 \x3d cljs.core.first(xs__6360__auto__);
var a \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52039,(0),null);
var vs \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52039,(1),null);
if(cljs.core.not_EQ_.cljs$core$IFn$_invoke$arity$2(a,new cljs.core.Keyword(\x22db\x22,\x22id\x22,\x22db/id\x22,-1388397098))){
var _ \x3d datascript.db.validate_attr(a,cljs.core.PersistentArrayMap.createAsIfByAssoc([new cljs.core.Keyword(\x22db\x22,\x22id\x22,\x22db/id\x22,-1388397098),eid,a,vs]));
var reverse_QMARK_ \x3d datascript.db.reverse_ref_QMARK_(a);
var straight_a \x3d ((reverse_QMARK_)?datascript.db.reverse_ref(a):a);
var ___$1 \x3d ((((reverse_QMARK_) \x26\x26 ((!(datascript.db.ref_QMARK_(db,straight_a))))))?(function(){throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22Bad attribute \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([a], 0)),\x22: reverse attribute name requires {:db/valueType :db.type/ref} in schema\x22].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22transact\x22,\x22syntax\x22,\x22transact/syntax\x22,-299207078),new cljs.core.Keyword(null,\x22attribute\x22,\x22attribute\x22,-2074029119),a,new cljs.core.Keyword(null,\x22context\x22,\x22context\x22,-830191113),cljs.core.PersistentArrayMap.createAsIfByAssoc([new cljs.core.Keyword(\x22db\x22,\x22id\x22,\x22db/id\x22,-1388397098),eid,a,vs])], null))})():null);
var iterys__5519__auto__ \x3d ((function (s__52034__$1,_,reverse_QMARK_,straight_a,___$1,vec__52039,a,vs,xs__6360__auto__,temp__5804__auto__,eid,a_PLUS_vs){
return (function datascript$db$explode_$_iter__52033_$_iter__52035(s__52036){
return (new cljs.core.LazySeq(null,((function (s__52034__$1,_,reverse_QMARK_,straight_a,___$1,vec__52039,a,vs,xs__6360__auto__,temp__5804__auto__,eid,a_PLUS_vs){
return (function (){
var s__52036__$1 \x3d s__52036;
while(true){
var temp__5804__auto____$1 \x3d cljs.core.seq(s__52036__$1);
if(temp__5804__auto____$1){
var s__52036__$2 \x3d temp__5804__auto____$1;
if(cljs.core.chunked_seq_QMARK_(s__52036__$2)){
var c__5521__auto__ \x3d cljs.core.chunk_first(s__52036__$2);
var size__5522__auto__ \x3d cljs.core.count(c__5521__auto__);
var b__52038 \x3d cljs.core.chunk_buffer(size__5522__auto__);
if((function (){var i__52037 \x3d (0);
while(true){
if((i__52037 \x3c size__5522__auto__)){
var v \x3d cljs.core._nth(c__5521__auto__,i__52037);
cljs.core.chunk_append(b__52038,((((datascript.db.ref_QMARK_(db,straight_a)) \x26\x26 (cljs.core.map_QMARK_(v))))?cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(v,datascript.db.reverse_ref(a),eid):((reverse_QMARK_)?new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22db\x22,\x22add\x22,\x22db/add\x22,235286841),v,straight_a,eid], null):new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22db\x22,\x22add\x22,\x22db/add\x22,235286841),eid,straight_a,v], null))));

var G__52723 \x3d (i__52037 + (1));
i__52037 \x3d G__52723;
continue;
} else {
return true;
}
break;
}
})()){
return cljs.core.chunk_cons(cljs.core.chunk(b__52038),datascript$db$explode_$_iter__52033_$_iter__52035(cljs.core.chunk_rest(s__52036__$2)));
} else {
return cljs.core.chunk_cons(cljs.core.chunk(b__52038),null);
}
} else {
var v \x3d cljs.core.first(s__52036__$2);
return cljs.core.cons(((((datascript.db.ref_QMARK_(db,straight_a)) \x26\x26 (cljs.core.map_QMARK_(v))))?cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(v,datascript.db.reverse_ref(a),eid):((reverse_QMARK_)?new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22db\x22,\x22add\x22,\x22db/add\x22,235286841),v,straight_a,eid], null):new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22db\x22,\x22add\x22,\x22db/add\x22,235286841),eid,straight_a,v], null))),datascript$db$explode_$_iter__52033_$_iter__52035(cljs.core.rest(s__52036__$2)));
}
} else {
return null;
}
break;
}
});})(s__52034__$1,_,reverse_QMARK_,straight_a,___$1,vec__52039,a,vs,xs__6360__auto__,temp__5804__auto__,eid,a_PLUS_vs))
,null,null));
});})(s__52034__$1,_,reverse_QMARK_,straight_a,___$1,vec__52039,a,vs,xs__6360__auto__,temp__5804__auto__,eid,a_PLUS_vs))
;
var fs__5520__auto__ \x3d cljs.core.seq(iterys__5519__auto__(datascript.db.maybe_wrap_multival(db,a,vs)));
if(fs__5520__auto__){
return cljs.core.concat.cljs$core$IFn$_invoke$arity$2(fs__5520__auto__,datascript$db$explode_$_iter__52033(cljs.core.rest(s__52034__$1)));
} else {
var G__52726 \x3d cljs.core.rest(s__52034__$1);
s__52034__$1 \x3d G__52726;
continue;
}
} else {
var G__52727 \x3d cljs.core.rest(s__52034__$1);
s__52034__$1 \x3d G__52727;
continue;
}
} else {
return null;
}
break;
}
}),null,null));
});
return iter__5523__auto__(a_PLUS_vs);
});
datascript.db.transact_add \x3d (function datascript$db$transact_add(report,p__52042){
var vec__52043 \x3d p__52042;
var _ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52043,(0),null);
var e \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52043,(1),null);
var a \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52043,(2),null);
var v \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52043,(3),null);
var tx \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52043,(4),null);
var ent \x3d vec__52043;
datascript.db.validate_attr(a,ent);

datascript.db.validate_val(v,ent);

var tx__$1 \x3d (function (){var or__5045__auto__ \x3d tx;
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return datascript.db.current_tx(report);
}
})();
var db \x3d new cljs.core.Keyword(null,\x22db-after\x22,\x22db-after\x22,-571884666).cljs$core$IFn$_invoke$arity$1(report);
var e__$1 \x3d datascript.db.entid_strict(db,e);
var v__$1 \x3d ((datascript.db.ref_QMARK_(db,a))?datascript.db.entid_strict(db,v):v);
var new_datom \x3d datascript.db.datom.cljs$core$IFn$_invoke$arity$4(e__$1,a,v__$1,tx__$1);
var multival_QMARK_ \x3d datascript.db.multival_QMARK_(db,a);
var old_datom \x3d ((multival_QMARK_)?datascript.db.fsearch(db,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [e__$1,a,v__$1], null)):datascript.db.fsearch(db,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [e__$1,a], null)));
if((old_datom \x3d\x3d null)){
return datascript.db.transact_report(report,new_datom);
} else {
if(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(old_datom.v,v__$1)){
return cljs.core.update.cljs$core$IFn$_invoke$arity$4(report,new cljs.core.Keyword(\x22datascript.db\x22,\x22tx-redundant\x22,\x22datascript.db/tx-redundant\x22,-1117921977),datascript.db.conjv,new_datom);
} else {
return datascript.db.transact_report(datascript.db.transact_report(report,datascript.db.datom.cljs$core$IFn$_invoke$arity$5(e__$1,a,old_datom.v,tx__$1,false)),new_datom);

}
}
});
datascript.db.transact_retract_datom \x3d (function datascript$db$transact_retract_datom(report,d){
var tx \x3d datascript.db.current_tx(report);
return datascript.db.transact_report(report,datascript.db.datom.cljs$core$IFn$_invoke$arity$5(d.e,d.a,d.v,tx,false));
});
datascript.db.retract_components \x3d (function datascript$db$retract_components(db,datoms){
return cljs.core.into.cljs$core$IFn$_invoke$arity$3(cljs.core.PersistentHashSet.EMPTY,cljs.core.comp.cljs$core$IFn$_invoke$arity$2(cljs.core.filter.cljs$core$IFn$_invoke$arity$1((function (d){
return datascript.db.component_QMARK_(db,d.a);
})),cljs.core.map.cljs$core$IFn$_invoke$arity$1((function (d){
return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22db.fn\x22,\x22retractEntity\x22,\x22db.fn/retractEntity\x22,-1423535441),d.v], null);
}))),datoms);
});
datascript.db.retry_with_tempid \x3d (function datascript$db$retry_with_tempid(initial_report,report,es,tempid,upserted_eid){
if(cljs.core.contains_QMARK_(new cljs.core.Keyword(null,\x22tempids\x22,\x22tempids\x22,1767509089).cljs$core$IFn$_invoke$arity$1(initial_report),tempid)){
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22Conflicting upsert: \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([tempid], 0)),\x22 resolves\x22,\x22 both to \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([upserted_eid], 0)),\x22 and \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([cljs.core.get_in.cljs$core$IFn$_invoke$arity$2(initial_report,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22tempids\x22,\x22tempids\x22,1767509089),tempid], null))], 0))].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22transact\x22,\x22upsert\x22,\x22transact/upsert\x22,412688078)], null));
} else {
var tempids_SINGLEQUOTE_ \x3d cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(new cljs.core.Keyword(null,\x22tempids\x22,\x22tempids\x22,1767509089).cljs$core$IFn$_invoke$arity$1(report),tempid,upserted_eid);
var report_SINGLEQUOTE_ \x3d cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(initial_report,new cljs.core.Keyword(null,\x22tempids\x22,\x22tempids\x22,1767509089),tempids_SINGLEQUOTE_);
return (datascript.db.transact_tx_data.cljs$core$IFn$_invoke$arity$2 ? datascript.db.transact_tx_data.cljs$core$IFn$_invoke$arity$2(report_SINGLEQUOTE_,es) : datascript.db.transact_tx_data.call(null,report_SINGLEQUOTE_,es));
}
});
datascript.db.builtin_fn_QMARK_ \x3d new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 8, [new cljs.core.Keyword(\x22db.fn\x22,\x22call\x22,\x22db.fn/call\x22,-151594418),null,new cljs.core.Keyword(\x22db\x22,\x22cas\x22,\x22db/cas\x22,-451542322),null,new cljs.core.Keyword(\x22db.fn\x22,\x22retractEntity\x22,\x22db.fn/retractEntity\x22,-1423535441),null,new cljs.core.Keyword(\x22db\x22,\x22retractEntity\x22,\x22db/retractEntity\x22,-1452737935),null,new cljs.core.Keyword(\x22db\x22,\x22retract\x22,\x22db/retract\x22,-1549825231),null,new cljs.core.Keyword(\x22db.fn\x22,\x22retractAttribute\x22,\x22db.fn/retractAttribute\x22,937402164),null,new cljs.core.Keyword(\x22db.fn\x22,\x22cas\x22,\x22db.fn/cas\x22,-379352172),null,new cljs.core.Keyword(\x22db\x22,\x22add\x22,\x22db/add\x22,235286841),null], null), null);
datascript.db.flush_tuples \x3d (function datascript$db$flush_tuples(report){
var db \x3d new cljs.core.Keyword(null,\x22db-after\x22,\x22db-after\x22,-571884666).cljs$core$IFn$_invoke$arity$1(report);
var schema \x3d datascript.db._schema(db);
var attr_tuples \x3d datascript.db._attrs_by(db,new cljs.core.Keyword(\x22db\x22,\x22attrTuples\x22,\x22db/attrTuples\x22,860541631));
return cljs.core.reduce_kv((function (entities,eid,tuples_PLUS_values){
return cljs.core.reduce_kv((function (entities__$1,tuple,value){
var value__$1 \x3d ((cljs.core.every_QMARK_(cljs.core.nil_QMARK_,value))?null:value);
var current \x3d new cljs.core.Keyword(null,\x22v\x22,\x22v\x22,21465059).cljs$core$IFn$_invoke$arity$1(cljs.core.first(datascript.db._datoms(db,new cljs.core.Keyword(null,\x22eavt\x22,\x22eavt\x22,-666437073),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [eid,tuple], null))));
if(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(value__$1,current)){
return entities__$1;
} else {
if((value__$1 \x3d\x3d null)){
return cljs.core.conj.cljs$core$IFn$_invoke$arity$2(entities__$1,cljs.core.with_meta(new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22db\x22,\x22retract\x22,\x22db/retract\x22,-1549825231),eid,tuple,current], null),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(\x22datascript.db\x22,\x22internal\x22,\x22datascript.db/internal\x22,-249301114),true], null)));
} else {
return cljs.core.conj.cljs$core$IFn$_invoke$arity$2(entities__$1,cljs.core.with_meta(new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22db\x22,\x22add\x22,\x22db/add\x22,235286841),eid,tuple,value__$1], null),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(\x22datascript.db\x22,\x22internal\x22,\x22datascript.db/internal\x22,-249301114),true], null)));

}
}
}),entities,tuples_PLUS_values);
}),cljs.core.PersistentVector.EMPTY,new cljs.core.Keyword(\x22datascript.db\x22,\x22queued-tuples\x22,\x22datascript.db/queued-tuples\x22,-762852029).cljs$core$IFn$_invoke$arity$1(report));
});
datascript.db.check_value_tempids \x3d (function datascript$db$check_value_tempids(report){
var all_tempids \x3d new cljs.core.Keyword(\x22datascript.db\x22,\x22value-tempids\x22,\x22datascript.db/value-tempids\x22,244806162).cljs$core$IFn$_invoke$arity$1(report);
var reduce_fn \x3d (function (tempids,datom){
if(cljs.core.truth_(datascript.db.datom_added(datom))){
return cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(tempids,new cljs.core.Keyword(null,\x22e\x22,\x22e\x22,1381269198).cljs$core$IFn$_invoke$arity$1(datom));
} else {
return tempids;
}
});
var unused \x3d cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(reduce_fn,all_tempids,cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22tx-data\x22,\x22tx-data\x22,934159761).cljs$core$IFn$_invoke$arity$1(report),new cljs.core.Keyword(\x22datascript.db\x22,\x22tx-redundant\x22,\x22datascript.db/tx-redundant\x22,-1117921977).cljs$core$IFn$_invoke$arity$1(report)));
if(cljs.core.empty_QMARK_(unused)){
return cljs.core.dissoc.cljs$core$IFn$_invoke$arity$variadic(report,new cljs.core.Keyword(\x22datascript.db\x22,\x22value-tempids\x22,\x22datascript.db/value-tempids\x22,244806162),cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(\x22datascript.db\x22,\x22tx-redundant\x22,\x22datascript.db/tx-redundant\x22,-1117921977)], 0));
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22Tempids used only as value in transaction: \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([cljs.core.sort.cljs$core$IFn$_invoke$arity$1(cljs.core.vals(unused))], 0))].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22transact\x22,\x22syntax\x22,\x22transact/syntax\x22,-299207078),new cljs.core.Keyword(null,\x22tempids\x22,\x22tempids\x22,1767509089),unused], null));
}
});
datascript.db.transact_tx_data \x3d (function datascript$db$transact_tx_data(initial_report,initial_es){
if((((initial_es \x3d\x3d null)) || (cljs.core.sequential_QMARK_(initial_es)))){
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22Bad transaction data \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([initial_es], 0)),\x22, expected sequential collection\x22].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22transact\x22,\x22syntax\x22,\x22transact/syntax\x22,-299207078),new cljs.core.Keyword(null,\x22tx-data\x22,\x22tx-data\x22,934159761),initial_es], null));
}

var initial_report_SINGLEQUOTE_ \x3d initial_report;
var has_tuples_QMARK_ \x3d (!(cljs.core.empty_QMARK_(datascript.db._attrs_by(new cljs.core.Keyword(null,\x22db-after\x22,\x22db-after\x22,-571884666).cljs$core$IFn$_invoke$arity$1(initial_report),new cljs.core.Keyword(\x22db.type\x22,\x22tuple\x22,\x22db.type/tuple\x22,938234914)))));
var initial_es_SINGLEQUOTE_ \x3d ((has_tuples_QMARK_)?cljs.core.interleave.cljs$core$IFn$_invoke$arity$2(initial_es,cljs.core.repeat.cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword(\x22datascript.db\x22,\x22flush-tuples\x22,\x22datascript.db/flush-tuples\x22,-797350002))):initial_es);
var report \x3d initial_report_SINGLEQUOTE_;
var es \x3d initial_es_SINGLEQUOTE_;
while(true){
if(cljs.core.empty_QMARK_(es)){
return cljs.core.update.cljs$core$IFn$_invoke$arity$5(cljs.core.update.cljs$core$IFn$_invoke$arity$5(datascript.db.check_value_tempids(report),new cljs.core.Keyword(null,\x22tempids\x22,\x22tempids\x22,1767509089),cljs.core.assoc,new cljs.core.Keyword(\x22db\x22,\x22current-tx\x22,\x22db/current-tx\x22,1600722132),datascript.db.current_tx(report)),new cljs.core.Keyword(null,\x22db-after\x22,\x22db-after\x22,-571884666),cljs.core.update,new cljs.core.Keyword(null,\x22max-tx\x22,\x22max-tx\x22,1119558339),cljs.core.inc);
} else {
var vec__52068 \x3d es;
var seq__52069 \x3d cljs.core.seq(vec__52068);
var first__52070 \x3d cljs.core.first(seq__52069);
var seq__52069__$1 \x3d cljs.core.next(seq__52069);
var entity \x3d first__52070;
var entities \x3d seq__52069__$1;
if((entity \x3d\x3d null)){
var G__52756 \x3d report;
var G__52757 \x3d entities;
report \x3d G__52756;
es \x3d G__52757;
continue;
} else {
if(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(\x22datascript.db\x22,\x22flush-tuples\x22,\x22datascript.db/flush-tuples\x22,-797350002),entity)){
if(cljs.core.contains_QMARK_(report,new cljs.core.Keyword(\x22datascript.db\x22,\x22queued-tuples\x22,\x22datascript.db/queued-tuples\x22,-762852029))){
var G__52758 \x3d cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(report,new cljs.core.Keyword(\x22datascript.db\x22,\x22queued-tuples\x22,\x22datascript.db/queued-tuples\x22,-762852029));
var G__52759 \x3d cljs.core.concat.cljs$core$IFn$_invoke$arity$2(datascript.db.flush_tuples(report),entities);
report \x3d G__52758;
es \x3d G__52759;
continue;
} else {
var G__52763 \x3d report;
var G__52764 \x3d entities;
report \x3d G__52763;
es \x3d G__52764;
continue;
}
} else {
var db \x3d new cljs.core.Keyword(null,\x22db-after\x22,\x22db-after\x22,-571884666).cljs$core$IFn$_invoke$arity$1(report);
var tempids \x3d new cljs.core.Keyword(null,\x22tempids\x22,\x22tempids\x22,1767509089).cljs$core$IFn$_invoke$arity$1(report);
if(cljs.core.map_QMARK_(entity)){
var old_eid \x3d new cljs.core.Keyword(\x22db\x22,\x22id\x22,\x22db/id\x22,-1388397098).cljs$core$IFn$_invoke$arity$1(entity);
if(datascript.db.tx_id_QMARK_(old_eid)){
var id \x3d datascript.db.current_tx(report);
var G__52767 \x3d datascript.db.allocate_eid.cljs$core$IFn$_invoke$arity$3(report,old_eid,id);
var G__52768 \x3d cljs.core.cons(cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(entity,new cljs.core.Keyword(\x22db\x22,\x22id\x22,\x22db/id\x22,-1388397098),id),entities);
report \x3d G__52767;
es \x3d G__52768;
continue;
} else {
if(cljs.core.sequential_QMARK_(old_eid)){
var id \x3d datascript.db.entid_strict(db,old_eid);
var G__52769 \x3d report;
var G__52770 \x3d cljs.core.cons(cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(entity,new cljs.core.Keyword(\x22db\x22,\x22id\x22,\x22db/id\x22,-1388397098),id),entities);
report \x3d G__52769;
es \x3d G__52770;
continue;
} else {
var vec__52071 \x3d datascript.db.resolve_upserts(db,entity);
var entity_SINGLEQUOTE_ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52071,(0),null);
var upserts \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52071,(1),null);
var upserted_eid \x3d datascript.db.validate_upserts(entity_SINGLEQUOTE_,upserts);
if((!((upserted_eid \x3d\x3d null)))){
if(((datascript.db.tempid_QMARK_(old_eid)) \x26\x26 (((cljs.core.contains_QMARK_(tempids,old_eid)) \x26\x26 (cljs.core.not_EQ_.cljs$core$IFn$_invoke$arity$2(upserted_eid,cljs.core.get.cljs$core$IFn$_invoke$arity$2(tempids,old_eid))))))){
return datascript.db.retry_with_tempid(initial_report,report,initial_es,old_eid,upserted_eid);
} else {
var G__52771 \x3d cljs.core.update.cljs$core$IFn$_invoke$arity$4(datascript.db.allocate_eid.cljs$core$IFn$_invoke$arity$3(report,old_eid,upserted_eid),new cljs.core.Keyword(\x22datascript.db\x22,\x22tx-redundant\x22,\x22datascript.db/tx-redundant\x22,-1117921977),datascript.db.conjv,datascript.db.datom.cljs$core$IFn$_invoke$arity$4(upserted_eid,null,null,(536870912)));
var G__52772 \x3d cljs.core.concat.cljs$core$IFn$_invoke$arity$2(datascript.db.explode(db,cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(entity_SINGLEQUOTE_,new cljs.core.Keyword(\x22db\x22,\x22id\x22,\x22db/id\x22,-1388397098),upserted_eid)),entities);
report \x3d G__52771;
es \x3d G__52772;
continue;
}
} else {
if(((typeof old_eid \x3d\x3d\x3d \x27number\x27) || ((((old_eid \x3d\x3d null)) || (typeof old_eid \x3d\x3d\x3d \x27string\x27))))){
var new_eid \x3d (((old_eid \x3d\x3d null))?datascript.db.next_eid(db):((datascript.db.tempid_QMARK_(old_eid))?(function (){var or__5045__auto__ \x3d cljs.core.get.cljs$core$IFn$_invoke$arity$2(tempids,old_eid);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return datascript.db.next_eid(db);
}
})():old_eid
));
var new_entity \x3d cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(entity,new cljs.core.Keyword(\x22db\x22,\x22id\x22,\x22db/id\x22,-1388397098),new_eid);
var G__52775 \x3d datascript.db.allocate_eid.cljs$core$IFn$_invoke$arity$3(report,old_eid,new_eid);
var G__52776 \x3d cljs.core.concat.cljs$core$IFn$_invoke$arity$2(datascript.db.explode(db,new_entity),entities);
report \x3d G__52775;
es \x3d G__52776;
continue;
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22Expected number, string or lookup ref for :db/id, got \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([old_eid], 0))].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22entity-id\x22,\x22syntax\x22,\x22entity-id/syntax\x22,1921317045),new cljs.core.Keyword(null,\x22entity\x22,\x22entity\x22,-450970276),entity], null));

}
}
}
}
} else {
if(cljs.core.sequential_QMARK_(entity)){
var vec__52074 \x3d entity;
var op \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52074,(0),null);
var e \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52074,(1),null);
var a \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52074,(2),null);
var v \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52074,(3),null);
if(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(op,new cljs.core.Keyword(\x22db.fn\x22,\x22call\x22,\x22db.fn/call\x22,-151594418))){
var vec__52077 \x3d entity;
var seq__52078 \x3d cljs.core.seq(vec__52077);
var first__52079 \x3d cljs.core.first(seq__52078);
var seq__52078__$1 \x3d cljs.core.next(seq__52078);
var _ \x3d first__52079;
var first__52079__$1 \x3d cljs.core.first(seq__52078__$1);
var seq__52078__$2 \x3d cljs.core.next(seq__52078__$1);
var f \x3d first__52079__$1;
var args \x3d seq__52078__$2;
var G__52787 \x3d report;
var G__52788 \x3d cljs.core.concat.cljs$core$IFn$_invoke$arity$2(cljs.core.apply.cljs$core$IFn$_invoke$arity$3(f,db,args),entities);
report \x3d G__52787;
es \x3d G__52788;
continue;
} else {
if((((op instanceof cljs.core.Keyword)) \x26\x26 (cljs.core.not((datascript.db.builtin_fn_QMARK_.cljs$core$IFn$_invoke$arity$1 ? datascript.db.builtin_fn_QMARK_.cljs$core$IFn$_invoke$arity$1(op) : datascript.db.builtin_fn_QMARK_.call(null,op)))))){
var temp__5806__auto__ \x3d datascript.db.entid(db,op);
if((temp__5806__auto__ \x3d\x3d null)){
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22Can\\u2019t find entity for transaction fn \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([op], 0))].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22transact\x22,\x22syntax\x22,\x22transact/syntax\x22,-299207078),new cljs.core.Keyword(null,\x22operation\x22,\x22operation\x22,-1267664310),new cljs.core.Keyword(\x22db.fn\x22,\x22call\x22,\x22db.fn/call\x22,-151594418),new cljs.core.Keyword(null,\x22tx-data\x22,\x22tx-data\x22,934159761),entity], null));
} else {
var ident \x3d temp__5806__auto__;
var fun \x3d new cljs.core.Keyword(null,\x22v\x22,\x22v\x22,21465059).cljs$core$IFn$_invoke$arity$1(datascript.db.fsearch(db,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [ident,new cljs.core.Keyword(\x22db\x22,\x22fn\x22,\x22db/fn\x22,-1175261470)], null)));
var args \x3d cljs.core.next(entity);
if(cljs.core.fn_QMARK_(fun)){
var G__52791 \x3d report;
var G__52792 \x3d cljs.core.concat.cljs$core$IFn$_invoke$arity$2(cljs.core.apply.cljs$core$IFn$_invoke$arity$3(fun,db,args),entities);
report \x3d G__52791;
es \x3d G__52792;
continue;
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22Entity \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([op], 0)),\x22 expected to have :db/fn attribute with fn? value\x22].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22transact\x22,\x22syntax\x22,\x22transact/syntax\x22,-299207078),new cljs.core.Keyword(null,\x22operation\x22,\x22operation\x22,-1267664310),new cljs.core.Keyword(\x22db.fn\x22,\x22call\x22,\x22db.fn/call\x22,-151594418),new cljs.core.Keyword(null,\x22tx-data\x22,\x22tx-data\x22,934159761),entity], null));
}
}
} else {
if(((datascript.db.tempid_QMARK_(e)) \x26\x26 (cljs.core.not_EQ_.cljs$core$IFn$_invoke$arity$2(op,new cljs.core.Keyword(\x22db\x22,\x22add\x22,\x22db/add\x22,235286841))))){
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22Can\x27t use tempid in \x27\x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([entity], 0)),\x22\x27. Tempids are allowed in :db/add only\x22].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22transact\x22,\x22syntax\x22,\x22transact/syntax\x22,-299207078),new cljs.core.Keyword(null,\x22op\x22,\x22op\x22,-1882987955),entity], null));
} else {
if(((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(op,new cljs.core.Keyword(\x22db.fn\x22,\x22cas\x22,\x22db.fn/cas\x22,-379352172))) || (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(op,new cljs.core.Keyword(\x22db\x22,\x22cas\x22,\x22db/cas\x22,-451542322))))){
var vec__52080 \x3d entity;
var _ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52080,(0),null);
var e__$1 \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52080,(1),null);
var a__$1 \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52080,(2),null);
var ov \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52080,(3),null);
var nv \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52080,(4),null);
var e__$2 \x3d datascript.db.entid_strict(db,e__$1);
var ___$1 \x3d datascript.db.validate_attr(a__$1,entity);
var ov__$1 \x3d ((datascript.db.ref_QMARK_(db,a__$1))?datascript.db.entid_strict(db,ov):ov);
var nv__$1 \x3d ((datascript.db.ref_QMARK_(db,a__$1))?datascript.db.entid_strict(db,nv):nv);
var ___$2 \x3d datascript.db.validate_val(nv__$1,entity);
var datoms \x3d cljs.core.vec(datascript.db._search(db,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [e__$2,a__$1], null)));
if(datascript.db.multival_QMARK_(db,a__$1)){
if(cljs.core.truth_(cljs.core.some(((function (report,es,vec__52080,_,e__$1,a__$1,ov,nv,e__$2,___$1,ov__$1,nv__$1,___$2,datoms,vec__52074,op,e,a,v,db,tempids,vec__52068,seq__52069,first__52070,seq__52069__$1,entity,entities,initial_report_SINGLEQUOTE_,has_tuples_QMARK_,initial_es_SINGLEQUOTE_){
return (function (d){
return cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(d.v,ov__$1);
});})(report,es,vec__52080,_,e__$1,a__$1,ov,nv,e__$2,___$1,ov__$1,nv__$1,___$2,datoms,vec__52074,op,e,a,v,db,tempids,vec__52068,seq__52069,first__52070,seq__52069__$1,entity,entities,initial_report_SINGLEQUOTE_,has_tuples_QMARK_,initial_es_SINGLEQUOTE_))
,datoms))){
var G__52803 \x3d datascript.db.transact_add(report,new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22db\x22,\x22add\x22,\x22db/add\x22,235286841),e__$2,a__$1,nv__$1], null));
var G__52804 \x3d entities;
report \x3d G__52803;
es \x3d G__52804;
continue;
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22:db.fn/cas failed on datom [\x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([e__$2], 0)),\x22 \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([a__$1], 0)),\x22 \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([cljs.core.map.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22v\x22,\x22v\x22,21465059),datoms)], 0)),\x22], expected \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([ov__$1], 0))].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22transact\x22,\x22cas\x22,\x22transact/cas\x22,816687170),new cljs.core.Keyword(null,\x22old\x22,\x22old\x22,-1825222690),datoms,new cljs.core.Keyword(null,\x22expected\x22,\x22expected\x22,1583670997),ov__$1,new cljs.core.Keyword(null,\x22new\x22,\x22new\x22,-2085437848),nv__$1], null));
}
} else {
var v__$1 \x3d new cljs.core.Keyword(null,\x22v\x22,\x22v\x22,21465059).cljs$core$IFn$_invoke$arity$1(cljs.core.first(datoms));
if(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(v__$1,ov__$1)){
var G__52805 \x3d datascript.db.transact_add(report,new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22db\x22,\x22add\x22,\x22db/add\x22,235286841),e__$2,a__$1,nv__$1], null));
var G__52806 \x3d entities;
report \x3d G__52805;
es \x3d G__52806;
continue;
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22:db.fn/cas failed on datom [\x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([e__$2], 0)),\x22 \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([a__$1], 0)),\x22 \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([v__$1], 0)),\x22], expected \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([ov__$1], 0))].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22transact\x22,\x22cas\x22,\x22transact/cas\x22,816687170),new cljs.core.Keyword(null,\x22old\x22,\x22old\x22,-1825222690),cljs.core.first(datoms),new cljs.core.Keyword(null,\x22expected\x22,\x22expected\x22,1583670997),ov__$1,new cljs.core.Keyword(null,\x22new\x22,\x22new\x22,-2085437848),nv__$1], null));
}
}
} else {
if(datascript.db.tx_id_QMARK_(e)){
var G__52809 \x3d datascript.db.allocate_eid.cljs$core$IFn$_invoke$arity$3(report,e,datascript.db.current_tx(report));
var G__52810 \x3d cljs.core.cons(new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [op,datascript.db.current_tx(report),a,v], null),entities);
report \x3d G__52809;
es \x3d G__52810;
continue;
} else {
if(((datascript.db.ref_QMARK_(db,a)) \x26\x26 (datascript.db.tx_id_QMARK_(v)))){
var G__52811 \x3d datascript.db.allocate_eid.cljs$core$IFn$_invoke$arity$3(report,v,datascript.db.current_tx(report));
var G__52812 \x3d cljs.core.cons(new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [op,e,a,datascript.db.current_tx(report)], null),entities);
report \x3d G__52811;
es \x3d G__52812;
continue;
} else {
if(((datascript.db.ref_QMARK_(db,a)) \x26\x26 (datascript.db.tempid_QMARK_(v)))){
var temp__5806__auto__ \x3d cljs.core.get.cljs$core$IFn$_invoke$arity$2(tempids,v);
if((temp__5806__auto__ \x3d\x3d null)){
var resolved \x3d datascript.db.next_eid(db);
var report_SINGLEQUOTE_ \x3d cljs.core.update.cljs$core$IFn$_invoke$arity$5(datascript.db.allocate_eid.cljs$core$IFn$_invoke$arity$3(report,v,resolved),new cljs.core.Keyword(\x22datascript.db\x22,\x22value-tempids\x22,\x22datascript.db/value-tempids\x22,244806162),cljs.core.assoc,resolved,v);
var G__52817 \x3d report_SINGLEQUOTE_;
var G__52818 \x3d es;
report \x3d G__52817;
es \x3d G__52818;
continue;
} else {
var resolved \x3d temp__5806__auto__;
var report_SINGLEQUOTE_ \x3d cljs.core.update.cljs$core$IFn$_invoke$arity$5(report,new cljs.core.Keyword(\x22datascript.db\x22,\x22value-tempids\x22,\x22datascript.db/value-tempids\x22,244806162),cljs.core.assoc,resolved,v);
var G__52819 \x3d report_SINGLEQUOTE_;
var G__52820 \x3d cljs.core.cons(new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [op,e,a,resolved], null),entities);
report \x3d G__52819;
es \x3d G__52820;
continue;
}
} else {
if(datascript.db.tempid_QMARK_(e)){
var upserted_eid \x3d ((datascript.db.is_attr_QMARK_(db,a,new cljs.core.Keyword(\x22db.unique\x22,\x22identity\x22,\x22db.unique/identity\x22,1675950722)))?new cljs.core.Keyword(null,\x22e\x22,\x22e\x22,1381269198).cljs$core$IFn$_invoke$arity$1(cljs.core.first(datascript.db._datoms(db,new cljs.core.Keyword(null,\x22avet\x22,\x22avet\x22,1383857032),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [a,v], null)))):null);
var allocated_eid \x3d cljs.core.get.cljs$core$IFn$_invoke$arity$2(tempids,e);
if(cljs.core.truth_((function (){var and__5043__auto__ \x3d upserted_eid;
if(cljs.core.truth_(and__5043__auto__)){
var and__5043__auto____$1 \x3d allocated_eid;
if(cljs.core.truth_(and__5043__auto____$1)){
return cljs.core.not_EQ_.cljs$core$IFn$_invoke$arity$2(upserted_eid,allocated_eid);
} else {
return and__5043__auto____$1;
}
} else {
return and__5043__auto__;
}
})())){
return datascript.db.retry_with_tempid(initial_report,report,initial_es,e,upserted_eid);
} else {
var eid \x3d (function (){var or__5045__auto__ \x3d upserted_eid;
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
var or__5045__auto____$1 \x3d allocated_eid;
if(cljs.core.truth_(or__5045__auto____$1)){
return or__5045__auto____$1;
} else {
return datascript.db.next_eid(db);
}
}
})();
var G__52832 \x3d datascript.db.allocate_eid.cljs$core$IFn$_invoke$arity$3(report,e,eid);
var G__52833 \x3d cljs.core.cons(new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [op,eid,a,v], null),entities);
report \x3d G__52832;
es \x3d G__52833;
continue;
}
} else {
if(((cljs.core.not(new cljs.core.Keyword(\x22datascript.db\x22,\x22internal\x22,\x22datascript.db/internal\x22,-249301114).cljs$core$IFn$_invoke$arity$1(cljs.core.meta(entity)))) \x26\x26 (datascript.db.tuple_QMARK_(db,a)))){
var tuple_attrs \x3d cljs.core.get_in.cljs$core$IFn$_invoke$arity$2(db,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22schema\x22,\x22schema\x22,-1582001791),a,new cljs.core.Keyword(\x22db\x22,\x22tupleAttrs\x22,\x22db/tupleAttrs\x22,250080092)], null));
if(((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(cljs.core.count(tuple_attrs),cljs.core.count(v))) \x26\x26 (((cljs.core.every_QMARK_(cljs.core.some_QMARK_,v)) \x26\x26 (cljs.core.every_QMARK_(((function (report,es,tuple_attrs,vec__52074,op,e,a,v,db,tempids,vec__52068,seq__52069,first__52070,seq__52069__$1,entity,entities,initial_report_SINGLEQUOTE_,has_tuples_QMARK_,initial_es_SINGLEQUOTE_){
return (function (p__52083){
var vec__52084 \x3d p__52083;
var tuple_attr \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52084,(0),null);
var tuple_value \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52084,(1),null);
var db_value \x3d new cljs.core.Keyword(null,\x22v\x22,\x22v\x22,21465059).cljs$core$IFn$_invoke$arity$1(cljs.core.first(datascript.db._datoms(db,new cljs.core.Keyword(null,\x22eavt\x22,\x22eavt\x22,-666437073),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [e,tuple_attr], null))));
return cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(tuple_value,db_value);
});})(report,es,tuple_attrs,vec__52074,op,e,a,v,db,tempids,vec__52068,seq__52069,first__52070,seq__52069__$1,entity,entities,initial_report_SINGLEQUOTE_,has_tuples_QMARK_,initial_es_SINGLEQUOTE_))
,cljs.core.map.cljs$core$IFn$_invoke$arity$3(cljs.core.vector,tuple_attrs,v))))))){
var G__52839 \x3d report;
var G__52840 \x3d entities;
report \x3d G__52839;
es \x3d G__52840;
continue;
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22Can\\u2019t modify tuple attrs directly: \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([entity], 0))].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22transact\x22,\x22syntax\x22,\x22transact/syntax\x22,-299207078),new cljs.core.Keyword(null,\x22tx-data\x22,\x22tx-data\x22,934159761),entity], null));
}
} else {
if(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(op,new cljs.core.Keyword(\x22db\x22,\x22add\x22,\x22db/add\x22,235286841))){
var G__52844 \x3d datascript.db.transact_add(report,entity);
var G__52845 \x3d entities;
report \x3d G__52844;
es \x3d G__52845;
continue;
} else {
if(((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(op,new cljs.core.Keyword(\x22db\x22,\x22retract\x22,\x22db/retract\x22,-1549825231))) \x26\x26 ((!((v \x3d\x3d null)))))){
var temp__5806__auto__ \x3d datascript.db.entid(db,e);
if((temp__5806__auto__ \x3d\x3d null)){
var G__52847 \x3d report;
var G__52848 \x3d entities;
report \x3d G__52847;
es \x3d G__52848;
continue;
} else {
var e__$1 \x3d temp__5806__auto__;
var v__$1 \x3d ((datascript.db.ref_QMARK_(db,a))?datascript.db.entid_strict(db,v):v);
datascript.db.validate_attr(a,entity);

datascript.db.validate_val(v__$1,entity);

var temp__5806__auto____$1 \x3d datascript.db.fsearch(db,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [e__$1,a,v__$1], null));
if((temp__5806__auto____$1 \x3d\x3d null)){
var G__52850 \x3d report;
var G__52851 \x3d entities;
report \x3d G__52850;
es \x3d G__52851;
continue;
} else {
var old_datom \x3d temp__5806__auto____$1;
var G__52852 \x3d datascript.db.transact_retract_datom(report,old_datom);
var G__52853 \x3d entities;
report \x3d G__52852;
es \x3d G__52853;
continue;
}
}
} else {
if(((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(op,new cljs.core.Keyword(\x22db.fn\x22,\x22retractAttribute\x22,\x22db.fn/retractAttribute\x22,937402164))) || (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(op,new cljs.core.Keyword(\x22db\x22,\x22retract\x22,\x22db/retract\x22,-1549825231))))){
var temp__5806__auto__ \x3d datascript.db.entid(db,e);
if((temp__5806__auto__ \x3d\x3d null)){
var G__52854 \x3d report;
var G__52855 \x3d entities;
report \x3d G__52854;
es \x3d G__52855;
continue;
} else {
var e__$1 \x3d temp__5806__auto__;
var _ \x3d datascript.db.validate_attr(a,entity);
var datoms \x3d cljs.core.vec(datascript.db._search(db,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [e__$1,a], null)));
var G__52856 \x3d cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(datascript.db.transact_retract_datom,report,datoms);
var G__52857 \x3d cljs.core.concat.cljs$core$IFn$_invoke$arity$2(datascript.db.retract_components(db,datoms),entities);
report \x3d G__52856;
es \x3d G__52857;
continue;
}
} else {
if(((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(op,new cljs.core.Keyword(\x22db.fn\x22,\x22retractEntity\x22,\x22db.fn/retractEntity\x22,-1423535441))) || (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(op,new cljs.core.Keyword(\x22db\x22,\x22retractEntity\x22,\x22db/retractEntity\x22,-1452737935))))){
var temp__5806__auto__ \x3d datascript.db.entid(db,e);
if((temp__5806__auto__ \x3d\x3d null)){
var G__52860 \x3d report;
var G__52861 \x3d entities;
report \x3d G__52860;
es \x3d G__52861;
continue;
} else {
var e__$1 \x3d temp__5806__auto__;
var e_datoms \x3d cljs.core.vec(datascript.db._search(db,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [e__$1], null)));
var v_datoms \x3d cljs.core.vec(cljs.core.mapcat.cljs$core$IFn$_invoke$arity$variadic(((function (report,es,e_datoms,e__$1,temp__5806__auto__,vec__52074,op,e,a,v,db,tempids,vec__52068,seq__52069,first__52070,seq__52069__$1,entity,entities,initial_report_SINGLEQUOTE_,has_tuples_QMARK_,initial_es_SINGLEQUOTE_){
return (function (a__$1){
return datascript.db._search(db,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [null,a__$1,e__$1], null));
});})(report,es,e_datoms,e__$1,temp__5806__auto__,vec__52074,op,e,a,v,db,tempids,vec__52068,seq__52069,first__52070,seq__52069__$1,entity,entities,initial_report_SINGLEQUOTE_,has_tuples_QMARK_,initial_es_SINGLEQUOTE_))
,cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([datascript.db._attrs_by(db,new cljs.core.Keyword(\x22db.type\x22,\x22ref\x22,\x22db.type/ref\x22,-1728373079))], 0)));
var G__52862 \x3d cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(datascript.db.transact_retract_datom,report,cljs.core.concat.cljs$core$IFn$_invoke$arity$2(e_datoms,v_datoms));
var G__52863 \x3d cljs.core.concat.cljs$core$IFn$_invoke$arity$2(datascript.db.retract_components(db,e_datoms),entities);
report \x3d G__52862;
es \x3d G__52863;
continue;
}
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22Unknown operation at \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([entity], 0)),\x22, expected :db/add, :db/retract, :db.fn/call, :db.fn/retractAttribute, :db.fn/retractEntity or an ident corresponding to an installed transaction function (e.g. {:db/ident \x3ckeyword\x3e :db/fn \x3cIfn\x3e}, usage of :db/ident requires {:db/unique :db.unique/identity} in schema)\x22].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22transact\x22,\x22syntax\x22,\x22transact/syntax\x22,-299207078),new cljs.core.Keyword(null,\x22operation\x22,\x22operation\x22,-1267664310),op,new cljs.core.Keyword(null,\x22tx-data\x22,\x22tx-data\x22,934159761),entity], null));

}
}
}
}
}
}
}
}
}
}
}
}
}
} else {
if(datascript.db.datom_QMARK_(entity)){
var vec__52087 \x3d entity;
var e \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52087,(0),null);
var a \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52087,(1),null);
var v \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52087,(2),null);
var tx \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52087,(3),null);
var added \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52087,(4),null);
if(cljs.core.truth_(added)){
var G__52867 \x3d datascript.db.transact_add(report,new cljs.core.PersistentVector(null, 5, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22db\x22,\x22add\x22,\x22db/add\x22,235286841),e,a,v,tx], null));
var G__52868 \x3d entities;
report \x3d G__52867;
es \x3d G__52868;
continue;
} else {
var G__52870 \x3d report;
var G__52871 \x3d cljs.core.cons(new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22db\x22,\x22retract\x22,\x22db/retract\x22,-1549825231),e,a,v], null),entities);
report \x3d G__52870;
es \x3d G__52871;
continue;
}
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22Bad entity type at \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([entity], 0)),\x22, expected map or vector\x22].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22transact\x22,\x22syntax\x22,\x22transact/syntax\x22,-299207078),new cljs.core.Keyword(null,\x22tx-data\x22,\x22tx-data\x22,934159761),entity], null));

}
}
}
}
}
}
break;
}
});
");
SHADOW_ENV.evalLoad("datascript.impl.entity.js", true , "goog.provide(\x27datascript.impl.entity\x27);




datascript.impl.entity.entid \x3d (function datascript$impl$entity$entid(db,eid){
if(((typeof eid \x3d\x3d\x3d \x27number\x27) || (((cljs.core.sequential_QMARK_(eid)) || ((eid instanceof cljs.core.Keyword)))))){
return datascript.db.entid(db,eid);
} else {
return null;
}
});
datascript.impl.entity.entity \x3d (function datascript$impl$entity$entity(db,eid){
if(datascript.db.db_QMARK_(db)){
} else {
throw (new Error(\x22Assert failed: (db/db? db)\x22));
}

var temp__5804__auto__ \x3d datascript.impl.entity.entid(db,eid);
if(cljs.core.truth_(temp__5804__auto__)){
var e \x3d temp__5804__auto__;
var G__52093 \x3d db;
var G__52094 \x3d e;
var G__52095 \x3d cljs.core.volatile_BANG_(false);
var G__52096 \x3d cljs.core.volatile_BANG_(cljs.core.PersistentArrayMap.EMPTY);
return (datascript.impl.entity.__GT_Entity.cljs$core$IFn$_invoke$arity$4 ? datascript.impl.entity.__GT_Entity.cljs$core$IFn$_invoke$arity$4(G__52093,G__52094,G__52095,G__52096) : datascript.impl.entity.__GT_Entity.call(null,G__52093,G__52094,G__52095,G__52096));
} else {
return null;
}
});
datascript.impl.entity.entity_attr \x3d (function datascript$impl$entity$entity_attr(db,a,datoms){
if(datascript.db.multival_QMARK_(db,a)){
if(datascript.db.ref_QMARK_(db,a)){
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (p1__52097_SHARP_,p2__52098_SHARP_){
return cljs.core.conj.cljs$core$IFn$_invoke$arity$2(p1__52097_SHARP_,datascript.impl.entity.entity(db,new cljs.core.Keyword(null,\x22v\x22,\x22v\x22,21465059).cljs$core$IFn$_invoke$arity$1(p2__52098_SHARP_)));
}),cljs.core.PersistentHashSet.EMPTY,datoms);
} else {
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (p1__52100_SHARP_,p2__52101_SHARP_){
return cljs.core.conj.cljs$core$IFn$_invoke$arity$2(p1__52100_SHARP_,new cljs.core.Keyword(null,\x22v\x22,\x22v\x22,21465059).cljs$core$IFn$_invoke$arity$1(p2__52101_SHARP_));
}),cljs.core.PersistentHashSet.EMPTY,datoms);
}
} else {
if(datascript.db.ref_QMARK_(db,a)){
return datascript.impl.entity.entity(db,new cljs.core.Keyword(null,\x22v\x22,\x22v\x22,21465059).cljs$core$IFn$_invoke$arity$1(cljs.core.first(datoms)));
} else {
return new cljs.core.Keyword(null,\x22v\x22,\x22v\x22,21465059).cljs$core$IFn$_invoke$arity$1(cljs.core.first(datoms));
}
}
});
datascript.impl.entity._lookup_backwards \x3d (function datascript$impl$entity$_lookup_backwards(db,eid,attr,not_found){
var temp__5802__auto__ \x3d cljs.core.not_empty(datascript.db._search(db,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [null,attr,eid], null)));
if(cljs.core.truth_(temp__5802__auto__)){
var datoms \x3d temp__5802__auto__;
if(datascript.db.component_QMARK_(db,attr)){
return datascript.impl.entity.entity(db,new cljs.core.Keyword(null,\x22e\x22,\x22e\x22,1381269198).cljs$core$IFn$_invoke$arity$1(cljs.core.first(datoms)));
} else {
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (p1__52107_SHARP_,p2__52108_SHARP_){
return cljs.core.conj.cljs$core$IFn$_invoke$arity$2(p1__52107_SHARP_,datascript.impl.entity.entity(db,new cljs.core.Keyword(null,\x22e\x22,\x22e\x22,1381269198).cljs$core$IFn$_invoke$arity$1(p2__52108_SHARP_)));
}),cljs.core.PersistentHashSet.EMPTY,datoms);
}
} else {
return not_found;
}
});
datascript.impl.entity.multival__GT_js \x3d (function datascript$impl$entity$multival__GT_js(val){
if(cljs.core.truth_(val)){
return cljs.core.to_array(val);
} else {
return null;
}
});
datascript.impl.entity.js_seq \x3d (function datascript$impl$entity$js_seq(e){
(datascript.impl.entity.touch.cljs$core$IFn$_invoke$arity$1 ? datascript.impl.entity.touch.cljs$core$IFn$_invoke$arity$1(e) : datascript.impl.entity.touch.call(null,e));

var iter__5523__auto__ \x3d (function datascript$impl$entity$js_seq_$_iter__52114(s__52115){
return (new cljs.core.LazySeq(null,(function (){
var s__52115__$1 \x3d s__52115;
while(true){
var temp__5804__auto__ \x3d cljs.core.seq(s__52115__$1);
if(temp__5804__auto__){
var s__52115__$2 \x3d temp__5804__auto__;
if(cljs.core.chunked_seq_QMARK_(s__52115__$2)){
var c__5521__auto__ \x3d cljs.core.chunk_first(s__52115__$2);
var size__5522__auto__ \x3d cljs.core.count(c__5521__auto__);
var b__52117 \x3d cljs.core.chunk_buffer(size__5522__auto__);
if((function (){var i__52116 \x3d (0);
while(true){
if((i__52116 \x3c size__5522__auto__)){
var vec__52118 \x3d cljs.core._nth(c__5521__auto__,i__52116);
var a \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52118,(0),null);
var v \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52118,(1),null);
cljs.core.chunk_append(b__52117,((datascript.db.multival_QMARK_(e.db,a))?new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [a,datascript.impl.entity.multival__GT_js(v)], null):new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [a,v], null)));

var G__52256 \x3d (i__52116 + (1));
i__52116 \x3d G__52256;
continue;
} else {
return true;
}
break;
}
})()){
return cljs.core.chunk_cons(cljs.core.chunk(b__52117),datascript$impl$entity$js_seq_$_iter__52114(cljs.core.chunk_rest(s__52115__$2)));
} else {
return cljs.core.chunk_cons(cljs.core.chunk(b__52117),null);
}
} else {
var vec__52122 \x3d cljs.core.first(s__52115__$2);
var a \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52122,(0),null);
var v \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52122,(1),null);
return cljs.core.cons(((datascript.db.multival_QMARK_(e.db,a))?new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [a,datascript.impl.entity.multival__GT_js(v)], null):new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [a,v], null)),datascript$impl$entity$js_seq_$_iter__52114(cljs.core.rest(s__52115__$2)));
}
} else {
return null;
}
break;
}
}),null,null));
});
return iter__5523__auto__(cljs.core.deref(e.cache));
});

/**
* @constructor
 * @implements {cljs.core.IEquiv}
 * @implements {cljs.core.IHash}
 * @implements {cljs.core.IFn}
 * @implements {cljs.core.ICounted}
 * @implements {cljs.core.ISeqable}
 * @implements {cljs.core.IPrintWithWriter}
 * @implements {cljs.core.IAssociative}
 * @implements {cljs.core.ILookup}
*/
datascript.impl.entity.Entity \x3d (function (db,eid,touched,cache){
this.db \x3d db;
this.eid \x3d eid;
this.touched \x3d touched;
this.cache \x3d cache;
this.cljs$lang$protocol_mask$partition0$ \x3d 2162164483;
this.cljs$lang$protocol_mask$partition1$ \x3d 0;
});
(datascript.impl.entity.Entity.prototype.entry_set \x3d (function (){
var self__ \x3d this;
var this$ \x3d this;
return cljs.core.to_array(cljs.core.map.cljs$core$IFn$_invoke$arity$2(cljs.core.to_array,datascript.impl.entity.js_seq(this$)));
}));

(datascript.impl.entity.Entity.prototype.forEach \x3d (function() {
var G__52257 \x3d null;
var G__52257__1 \x3d (function (f){
var self__ \x3d this;
var this$ \x3d this;
var seq__52126 \x3d cljs.core.seq(datascript.impl.entity.js_seq(this$));
var chunk__52127 \x3d null;
var count__52128 \x3d (0);
var i__52129 \x3d (0);
while(true){
if((i__52129 \x3c count__52128)){
var vec__52136 \x3d chunk__52127.cljs$core$IIndexed$_nth$arity$2(null,i__52129);
var a \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52136,(0),null);
var v \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52136,(1),null);
(f.cljs$core$IFn$_invoke$arity$3 ? f.cljs$core$IFn$_invoke$arity$3(v,a,this$) : f.call(null,v,a,this$));


var G__52259 \x3d seq__52126;
var G__52260 \x3d chunk__52127;
var G__52261 \x3d count__52128;
var G__52262 \x3d (i__52129 + (1));
seq__52126 \x3d G__52259;
chunk__52127 \x3d G__52260;
count__52128 \x3d G__52261;
i__52129 \x3d G__52262;
continue;
} else {
var temp__5804__auto__ \x3d cljs.core.seq(seq__52126);
if(temp__5804__auto__){
var seq__52126__$1 \x3d temp__5804__auto__;
if(cljs.core.chunked_seq_QMARK_(seq__52126__$1)){
var c__5568__auto__ \x3d cljs.core.chunk_first(seq__52126__$1);
var G__52263 \x3d cljs.core.chunk_rest(seq__52126__$1);
var G__52264 \x3d c__5568__auto__;
var G__52265 \x3d cljs.core.count(c__5568__auto__);
var G__52266 \x3d (0);
seq__52126 \x3d G__52263;
chunk__52127 \x3d G__52264;
count__52128 \x3d G__52265;
i__52129 \x3d G__52266;
continue;
} else {
var vec__52139 \x3d cljs.core.first(seq__52126__$1);
var a \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52139,(0),null);
var v \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52139,(1),null);
(f.cljs$core$IFn$_invoke$arity$3 ? f.cljs$core$IFn$_invoke$arity$3(v,a,this$) : f.call(null,v,a,this$));


var G__52267 \x3d cljs.core.next(seq__52126__$1);
var G__52268 \x3d null;
var G__52269 \x3d (0);
var G__52270 \x3d (0);
seq__52126 \x3d G__52267;
chunk__52127 \x3d G__52268;
count__52128 \x3d G__52269;
i__52129 \x3d G__52270;
continue;
}
} else {
return null;
}
}
break;
}
});
var G__52257__2 \x3d (function (f,use_as_this){
var self__ \x3d this;
var this$ \x3d this;
var seq__52142 \x3d cljs.core.seq(datascript.impl.entity.js_seq(this$));
var chunk__52143 \x3d null;
var count__52144 \x3d (0);
var i__52145 \x3d (0);
while(true){
if((i__52145 \x3c count__52144)){
var vec__52154 \x3d chunk__52143.cljs$core$IIndexed$_nth$arity$2(null,i__52145);
var a \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52154,(0),null);
var v \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52154,(1),null);
f.call(use_as_this,v,a,this$);


var G__52271 \x3d seq__52142;
var G__52272 \x3d chunk__52143;
var G__52273 \x3d count__52144;
var G__52274 \x3d (i__52145 + (1));
seq__52142 \x3d G__52271;
chunk__52143 \x3d G__52272;
count__52144 \x3d G__52273;
i__52145 \x3d G__52274;
continue;
} else {
var temp__5804__auto__ \x3d cljs.core.seq(seq__52142);
if(temp__5804__auto__){
var seq__52142__$1 \x3d temp__5804__auto__;
if(cljs.core.chunked_seq_QMARK_(seq__52142__$1)){
var c__5568__auto__ \x3d cljs.core.chunk_first(seq__52142__$1);
var G__52275 \x3d cljs.core.chunk_rest(seq__52142__$1);
var G__52276 \x3d c__5568__auto__;
var G__52277 \x3d cljs.core.count(c__5568__auto__);
var G__52278 \x3d (0);
seq__52142 \x3d G__52275;
chunk__52143 \x3d G__52276;
count__52144 \x3d G__52277;
i__52145 \x3d G__52278;
continue;
} else {
var vec__52160 \x3d cljs.core.first(seq__52142__$1);
var a \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52160,(0),null);
var v \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__52160,(1),null);
f.call(use_as_this,v,a,this$);


var G__52279 \x3d cljs.core.next(seq__52142__$1);
var G__52280 \x3d null;
var G__52281 \x3d (0);
var G__52282 \x3d (0);
seq__52142 \x3d G__52279;
chunk__52143 \x3d G__52280;
count__52144 \x3d G__52281;
i__52145 \x3d G__52282;
continue;
}
} else {
return null;
}
}
break;
}
});
G__52257 \x3d function(f,use_as_this){
switch(arguments.length){
case 1:
return G__52257__1.call(this,f);
case 2:
return G__52257__2.call(this,f,use_as_this);
}
throw(new Error(\x27Invalid arity: \x27 + arguments.length));
};
G__52257.cljs$core$IFn$_invoke$arity$1 \x3d G__52257__1;
G__52257.cljs$core$IFn$_invoke$arity$2 \x3d G__52257__2;
return G__52257;
})()
);

(datascript.impl.entity.Entity.prototype.get \x3d (function (attr){
var self__ \x3d this;
var this$ \x3d this;
if(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(attr,\x22:db/id\x22)){
return self__.eid;
} else {
if(datascript.db.reverse_ref_QMARK_(attr)){
return datascript.impl.entity.multival__GT_js(datascript.impl.entity._lookup_backwards(self__.db,self__.eid,datascript.db.reverse_ref(attr),null));
} else {
var G__52165 \x3d (datascript.impl.entity.lookup_entity.cljs$core$IFn$_invoke$arity$2 ? datascript.impl.entity.lookup_entity.cljs$core$IFn$_invoke$arity$2(this$,attr) : datascript.impl.entity.lookup_entity.call(null,this$,attr));
if(datascript.db.multival_QMARK_(self__.db,attr)){
return datascript.impl.entity.multival__GT_js(G__52165);
} else {
return G__52165;
}
}
}
}));

(datascript.impl.entity.Entity.prototype.key_set \x3d (function (){
var self__ \x3d this;
var this$ \x3d this;
return cljs.core.to_array(cljs.core.keys(this$));
}));

(datascript.impl.entity.Entity.prototype.entries \x3d (function (){
var self__ \x3d this;
var this$ \x3d this;
return cljs.core.es6_entries_iterator(datascript.impl.entity.js_seq(this$));
}));

(datascript.impl.entity.Entity.prototype.value_set \x3d (function (){
var self__ \x3d this;
var this$ \x3d this;
return cljs.core.to_array(cljs.core.map.cljs$core$IFn$_invoke$arity$2(cljs.core.second,datascript.impl.entity.js_seq(this$)));
}));

(datascript.impl.entity.Entity.prototype.toString \x3d (function (){
var self__ \x3d this;
var this$ \x3d this;
return cljs.core.pr_str_STAR_(this$);
}));

(datascript.impl.entity.Entity.prototype.keys \x3d (function (){
var self__ \x3d this;
var this$ \x3d this;
return cljs.core.es6_iterator(cljs.core.keys(this$));
}));

(datascript.impl.entity.Entity.prototype.values \x3d (function (){
var self__ \x3d this;
var this$ \x3d this;
return cljs.core.es6_iterator(cljs.core.map.cljs$core$IFn$_invoke$arity$2(cljs.core.second,datascript.impl.entity.js_seq(this$)));
}));

(datascript.impl.entity.Entity.prototype.equiv \x3d (function (other){
var self__ \x3d this;
var this$ \x3d this;
return (datascript.impl.entity.equiv_entity.cljs$core$IFn$_invoke$arity$2 ? datascript.impl.entity.equiv_entity.cljs$core$IFn$_invoke$arity$2(this$,other) : datascript.impl.entity.equiv_entity.call(null,this$,other));
}));

(datascript.impl.entity.Entity.prototype.has \x3d (function (attr){
var self__ \x3d this;
var this$ \x3d this;
return (!((this$.get(attr) \x3d\x3d null)));
}));

(datascript.impl.entity.Entity.prototype.cljs$core$ILookup$_lookup$arity$2 \x3d (function (this$,attr){
var self__ \x3d this;
var this$__$1 \x3d this;
return (datascript.impl.entity.lookup_entity.cljs$core$IFn$_invoke$arity$3 ? datascript.impl.entity.lookup_entity.cljs$core$IFn$_invoke$arity$3(this$__$1,attr,null) : datascript.impl.entity.lookup_entity.call(null,this$__$1,attr,null));
}));

(datascript.impl.entity.Entity.prototype.cljs$core$ILookup$_lookup$arity$3 \x3d (function (this$,attr,not_found){
var self__ \x3d this;
var this$__$1 \x3d this;
return (datascript.impl.entity.lookup_entity.cljs$core$IFn$_invoke$arity$3 ? datascript.impl.entity.lookup_entity.cljs$core$IFn$_invoke$arity$3(this$__$1,attr,not_found) : datascript.impl.entity.lookup_entity.call(null,this$__$1,attr,not_found));
}));

(datascript.impl.entity.Entity.prototype.cljs$core$IPrintWithWriter$_pr_writer$arity$3 \x3d (function (_,writer,opts){
var self__ \x3d this;
var ___$1 \x3d this;
return cljs.core._pr_writer(cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(cljs.core.deref(self__.cache),new cljs.core.Keyword(\x22db\x22,\x22id\x22,\x22db/id\x22,-1388397098),self__.eid),writer,opts);
}));

(datascript.impl.entity.Entity.prototype.cljs$core$ICounted$_count$arity$1 \x3d (function (this$){
var self__ \x3d this;
var this$__$1 \x3d this;
(datascript.impl.entity.touch.cljs$core$IFn$_invoke$arity$1 ? datascript.impl.entity.touch.cljs$core$IFn$_invoke$arity$1(this$__$1) : datascript.impl.entity.touch.call(null,this$__$1));

return cljs.core.count(cljs.core.deref(self__.cache));
}));

(datascript.impl.entity.Entity.prototype.cljs$core$IHash$_hash$arity$1 \x3d (function (_){
var self__ \x3d this;
var ___$1 \x3d this;
return cljs.core.hash(self__.eid);
}));

(datascript.impl.entity.Entity.prototype.cljs$core$IEquiv$_equiv$arity$2 \x3d (function (this$,o){
var self__ \x3d this;
var this$__$1 \x3d this;
return (datascript.impl.entity.equiv_entity.cljs$core$IFn$_invoke$arity$2 ? datascript.impl.entity.equiv_entity.cljs$core$IFn$_invoke$arity$2(this$__$1,o) : datascript.impl.entity.equiv_entity.call(null,this$__$1,o));
}));

(datascript.impl.entity.Entity.prototype.cljs$core$IAssociative$_contains_key_QMARK_$arity$2 \x3d (function (this$,k){
var self__ \x3d this;
var this$__$1 \x3d this;
return cljs.core.not_EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(\x22datascript.impl.entity\x22,\x22nf\x22,\x22datascript.impl.entity/nf\x22,-953741353),(datascript.impl.entity.lookup_entity.cljs$core$IFn$_invoke$arity$3 ? datascript.impl.entity.lookup_entity.cljs$core$IFn$_invoke$arity$3(this$__$1,k,new cljs.core.Keyword(\x22datascript.impl.entity\x22,\x22nf\x22,\x22datascript.impl.entity/nf\x22,-953741353)) : datascript.impl.entity.lookup_entity.call(null,this$__$1,k,new cljs.core.Keyword(\x22datascript.impl.entity\x22,\x22nf\x22,\x22datascript.impl.entity/nf\x22,-953741353))));
}));

(datascript.impl.entity.Entity.prototype.cljs$core$ISeqable$_seq$arity$1 \x3d (function (this$){
var self__ \x3d this;
var this$__$1 \x3d this;
(datascript.impl.entity.touch.cljs$core$IFn$_invoke$arity$1 ? datascript.impl.entity.touch.cljs$core$IFn$_invoke$arity$1(this$__$1) : datascript.impl.entity.touch.call(null,this$__$1));

return cljs.core.seq(cljs.core.deref(self__.cache));
}));

(datascript.impl.entity.Entity.prototype.call \x3d (function (unused__11785__auto__){
var self__ \x3d this;
var self__ \x3d this;
var G__52180 \x3d (arguments.length - (1));
switch (G__52180) {
case (1):
return self__.cljs$core$IFn$_invoke$arity$1((arguments[(1)]));

break;
case (2):
return self__.cljs$core$IFn$_invoke$arity$2((arguments[(1)]),(arguments[(2)]));

break;
default:
throw (new Error([\x22Invalid arity: \x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1((arguments.length - (1)))].join(\x27\x27)));

}
}));

(datascript.impl.entity.Entity.prototype.apply \x3d (function (self__,args52125){
var self__ \x3d this;
var self____$1 \x3d this;
return self____$1.call.apply(self____$1,[self____$1].concat(cljs.core.aclone(args52125)));
}));

(datascript.impl.entity.Entity.prototype.cljs$core$IFn$_invoke$arity$1 \x3d (function (k){
var self__ \x3d this;
var this$ \x3d this;
return (datascript.impl.entity.lookup_entity.cljs$core$IFn$_invoke$arity$2 ? datascript.impl.entity.lookup_entity.cljs$core$IFn$_invoke$arity$2(this$,k) : datascript.impl.entity.lookup_entity.call(null,this$,k));
}));

(datascript.impl.entity.Entity.prototype.cljs$core$IFn$_invoke$arity$2 \x3d (function (k,not_found){
var self__ \x3d this;
var this$ \x3d this;
return (datascript.impl.entity.lookup_entity.cljs$core$IFn$_invoke$arity$3 ? datascript.impl.entity.lookup_entity.cljs$core$IFn$_invoke$arity$3(this$,k,not_found) : datascript.impl.entity.lookup_entity.call(null,this$,k,not_found));
}));

(datascript.impl.entity.Entity.getBasis \x3d (function (){
return new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22db\x22,\x22db\x22,-1661185010,null),new cljs.core.Symbol(null,\x22eid\x22,\x22eid\x22,-2094915839,null),new cljs.core.Symbol(null,\x22touched\x22,\x22touched\x22,1031397108,null),new cljs.core.Symbol(null,\x22cache\x22,\x22cache\x22,403508473,null)], null);
}));

(datascript.impl.entity.Entity.cljs$lang$type \x3d true);

(datascript.impl.entity.Entity.cljs$lang$ctorStr \x3d \x22datascript.impl.entity/Entity\x22);

(datascript.impl.entity.Entity.cljs$lang$ctorPrWriter \x3d (function (this__5330__auto__,writer__5331__auto__,opt__5332__auto__){
return cljs.core._write(writer__5331__auto__,\x22datascript.impl.entity/Entity\x22);
}));

/**
 * Positional factory function for datascript.impl.entity/Entity.
 */
datascript.impl.entity.__GT_Entity \x3d (function datascript$impl$entity$__GT_Entity(db,eid,touched,cache){
return (new datascript.impl.entity.Entity(db,eid,touched,cache));
});

datascript.impl.entity.entity_QMARK_ \x3d (function datascript$impl$entity$entity_QMARK_(x){
return (x instanceof datascript.impl.entity.Entity);
});
datascript.impl.entity.equiv_entity \x3d (function datascript$impl$entity$equiv_entity(this$,that){
return (((that instanceof datascript.impl.entity.Entity)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this$.eid,that.eid)));
});
datascript.impl.entity.lookup_entity \x3d (function datascript$impl$entity$lookup_entity(var_args){
var G__52188 \x3d arguments.length;
switch (G__52188) {
case 2:
return datascript.impl.entity.lookup_entity.cljs$core$IFn$_invoke$arity$2((arguments[(0)]),(arguments[(1)]));

break;
case 3:
return datascript.impl.entity.lookup_entity.cljs$core$IFn$_invoke$arity$3((arguments[(0)]),(arguments[(1)]),(arguments[(2)]));

break;
default:
throw (new Error([\x22Invalid arity: \x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1(arguments.length)].join(\x27\x27)));

}
});

(datascript.impl.entity.lookup_entity.cljs$core$IFn$_invoke$arity$2 \x3d (function (this$,attr){
return datascript.impl.entity.lookup_entity.cljs$core$IFn$_invoke$arity$3(this$,attr,null);
}));

(datascript.impl.entity.lookup_entity.cljs$core$IFn$_invoke$arity$3 \x3d (function (this$,attr,not_found){
if(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(attr,new cljs.core.Keyword(\x22db\x22,\x22id\x22,\x22db/id\x22,-1388397098))){
return this$.eid;
} else {
if(datascript.db.reverse_ref_QMARK_(attr)){
return datascript.impl.entity._lookup_backwards(this$.db,this$.eid,datascript.db.reverse_ref(attr),not_found);
} else {
var temp__5806__auto__ \x3d (function (){var fexpr__52191 \x3d cljs.core.deref(this$.cache);
return (fexpr__52191.cljs$core$IFn$_invoke$arity$1 ? fexpr__52191.cljs$core$IFn$_invoke$arity$1(attr) : fexpr__52191.call(null,attr));
})();
if((temp__5806__auto__ \x3d\x3d null)){
if(cljs.core.truth_(cljs.core.deref(this$.touched))){
return not_found;
} else {
var temp__5806__auto____$1 \x3d cljs.core.not_empty(datascript.db._search(this$.db,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [this$.eid,attr], null)));
if((temp__5806__auto____$1 \x3d\x3d null)){
return not_found;
} else {
var datoms \x3d temp__5806__auto____$1;
var value \x3d datascript.impl.entity.entity_attr(this$.db,attr,datoms);
cljs.core.vreset_BANG_(this$.cache,cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(cljs.core.deref(this$.cache),attr,value));

return value;
}
}
} else {
var v \x3d temp__5806__auto__;
return v;
}
}
}
}));

(datascript.impl.entity.lookup_entity.cljs$lang$maxFixedArity \x3d 3);

datascript.impl.entity.touch_components \x3d (function datascript$impl$entity$touch_components(db,a__GT_v){
return cljs.core.reduce_kv((function (acc,a,v){
return cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(acc,a,((datascript.db.component_QMARK_(db,a))?((datascript.db.multival_QMARK_(db,a))?cljs.core.set(cljs.core.map.cljs$core$IFn$_invoke$arity$2(datascript.impl.entity.touch,v)):(datascript.impl.entity.touch.cljs$core$IFn$_invoke$arity$1 ? datascript.impl.entity.touch.cljs$core$IFn$_invoke$arity$1(v) : datascript.impl.entity.touch.call(null,v))):v));
}),cljs.core.PersistentArrayMap.EMPTY,a__GT_v);
});
datascript.impl.entity.datoms__GT_cache \x3d (function datascript$impl$entity$datoms__GT_cache(db,datoms){
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (acc,part){
var a \x3d new cljs.core.Keyword(null,\x22a\x22,\x22a\x22,-2123407586).cljs$core$IFn$_invoke$arity$1(cljs.core.first(part));
return cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(acc,a,datascript.impl.entity.entity_attr(db,a,part));
}),cljs.core.PersistentArrayMap.EMPTY,cljs.core.partition_by.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22a\x22,\x22a\x22,-2123407586),datoms));
});
datascript.impl.entity.touch \x3d (function datascript$impl$entity$touch(e){
if(datascript.impl.entity.entity_QMARK_(e)){
} else {
throw (new Error(\x22Assert failed: (entity? e)\x22));
}

if(cljs.core.truth_(cljs.core.deref(e.touched))){
} else {
var temp__5804__auto___52296 \x3d cljs.core.not_empty(datascript.db._search(e.db,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [e.eid], null)));
if(cljs.core.truth_(temp__5804__auto___52296)){
var datoms_52297 \x3d temp__5804__auto___52296;
cljs.core.vreset_BANG_(e.cache,datascript.impl.entity.touch_components(e.db,datascript.impl.entity.datoms__GT_cache(e.db,datoms_52297)));

cljs.core.vreset_BANG_(e.touched,true);
} else {
}
}

return e;
});
goog.exportSymbol(\x22datascript.impl.entity.Entity\x22,datascript.impl.entity.Entity);
");
SHADOW_ENV.evalLoad("datascript.built_ins.js", true , "goog.provide(\x27datascript.built_ins\x27);
datascript.built_ins._differ_QMARK_ \x3d (function datascript$built_ins$_differ_QMARK_(var_args){
var args__5775__auto__ \x3d [];
var len__5769__auto___53850 \x3d arguments.length;
var i__5770__auto___53851 \x3d (0);
while(true){
if((i__5770__auto___53851 \x3c len__5769__auto___53850)){
args__5775__auto__.push((arguments[i__5770__auto___53851]));

var G__53852 \x3d (i__5770__auto___53851 + (1));
i__5770__auto___53851 \x3d G__53852;
continue;
} else {
}
break;
}

var argseq__5776__auto__ \x3d ((((0) \x3c args__5775__auto__.length))?(new cljs.core.IndexedSeq(args__5775__auto__.slice((0)),(0),null)):null);
return datascript.built_ins._differ_QMARK_.cljs$core$IFn$_invoke$arity$variadic(argseq__5776__auto__);
});

(datascript.built_ins._differ_QMARK_.cljs$core$IFn$_invoke$arity$variadic \x3d (function (xs){
var l \x3d cljs.core.count(xs);
return cljs.core.not_EQ_.cljs$core$IFn$_invoke$arity$2(cljs.core.take.cljs$core$IFn$_invoke$arity$2((l / (2)),xs),cljs.core.drop.cljs$core$IFn$_invoke$arity$2((l / (2)),xs));
}));

(datascript.built_ins._differ_QMARK_.cljs$lang$maxFixedArity \x3d (0));

/** @this {Function} */
(datascript.built_ins._differ_QMARK_.cljs$lang$applyTo \x3d (function (seq53740){
var self__5755__auto__ \x3d this;
return self__5755__auto__.cljs$core$IFn$_invoke$arity$variadic(cljs.core.seq(seq53740));
}));

datascript.built_ins._get_else \x3d (function datascript$built_ins$_get_else(db,e,a,else_val){
if((else_val \x3d\x3d null)){
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2(\x22get-else: nil default value is not supported\x22,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22query\x22,\x22where\x22,\x22query/where\x22,-1935159429)], null));
} else {
}

var temp__5806__auto__ \x3d cljs.core.first(datascript.db._search(db,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [e,a], null)));
if((temp__5806__auto__ \x3d\x3d null)){
return else_val;
} else {
var datom \x3d temp__5806__auto__;
return new cljs.core.Keyword(null,\x22v\x22,\x22v\x22,21465059).cljs$core$IFn$_invoke$arity$1(datom);
}
});
datascript.built_ins._get_some \x3d (function datascript$built_ins$_get_some(var_args){
var args__5775__auto__ \x3d [];
var len__5769__auto___53858 \x3d arguments.length;
var i__5770__auto___53859 \x3d (0);
while(true){
if((i__5770__auto___53859 \x3c len__5769__auto___53858)){
args__5775__auto__.push((arguments[i__5770__auto___53859]));

var G__53861 \x3d (i__5770__auto___53859 + (1));
i__5770__auto___53859 \x3d G__53861;
continue;
} else {
}
break;
}

var argseq__5776__auto__ \x3d ((((2) \x3c args__5775__auto__.length))?(new cljs.core.IndexedSeq(args__5775__auto__.slice((2)),(0),null)):null);
return datascript.built_ins._get_some.cljs$core$IFn$_invoke$arity$variadic((arguments[(0)]),(arguments[(1)]),argseq__5776__auto__);
});

(datascript.built_ins._get_some.cljs$core$IFn$_invoke$arity$variadic \x3d (function (db,e,as){
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (_,a){
var temp__5808__auto__ \x3d cljs.core.first(datascript.db._search(db,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [e,a], null)));
if((temp__5808__auto__ \x3d\x3d null)){
return null;
} else {
var datom \x3d temp__5808__auto__;
return cljs.core.reduced(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22a\x22,\x22a\x22,-2123407586).cljs$core$IFn$_invoke$arity$1(datom),new cljs.core.Keyword(null,\x22v\x22,\x22v\x22,21465059).cljs$core$IFn$_invoke$arity$1(datom)], null));
}
}),null,as);
}));

(datascript.built_ins._get_some.cljs$lang$maxFixedArity \x3d (2));

/** @this {Function} */
(datascript.built_ins._get_some.cljs$lang$applyTo \x3d (function (seq53741){
var G__53742 \x3d cljs.core.first(seq53741);
var seq53741__$1 \x3d cljs.core.next(seq53741);
var G__53743 \x3d cljs.core.first(seq53741__$1);
var seq53741__$2 \x3d cljs.core.next(seq53741__$1);
var self__5754__auto__ \x3d this;
return self__5754__auto__.cljs$core$IFn$_invoke$arity$variadic(G__53742,G__53743,seq53741__$2);
}));

datascript.built_ins._missing_QMARK_ \x3d (function datascript$built_ins$_missing_QMARK_(db,e,a){
return (cljs.core.get.cljs$core$IFn$_invoke$arity$2(datascript.impl.entity.entity(db,e),a) \x3d\x3d null);
});
datascript.built_ins.and_fn \x3d (function datascript$built_ins$and_fn(var_args){
var args__5775__auto__ \x3d [];
var len__5769__auto___53866 \x3d arguments.length;
var i__5770__auto___53867 \x3d (0);
while(true){
if((i__5770__auto___53867 \x3c len__5769__auto___53866)){
args__5775__auto__.push((arguments[i__5770__auto___53867]));

var G__53868 \x3d (i__5770__auto___53867 + (1));
i__5770__auto___53867 \x3d G__53868;
continue;
} else {
}
break;
}

var argseq__5776__auto__ \x3d ((((0) \x3c args__5775__auto__.length))?(new cljs.core.IndexedSeq(args__5775__auto__.slice((0)),(0),null)):null);
return datascript.built_ins.and_fn.cljs$core$IFn$_invoke$arity$variadic(argseq__5776__auto__);
});

(datascript.built_ins.and_fn.cljs$core$IFn$_invoke$arity$variadic \x3d (function (args){
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (a,b){
if(cljs.core.truth_(b)){
return b;
} else {
return cljs.core.reduced(b);
}
}),true,args);
}));

(datascript.built_ins.and_fn.cljs$lang$maxFixedArity \x3d (0));

/** @this {Function} */
(datascript.built_ins.and_fn.cljs$lang$applyTo \x3d (function (seq53755){
var self__5755__auto__ \x3d this;
return self__5755__auto__.cljs$core$IFn$_invoke$arity$variadic(cljs.core.seq(seq53755));
}));

datascript.built_ins.or_fn \x3d (function datascript$built_ins$or_fn(var_args){
var args__5775__auto__ \x3d [];
var len__5769__auto___53869 \x3d arguments.length;
var i__5770__auto___53870 \x3d (0);
while(true){
if((i__5770__auto___53870 \x3c len__5769__auto___53869)){
args__5775__auto__.push((arguments[i__5770__auto___53870]));

var G__53871 \x3d (i__5770__auto___53870 + (1));
i__5770__auto___53870 \x3d G__53871;
continue;
} else {
}
break;
}

var argseq__5776__auto__ \x3d ((((0) \x3c args__5775__auto__.length))?(new cljs.core.IndexedSeq(args__5775__auto__.slice((0)),(0),null)):null);
return datascript.built_ins.or_fn.cljs$core$IFn$_invoke$arity$variadic(argseq__5776__auto__);
});

(datascript.built_ins.or_fn.cljs$core$IFn$_invoke$arity$variadic \x3d (function (args){
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (a,b){
if(cljs.core.truth_(b)){
return cljs.core.reduced(b);
} else {
return b;
}
}),null,args);
}));

(datascript.built_ins.or_fn.cljs$lang$maxFixedArity \x3d (0));

/** @this {Function} */
(datascript.built_ins.or_fn.cljs$lang$applyTo \x3d (function (seq53758){
var self__5755__auto__ \x3d this;
return self__5755__auto__.cljs$core$IFn$_invoke$arity$variadic(cljs.core.seq(seq53758));
}));

datascript.built_ins.less \x3d (function datascript$built_ins$less(var_args){
var G__53767 \x3d arguments.length;
switch (G__53767) {
case 1:
return datascript.built_ins.less.cljs$core$IFn$_invoke$arity$1((arguments[(0)]));

break;
case 2:
return datascript.built_ins.less.cljs$core$IFn$_invoke$arity$2((arguments[(0)]),(arguments[(1)]));

break;
default:
var args_arr__5794__auto__ \x3d [];
var len__5769__auto___53873 \x3d arguments.length;
var i__5770__auto___53874 \x3d (0);
while(true){
if((i__5770__auto___53874 \x3c len__5769__auto___53873)){
args_arr__5794__auto__.push((arguments[i__5770__auto___53874]));

var G__53875 \x3d (i__5770__auto___53874 + (1));
i__5770__auto___53874 \x3d G__53875;
continue;
} else {
}
break;
}

var argseq__5795__auto__ \x3d (new cljs.core.IndexedSeq(args_arr__5794__auto__.slice((2)),(0),null));
return datascript.built_ins.less.cljs$core$IFn$_invoke$arity$variadic((arguments[(0)]),(arguments[(1)]),argseq__5795__auto__);

}
});

(datascript.built_ins.less.cljs$core$IFn$_invoke$arity$1 \x3d (function (x){
return true;
}));

(datascript.built_ins.less.cljs$core$IFn$_invoke$arity$2 \x3d (function (x,y){
return (datascript.db.value_compare(x,y) \x3c (0));
}));

(datascript.built_ins.less.cljs$core$IFn$_invoke$arity$variadic \x3d (function (x,y,more){
while(true){
if(datascript.built_ins.less.cljs$core$IFn$_invoke$arity$2(x,y)){
if(cljs.core.next(more)){
var G__53876 \x3d y;
var G__53877 \x3d cljs.core.first(more);
var G__53878 \x3d cljs.core.next(more);
x \x3d G__53876;
y \x3d G__53877;
more \x3d G__53878;
continue;
} else {
return datascript.built_ins.less.cljs$core$IFn$_invoke$arity$2(y,cljs.core.first(more));
}
} else {
return false;
}
break;
}
}));

/** @this {Function} */
(datascript.built_ins.less.cljs$lang$applyTo \x3d (function (seq53764){
var G__53765 \x3d cljs.core.first(seq53764);
var seq53764__$1 \x3d cljs.core.next(seq53764);
var G__53766 \x3d cljs.core.first(seq53764__$1);
var seq53764__$2 \x3d cljs.core.next(seq53764__$1);
var self__5754__auto__ \x3d this;
return self__5754__auto__.cljs$core$IFn$_invoke$arity$variadic(G__53765,G__53766,seq53764__$2);
}));

(datascript.built_ins.less.cljs$lang$maxFixedArity \x3d (2));

datascript.built_ins.greater \x3d (function datascript$built_ins$greater(var_args){
var G__53787 \x3d arguments.length;
switch (G__53787) {
case 1:
return datascript.built_ins.greater.cljs$core$IFn$_invoke$arity$1((arguments[(0)]));

break;
case 2:
return datascript.built_ins.greater.cljs$core$IFn$_invoke$arity$2((arguments[(0)]),(arguments[(1)]));

break;
default:
var args_arr__5794__auto__ \x3d [];
var len__5769__auto___53881 \x3d arguments.length;
var i__5770__auto___53882 \x3d (0);
while(true){
if((i__5770__auto___53882 \x3c len__5769__auto___53881)){
args_arr__5794__auto__.push((arguments[i__5770__auto___53882]));

var G__53886 \x3d (i__5770__auto___53882 + (1));
i__5770__auto___53882 \x3d G__53886;
continue;
} else {
}
break;
}

var argseq__5795__auto__ \x3d (new cljs.core.IndexedSeq(args_arr__5794__auto__.slice((2)),(0),null));
return datascript.built_ins.greater.cljs$core$IFn$_invoke$arity$variadic((arguments[(0)]),(arguments[(1)]),argseq__5795__auto__);

}
});

(datascript.built_ins.greater.cljs$core$IFn$_invoke$arity$1 \x3d (function (x){
return true;
}));

(datascript.built_ins.greater.cljs$core$IFn$_invoke$arity$2 \x3d (function (x,y){
return (datascript.db.value_compare(x,y) \x3e (0));
}));

(datascript.built_ins.greater.cljs$core$IFn$_invoke$arity$variadic \x3d (function (x,y,more){
while(true){
if(datascript.built_ins.greater.cljs$core$IFn$_invoke$arity$2(x,y)){
if(cljs.core.next(more)){
var G__53887 \x3d y;
var G__53888 \x3d cljs.core.first(more);
var G__53889 \x3d cljs.core.next(more);
x \x3d G__53887;
y \x3d G__53888;
more \x3d G__53889;
continue;
} else {
return datascript.built_ins.greater.cljs$core$IFn$_invoke$arity$2(y,cljs.core.first(more));
}
} else {
return false;
}
break;
}
}));

/** @this {Function} */
(datascript.built_ins.greater.cljs$lang$applyTo \x3d (function (seq53784){
var G__53785 \x3d cljs.core.first(seq53784);
var seq53784__$1 \x3d cljs.core.next(seq53784);
var G__53786 \x3d cljs.core.first(seq53784__$1);
var seq53784__$2 \x3d cljs.core.next(seq53784__$1);
var self__5754__auto__ \x3d this;
return self__5754__auto__.cljs$core$IFn$_invoke$arity$variadic(G__53785,G__53786,seq53784__$2);
}));

(datascript.built_ins.greater.cljs$lang$maxFixedArity \x3d (2));

datascript.built_ins.less_equal \x3d (function datascript$built_ins$less_equal(var_args){
var G__53798 \x3d arguments.length;
switch (G__53798) {
case 1:
return datascript.built_ins.less_equal.cljs$core$IFn$_invoke$arity$1((arguments[(0)]));

break;
case 2:
return datascript.built_ins.less_equal.cljs$core$IFn$_invoke$arity$2((arguments[(0)]),(arguments[(1)]));

break;
default:
var args_arr__5794__auto__ \x3d [];
var len__5769__auto___53891 \x3d arguments.length;
var i__5770__auto___53892 \x3d (0);
while(true){
if((i__5770__auto___53892 \x3c len__5769__auto___53891)){
args_arr__5794__auto__.push((arguments[i__5770__auto___53892]));

var G__53893 \x3d (i__5770__auto___53892 + (1));
i__5770__auto___53892 \x3d G__53893;
continue;
} else {
}
break;
}

var argseq__5795__auto__ \x3d (new cljs.core.IndexedSeq(args_arr__5794__auto__.slice((2)),(0),null));
return datascript.built_ins.less_equal.cljs$core$IFn$_invoke$arity$variadic((arguments[(0)]),(arguments[(1)]),argseq__5795__auto__);

}
});

(datascript.built_ins.less_equal.cljs$core$IFn$_invoke$arity$1 \x3d (function (x){
return true;
}));

(datascript.built_ins.less_equal.cljs$core$IFn$_invoke$arity$2 \x3d (function (x,y){
return (!((datascript.db.value_compare(x,y) \x3e (0))));
}));

(datascript.built_ins.less_equal.cljs$core$IFn$_invoke$arity$variadic \x3d (function (x,y,more){
while(true){
if(datascript.built_ins.less_equal.cljs$core$IFn$_invoke$arity$2(x,y)){
if(cljs.core.next(more)){
var G__53894 \x3d y;
var G__53895 \x3d cljs.core.first(more);
var G__53896 \x3d cljs.core.next(more);
x \x3d G__53894;
y \x3d G__53895;
more \x3d G__53896;
continue;
} else {
return datascript.built_ins.less_equal.cljs$core$IFn$_invoke$arity$2(y,cljs.core.first(more));
}
} else {
return false;
}
break;
}
}));

/** @this {Function} */
(datascript.built_ins.less_equal.cljs$lang$applyTo \x3d (function (seq53795){
var G__53796 \x3d cljs.core.first(seq53795);
var seq53795__$1 \x3d cljs.core.next(seq53795);
var G__53797 \x3d cljs.core.first(seq53795__$1);
var seq53795__$2 \x3d cljs.core.next(seq53795__$1);
var self__5754__auto__ \x3d this;
return self__5754__auto__.cljs$core$IFn$_invoke$arity$variadic(G__53796,G__53797,seq53795__$2);
}));

(datascript.built_ins.less_equal.cljs$lang$maxFixedArity \x3d (2));

datascript.built_ins.greater_equal \x3d (function datascript$built_ins$greater_equal(var_args){
var G__53803 \x3d arguments.length;
switch (G__53803) {
case 1:
return datascript.built_ins.greater_equal.cljs$core$IFn$_invoke$arity$1((arguments[(0)]));

break;
case 2:
return datascript.built_ins.greater_equal.cljs$core$IFn$_invoke$arity$2((arguments[(0)]),(arguments[(1)]));

break;
default:
var args_arr__5794__auto__ \x3d [];
var len__5769__auto___53898 \x3d arguments.length;
var i__5770__auto___53899 \x3d (0);
while(true){
if((i__5770__auto___53899 \x3c len__5769__auto___53898)){
args_arr__5794__auto__.push((arguments[i__5770__auto___53899]));

var G__53900 \x3d (i__5770__auto___53899 + (1));
i__5770__auto___53899 \x3d G__53900;
continue;
} else {
}
break;
}

var argseq__5795__auto__ \x3d (new cljs.core.IndexedSeq(args_arr__5794__auto__.slice((2)),(0),null));
return datascript.built_ins.greater_equal.cljs$core$IFn$_invoke$arity$variadic((arguments[(0)]),(arguments[(1)]),argseq__5795__auto__);

}
});

(datascript.built_ins.greater_equal.cljs$core$IFn$_invoke$arity$1 \x3d (function (x){
return true;
}));

(datascript.built_ins.greater_equal.cljs$core$IFn$_invoke$arity$2 \x3d (function (x,y){
return (!((datascript.db.value_compare(x,y) \x3c (0))));
}));

(datascript.built_ins.greater_equal.cljs$core$IFn$_invoke$arity$variadic \x3d (function (x,y,more){
while(true){
if(datascript.built_ins.greater_equal.cljs$core$IFn$_invoke$arity$2(x,y)){
if(cljs.core.next(more)){
var G__53901 \x3d y;
var G__53902 \x3d cljs.core.first(more);
var G__53903 \x3d cljs.core.next(more);
x \x3d G__53901;
y \x3d G__53902;
more \x3d G__53903;
continue;
} else {
return datascript.built_ins.greater_equal.cljs$core$IFn$_invoke$arity$2(y,cljs.core.first(more));
}
} else {
return false;
}
break;
}
}));

/** @this {Function} */
(datascript.built_ins.greater_equal.cljs$lang$applyTo \x3d (function (seq53800){
var G__53801 \x3d cljs.core.first(seq53800);
var seq53800__$1 \x3d cljs.core.next(seq53800);
var G__53802 \x3d cljs.core.first(seq53800__$1);
var seq53800__$2 \x3d cljs.core.next(seq53800__$1);
var self__5754__auto__ \x3d this;
return self__5754__auto__.cljs$core$IFn$_invoke$arity$variadic(G__53801,G__53802,seq53800__$2);
}));

(datascript.built_ins.greater_equal.cljs$lang$maxFixedArity \x3d (2));

datascript.built_ins.query_fns \x3d cljs.core.PersistentHashMap.fromArrays([new cljs.core.Symbol(null,\x22true?\x22,\x22true?\x22,-1600332395,null),new cljs.core.Symbol(null,\x22and\x22,\x22and\x22,668631710,null),new cljs.core.Symbol(null,\x22odd?\x22,\x22odd?\x22,-1458588199,null),new cljs.core.Symbol(null,\x22get-else\x22,\x22get-else\x22,1312024065,null),new cljs.core.Symbol(null,\x22\x3e\x3d\x22,\x22\x3e\x3d\x22,1016916022,null),new cljs.core.Symbol(null,\x22print-str\x22,\x22print-str\x22,-699700354,null),new cljs.core.Symbol(null,\x22\x3e\x22,\x22\x3e\x22,1085014381,null),new cljs.core.Symbol(null,\x22count\x22,\x22count\x22,-514511684,null),new cljs.core.Symbol(null,\x22get-some\x22,\x22get-some\x22,409442058,null),new cljs.core.Symbol(null,\x22nil?\x22,\x22nil?\x22,1612038930,null),new cljs.core.Symbol(null,\x22untuple\x22,\x22untuple\x22,-606149900,null),new cljs.core.Symbol(null,\x22inc\x22,\x22inc\x22,324505433,null),new cljs.core.Symbol(null,\x22/\x22,\x22/\x22,-1371932971,null),new cljs.core.Symbol(null,\x22quot\x22,\x22quot\x22,-1125214196,null),new cljs.core.Symbol(null,\x22false?\x22,\x22false?\x22,-1522377573,null),new cljs.core.Symbol(null,\x22not\x22,\x22not\x22,1044554643,null),new cljs.core.Symbol(null,\x22identity\x22,\x22identity\x22,-1007039734,null),new cljs.core.Symbol(null,\x22-differ?\x22,\x22-differ?\x22,1465687357,null),new cljs.core.Symbol(null,\x22tuple\x22,\x22tuple\x22,1167864243,null),new cljs.core.Symbol(null,\x22re-seq\x22,\x22re-seq\x22,-2105554076,null),new cljs.core.Symbol(null,\x22\x3c\x3d\x22,\x22\x3c\x3d\x22,1244895369,null),new cljs.core.Symbol(\x22clojure.string\x22,\x22starts-with?\x22,\x22clojure.string/starts-with?\x22,656256322,null),new cljs.core.Symbol(null,\x22\x3d\x22,\x22\x3d\x22,-1501502141,null),new cljs.core.Symbol(null,\x22min\x22,\x22min\x22,2085523049,null),new cljs.core.Symbol(null,\x22+\x22,\x22+\x22,-740910886,null),new cljs.core.Symbol(null,\x22name\x22,\x22name\x22,-810760592,null),new cljs.core.Symbol(null,\x22missing?\x22,\x22missing?\x22,-1710383910,null),new cljs.core.Symbol(null,\x22ground\x22,\x22ground\x22,-1460862835,null),new cljs.core.Symbol(null,\x22rand-int\x22,\x22rand-int\x22,-495012157,null),new cljs.core.Symbol(null,\x22complement\x22,\x22complement\x22,-913606051,null),new cljs.core.Symbol(null,\x22\x3d\x3d\x22,\x22\x3d\x3d\x22,-234118149,null),new cljs.core.Symbol(null,\x22hash-map\x22,\x22hash-map\x22,-439030950,null),new cljs.core.Symbol(null,\x22compare\x22,\x22compare\x22,1109853757,null),new cljs.core.Symbol(null,\x22range\x22,\x22range\x22,-1014743483,null),new cljs.core.Symbol(null,\x22max\x22,\x22max\x22,1701898075,null),new cljs.core.Symbol(null,\x22empty?\x22,\x22empty?\x22,76408555,null),new cljs.core.Symbol(null,\x22*\x22,\x22*\x22,345799209,null),new cljs.core.Symbol(null,\x22pr-str\x22,\x22pr-str\x22,-2066912145,null),new cljs.core.Symbol(null,\x22println-str\x22,\x22println-str\x22,-2049216703,null),new cljs.core.Symbol(null,\x22meta\x22,\x22meta\x22,-1154898805,null),new cljs.core.Symbol(null,\x22zero?\x22,\x22zero?\x22,325758897,null),new cljs.core.Symbol(null,\x22!\x3d\x22,\x22!\x3d\x22,-201205829,null),new cljs.core.Symbol(null,\x22prn-str\x22,\x22prn-str\x22,-145225943,null),new cljs.core.Symbol(null,\x22dec\x22,\x22dec\x22,-766002333,null),new cljs.core.Symbol(null,\x22re-pattern\x22,\x22re-pattern\x22,1047705161,null),new cljs.core.Symbol(null,\x22vector\x22,\x22vector\x22,-751469611,null),new cljs.core.Symbol(null,\x22not\x3d\x22,\x22not\x3d\x22,1466536204,null),new cljs.core.Symbol(null,\x22get\x22,\x22get\x22,-971253014,null),new cljs.core.Symbol(null,\x22str\x22,\x22str\x22,-1564826950,null),new cljs.core.Symbol(null,\x22\x3c\x22,\x22\x3c\x22,993667236,null),new cljs.core.Symbol(null,\x22namespace\x22,\x22namespace\x22,1263021155,null),new cljs.core.Symbol(null,\x22keyword\x22,\x22keyword\x22,-1843046022,null),new cljs.core.Symbol(null,\x22-\x22,\x22-\x22,-471816912,null),new cljs.core.Symbol(null,\x22some?\x22,\x22some?\x22,234752293,null),new cljs.core.Symbol(null,\x22pos?\x22,\x22pos?\x22,-244377722,null),new cljs.core.Symbol(null,\x22rand\x22,\x22rand\x22,-1745930995,null),new cljs.core.Symbol(null,\x22re-matches\x22,\x22re-matches\x22,-1865705768,null),new cljs.core.Symbol(null,\x22list\x22,\x22list\x22,-1889078086,null),new cljs.core.Symbol(null,\x22contains?\x22,\x22contains?\x22,-1676812576,null),new cljs.core.Symbol(\x22clojure.string\x22,\x22ends-with?\x22,\x22clojure.string/ends-with?\x22,-745964149,null),new cljs.core.Symbol(null,\x22subs\x22,\x22subs\x22,1453849536,null),new cljs.core.Symbol(null,\x22mod\x22,\x22mod\x22,1510044207,null),new cljs.core.Symbol(\x22clojure.string\x22,\x22includes?\x22,\x22clojure.string/includes?\x22,-1842146260,null),new cljs.core.Symbol(null,\x22array-map\x22,\x22array-map\x22,1555038968,null),new cljs.core.Symbol(null,\x22rem\x22,\x22rem\x22,664046770,null),new cljs.core.Symbol(null,\x22even?\x22,\x22even?\x22,-1827825394,null),new cljs.core.Symbol(null,\x22type\x22,\x22type\x22,-1480165421,null),new cljs.core.Symbol(null,\x22neg?\x22,\x22neg?\x22,-1902175577,null),new cljs.core.Symbol(\x22clojure.string\x22,\x22blank?\x22,\x22clojure.string/blank?\x22,1772874244,null),new cljs.core.Symbol(null,\x22not-empty\x22,\x22not-empty\x22,2029453590,null),new cljs.core.Symbol(null,\x22or\x22,\x22or\x22,1876275696,null),new cljs.core.Symbol(null,\x22identical?\x22,\x22identical?\x22,-745864205,null),new cljs.core.Symbol(null,\x22set\x22,\x22set\x22,1945134081,null),new cljs.core.Symbol(null,\x22re-find\x22,\x22re-find\x22,1143444147,null)],[cljs.core.true_QMARK_,datascript.built_ins.and_fn,cljs.core.odd_QMARK_,datascript.built_ins._get_else,datascript.built_ins.greater_equal,cljs.core.print_str,datascript.built_ins.greater,cljs.core.count,datascript.built_ins._get_some,cljs.core.nil_QMARK_,cljs.core.identity,cljs.core.inc,cljs.core._SLASH_,cljs.core.quot,cljs.core.false_QMARK_,cljs.core.not,cljs.core.identity,datascript.built_ins._differ_QMARK_,cljs.core.vector,cljs.core.re_seq,datascript.built_ins.less_equal,clojure.string.starts_with_QMARK_,cljs.core._EQ_,cljs.core.min,cljs.core._PLUS_,cljs.core.name,datascript.built_ins._missing_QMARK_,cljs.core.identity,cljs.core.rand_int,cljs.core.complement,cljs.core._EQ__EQ_,cljs.core.hash_map,cljs.core.compare,cljs.core.range,cljs.core.max,cljs.core.empty_QMARK_,cljs.core._STAR_,cljs.core.pr_str,cljs.core.println_str,cljs.core.meta,cljs.core.zero_QMARK_,cljs.core.not_EQ_,cljs.core.prn_str,cljs.core.dec,cljs.core.re_pattern,cljs.core.vector,cljs.core.not_EQ_,cljs.core.get,cljs.core.str,datascript.built_ins.less,cljs.core.namespace,cljs.core.keyword,cljs.core._,cljs.core.some_QMARK_,cljs.core.pos_QMARK_,cljs.core.rand,cljs.core.re_matches,cljs.core.list,cljs.core.contains_QMARK_,clojure.string.ends_with_QMARK_,cljs.core.subs,cljs.core.mod,clojure.string.includes_QMARK_,cljs.core.array_map,cljs.core.rem,cljs.core.even_QMARK_,cljs.core.type,cljs.core.neg_QMARK_,clojure.string.blank_QMARK_,cljs.core.not_empty,datascript.built_ins.or_fn,cljs.core.identical_QMARK_,cljs.core.set,cljs.core.re_find]);
datascript.built_ins.aggregate_sum \x3d (function datascript$built_ins$aggregate_sum(coll){
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(cljs.core._PLUS_,(0),coll);
});
datascript.built_ins.aggregate_avg \x3d (function datascript$built_ins$aggregate_avg(coll){
return (datascript.built_ins.aggregate_sum(coll) / cljs.core.count(coll));
});
datascript.built_ins.aggregate_median \x3d (function datascript$built_ins$aggregate_median(coll){
var terms \x3d cljs.core.sort.cljs$core$IFn$_invoke$arity$1(coll);
var size \x3d cljs.core.count(coll);
var med \x3d (size \x3e\x3e (1));
var G__53816 \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$2(terms,med);
if(cljs.core.even_QMARK_(size)){
return ((G__53816 + cljs.core.nth.cljs$core$IFn$_invoke$arity$2(terms,(med - (1)))) / (2));
} else {
return G__53816;
}
});
datascript.built_ins.aggregate_variance \x3d (function datascript$built_ins$aggregate_variance(coll){
var mean \x3d datascript.built_ins.aggregate_avg(coll);
var sum \x3d datascript.built_ins.aggregate_sum((function (){var iter__5523__auto__ \x3d (function datascript$built_ins$aggregate_variance_$_iter__53818(s__53819){
return (new cljs.core.LazySeq(null,(function (){
var s__53819__$1 \x3d s__53819;
while(true){
var temp__5804__auto__ \x3d cljs.core.seq(s__53819__$1);
if(temp__5804__auto__){
var s__53819__$2 \x3d temp__5804__auto__;
if(cljs.core.chunked_seq_QMARK_(s__53819__$2)){
var c__5521__auto__ \x3d cljs.core.chunk_first(s__53819__$2);
var size__5522__auto__ \x3d cljs.core.count(c__5521__auto__);
var b__53821 \x3d cljs.core.chunk_buffer(size__5522__auto__);
if((function (){var i__53820 \x3d (0);
while(true){
if((i__53820 \x3c size__5522__auto__)){
var x \x3d cljs.core._nth(c__5521__auto__,i__53820);
var delta \x3d (x - mean);
cljs.core.chunk_append(b__53821,(delta * delta));

var G__53922 \x3d (i__53820 + (1));
i__53820 \x3d G__53922;
continue;
} else {
return true;
}
break;
}
})()){
return cljs.core.chunk_cons(cljs.core.chunk(b__53821),datascript$built_ins$aggregate_variance_$_iter__53818(cljs.core.chunk_rest(s__53819__$2)));
} else {
return cljs.core.chunk_cons(cljs.core.chunk(b__53821),null);
}
} else {
var x \x3d cljs.core.first(s__53819__$2);
var delta \x3d (x - mean);
return cljs.core.cons((delta * delta),datascript$built_ins$aggregate_variance_$_iter__53818(cljs.core.rest(s__53819__$2)));
}
} else {
return null;
}
break;
}
}),null,null));
});
return iter__5523__auto__(coll);
})());
return (sum / cljs.core.count(coll));
});
datascript.built_ins.aggregate_stddev \x3d (function datascript$built_ins$aggregate_stddev(coll){
return Math.sqrt(datascript.built_ins.aggregate_variance(coll));
});
datascript.built_ins.aggregate_min \x3d (function datascript$built_ins$aggregate_min(var_args){
var G__53827 \x3d arguments.length;
switch (G__53827) {
case 1:
return datascript.built_ins.aggregate_min.cljs$core$IFn$_invoke$arity$1((arguments[(0)]));

break;
case 2:
return datascript.built_ins.aggregate_min.cljs$core$IFn$_invoke$arity$2((arguments[(0)]),(arguments[(1)]));

break;
default:
throw (new Error([\x22Invalid arity: \x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1(arguments.length)].join(\x27\x27)));

}
});

(datascript.built_ins.aggregate_min.cljs$core$IFn$_invoke$arity$1 \x3d (function (coll){
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (acc,x){
if((cljs.core.compare(x,acc) \x3c (0))){
return x;
} else {
return acc;
}
}),cljs.core.first(coll),cljs.core.next(coll));
}));

(datascript.built_ins.aggregate_min.cljs$core$IFn$_invoke$arity$2 \x3d (function (n,coll){
return cljs.core.vec(cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (acc,x){
if((cljs.core.count(acc) \x3c n)){
return cljs.core.sort.cljs$core$IFn$_invoke$arity$2(cljs.core.compare,cljs.core.conj.cljs$core$IFn$_invoke$arity$2(acc,x));
} else {
if((cljs.core.compare(x,cljs.core.last(acc)) \x3c (0))){
return cljs.core.sort.cljs$core$IFn$_invoke$arity$2(cljs.core.compare,cljs.core.conj.cljs$core$IFn$_invoke$arity$2(cljs.core.butlast(acc),x));
} else {
return acc;

}
}
}),cljs.core.PersistentVector.EMPTY,coll));
}));

(datascript.built_ins.aggregate_min.cljs$lang$maxFixedArity \x3d 2);

datascript.built_ins.aggregate_max \x3d (function datascript$built_ins$aggregate_max(var_args){
var G__53833 \x3d arguments.length;
switch (G__53833) {
case 1:
return datascript.built_ins.aggregate_max.cljs$core$IFn$_invoke$arity$1((arguments[(0)]));

break;
case 2:
return datascript.built_ins.aggregate_max.cljs$core$IFn$_invoke$arity$2((arguments[(0)]),(arguments[(1)]));

break;
default:
throw (new Error([\x22Invalid arity: \x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1(arguments.length)].join(\x27\x27)));

}
});

(datascript.built_ins.aggregate_max.cljs$core$IFn$_invoke$arity$1 \x3d (function (coll){
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (acc,x){
if((cljs.core.compare(x,acc) \x3e (0))){
return x;
} else {
return acc;
}
}),cljs.core.first(coll),cljs.core.next(coll));
}));

(datascript.built_ins.aggregate_max.cljs$core$IFn$_invoke$arity$2 \x3d (function (n,coll){
return cljs.core.vec(cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (acc,x){
if((cljs.core.count(acc) \x3c n)){
return cljs.core.sort.cljs$core$IFn$_invoke$arity$2(cljs.core.compare,cljs.core.conj.cljs$core$IFn$_invoke$arity$2(acc,x));
} else {
if((cljs.core.compare(x,cljs.core.first(acc)) \x3e (0))){
return cljs.core.sort.cljs$core$IFn$_invoke$arity$2(cljs.core.compare,cljs.core.conj.cljs$core$IFn$_invoke$arity$2(cljs.core.next(acc),x));
} else {
return acc;

}
}
}),cljs.core.PersistentVector.EMPTY,coll));
}));

(datascript.built_ins.aggregate_max.cljs$lang$maxFixedArity \x3d 2);

datascript.built_ins.aggregate_rand \x3d (function datascript$built_ins$aggregate_rand(var_args){
var G__53835 \x3d arguments.length;
switch (G__53835) {
case 1:
return datascript.built_ins.aggregate_rand.cljs$core$IFn$_invoke$arity$1((arguments[(0)]));

break;
case 2:
return datascript.built_ins.aggregate_rand.cljs$core$IFn$_invoke$arity$2((arguments[(0)]),(arguments[(1)]));

break;
default:
throw (new Error([\x22Invalid arity: \x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1(arguments.length)].join(\x27\x27)));

}
});

(datascript.built_ins.aggregate_rand.cljs$core$IFn$_invoke$arity$1 \x3d (function (coll){
return cljs.core.rand_nth(coll);
}));

(datascript.built_ins.aggregate_rand.cljs$core$IFn$_invoke$arity$2 \x3d (function (n,coll){
return cljs.core.vec(cljs.core.repeatedly.cljs$core$IFn$_invoke$arity$2(n,(function (){
return cljs.core.rand_nth(coll);
})));
}));

(datascript.built_ins.aggregate_rand.cljs$lang$maxFixedArity \x3d 2);

datascript.built_ins.aggregate_sample \x3d (function datascript$built_ins$aggregate_sample(n,coll){
return cljs.core.vec(cljs.core.take.cljs$core$IFn$_invoke$arity$2(n,cljs.core.shuffle(coll)));
});
datascript.built_ins.aggregate_count_distinct \x3d (function datascript$built_ins$aggregate_count_distinct(coll){
return cljs.core.count(cljs.core.distinct.cljs$core$IFn$_invoke$arity$1(coll));
});
datascript.built_ins.aggregates \x3d cljs.core.PersistentHashMap.fromArrays([new cljs.core.Symbol(null,\x22variance\x22,\x22variance\x22,-1522424942,null),new cljs.core.Symbol(null,\x22count\x22,\x22count\x22,-514511684,null),new cljs.core.Symbol(null,\x22median\x22,\x22median\x22,-2084869638,null),new cljs.core.Symbol(null,\x22sum\x22,\x22sum\x22,1777518341,null),new cljs.core.Symbol(null,\x22min\x22,\x22min\x22,2085523049,null),new cljs.core.Symbol(null,\x22max\x22,\x22max\x22,1701898075,null),new cljs.core.Symbol(null,\x22count-distinct\x22,\x22count-distinct\x22,-1566572514,null),new cljs.core.Symbol(null,\x22distinct\x22,\x22distinct\x22,-148347594,null),new cljs.core.Symbol(null,\x22avg\x22,\x22avg\x22,1837937727,null),new cljs.core.Symbol(null,\x22stddev\x22,\x22stddev\x22,775056588,null),new cljs.core.Symbol(null,\x22rand\x22,\x22rand\x22,-1745930995,null),new cljs.core.Symbol(null,\x22sample\x22,\x22sample\x22,1719555128,null)],[datascript.built_ins.aggregate_variance,cljs.core.count,datascript.built_ins.aggregate_median,datascript.built_ins.aggregate_sum,datascript.built_ins.aggregate_min,datascript.built_ins.aggregate_max,datascript.built_ins.aggregate_count_distinct,cljs.core.set,datascript.built_ins.aggregate_avg,datascript.built_ins.aggregate_stddev,datascript.built_ins.aggregate_rand,datascript.built_ins.aggregate_sample]);
");
SHADOW_ENV.evalLoad("datascript.pull_parser.js", true , "goog.provide(\x27datascript.pull_parser\x27);

/**
* @constructor
 * @implements {cljs.core.IRecord}
 * @implements {cljs.core.IKVReduce}
 * @implements {cljs.core.IEquiv}
 * @implements {cljs.core.IHash}
 * @implements {cljs.core.ICollection}
 * @implements {cljs.core.ICounted}
 * @implements {cljs.core.ISeqable}
 * @implements {cljs.core.IMeta}
 * @implements {cljs.core.ICloneable}
 * @implements {cljs.core.IPrintWithWriter}
 * @implements {cljs.core.IIterable}
 * @implements {cljs.core.IWithMeta}
 * @implements {cljs.core.IAssociative}
 * @implements {cljs.core.IMap}
 * @implements {cljs.core.ILookup}
*/
datascript.pull_parser.PullAttr \x3d (function (as,default$,limit,name,pattern,recursion_limit,recursive_QMARK_,reverse_QMARK_,xform,multival_QMARK_,ref_QMARK_,component_QMARK_,__meta,__extmap,__hash){
this.as \x3d as;
this.default$ \x3d default$;
this.limit \x3d limit;
this.name \x3d name;
this.pattern \x3d pattern;
this.recursion_limit \x3d recursion_limit;
this.recursive_QMARK_ \x3d recursive_QMARK_;
this.reverse_QMARK_ \x3d reverse_QMARK_;
this.xform \x3d xform;
this.multival_QMARK_ \x3d multival_QMARK_;
this.ref_QMARK_ \x3d ref_QMARK_;
this.component_QMARK_ \x3d component_QMARK_;
this.__meta \x3d __meta;
this.__extmap \x3d __extmap;
this.__hash \x3d __hash;
this.cljs$lang$protocol_mask$partition0$ \x3d 2230716170;
this.cljs$lang$protocol_mask$partition1$ \x3d 139264;
});
(datascript.pull_parser.PullAttr.prototype.cljs$core$ILookup$_lookup$arity$2 \x3d (function (this__5343__auto__,k__5344__auto__){
var self__ \x3d this;
var this__5343__auto____$1 \x3d this;
return this__5343__auto____$1.cljs$core$ILookup$_lookup$arity$3(null,k__5344__auto__,null);
}));

(datascript.pull_parser.PullAttr.prototype.cljs$core$ILookup$_lookup$arity$3 \x3d (function (this__5345__auto__,k53847,else__5346__auto__){
var self__ \x3d this;
var this__5345__auto____$1 \x3d this;
var G__53860 \x3d k53847;
var G__53860__$1 \x3d (((G__53860 instanceof cljs.core.Keyword))?G__53860.fqn:null);
switch (G__53860__$1) {
case \x22as\x22:
return self__.as;

break;
case \x22default\x22:
return self__.default$;

break;
case \x22limit\x22:
return self__.limit;

break;
case \x22name\x22:
return self__.name;

break;
case \x22pattern\x22:
return self__.pattern;

break;
case \x22recursion-limit\x22:
return self__.recursion_limit;

break;
case \x22recursive?\x22:
return self__.recursive_QMARK_;

break;
case \x22reverse?\x22:
return self__.reverse_QMARK_;

break;
case \x22xform\x22:
return self__.xform;

break;
case \x22multival?\x22:
return self__.multival_QMARK_;

break;
case \x22ref?\x22:
return self__.ref_QMARK_;

break;
case \x22component?\x22:
return self__.component_QMARK_;

break;
default:
return cljs.core.get.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k53847,else__5346__auto__);

}
}));

(datascript.pull_parser.PullAttr.prototype.cljs$core$IKVReduce$_kv_reduce$arity$3 \x3d (function (this__5363__auto__,f__5364__auto__,init__5365__auto__){
var self__ \x3d this;
var this__5363__auto____$1 \x3d this;
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (ret__5366__auto__,p__53862){
var vec__53863 \x3d p__53862;
var k__5367__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__53863,(0),null);
var v__5368__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__53863,(1),null);
return (f__5364__auto__.cljs$core$IFn$_invoke$arity$3 ? f__5364__auto__.cljs$core$IFn$_invoke$arity$3(ret__5366__auto__,k__5367__auto__,v__5368__auto__) : f__5364__auto__.call(null,ret__5366__auto__,k__5367__auto__,v__5368__auto__));
}),init__5365__auto__,this__5363__auto____$1);
}));

(datascript.pull_parser.PullAttr.prototype.cljs$core$IPrintWithWriter$_pr_writer$arity$3 \x3d (function (this__5358__auto__,writer__5359__auto__,opts__5360__auto__){
var self__ \x3d this;
var this__5358__auto____$1 \x3d this;
var pr_pair__5361__auto__ \x3d (function (keyval__5362__auto__){
return cljs.core.pr_sequential_writer(writer__5359__auto__,cljs.core.pr_writer,\x22\x22,\x22 \x22,\x22\x22,opts__5360__auto__,keyval__5362__auto__);
});
return cljs.core.pr_sequential_writer(writer__5359__auto__,pr_pair__5361__auto__,\x22#datascript.pull-parser.PullAttr{\x22,\x22, \x22,\x22}\x22,opts__5360__auto__,cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 12, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22as\x22,\x22as\x22,1148689641),self__.as],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22default\x22,\x22default\x22,-1987822328),self__.default$],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22limit\x22,\x22limit\x22,-1355822363),self__.limit],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),self__.name],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423),self__.pattern],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22recursion-limit\x22,\x22recursion-limit\x22,52345639),self__.recursion_limit],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22recursive?\x22,\x22recursive?\x22,1340075244),self__.recursive_QMARK_],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22reverse?\x22,\x22reverse?\x22,-1672868474),self__.reverse_QMARK_],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22xform\x22,\x22xform\x22,-1725711008),self__.xform],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22multival?\x22,\x22multival?\x22,1072388383),self__.multival_QMARK_],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22ref?\x22,\x22ref?\x22,1932693720),self__.ref_QMARK_],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22component?\x22,\x22component?\x22,407783990),self__.component_QMARK_],null))], null),self__.__extmap));
}));

(datascript.pull_parser.PullAttr.prototype.cljs$core$IIterable$_iterator$arity$1 \x3d (function (G__53846){
var self__ \x3d this;
var G__53846__$1 \x3d this;
return (new cljs.core.RecordIter((0),G__53846__$1,12,new cljs.core.PersistentVector(null, 12, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22as\x22,\x22as\x22,1148689641),new cljs.core.Keyword(null,\x22default\x22,\x22default\x22,-1987822328),new cljs.core.Keyword(null,\x22limit\x22,\x22limit\x22,-1355822363),new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423),new cljs.core.Keyword(null,\x22recursion-limit\x22,\x22recursion-limit\x22,52345639),new cljs.core.Keyword(null,\x22recursive?\x22,\x22recursive?\x22,1340075244),new cljs.core.Keyword(null,\x22reverse?\x22,\x22reverse?\x22,-1672868474),new cljs.core.Keyword(null,\x22xform\x22,\x22xform\x22,-1725711008),new cljs.core.Keyword(null,\x22multival?\x22,\x22multival?\x22,1072388383),new cljs.core.Keyword(null,\x22ref?\x22,\x22ref?\x22,1932693720),new cljs.core.Keyword(null,\x22component?\x22,\x22component?\x22,407783990)], null),(cljs.core.truth_(self__.__extmap)?cljs.core._iterator(self__.__extmap):cljs.core.nil_iter())));
}));

(datascript.pull_parser.PullAttr.prototype.cljs$core$IMeta$_meta$arity$1 \x3d (function (this__5341__auto__){
var self__ \x3d this;
var this__5341__auto____$1 \x3d this;
return self__.__meta;
}));

(datascript.pull_parser.PullAttr.prototype.cljs$core$ICloneable$_clone$arity$1 \x3d (function (this__5338__auto__){
var self__ \x3d this;
var this__5338__auto____$1 \x3d this;
return (new datascript.pull_parser.PullAttr(self__.as,self__.default$,self__.limit,self__.name,self__.pattern,self__.recursion_limit,self__.recursive_QMARK_,self__.reverse_QMARK_,self__.xform,self__.multival_QMARK_,self__.ref_QMARK_,self__.component_QMARK_,self__.__meta,self__.__extmap,self__.__hash));
}));

(datascript.pull_parser.PullAttr.prototype.cljs$core$ICounted$_count$arity$1 \x3d (function (this__5347__auto__){
var self__ \x3d this;
var this__5347__auto____$1 \x3d this;
return (12 + cljs.core.count(self__.__extmap));
}));

(datascript.pull_parser.PullAttr.prototype.cljs$core$IHash$_hash$arity$1 \x3d (function (this__5339__auto__){
var self__ \x3d this;
var this__5339__auto____$1 \x3d this;
var h__5154__auto__ \x3d self__.__hash;
if((!((h__5154__auto__ \x3d\x3d null)))){
return h__5154__auto__;
} else {
var h__5154__auto____$1 \x3d (function (coll__5340__auto__){
return (-1743810262 ^ cljs.core.hash_unordered_coll(coll__5340__auto__));
})(this__5339__auto____$1);
(self__.__hash \x3d h__5154__auto____$1);

return h__5154__auto____$1;
}
}));

(datascript.pull_parser.PullAttr.prototype.cljs$core$IEquiv$_equiv$arity$2 \x3d (function (this53848,other53849){
var self__ \x3d this;
var this53848__$1 \x3d this;
return (((!((other53849 \x3d\x3d null)))) \x26\x26 ((((this53848__$1.constructor \x3d\x3d\x3d other53849.constructor)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this53848__$1.as,other53849.as)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this53848__$1.default,other53849.default)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this53848__$1.limit,other53849.limit)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this53848__$1.name,other53849.name)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this53848__$1.pattern,other53849.pattern)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this53848__$1.recursion_limit,other53849.recursion_limit)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this53848__$1.recursive_QMARK_,other53849.recursive_QMARK_)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this53848__$1.reverse_QMARK_,other53849.reverse_QMARK_)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this53848__$1.xform,other53849.xform)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this53848__$1.multival_QMARK_,other53849.multival_QMARK_)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this53848__$1.ref_QMARK_,other53849.ref_QMARK_)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this53848__$1.component_QMARK_,other53849.component_QMARK_)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this53848__$1.__extmap,other53849.__extmap)))))))))))))))))))))))))))));
}));

(datascript.pull_parser.PullAttr.prototype.cljs$core$IMap$_dissoc$arity$2 \x3d (function (this__5353__auto__,k__5354__auto__){
var self__ \x3d this;
var this__5353__auto____$1 \x3d this;
if(cljs.core.contains_QMARK_(new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 12, [new cljs.core.Keyword(null,\x22xform\x22,\x22xform\x22,-1725711008),null,new cljs.core.Keyword(null,\x22limit\x22,\x22limit\x22,-1355822363),null,new cljs.core.Keyword(null,\x22reverse?\x22,\x22reverse?\x22,-1672868474),null,new cljs.core.Keyword(null,\x22recursion-limit\x22,\x22recursion-limit\x22,52345639),null,new cljs.core.Keyword(null,\x22default\x22,\x22default\x22,-1987822328),null,new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),null,new cljs.core.Keyword(null,\x22as\x22,\x22as\x22,1148689641),null,new cljs.core.Keyword(null,\x22recursive?\x22,\x22recursive?\x22,1340075244),null,new cljs.core.Keyword(null,\x22component?\x22,\x22component?\x22,407783990),null,new cljs.core.Keyword(null,\x22ref?\x22,\x22ref?\x22,1932693720),null,new cljs.core.Keyword(null,\x22multival?\x22,\x22multival?\x22,1072388383),null,new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423),null], null), null),k__5354__auto__)){
return cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(cljs.core._with_meta(cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,this__5353__auto____$1),self__.__meta),k__5354__auto__);
} else {
return (new datascript.pull_parser.PullAttr(self__.as,self__.default$,self__.limit,self__.name,self__.pattern,self__.recursion_limit,self__.recursive_QMARK_,self__.reverse_QMARK_,self__.xform,self__.multival_QMARK_,self__.ref_QMARK_,self__.component_QMARK_,self__.__meta,cljs.core.not_empty(cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(self__.__extmap,k__5354__auto__)),null));
}
}));

(datascript.pull_parser.PullAttr.prototype.cljs$core$IAssociative$_contains_key_QMARK_$arity$2 \x3d (function (this__5350__auto__,k53847){
var self__ \x3d this;
var this__5350__auto____$1 \x3d this;
var G__53912 \x3d k53847;
var G__53912__$1 \x3d (((G__53912 instanceof cljs.core.Keyword))?G__53912.fqn:null);
switch (G__53912__$1) {
case \x22as\x22:
case \x22default\x22:
case \x22limit\x22:
case \x22name\x22:
case \x22pattern\x22:
case \x22recursion-limit\x22:
case \x22recursive?\x22:
case \x22reverse?\x22:
case \x22xform\x22:
case \x22multival?\x22:
case \x22ref?\x22:
case \x22component?\x22:
return true;

break;
default:
return cljs.core.contains_QMARK_(self__.__extmap,k53847);

}
}));

(datascript.pull_parser.PullAttr.prototype.cljs$core$IAssociative$_assoc$arity$3 \x3d (function (this__5351__auto__,k__5352__auto__,G__53846){
var self__ \x3d this;
var this__5351__auto____$1 \x3d this;
var pred__53914 \x3d cljs.core.keyword_identical_QMARK_;
var expr__53915 \x3d k__5352__auto__;
if(cljs.core.truth_((pred__53914.cljs$core$IFn$_invoke$arity$2 ? pred__53914.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22as\x22,\x22as\x22,1148689641),expr__53915) : pred__53914.call(null,new cljs.core.Keyword(null,\x22as\x22,\x22as\x22,1148689641),expr__53915)))){
return (new datascript.pull_parser.PullAttr(G__53846,self__.default$,self__.limit,self__.name,self__.pattern,self__.recursion_limit,self__.recursive_QMARK_,self__.reverse_QMARK_,self__.xform,self__.multival_QMARK_,self__.ref_QMARK_,self__.component_QMARK_,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__53914.cljs$core$IFn$_invoke$arity$2 ? pred__53914.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22default\x22,\x22default\x22,-1987822328),expr__53915) : pred__53914.call(null,new cljs.core.Keyword(null,\x22default\x22,\x22default\x22,-1987822328),expr__53915)))){
return (new datascript.pull_parser.PullAttr(self__.as,G__53846,self__.limit,self__.name,self__.pattern,self__.recursion_limit,self__.recursive_QMARK_,self__.reverse_QMARK_,self__.xform,self__.multival_QMARK_,self__.ref_QMARK_,self__.component_QMARK_,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__53914.cljs$core$IFn$_invoke$arity$2 ? pred__53914.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22limit\x22,\x22limit\x22,-1355822363),expr__53915) : pred__53914.call(null,new cljs.core.Keyword(null,\x22limit\x22,\x22limit\x22,-1355822363),expr__53915)))){
return (new datascript.pull_parser.PullAttr(self__.as,self__.default$,G__53846,self__.name,self__.pattern,self__.recursion_limit,self__.recursive_QMARK_,self__.reverse_QMARK_,self__.xform,self__.multival_QMARK_,self__.ref_QMARK_,self__.component_QMARK_,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__53914.cljs$core$IFn$_invoke$arity$2 ? pred__53914.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),expr__53915) : pred__53914.call(null,new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),expr__53915)))){
return (new datascript.pull_parser.PullAttr(self__.as,self__.default$,self__.limit,G__53846,self__.pattern,self__.recursion_limit,self__.recursive_QMARK_,self__.reverse_QMARK_,self__.xform,self__.multival_QMARK_,self__.ref_QMARK_,self__.component_QMARK_,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__53914.cljs$core$IFn$_invoke$arity$2 ? pred__53914.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423),expr__53915) : pred__53914.call(null,new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423),expr__53915)))){
return (new datascript.pull_parser.PullAttr(self__.as,self__.default$,self__.limit,self__.name,G__53846,self__.recursion_limit,self__.recursive_QMARK_,self__.reverse_QMARK_,self__.xform,self__.multival_QMARK_,self__.ref_QMARK_,self__.component_QMARK_,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__53914.cljs$core$IFn$_invoke$arity$2 ? pred__53914.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22recursion-limit\x22,\x22recursion-limit\x22,52345639),expr__53915) : pred__53914.call(null,new cljs.core.Keyword(null,\x22recursion-limit\x22,\x22recursion-limit\x22,52345639),expr__53915)))){
return (new datascript.pull_parser.PullAttr(self__.as,self__.default$,self__.limit,self__.name,self__.pattern,G__53846,self__.recursive_QMARK_,self__.reverse_QMARK_,self__.xform,self__.multival_QMARK_,self__.ref_QMARK_,self__.component_QMARK_,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__53914.cljs$core$IFn$_invoke$arity$2 ? pred__53914.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22recursive?\x22,\x22recursive?\x22,1340075244),expr__53915) : pred__53914.call(null,new cljs.core.Keyword(null,\x22recursive?\x22,\x22recursive?\x22,1340075244),expr__53915)))){
return (new datascript.pull_parser.PullAttr(self__.as,self__.default$,self__.limit,self__.name,self__.pattern,self__.recursion_limit,G__53846,self__.reverse_QMARK_,self__.xform,self__.multival_QMARK_,self__.ref_QMARK_,self__.component_QMARK_,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__53914.cljs$core$IFn$_invoke$arity$2 ? pred__53914.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22reverse?\x22,\x22reverse?\x22,-1672868474),expr__53915) : pred__53914.call(null,new cljs.core.Keyword(null,\x22reverse?\x22,\x22reverse?\x22,-1672868474),expr__53915)))){
return (new datascript.pull_parser.PullAttr(self__.as,self__.default$,self__.limit,self__.name,self__.pattern,self__.recursion_limit,self__.recursive_QMARK_,G__53846,self__.xform,self__.multival_QMARK_,self__.ref_QMARK_,self__.component_QMARK_,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__53914.cljs$core$IFn$_invoke$arity$2 ? pred__53914.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22xform\x22,\x22xform\x22,-1725711008),expr__53915) : pred__53914.call(null,new cljs.core.Keyword(null,\x22xform\x22,\x22xform\x22,-1725711008),expr__53915)))){
return (new datascript.pull_parser.PullAttr(self__.as,self__.default$,self__.limit,self__.name,self__.pattern,self__.recursion_limit,self__.recursive_QMARK_,self__.reverse_QMARK_,G__53846,self__.multival_QMARK_,self__.ref_QMARK_,self__.component_QMARK_,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__53914.cljs$core$IFn$_invoke$arity$2 ? pred__53914.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22multival?\x22,\x22multival?\x22,1072388383),expr__53915) : pred__53914.call(null,new cljs.core.Keyword(null,\x22multival?\x22,\x22multival?\x22,1072388383),expr__53915)))){
return (new datascript.pull_parser.PullAttr(self__.as,self__.default$,self__.limit,self__.name,self__.pattern,self__.recursion_limit,self__.recursive_QMARK_,self__.reverse_QMARK_,self__.xform,G__53846,self__.ref_QMARK_,self__.component_QMARK_,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__53914.cljs$core$IFn$_invoke$arity$2 ? pred__53914.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22ref?\x22,\x22ref?\x22,1932693720),expr__53915) : pred__53914.call(null,new cljs.core.Keyword(null,\x22ref?\x22,\x22ref?\x22,1932693720),expr__53915)))){
return (new datascript.pull_parser.PullAttr(self__.as,self__.default$,self__.limit,self__.name,self__.pattern,self__.recursion_limit,self__.recursive_QMARK_,self__.reverse_QMARK_,self__.xform,self__.multival_QMARK_,G__53846,self__.component_QMARK_,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__53914.cljs$core$IFn$_invoke$arity$2 ? pred__53914.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22component?\x22,\x22component?\x22,407783990),expr__53915) : pred__53914.call(null,new cljs.core.Keyword(null,\x22component?\x22,\x22component?\x22,407783990),expr__53915)))){
return (new datascript.pull_parser.PullAttr(self__.as,self__.default$,self__.limit,self__.name,self__.pattern,self__.recursion_limit,self__.recursive_QMARK_,self__.reverse_QMARK_,self__.xform,self__.multival_QMARK_,self__.ref_QMARK_,G__53846,self__.__meta,self__.__extmap,null));
} else {
return (new datascript.pull_parser.PullAttr(self__.as,self__.default$,self__.limit,self__.name,self__.pattern,self__.recursion_limit,self__.recursive_QMARK_,self__.reverse_QMARK_,self__.xform,self__.multival_QMARK_,self__.ref_QMARK_,self__.component_QMARK_,self__.__meta,cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k__5352__auto__,G__53846),null));
}
}
}
}
}
}
}
}
}
}
}
}
}));

(datascript.pull_parser.PullAttr.prototype.cljs$core$ISeqable$_seq$arity$1 \x3d (function (this__5356__auto__){
var self__ \x3d this;
var this__5356__auto____$1 \x3d this;
return cljs.core.seq(cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 12, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22as\x22,\x22as\x22,1148689641),self__.as,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22default\x22,\x22default\x22,-1987822328),self__.default$,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22limit\x22,\x22limit\x22,-1355822363),self__.limit,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),self__.name,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423),self__.pattern,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22recursion-limit\x22,\x22recursion-limit\x22,52345639),self__.recursion_limit,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22recursive?\x22,\x22recursive?\x22,1340075244),self__.recursive_QMARK_,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22reverse?\x22,\x22reverse?\x22,-1672868474),self__.reverse_QMARK_,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22xform\x22,\x22xform\x22,-1725711008),self__.xform,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22multival?\x22,\x22multival?\x22,1072388383),self__.multival_QMARK_,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22ref?\x22,\x22ref?\x22,1932693720),self__.ref_QMARK_,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22component?\x22,\x22component?\x22,407783990),self__.component_QMARK_,null))], null),self__.__extmap));
}));

(datascript.pull_parser.PullAttr.prototype.cljs$core$IWithMeta$_with_meta$arity$2 \x3d (function (this__5342__auto__,G__53846){
var self__ \x3d this;
var this__5342__auto____$1 \x3d this;
return (new datascript.pull_parser.PullAttr(self__.as,self__.default$,self__.limit,self__.name,self__.pattern,self__.recursion_limit,self__.recursive_QMARK_,self__.reverse_QMARK_,self__.xform,self__.multival_QMARK_,self__.ref_QMARK_,self__.component_QMARK_,G__53846,self__.__extmap,self__.__hash));
}));

(datascript.pull_parser.PullAttr.prototype.cljs$core$ICollection$_conj$arity$2 \x3d (function (this__5348__auto__,entry__5349__auto__){
var self__ \x3d this;
var this__5348__auto____$1 \x3d this;
if(cljs.core.vector_QMARK_(entry__5349__auto__)){
return this__5348__auto____$1.cljs$core$IAssociative$_assoc$arity$3(null,cljs.core._nth(entry__5349__auto__,(0)),cljs.core._nth(entry__5349__auto__,(1)));
} else {
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(cljs.core._conj,this__5348__auto____$1,entry__5349__auto__);
}
}));

(datascript.pull_parser.PullAttr.getBasis \x3d (function (){
return new cljs.core.PersistentVector(null, 12, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22as\x22,\x22as\x22,-1505746128,null),new cljs.core.Symbol(null,\x22default\x22,\x22default\x22,-347290801,null),new cljs.core.Symbol(null,\x22limit\x22,\x22limit\x22,284709164,null),new cljs.core.Symbol(null,\x22name\x22,\x22name\x22,-810760592,null),new cljs.core.Symbol(null,\x22pattern\x22,\x22pattern\x22,1882666950,null),new cljs.core.Symbol(null,\x22recursion-limit\x22,\x22recursion-limit\x22,1692877166,null),new cljs.core.Symbol(null,\x22recursive?\x22,\x22recursive?\x22,-1314360525,null),new cljs.core.Symbol(null,\x22reverse?\x22,\x22reverse?\x22,-32336947,null),new cljs.core.Symbol(null,\x22xform\x22,\x22xform\x22,-85179481,null),new cljs.core.Symbol(null,\x22multival?\x22,\x22multival?\x22,-1582047386,null),new cljs.core.Symbol(null,\x22ref?\x22,\x22ref?\x22,-721742049,null),new cljs.core.Symbol(null,\x22component?\x22,\x22component?\x22,2048315517,null)], null);
}));

(datascript.pull_parser.PullAttr.cljs$lang$type \x3d true);

(datascript.pull_parser.PullAttr.cljs$lang$ctorPrSeq \x3d (function (this__5389__auto__){
return (new cljs.core.List(null,\x22datascript.pull-parser/PullAttr\x22,null,(1),null));
}));

(datascript.pull_parser.PullAttr.cljs$lang$ctorPrWriter \x3d (function (this__5389__auto__,writer__5390__auto__){
return cljs.core._write(writer__5390__auto__,\x22datascript.pull-parser/PullAttr\x22);
}));

/**
 * Positional factory function for datascript.pull-parser/PullAttr.
 */
datascript.pull_parser.__GT_PullAttr \x3d (function datascript$pull_parser$__GT_PullAttr(as,default$,limit,name,pattern,recursion_limit,recursive_QMARK_,reverse_QMARK_,xform,multival_QMARK_,ref_QMARK_,component_QMARK_){
return (new datascript.pull_parser.PullAttr(as,default$,limit,name,pattern,recursion_limit,recursive_QMARK_,reverse_QMARK_,xform,multival_QMARK_,ref_QMARK_,component_QMARK_,null,null,null));
});

/**
 * Factory function for datascript.pull-parser/PullAttr, taking a map of keywords to field values.
 */
datascript.pull_parser.map__GT_PullAttr \x3d (function datascript$pull_parser$map__GT_PullAttr(G__53853){
var extmap__5385__auto__ \x3d (function (){var G__53925 \x3d cljs.core.dissoc.cljs$core$IFn$_invoke$arity$variadic(G__53853,new cljs.core.Keyword(null,\x22as\x22,\x22as\x22,1148689641),cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,\x22default\x22,\x22default\x22,-1987822328),new cljs.core.Keyword(null,\x22limit\x22,\x22limit\x22,-1355822363),new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423),new cljs.core.Keyword(null,\x22recursion-limit\x22,\x22recursion-limit\x22,52345639),new cljs.core.Keyword(null,\x22recursive?\x22,\x22recursive?\x22,1340075244),new cljs.core.Keyword(null,\x22reverse?\x22,\x22reverse?\x22,-1672868474),new cljs.core.Keyword(null,\x22xform\x22,\x22xform\x22,-1725711008),new cljs.core.Keyword(null,\x22multival?\x22,\x22multival?\x22,1072388383),new cljs.core.Keyword(null,\x22ref?\x22,\x22ref?\x22,1932693720),new cljs.core.Keyword(null,\x22component?\x22,\x22component?\x22,407783990)], 0));
if(cljs.core.record_QMARK_(G__53853)){
return cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,G__53925);
} else {
return G__53925;
}
})();
return (new datascript.pull_parser.PullAttr(new cljs.core.Keyword(null,\x22as\x22,\x22as\x22,1148689641).cljs$core$IFn$_invoke$arity$1(G__53853),new cljs.core.Keyword(null,\x22default\x22,\x22default\x22,-1987822328).cljs$core$IFn$_invoke$arity$1(G__53853),new cljs.core.Keyword(null,\x22limit\x22,\x22limit\x22,-1355822363).cljs$core$IFn$_invoke$arity$1(G__53853),new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177).cljs$core$IFn$_invoke$arity$1(G__53853),new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423).cljs$core$IFn$_invoke$arity$1(G__53853),new cljs.core.Keyword(null,\x22recursion-limit\x22,\x22recursion-limit\x22,52345639).cljs$core$IFn$_invoke$arity$1(G__53853),new cljs.core.Keyword(null,\x22recursive?\x22,\x22recursive?\x22,1340075244).cljs$core$IFn$_invoke$arity$1(G__53853),new cljs.core.Keyword(null,\x22reverse?\x22,\x22reverse?\x22,-1672868474).cljs$core$IFn$_invoke$arity$1(G__53853),new cljs.core.Keyword(null,\x22xform\x22,\x22xform\x22,-1725711008).cljs$core$IFn$_invoke$arity$1(G__53853),new cljs.core.Keyword(null,\x22multival?\x22,\x22multival?\x22,1072388383).cljs$core$IFn$_invoke$arity$1(G__53853),new cljs.core.Keyword(null,\x22ref?\x22,\x22ref?\x22,1932693720).cljs$core$IFn$_invoke$arity$1(G__53853),new cljs.core.Keyword(null,\x22component?\x22,\x22component?\x22,407783990).cljs$core$IFn$_invoke$arity$1(G__53853),null,cljs.core.not_empty(extmap__5385__auto__),null));
});


/**
* @constructor
 * @implements {cljs.core.IRecord}
 * @implements {cljs.core.IKVReduce}
 * @implements {cljs.core.IEquiv}
 * @implements {cljs.core.IHash}
 * @implements {cljs.core.ICollection}
 * @implements {cljs.core.ICounted}
 * @implements {cljs.core.ISeqable}
 * @implements {cljs.core.IMeta}
 * @implements {cljs.core.ICloneable}
 * @implements {cljs.core.IPrintWithWriter}
 * @implements {cljs.core.IIterable}
 * @implements {cljs.core.IWithMeta}
 * @implements {cljs.core.IAssociative}
 * @implements {cljs.core.IMap}
 * @implements {cljs.core.ILookup}
*/
datascript.pull_parser.PullPattern \x3d (function (attrs,first_attr,last_attr,reverse_attrs,wildcard_QMARK_,__meta,__extmap,__hash){
this.attrs \x3d attrs;
this.first_attr \x3d first_attr;
this.last_attr \x3d last_attr;
this.reverse_attrs \x3d reverse_attrs;
this.wildcard_QMARK_ \x3d wildcard_QMARK_;
this.__meta \x3d __meta;
this.__extmap \x3d __extmap;
this.__hash \x3d __hash;
this.cljs$lang$protocol_mask$partition0$ \x3d 2230716170;
this.cljs$lang$protocol_mask$partition1$ \x3d 139264;
});
(datascript.pull_parser.PullPattern.prototype.cljs$core$ILookup$_lookup$arity$2 \x3d (function (this__5343__auto__,k__5344__auto__){
var self__ \x3d this;
var this__5343__auto____$1 \x3d this;
return this__5343__auto____$1.cljs$core$ILookup$_lookup$arity$3(null,k__5344__auto__,null);
}));

(datascript.pull_parser.PullPattern.prototype.cljs$core$ILookup$_lookup$arity$3 \x3d (function (this__5345__auto__,k53928,else__5346__auto__){
var self__ \x3d this;
var this__5345__auto____$1 \x3d this;
var G__53935 \x3d k53928;
var G__53935__$1 \x3d (((G__53935 instanceof cljs.core.Keyword))?G__53935.fqn:null);
switch (G__53935__$1) {
case \x22attrs\x22:
return self__.attrs;

break;
case \x22first-attr\x22:
return self__.first_attr;

break;
case \x22last-attr\x22:
return self__.last_attr;

break;
case \x22reverse-attrs\x22:
return self__.reverse_attrs;

break;
case \x22wildcard?\x22:
return self__.wildcard_QMARK_;

break;
default:
return cljs.core.get.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k53928,else__5346__auto__);

}
}));

(datascript.pull_parser.PullPattern.prototype.cljs$core$IKVReduce$_kv_reduce$arity$3 \x3d (function (this__5363__auto__,f__5364__auto__,init__5365__auto__){
var self__ \x3d this;
var this__5363__auto____$1 \x3d this;
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (ret__5366__auto__,p__53936){
var vec__53937 \x3d p__53936;
var k__5367__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__53937,(0),null);
var v__5368__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__53937,(1),null);
return (f__5364__auto__.cljs$core$IFn$_invoke$arity$3 ? f__5364__auto__.cljs$core$IFn$_invoke$arity$3(ret__5366__auto__,k__5367__auto__,v__5368__auto__) : f__5364__auto__.call(null,ret__5366__auto__,k__5367__auto__,v__5368__auto__));
}),init__5365__auto__,this__5363__auto____$1);
}));

(datascript.pull_parser.PullPattern.prototype.cljs$core$IPrintWithWriter$_pr_writer$arity$3 \x3d (function (this__5358__auto__,writer__5359__auto__,opts__5360__auto__){
var self__ \x3d this;
var this__5358__auto____$1 \x3d this;
var pr_pair__5361__auto__ \x3d (function (keyval__5362__auto__){
return cljs.core.pr_sequential_writer(writer__5359__auto__,cljs.core.pr_writer,\x22\x22,\x22 \x22,\x22\x22,opts__5360__auto__,keyval__5362__auto__);
});
return cljs.core.pr_sequential_writer(writer__5359__auto__,pr_pair__5361__auto__,\x22#datascript.pull-parser.PullPattern{\x22,\x22, \x22,\x22}\x22,opts__5360__auto__,cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 5, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713),self__.attrs],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22first-attr\x22,\x22first-attr\x22,-1993039831),self__.first_attr],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22last-attr\x22,\x22last-attr\x22,-526000708),self__.last_attr],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22reverse-attrs\x22,\x22reverse-attrs\x22,630097702),self__.reverse_attrs],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22wildcard?\x22,\x22wildcard?\x22,-686044101),self__.wildcard_QMARK_],null))], null),self__.__extmap));
}));

(datascript.pull_parser.PullPattern.prototype.cljs$core$IIterable$_iterator$arity$1 \x3d (function (G__53927){
var self__ \x3d this;
var G__53927__$1 \x3d this;
return (new cljs.core.RecordIter((0),G__53927__$1,5,new cljs.core.PersistentVector(null, 5, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713),new cljs.core.Keyword(null,\x22first-attr\x22,\x22first-attr\x22,-1993039831),new cljs.core.Keyword(null,\x22last-attr\x22,\x22last-attr\x22,-526000708),new cljs.core.Keyword(null,\x22reverse-attrs\x22,\x22reverse-attrs\x22,630097702),new cljs.core.Keyword(null,\x22wildcard?\x22,\x22wildcard?\x22,-686044101)], null),(cljs.core.truth_(self__.__extmap)?cljs.core._iterator(self__.__extmap):cljs.core.nil_iter())));
}));

(datascript.pull_parser.PullPattern.prototype.cljs$core$IMeta$_meta$arity$1 \x3d (function (this__5341__auto__){
var self__ \x3d this;
var this__5341__auto____$1 \x3d this;
return self__.__meta;
}));

(datascript.pull_parser.PullPattern.prototype.cljs$core$ICloneable$_clone$arity$1 \x3d (function (this__5338__auto__){
var self__ \x3d this;
var this__5338__auto____$1 \x3d this;
return (new datascript.pull_parser.PullPattern(self__.attrs,self__.first_attr,self__.last_attr,self__.reverse_attrs,self__.wildcard_QMARK_,self__.__meta,self__.__extmap,self__.__hash));
}));

(datascript.pull_parser.PullPattern.prototype.cljs$core$ICounted$_count$arity$1 \x3d (function (this__5347__auto__){
var self__ \x3d this;
var this__5347__auto____$1 \x3d this;
return (5 + cljs.core.count(self__.__extmap));
}));

(datascript.pull_parser.PullPattern.prototype.cljs$core$IHash$_hash$arity$1 \x3d (function (this__5339__auto__){
var self__ \x3d this;
var this__5339__auto____$1 \x3d this;
var h__5154__auto__ \x3d self__.__hash;
if((!((h__5154__auto__ \x3d\x3d null)))){
return h__5154__auto__;
} else {
var h__5154__auto____$1 \x3d (function (coll__5340__auto__){
return (-795554044 ^ cljs.core.hash_unordered_coll(coll__5340__auto__));
})(this__5339__auto____$1);
(self__.__hash \x3d h__5154__auto____$1);

return h__5154__auto____$1;
}
}));

(datascript.pull_parser.PullPattern.prototype.cljs$core$IEquiv$_equiv$arity$2 \x3d (function (this53929,other53930){
var self__ \x3d this;
var this53929__$1 \x3d this;
return (((!((other53930 \x3d\x3d null)))) \x26\x26 ((((this53929__$1.constructor \x3d\x3d\x3d other53930.constructor)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this53929__$1.attrs,other53930.attrs)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this53929__$1.first_attr,other53930.first_attr)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this53929__$1.last_attr,other53930.last_attr)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this53929__$1.reverse_attrs,other53930.reverse_attrs)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this53929__$1.wildcard_QMARK_,other53930.wildcard_QMARK_)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this53929__$1.__extmap,other53930.__extmap)))))))))))))));
}));

(datascript.pull_parser.PullPattern.prototype.cljs$core$IMap$_dissoc$arity$2 \x3d (function (this__5353__auto__,k__5354__auto__){
var self__ \x3d this;
var this__5353__auto____$1 \x3d this;
if(cljs.core.contains_QMARK_(new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 5, [new cljs.core.Keyword(null,\x22reverse-attrs\x22,\x22reverse-attrs\x22,630097702),null,new cljs.core.Keyword(null,\x22first-attr\x22,\x22first-attr\x22,-1993039831),null,new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713),null,new cljs.core.Keyword(null,\x22wildcard?\x22,\x22wildcard?\x22,-686044101),null,new cljs.core.Keyword(null,\x22last-attr\x22,\x22last-attr\x22,-526000708),null], null), null),k__5354__auto__)){
return cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(cljs.core._with_meta(cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,this__5353__auto____$1),self__.__meta),k__5354__auto__);
} else {
return (new datascript.pull_parser.PullPattern(self__.attrs,self__.first_attr,self__.last_attr,self__.reverse_attrs,self__.wildcard_QMARK_,self__.__meta,cljs.core.not_empty(cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(self__.__extmap,k__5354__auto__)),null));
}
}));

(datascript.pull_parser.PullPattern.prototype.cljs$core$IAssociative$_contains_key_QMARK_$arity$2 \x3d (function (this__5350__auto__,k53928){
var self__ \x3d this;
var this__5350__auto____$1 \x3d this;
var G__53954 \x3d k53928;
var G__53954__$1 \x3d (((G__53954 instanceof cljs.core.Keyword))?G__53954.fqn:null);
switch (G__53954__$1) {
case \x22attrs\x22:
case \x22first-attr\x22:
case \x22last-attr\x22:
case \x22reverse-attrs\x22:
case \x22wildcard?\x22:
return true;

break;
default:
return cljs.core.contains_QMARK_(self__.__extmap,k53928);

}
}));

(datascript.pull_parser.PullPattern.prototype.cljs$core$IAssociative$_assoc$arity$3 \x3d (function (this__5351__auto__,k__5352__auto__,G__53927){
var self__ \x3d this;
var this__5351__auto____$1 \x3d this;
var pred__53955 \x3d cljs.core.keyword_identical_QMARK_;
var expr__53956 \x3d k__5352__auto__;
if(cljs.core.truth_((pred__53955.cljs$core$IFn$_invoke$arity$2 ? pred__53955.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713),expr__53956) : pred__53955.call(null,new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713),expr__53956)))){
return (new datascript.pull_parser.PullPattern(G__53927,self__.first_attr,self__.last_attr,self__.reverse_attrs,self__.wildcard_QMARK_,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__53955.cljs$core$IFn$_invoke$arity$2 ? pred__53955.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22first-attr\x22,\x22first-attr\x22,-1993039831),expr__53956) : pred__53955.call(null,new cljs.core.Keyword(null,\x22first-attr\x22,\x22first-attr\x22,-1993039831),expr__53956)))){
return (new datascript.pull_parser.PullPattern(self__.attrs,G__53927,self__.last_attr,self__.reverse_attrs,self__.wildcard_QMARK_,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__53955.cljs$core$IFn$_invoke$arity$2 ? pred__53955.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22last-attr\x22,\x22last-attr\x22,-526000708),expr__53956) : pred__53955.call(null,new cljs.core.Keyword(null,\x22last-attr\x22,\x22last-attr\x22,-526000708),expr__53956)))){
return (new datascript.pull_parser.PullPattern(self__.attrs,self__.first_attr,G__53927,self__.reverse_attrs,self__.wildcard_QMARK_,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__53955.cljs$core$IFn$_invoke$arity$2 ? pred__53955.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22reverse-attrs\x22,\x22reverse-attrs\x22,630097702),expr__53956) : pred__53955.call(null,new cljs.core.Keyword(null,\x22reverse-attrs\x22,\x22reverse-attrs\x22,630097702),expr__53956)))){
return (new datascript.pull_parser.PullPattern(self__.attrs,self__.first_attr,self__.last_attr,G__53927,self__.wildcard_QMARK_,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__53955.cljs$core$IFn$_invoke$arity$2 ? pred__53955.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22wildcard?\x22,\x22wildcard?\x22,-686044101),expr__53956) : pred__53955.call(null,new cljs.core.Keyword(null,\x22wildcard?\x22,\x22wildcard?\x22,-686044101),expr__53956)))){
return (new datascript.pull_parser.PullPattern(self__.attrs,self__.first_attr,self__.last_attr,self__.reverse_attrs,G__53927,self__.__meta,self__.__extmap,null));
} else {
return (new datascript.pull_parser.PullPattern(self__.attrs,self__.first_attr,self__.last_attr,self__.reverse_attrs,self__.wildcard_QMARK_,self__.__meta,cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k__5352__auto__,G__53927),null));
}
}
}
}
}
}));

(datascript.pull_parser.PullPattern.prototype.cljs$core$ISeqable$_seq$arity$1 \x3d (function (this__5356__auto__){
var self__ \x3d this;
var this__5356__auto____$1 \x3d this;
return cljs.core.seq(cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 5, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713),self__.attrs,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22first-attr\x22,\x22first-attr\x22,-1993039831),self__.first_attr,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22last-attr\x22,\x22last-attr\x22,-526000708),self__.last_attr,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22reverse-attrs\x22,\x22reverse-attrs\x22,630097702),self__.reverse_attrs,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22wildcard?\x22,\x22wildcard?\x22,-686044101),self__.wildcard_QMARK_,null))], null),self__.__extmap));
}));

(datascript.pull_parser.PullPattern.prototype.cljs$core$IWithMeta$_with_meta$arity$2 \x3d (function (this__5342__auto__,G__53927){
var self__ \x3d this;
var this__5342__auto____$1 \x3d this;
return (new datascript.pull_parser.PullPattern(self__.attrs,self__.first_attr,self__.last_attr,self__.reverse_attrs,self__.wildcard_QMARK_,G__53927,self__.__extmap,self__.__hash));
}));

(datascript.pull_parser.PullPattern.prototype.cljs$core$ICollection$_conj$arity$2 \x3d (function (this__5348__auto__,entry__5349__auto__){
var self__ \x3d this;
var this__5348__auto____$1 \x3d this;
if(cljs.core.vector_QMARK_(entry__5349__auto__)){
return this__5348__auto____$1.cljs$core$IAssociative$_assoc$arity$3(null,cljs.core._nth(entry__5349__auto__,(0)),cljs.core._nth(entry__5349__auto__,(1)));
} else {
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(cljs.core._conj,this__5348__auto____$1,entry__5349__auto__);
}
}));

(datascript.pull_parser.PullPattern.getBasis \x3d (function (){
return new cljs.core.PersistentVector(null, 5, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22attrs\x22,\x22attrs\x22,-450137186,null),new cljs.core.Symbol(null,\x22first-attr\x22,\x22first-attr\x22,-352508304,null),new cljs.core.Symbol(null,\x22last-attr\x22,\x22last-attr\x22,1114530819,null),new cljs.core.Symbol(null,\x22reverse-attrs\x22,\x22reverse-attrs\x22,-2024338067,null),new cljs.core.Symbol(null,\x22wildcard?\x22,\x22wildcard?\x22,954487426,null)], null);
}));

(datascript.pull_parser.PullPattern.cljs$lang$type \x3d true);

(datascript.pull_parser.PullPattern.cljs$lang$ctorPrSeq \x3d (function (this__5389__auto__){
return (new cljs.core.List(null,\x22datascript.pull-parser/PullPattern\x22,null,(1),null));
}));

(datascript.pull_parser.PullPattern.cljs$lang$ctorPrWriter \x3d (function (this__5389__auto__,writer__5390__auto__){
return cljs.core._write(writer__5390__auto__,\x22datascript.pull-parser/PullPattern\x22);
}));

/**
 * Positional factory function for datascript.pull-parser/PullPattern.
 */
datascript.pull_parser.__GT_PullPattern \x3d (function datascript$pull_parser$__GT_PullPattern(attrs,first_attr,last_attr,reverse_attrs,wildcard_QMARK_){
return (new datascript.pull_parser.PullPattern(attrs,first_attr,last_attr,reverse_attrs,wildcard_QMARK_,null,null,null));
});

/**
 * Factory function for datascript.pull-parser/PullPattern, taking a map of keywords to field values.
 */
datascript.pull_parser.map__GT_PullPattern \x3d (function datascript$pull_parser$map__GT_PullPattern(G__53934){
var extmap__5385__auto__ \x3d (function (){var G__53961 \x3d cljs.core.dissoc.cljs$core$IFn$_invoke$arity$variadic(G__53934,new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713),cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,\x22first-attr\x22,\x22first-attr\x22,-1993039831),new cljs.core.Keyword(null,\x22last-attr\x22,\x22last-attr\x22,-526000708),new cljs.core.Keyword(null,\x22reverse-attrs\x22,\x22reverse-attrs\x22,630097702),new cljs.core.Keyword(null,\x22wildcard?\x22,\x22wildcard?\x22,-686044101)], 0));
if(cljs.core.record_QMARK_(G__53934)){
return cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,G__53961);
} else {
return G__53961;
}
})();
return (new datascript.pull_parser.PullPattern(new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713).cljs$core$IFn$_invoke$arity$1(G__53934),new cljs.core.Keyword(null,\x22first-attr\x22,\x22first-attr\x22,-1993039831).cljs$core$IFn$_invoke$arity$1(G__53934),new cljs.core.Keyword(null,\x22last-attr\x22,\x22last-attr\x22,-526000708).cljs$core$IFn$_invoke$arity$1(G__53934),new cljs.core.Keyword(null,\x22reverse-attrs\x22,\x22reverse-attrs\x22,630097702).cljs$core$IFn$_invoke$arity$1(G__53934),new cljs.core.Keyword(null,\x22wildcard?\x22,\x22wildcard?\x22,-686044101).cljs$core$IFn$_invoke$arity$1(G__53934),null,cljs.core.not_empty(extmap__5385__auto__),null));
});

datascript.pull_parser.default_db_id_attr \x3d datascript.pull_parser.map__GT_PullAttr(new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),new cljs.core.Keyword(\x22db\x22,\x22id\x22,\x22db/id\x22,-1388397098),new cljs.core.Keyword(null,\x22as\x22,\x22as\x22,1148689641),new cljs.core.Keyword(\x22db\x22,\x22id\x22,\x22db/id\x22,-1388397098),new cljs.core.Keyword(null,\x22xform\x22,\x22xform\x22,-1725711008),cljs.core.identity], null));
datascript.pull_parser.default_pattern_ref \x3d datascript.pull_parser.map__GT_PullPattern(new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713),(new cljs.core.List(null,datascript.pull_parser.default_db_id_attr,null,(1),null))], null));
datascript.pull_parser.default_pattern_component \x3d cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(datascript.pull_parser.default_pattern_ref,new cljs.core.Keyword(null,\x22wildcard?\x22,\x22wildcard?\x22,-686044101),true);

datascript.pull_parser.check \x3d (function datascript$pull_parser$check(cond,expected,fragment){
if(cljs.core.truth_(cond)){
return null;
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22Expected \x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1(expected),\x22, got: \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([fragment], 0))].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22parser\x22,\x22pull\x22,\x22parser/pull\x22,-2147427204),new cljs.core.Keyword(null,\x22fragment\x22,\x22fragment\x22,826775688),fragment], null));
}
});
datascript.pull_parser.parse_attr_name \x3d (function datascript$pull_parser$parse_attr_name(db,attr_spec){
var reverse_QMARK_ \x3d datascript.db.reverse_ref_QMARK_(attr_spec);
var name \x3d ((reverse_QMARK_)?datascript.db.reverse_ref(attr_spec):attr_spec);
var ref_QMARK_ \x3d datascript.db.ref_QMARK_(db,name);
var component_QMARK_ \x3d datascript.db.component_QMARK_(db,name);
var multival_QMARK_ \x3d datascript.db.multival_QMARK_(db,name);
return datascript.pull_parser.map__GT_PullAttr(cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,\x22xform\x22,\x22xform\x22,-1725711008),new cljs.core.Keyword(null,\x22limit\x22,\x22limit\x22,-1355822363),new cljs.core.Keyword(null,\x22reverse?\x22,\x22reverse?\x22,-1672868474),new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),new cljs.core.Keyword(null,\x22as\x22,\x22as\x22,1148689641),new cljs.core.Keyword(null,\x22component?\x22,\x22component?\x22,407783990),new cljs.core.Keyword(null,\x22ref?\x22,\x22ref?\x22,1932693720),new cljs.core.Keyword(null,\x22multival?\x22,\x22multival?\x22,1072388383),new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423)],[cljs.core.identity,((multival_QMARK_)?(1000):null),((reverse_QMARK_)?(function (){
datascript.pull_parser.check(ref_QMARK_,\x22reverse attribute having :db.type/ref\x22,attr_spec);

return true;
})()
:null),name,attr_spec,((component_QMARK_)?true:null),((ref_QMARK_)?true:null),((multival_QMARK_)?true:null),(((!(ref_QMARK_)))?null:((reverse_QMARK_)?datascript.pull_parser.default_pattern_ref:((component_QMARK_)?datascript.pull_parser.default_pattern_component:datascript.pull_parser.default_pattern_ref
)))]));
});
datascript.pull_parser.check_limit \x3d (function datascript$pull_parser$check_limit(db,pull_attr,limit){
datascript.pull_parser.check(((((typeof limit \x3d\x3d\x3d \x27number\x27) \x26\x26 ((limit \x3e (0))))) || ((limit \x3d\x3d null))),\x22(positive-number | nil)\x22,limit);

return datascript.pull_parser.check(datascript.db.multival_QMARK_(db,new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177).cljs$core$IFn$_invoke$arity$1(pull_attr)),\x22limit attribute having :db.cardinality/many\x22,new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177).cljs$core$IFn$_invoke$arity$1(pull_attr));
});
datascript.pull_parser.resolve_xform \x3d (function datascript$pull_parser$resolve_xform(sym_or_fn){
var or__5045__auto__ \x3d ((cljs.core.fn_QMARK_(sym_or_fn))?sym_or_fn:null);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
var or__5045__auto____$1 \x3d cljs.core.get.cljs$core$IFn$_invoke$arity$2(datascript.built_ins.query_fns,sym_or_fn);
if(cljs.core.truth_(or__5045__auto____$1)){
return or__5045__auto____$1;
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22Can\x27t resolve symbol \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([sym_or_fn], 0))].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22parser\x22,\x22pull\x22,\x22parser/pull\x22,-2147427204),new cljs.core.Keyword(null,\x22fragment\x22,\x22fragment\x22,826775688),sym_or_fn], null));
}
}
});
datascript.pull_parser.parse_attr_expr \x3d (function datascript$pull_parser$parse_attr_expr(db,attr_spec){
var temp__5808__auto__ \x3d (function (){var G__53976 \x3d db;
var G__53977 \x3d cljs.core.first(attr_spec);
return (datascript.pull_parser.parse_attr_spec.cljs$core$IFn$_invoke$arity$2 ? datascript.pull_parser.parse_attr_spec.cljs$core$IFn$_invoke$arity$2(G__53976,G__53977) : datascript.pull_parser.parse_attr_spec.call(null,G__53976,G__53977));
})();
if((temp__5808__auto__ \x3d\x3d null)){
return null;
} else {
var pull_attr \x3d temp__5808__auto__;
datascript.pull_parser.check(cljs.core.even_QMARK_(cljs.core.count(cljs.core.next(attr_spec))),\x22even number of opts\x22,attr_spec);

return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (pull_attr__$1,p__53978){
var vec__53979 \x3d p__53978;
var key \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__53979,(0),null);
var value \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__53979,(1),null);
var G__53982 \x3d key;
var G__53982__$1 \x3d (((G__53982 instanceof cljs.core.Keyword))?G__53982.fqn:null);
switch (G__53982__$1) {
case \x22as\x22:
return cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(pull_attr__$1,new cljs.core.Keyword(null,\x22as\x22,\x22as\x22,1148689641),value);

break;
case \x22limit\x22:
datascript.pull_parser.check_limit(db,pull_attr__$1,value);

return cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(pull_attr__$1,new cljs.core.Keyword(null,\x22limit\x22,\x22limit\x22,-1355822363),value);

break;
case \x22default\x22:
return cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(pull_attr__$1,new cljs.core.Keyword(null,\x22default\x22,\x22default\x22,-1987822328),value);

break;
case \x22xform\x22:
return cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(pull_attr__$1,new cljs.core.Keyword(null,\x22xform\x22,\x22xform\x22,-1725711008),datascript.pull_parser.resolve_xform(value));

break;
default:
return datascript.pull_parser.check(false,\x22one of :as, :limit, :default, :xform\x22,attr_spec);

}
}),pull_attr,cljs.core.partition.cljs$core$IFn$_invoke$arity$2((2),cljs.core.next(attr_spec)));
}
});
datascript.pull_parser.parse_legacy_limit_expr \x3d (function datascript$pull_parser$parse_legacy_limit_expr(db,attr_spec){
var expected \x3d \x22[\x27limit attr-name (positive-number | nil)]\x22;
if(cljs.core.truth_((function (){var G__53984 \x3d cljs.core.first(attr_spec);
var fexpr__53983 \x3d new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Symbol(null,\x22limit\x22,\x22limit\x22,284709164,null),null,\x22limit\x22,null], null), null);
return (fexpr__53983.cljs$core$IFn$_invoke$arity$1 ? fexpr__53983.cljs$core$IFn$_invoke$arity$1(G__53984) : fexpr__53983.call(null,G__53984));
})())){
datascript.pull_parser.check(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(cljs.core.count(attr_spec),(3)),expected,attr_spec);

var vec__53985 \x3d attr_spec;
var _ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__53985,(0),null);
var attr \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__53985,(1),null);
var limit \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__53985,(2),null);
var pull_attr \x3d (datascript.pull_parser.parse_attr_spec.cljs$core$IFn$_invoke$arity$2 ? datascript.pull_parser.parse_attr_spec.cljs$core$IFn$_invoke$arity$2(db,attr) : datascript.pull_parser.parse_attr_spec.call(null,db,attr));
datascript.pull_parser.check_limit(db,pull_attr,limit);

return cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(pull_attr,new cljs.core.Keyword(null,\x22limit\x22,\x22limit\x22,-1355822363),limit);
} else {
return null;
}
});
datascript.pull_parser.parse_legacy_default_expr \x3d (function datascript$pull_parser$parse_legacy_default_expr(db,attr_spec){
var expected \x3d \x22[\x27default attr-name any-value]\x22;
if(cljs.core.truth_((function (){var G__53989 \x3d cljs.core.first(attr_spec);
var fexpr__53988 \x3d new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Symbol(null,\x22default\x22,\x22default\x22,-347290801,null),null,\x22default\x22,null], null), null);
return (fexpr__53988.cljs$core$IFn$_invoke$arity$1 ? fexpr__53988.cljs$core$IFn$_invoke$arity$1(G__53989) : fexpr__53988.call(null,G__53989));
})())){
datascript.pull_parser.check(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(cljs.core.count(attr_spec),(3)),expected,attr_spec);

var vec__53990 \x3d attr_spec;
var _ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__53990,(0),null);
var attr \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__53990,(1),null);
var default$ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__53990,(2),null);
var pull_attr \x3d (datascript.pull_parser.parse_attr_spec.cljs$core$IFn$_invoke$arity$2 ? datascript.pull_parser.parse_attr_spec.cljs$core$IFn$_invoke$arity$2(db,attr) : datascript.pull_parser.parse_attr_spec.call(null,db,attr));
return cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(pull_attr,new cljs.core.Keyword(null,\x22default\x22,\x22default\x22,-1987822328),default$);
} else {
return null;
}
});
datascript.pull_parser.parse_attr_spec \x3d (function datascript$pull_parser$parse_attr_spec(db,attr_spec){
if((((attr_spec instanceof cljs.core.Keyword)) || (((typeof attr_spec \x3d\x3d\x3d \x27string\x27) \x26\x26 (cljs.core.not((function (){var fexpr__53994 \x3d new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 2, [\x22limit\x22,null,\x22default\x22,null], null), null);
return (fexpr__53994.cljs$core$IFn$_invoke$arity$1 ? fexpr__53994.cljs$core$IFn$_invoke$arity$1(attr_spec) : fexpr__53994.call(null,attr_spec));
})())))))){
return datascript.pull_parser.parse_attr_name(db,attr_spec);
} else {
if(cljs.core.sequential_QMARK_(attr_spec)){
var or__5045__auto__ \x3d datascript.pull_parser.parse_attr_expr(db,attr_spec);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
var or__5045__auto____$1 \x3d datascript.pull_parser.parse_legacy_limit_expr(db,attr_spec);
if(cljs.core.truth_(or__5045__auto____$1)){
return or__5045__auto____$1;
} else {
var or__5045__auto____$2 \x3d datascript.pull_parser.parse_legacy_default_expr(db,attr_spec);
if(cljs.core.truth_(or__5045__auto____$2)){
return or__5045__auto____$2;
} else {
return datascript.pull_parser.check(false,\x22[attr-name attr-option+] | [\x27limit attr-name (positive-num | nil)] | [\x27default attr-name any-val]\x22,attr_spec);
}
}
}
} else {
return null;

}
}
});
datascript.pull_parser.parse_map_spec \x3d (function datascript$pull_parser$parse_map_spec(db,attr_spec,pattern){
var pull_attr \x3d datascript.pull_parser.parse_attr_spec(db,attr_spec);
datascript.pull_parser.check((!((pull_attr \x3d\x3d null))),\x22attr-name | attr-expr\x22,attr_spec);

datascript.pull_parser.check(datascript.db.ref_QMARK_(db,new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177).cljs$core$IFn$_invoke$arity$1(pull_attr)),\x22attribute having :db.type/ref\x22,attr_spec);

if(((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Symbol(null,\x22...\x22,\x22...\x22,-1926939749,null),pattern)) || (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(\x22...\x22,pattern)))){
return cljs.core.assoc.cljs$core$IFn$_invoke$arity$variadic(pull_attr,new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423),null,cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,\x22recursive?\x22,\x22recursive?\x22,1340075244),true,new cljs.core.Keyword(null,\x22recursion-limit\x22,\x22recursion-limit\x22,52345639),null], 0));
} else {
if(typeof pattern \x3d\x3d\x3d \x27number\x27){
datascript.pull_parser.check((pattern \x3e (0)),\x22(positive-num | ...)\x22,cljs.core.PersistentArrayMap.createAsIfByAssoc([attr_spec,pattern]));

return cljs.core.assoc.cljs$core$IFn$_invoke$arity$variadic(pull_attr,new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423),null,cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,\x22recursive?\x22,\x22recursive?\x22,1340075244),true,new cljs.core.Keyword(null,\x22recursion-limit\x22,\x22recursion-limit\x22,52345639),pattern], 0));
} else {
return cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(pull_attr,new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423),(datascript.pull_parser.parse_pattern.cljs$core$IFn$_invoke$arity$2 ? datascript.pull_parser.parse_pattern.cljs$core$IFn$_invoke$arity$2(db,pattern) : datascript.pull_parser.parse_pattern.call(null,db,pattern)));

}
}
});
datascript.pull_parser.index_of \x3d (function datascript$pull_parser$index_of(pred,xs){
return cljs.core.some((function (p__53998){
var vec__53999 \x3d p__53998;
var x \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__53999,(0),null);
var idx \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__53999,(1),null);
if(cljs.core.truth_((pred.cljs$core$IFn$_invoke$arity$1 ? pred.cljs$core$IFn$_invoke$arity$1(x) : pred.call(null,x)))){
return idx;
} else {
return null;
}
}),cljs.core.map.cljs$core$IFn$_invoke$arity$3(cljs.core.vector,xs,cljs.core.range.cljs$core$IFn$_invoke$arity$0()));
});
datascript.pull_parser.conj_attr \x3d (function datascript$pull_parser$conj_attr(pull_pattern,pull_attr){
var pattern_attr \x3d (cljs.core.truth_(new cljs.core.Keyword(null,\x22reverse?\x22,\x22reverse?\x22,-1672868474).cljs$core$IFn$_invoke$arity$1(pull_attr))?new cljs.core.Keyword(null,\x22reverse-attrs\x22,\x22reverse-attrs\x22,630097702):new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713));
var temp__5806__auto__ \x3d datascript.pull_parser.index_of((function (p1__54002_SHARP_){
return cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22as\x22,\x22as\x22,1148689641).cljs$core$IFn$_invoke$arity$1(p1__54002_SHARP_),new cljs.core.Keyword(null,\x22as\x22,\x22as\x22,1148689641).cljs$core$IFn$_invoke$arity$1(pull_attr));
}),cljs.core.get.cljs$core$IFn$_invoke$arity$2(pull_pattern,pattern_attr));
if((temp__5806__auto__ \x3d\x3d null)){
return cljs.core.update.cljs$core$IFn$_invoke$arity$4(pull_pattern,pattern_attr,cljs.core.conj,pull_attr);
} else {
var idx \x3d temp__5806__auto__;
return cljs.core.update.cljs$core$IFn$_invoke$arity$5(pull_pattern,pattern_attr,cljs.core.assoc,idx,pull_attr);
}
});
datascript.pull_parser.parse_pattern \x3d (function datascript$pull_parser$parse_pattern(db,pattern){
datascript.pull_parser.check(cljs.core.sequential_QMARK_(pattern),\x22pattern to be sequential?\x22,pattern);

var pattern__$1 \x3d pattern;
var result \x3d datascript.pull_parser.map__GT_PullPattern(new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713),cljs.core.PersistentVector.EMPTY,new cljs.core.Keyword(null,\x22reverse-attrs\x22,\x22reverse-attrs\x22,630097702),cljs.core.PersistentVector.EMPTY,new cljs.core.Keyword(null,\x22wildcard?\x22,\x22wildcard?\x22,-686044101),null], null));
while(true){
if(cljs.core.empty_QMARK_(pattern__$1)){
var attrs \x3d result.attrs;
var db_id_QMARK_ \x3d ((function (pattern__$1,result,attrs){
return (function (attr){
var G__54020 \x3d attr.name;
var fexpr__54019 \x3d new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(\x22db\x22,\x22id\x22,\x22db/id\x22,-1388397098),null,\x22:db/id\x22,null], null), null);
return (fexpr__54019.cljs$core$IFn$_invoke$arity$1 ? fexpr__54019.cljs$core$IFn$_invoke$arity$1(G__54020) : fexpr__54019.call(null,G__54020));
});})(pattern__$1,result,attrs))
;
var key_fn \x3d ((function (pattern__$1,result,attrs,db_id_QMARK_){
return (function (attr){
var name \x3d new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177).cljs$core$IFn$_invoke$arity$1(attr);
if((name instanceof cljs.core.Keyword)){
return name;
} else {
if(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(\x22:\x22,cljs.core.subs.cljs$core$IFn$_invoke$arity$3(name,(0),(1)))){
return cljs.core.keyword.cljs$core$IFn$_invoke$arity$1(cljs.core.subs.cljs$core$IFn$_invoke$arity$2(name,(1)));
} else {
return cljs.core.keyword.cljs$core$IFn$_invoke$arity$1(name);

}
}
});})(pattern__$1,result,attrs,db_id_QMARK_))
;
var attrs__$1 \x3d (cljs.core.truth_((function (){var and__5043__auto__ \x3d result.wildcard_QMARK_;
if(cljs.core.truth_(and__5043__auto__)){
return cljs.core.not(cljs.core.some(db_id_QMARK_,result.attrs));
} else {
return and__5043__auto__;
}
})())?cljs.core.conj.cljs$core$IFn$_invoke$arity$2(attrs,datascript.pull_parser.default_db_id_attr):attrs);
var attrs__$2 \x3d cljs.core.list_STAR_.cljs$core$IFn$_invoke$arity$1(cljs.core.sort_by.cljs$core$IFn$_invoke$arity$2(key_fn,attrs__$1));
var datom_attrs \x3d cljs.core.remove.cljs$core$IFn$_invoke$arity$2(db_id_QMARK_,attrs__$2);
var first_attr \x3d cljs.core.first(datom_attrs);
var last_attr \x3d cljs.core.last(datom_attrs);
return datascript.pull_parser.map__GT_PullPattern(new cljs.core.PersistentArrayMap(null, 5, [new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713),attrs__$2,new cljs.core.Keyword(null,\x22first-attr\x22,\x22first-attr\x22,-1993039831),first_attr,new cljs.core.Keyword(null,\x22last-attr\x22,\x22last-attr\x22,-526000708),last_attr,new cljs.core.Keyword(null,\x22reverse-attrs\x22,\x22reverse-attrs\x22,630097702),cljs.core.list_STAR_.cljs$core$IFn$_invoke$arity$1(cljs.core.sort_by.cljs$core$IFn$_invoke$arity$2(key_fn,result.reverse_attrs)),new cljs.core.Keyword(null,\x22wildcard?\x22,\x22wildcard?\x22,-686044101),result.wildcard_QMARK_], null));
} else {
var attr_spec \x3d cljs.core.first(pattern__$1);
if(((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Symbol(null,\x22*\x22,\x22*\x22,345799209,null),attr_spec)) || (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(\x22*\x22,attr_spec)) || (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22*\x22,\x22*\x22,-1294732318),attr_spec)))))){
var G__54088 \x3d cljs.core.next(pattern__$1);
var G__54089 \x3d cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(result,new cljs.core.Keyword(null,\x22wildcard?\x22,\x22wildcard?\x22,-686044101),true);
pattern__$1 \x3d G__54088;
result \x3d G__54089;
continue;
} else {
if(cljs.core.map_QMARK_(attr_spec)){
var result_SINGLEQUOTE_ \x3d cljs.core.reduce_kv(((function (pattern__$1,result,attr_spec){
return (function (result__$1,attr_spec__$1,pattern__$2){
return datascript.pull_parser.conj_attr(result__$1,datascript.pull_parser.parse_map_spec(db,attr_spec__$1,pattern__$2));
});})(pattern__$1,result,attr_spec))
,result,attr_spec);
var G__54091 \x3d cljs.core.next(pattern__$1);
var G__54092 \x3d result_SINGLEQUOTE_;
pattern__$1 \x3d G__54091;
result \x3d G__54092;
continue;
} else {
var pull_attr \x3d datascript.pull_parser.parse_attr_spec(db,attr_spec);
if((pull_attr \x3d\x3d null)){
return datascript.pull_parser.check(false,\x22attr-name | attr-expr | map-spec | *\x22,attr_spec);
} else {
var G__54096 \x3d cljs.core.next(pattern__$1);
var G__54097 \x3d datascript.pull_parser.conj_attr(result,pull_attr);
pattern__$1 \x3d G__54096;
result \x3d G__54097;
continue;

}
}
}
}
break;
}
});
");
SHADOW_ENV.evalLoad("datascript.pull_api.js", true , "goog.provide(\x27datascript.pull_api\x27);



datascript.pull_api.first_seq \x3d (function datascript$pull_api$first_seq(xs){
if((xs \x3d\x3d null)){
return null;
} else {
return cljs.core._first(xs);
}
});
datascript.pull_api.next_seq \x3d (function datascript$pull_api$next_seq(xs){
if((xs \x3d\x3d null)){
return null;
} else {
return cljs.core._next(xs);
}
});
datascript.pull_api.conj_seq \x3d (function datascript$pull_api$conj_seq(xs,x){
if((xs \x3d\x3d null)){
return (new cljs.core.List(null,x,null,(1),null));
} else {
return cljs.core._conj(xs,x);
}
});
datascript.pull_api.assoc_some_BANG_ \x3d (function datascript$pull_api$assoc_some_BANG_(m,k,v){
if((v \x3d\x3d null)){
return m;
} else {
return cljs.core.assoc_BANG_.cljs$core$IFn$_invoke$arity$3(m,k,v);
}
});
datascript.pull_api.conj_some_BANG_ \x3d (function datascript$pull_api$conj_some_BANG_(xs,v){
if((v \x3d\x3d null)){
return xs;
} else {
return cljs.core.conj_BANG_.cljs$core$IFn$_invoke$arity$2(xs,v);
}
});

/**
* @constructor
 * @implements {cljs.core.IRecord}
 * @implements {cljs.core.IKVReduce}
 * @implements {cljs.core.IEquiv}
 * @implements {cljs.core.IHash}
 * @implements {cljs.core.ICollection}
 * @implements {cljs.core.ICounted}
 * @implements {cljs.core.ISeqable}
 * @implements {cljs.core.IMeta}
 * @implements {cljs.core.ICloneable}
 * @implements {cljs.core.IPrintWithWriter}
 * @implements {cljs.core.IIterable}
 * @implements {cljs.core.IWithMeta}
 * @implements {cljs.core.IAssociative}
 * @implements {cljs.core.IMap}
 * @implements {cljs.core.ILookup}
*/
datascript.pull_api.Context \x3d (function (db,visitor,__meta,__extmap,__hash){
this.db \x3d db;
this.visitor \x3d visitor;
this.__meta \x3d __meta;
this.__extmap \x3d __extmap;
this.__hash \x3d __hash;
this.cljs$lang$protocol_mask$partition0$ \x3d 2230716170;
this.cljs$lang$protocol_mask$partition1$ \x3d 139264;
});
(datascript.pull_api.Context.prototype.cljs$core$ILookup$_lookup$arity$2 \x3d (function (this__5343__auto__,k__5344__auto__){
var self__ \x3d this;
var this__5343__auto____$1 \x3d this;
return this__5343__auto____$1.cljs$core$ILookup$_lookup$arity$3(null,k__5344__auto__,null);
}));

(datascript.pull_api.Context.prototype.cljs$core$ILookup$_lookup$arity$3 \x3d (function (this__5345__auto__,k54038,else__5346__auto__){
var self__ \x3d this;
var this__5345__auto____$1 \x3d this;
var G__54047 \x3d k54038;
var G__54047__$1 \x3d (((G__54047 instanceof cljs.core.Keyword))?G__54047.fqn:null);
switch (G__54047__$1) {
case \x22db\x22:
return self__.db;

break;
case \x22visitor\x22:
return self__.visitor;

break;
default:
return cljs.core.get.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k54038,else__5346__auto__);

}
}));

(datascript.pull_api.Context.prototype.cljs$core$IKVReduce$_kv_reduce$arity$3 \x3d (function (this__5363__auto__,f__5364__auto__,init__5365__auto__){
var self__ \x3d this;
var this__5363__auto____$1 \x3d this;
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (ret__5366__auto__,p__54048){
var vec__54049 \x3d p__54048;
var k__5367__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54049,(0),null);
var v__5368__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54049,(1),null);
return (f__5364__auto__.cljs$core$IFn$_invoke$arity$3 ? f__5364__auto__.cljs$core$IFn$_invoke$arity$3(ret__5366__auto__,k__5367__auto__,v__5368__auto__) : f__5364__auto__.call(null,ret__5366__auto__,k__5367__auto__,v__5368__auto__));
}),init__5365__auto__,this__5363__auto____$1);
}));

(datascript.pull_api.Context.prototype.cljs$core$IPrintWithWriter$_pr_writer$arity$3 \x3d (function (this__5358__auto__,writer__5359__auto__,opts__5360__auto__){
var self__ \x3d this;
var this__5358__auto____$1 \x3d this;
var pr_pair__5361__auto__ \x3d (function (keyval__5362__auto__){
return cljs.core.pr_sequential_writer(writer__5359__auto__,cljs.core.pr_writer,\x22\x22,\x22 \x22,\x22\x22,opts__5360__auto__,keyval__5362__auto__);
});
return cljs.core.pr_sequential_writer(writer__5359__auto__,pr_pair__5361__auto__,\x22#datascript.pull-api.Context{\x22,\x22, \x22,\x22}\x22,opts__5360__auto__,cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22db\x22,\x22db\x22,993250759),self__.db],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22visitor\x22,\x22visitor\x22,-1026865865),self__.visitor],null))], null),self__.__extmap));
}));

(datascript.pull_api.Context.prototype.cljs$core$IIterable$_iterator$arity$1 \x3d (function (G__54037){
var self__ \x3d this;
var G__54037__$1 \x3d this;
return (new cljs.core.RecordIter((0),G__54037__$1,2,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22db\x22,\x22db\x22,993250759),new cljs.core.Keyword(null,\x22visitor\x22,\x22visitor\x22,-1026865865)], null),(cljs.core.truth_(self__.__extmap)?cljs.core._iterator(self__.__extmap):cljs.core.nil_iter())));
}));

(datascript.pull_api.Context.prototype.cljs$core$IMeta$_meta$arity$1 \x3d (function (this__5341__auto__){
var self__ \x3d this;
var this__5341__auto____$1 \x3d this;
return self__.__meta;
}));

(datascript.pull_api.Context.prototype.cljs$core$ICloneable$_clone$arity$1 \x3d (function (this__5338__auto__){
var self__ \x3d this;
var this__5338__auto____$1 \x3d this;
return (new datascript.pull_api.Context(self__.db,self__.visitor,self__.__meta,self__.__extmap,self__.__hash));
}));

(datascript.pull_api.Context.prototype.cljs$core$ICounted$_count$arity$1 \x3d (function (this__5347__auto__){
var self__ \x3d this;
var this__5347__auto____$1 \x3d this;
return (2 + cljs.core.count(self__.__extmap));
}));

(datascript.pull_api.Context.prototype.cljs$core$IHash$_hash$arity$1 \x3d (function (this__5339__auto__){
var self__ \x3d this;
var this__5339__auto____$1 \x3d this;
var h__5154__auto__ \x3d self__.__hash;
if((!((h__5154__auto__ \x3d\x3d null)))){
return h__5154__auto__;
} else {
var h__5154__auto____$1 \x3d (function (coll__5340__auto__){
return (1727735959 ^ cljs.core.hash_unordered_coll(coll__5340__auto__));
})(this__5339__auto____$1);
(self__.__hash \x3d h__5154__auto____$1);

return h__5154__auto____$1;
}
}));

(datascript.pull_api.Context.prototype.cljs$core$IEquiv$_equiv$arity$2 \x3d (function (this54039,other54040){
var self__ \x3d this;
var this54039__$1 \x3d this;
return (((!((other54040 \x3d\x3d null)))) \x26\x26 ((((this54039__$1.constructor \x3d\x3d\x3d other54040.constructor)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54039__$1.db,other54040.db)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54039__$1.visitor,other54040.visitor)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54039__$1.__extmap,other54040.__extmap)))))))));
}));

(datascript.pull_api.Context.prototype.cljs$core$IMap$_dissoc$arity$2 \x3d (function (this__5353__auto__,k__5354__auto__){
var self__ \x3d this;
var this__5353__auto____$1 \x3d this;
if(cljs.core.contains_QMARK_(new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22db\x22,\x22db\x22,993250759),null,new cljs.core.Keyword(null,\x22visitor\x22,\x22visitor\x22,-1026865865),null], null), null),k__5354__auto__)){
return cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(cljs.core._with_meta(cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,this__5353__auto____$1),self__.__meta),k__5354__auto__);
} else {
return (new datascript.pull_api.Context(self__.db,self__.visitor,self__.__meta,cljs.core.not_empty(cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(self__.__extmap,k__5354__auto__)),null));
}
}));

(datascript.pull_api.Context.prototype.cljs$core$IAssociative$_contains_key_QMARK_$arity$2 \x3d (function (this__5350__auto__,k54038){
var self__ \x3d this;
var this__5350__auto____$1 \x3d this;
var G__54057 \x3d k54038;
var G__54057__$1 \x3d (((G__54057 instanceof cljs.core.Keyword))?G__54057.fqn:null);
switch (G__54057__$1) {
case \x22db\x22:
case \x22visitor\x22:
return true;

break;
default:
return cljs.core.contains_QMARK_(self__.__extmap,k54038);

}
}));

(datascript.pull_api.Context.prototype.cljs$core$IAssociative$_assoc$arity$3 \x3d (function (this__5351__auto__,k__5352__auto__,G__54037){
var self__ \x3d this;
var this__5351__auto____$1 \x3d this;
var pred__54058 \x3d cljs.core.keyword_identical_QMARK_;
var expr__54059 \x3d k__5352__auto__;
if(cljs.core.truth_((pred__54058.cljs$core$IFn$_invoke$arity$2 ? pred__54058.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22db\x22,\x22db\x22,993250759),expr__54059) : pred__54058.call(null,new cljs.core.Keyword(null,\x22db\x22,\x22db\x22,993250759),expr__54059)))){
return (new datascript.pull_api.Context(G__54037,self__.visitor,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__54058.cljs$core$IFn$_invoke$arity$2 ? pred__54058.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22visitor\x22,\x22visitor\x22,-1026865865),expr__54059) : pred__54058.call(null,new cljs.core.Keyword(null,\x22visitor\x22,\x22visitor\x22,-1026865865),expr__54059)))){
return (new datascript.pull_api.Context(self__.db,G__54037,self__.__meta,self__.__extmap,null));
} else {
return (new datascript.pull_api.Context(self__.db,self__.visitor,self__.__meta,cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k__5352__auto__,G__54037),null));
}
}
}));

(datascript.pull_api.Context.prototype.cljs$core$ISeqable$_seq$arity$1 \x3d (function (this__5356__auto__){
var self__ \x3d this;
var this__5356__auto____$1 \x3d this;
return cljs.core.seq(cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22db\x22,\x22db\x22,993250759),self__.db,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22visitor\x22,\x22visitor\x22,-1026865865),self__.visitor,null))], null),self__.__extmap));
}));

(datascript.pull_api.Context.prototype.cljs$core$IWithMeta$_with_meta$arity$2 \x3d (function (this__5342__auto__,G__54037){
var self__ \x3d this;
var this__5342__auto____$1 \x3d this;
return (new datascript.pull_api.Context(self__.db,self__.visitor,G__54037,self__.__extmap,self__.__hash));
}));

(datascript.pull_api.Context.prototype.cljs$core$ICollection$_conj$arity$2 \x3d (function (this__5348__auto__,entry__5349__auto__){
var self__ \x3d this;
var this__5348__auto____$1 \x3d this;
if(cljs.core.vector_QMARK_(entry__5349__auto__)){
return this__5348__auto____$1.cljs$core$IAssociative$_assoc$arity$3(null,cljs.core._nth(entry__5349__auto__,(0)),cljs.core._nth(entry__5349__auto__,(1)));
} else {
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(cljs.core._conj,this__5348__auto____$1,entry__5349__auto__);
}
}));

(datascript.pull_api.Context.getBasis \x3d (function (){
return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22db\x22,\x22db\x22,-1661185010,null),new cljs.core.Symbol(null,\x22visitor\x22,\x22visitor\x22,613665662,null)], null);
}));

(datascript.pull_api.Context.cljs$lang$type \x3d true);

(datascript.pull_api.Context.cljs$lang$ctorPrSeq \x3d (function (this__5389__auto__){
return (new cljs.core.List(null,\x22datascript.pull-api/Context\x22,null,(1),null));
}));

(datascript.pull_api.Context.cljs$lang$ctorPrWriter \x3d (function (this__5389__auto__,writer__5390__auto__){
return cljs.core._write(writer__5390__auto__,\x22datascript.pull-api/Context\x22);
}));

/**
 * Positional factory function for datascript.pull-api/Context.
 */
datascript.pull_api.__GT_Context \x3d (function datascript$pull_api$__GT_Context(db,visitor){
return (new datascript.pull_api.Context(db,visitor,null,null,null));
});

/**
 * Factory function for datascript.pull-api/Context, taking a map of keywords to field values.
 */
datascript.pull_api.map__GT_Context \x3d (function datascript$pull_api$map__GT_Context(G__54045){
var extmap__5385__auto__ \x3d (function (){var G__54065 \x3d cljs.core.dissoc.cljs$core$IFn$_invoke$arity$variadic(G__54045,new cljs.core.Keyword(null,\x22db\x22,\x22db\x22,993250759),cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,\x22visitor\x22,\x22visitor\x22,-1026865865)], 0));
if(cljs.core.record_QMARK_(G__54045)){
return cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,G__54065);
} else {
return G__54065;
}
})();
return (new datascript.pull_api.Context(new cljs.core.Keyword(null,\x22db\x22,\x22db\x22,993250759).cljs$core$IFn$_invoke$arity$1(G__54045),new cljs.core.Keyword(null,\x22visitor\x22,\x22visitor\x22,-1026865865).cljs$core$IFn$_invoke$arity$1(G__54045),null,cljs.core.not_empty(extmap__5385__auto__),null));
});

datascript.pull_api.visit \x3d (function datascript$pull_api$visit(context,pattern,e,a,v){
var temp__5808__auto__ \x3d context.visitor;
if((temp__5808__auto__ \x3d\x3d null)){
return null;
} else {
var visitor \x3d temp__5808__auto__;
return (visitor.cljs$core$IFn$_invoke$arity$4 ? visitor.cljs$core$IFn$_invoke$arity$4(pattern,e,a,v) : visitor.call(null,pattern,e,a,v));
}
});

/**
 * @interface
 */
datascript.pull_api.IFrame \x3d function(){};

var datascript$pull_api$IFrame$_merge$dyn_54385 \x3d (function (this$,result){
var x__5393__auto__ \x3d (((this$ \x3d\x3d null))?null:this$);
var m__5394__auto__ \x3d (datascript.pull_api._merge[goog.typeOf(x__5393__auto__)]);
if((!((m__5394__auto__ \x3d\x3d null)))){
return (m__5394__auto__.cljs$core$IFn$_invoke$arity$2 ? m__5394__auto__.cljs$core$IFn$_invoke$arity$2(this$,result) : m__5394__auto__.call(null,this$,result));
} else {
var m__5392__auto__ \x3d (datascript.pull_api._merge[\x22_\x22]);
if((!((m__5392__auto__ \x3d\x3d null)))){
return (m__5392__auto__.cljs$core$IFn$_invoke$arity$2 ? m__5392__auto__.cljs$core$IFn$_invoke$arity$2(this$,result) : m__5392__auto__.call(null,this$,result));
} else {
throw cljs.core.missing_protocol(\x22IFrame.-merge\x22,this$);
}
}
});
datascript.pull_api._merge \x3d (function datascript$pull_api$_merge(this$,result){
if((((!((this$ \x3d\x3d null)))) \x26\x26 ((!((this$.datascript$pull_api$IFrame$_merge$arity$2 \x3d\x3d null)))))){
return this$.datascript$pull_api$IFrame$_merge$arity$2(this$,result);
} else {
return datascript$pull_api$IFrame$_merge$dyn_54385(this$,result);
}
});

var datascript$pull_api$IFrame$_run$dyn_54386 \x3d (function (this$,context){
var x__5393__auto__ \x3d (((this$ \x3d\x3d null))?null:this$);
var m__5394__auto__ \x3d (datascript.pull_api._run[goog.typeOf(x__5393__auto__)]);
if((!((m__5394__auto__ \x3d\x3d null)))){
return (m__5394__auto__.cljs$core$IFn$_invoke$arity$2 ? m__5394__auto__.cljs$core$IFn$_invoke$arity$2(this$,context) : m__5394__auto__.call(null,this$,context));
} else {
var m__5392__auto__ \x3d (datascript.pull_api._run[\x22_\x22]);
if((!((m__5392__auto__ \x3d\x3d null)))){
return (m__5392__auto__.cljs$core$IFn$_invoke$arity$2 ? m__5392__auto__.cljs$core$IFn$_invoke$arity$2(this$,context) : m__5392__auto__.call(null,this$,context));
} else {
throw cljs.core.missing_protocol(\x22IFrame.-run\x22,this$);
}
}
});
datascript.pull_api._run \x3d (function datascript$pull_api$_run(this$,context){
if((((!((this$ \x3d\x3d null)))) \x26\x26 ((!((this$.datascript$pull_api$IFrame$_run$arity$2 \x3d\x3d null)))))){
return this$.datascript$pull_api$IFrame$_run$arity$2(this$,context);
} else {
return datascript$pull_api$IFrame$_run$dyn_54386(this$,context);
}
});


/**
* @constructor
 * @implements {cljs.core.IRecord}
 * @implements {cljs.core.IKVReduce}
 * @implements {cljs.core.IEquiv}
 * @implements {cljs.core.IHash}
 * @implements {cljs.core.ICollection}
 * @implements {cljs.core.ICounted}
 * @implements {cljs.core.ISeqable}
 * @implements {cljs.core.IMeta}
 * @implements {cljs.core.ICloneable}
 * @implements {cljs.core.IPrintWithWriter}
 * @implements {cljs.core.IIterable}
 * @implements {cljs.core.IWithMeta}
 * @implements {cljs.core.IAssociative}
 * @implements {cljs.core.IMap}
 * @implements {cljs.core.ILookup}
*/
datascript.pull_api.ResultFrame \x3d (function (value,datoms,__meta,__extmap,__hash){
this.value \x3d value;
this.datoms \x3d datoms;
this.__meta \x3d __meta;
this.__extmap \x3d __extmap;
this.__hash \x3d __hash;
this.cljs$lang$protocol_mask$partition0$ \x3d 2230716170;
this.cljs$lang$protocol_mask$partition1$ \x3d 139264;
});
(datascript.pull_api.ResultFrame.prototype.cljs$core$ILookup$_lookup$arity$2 \x3d (function (this__5343__auto__,k__5344__auto__){
var self__ \x3d this;
var this__5343__auto____$1 \x3d this;
return this__5343__auto____$1.cljs$core$ILookup$_lookup$arity$3(null,k__5344__auto__,null);
}));

(datascript.pull_api.ResultFrame.prototype.cljs$core$ILookup$_lookup$arity$3 \x3d (function (this__5345__auto__,k54079,else__5346__auto__){
var self__ \x3d this;
var this__5345__auto____$1 \x3d this;
var G__54087 \x3d k54079;
var G__54087__$1 \x3d (((G__54087 instanceof cljs.core.Keyword))?G__54087.fqn:null);
switch (G__54087__$1) {
case \x22value\x22:
return self__.value;

break;
case \x22datoms\x22:
return self__.datoms;

break;
default:
return cljs.core.get.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k54079,else__5346__auto__);

}
}));

(datascript.pull_api.ResultFrame.prototype.cljs$core$IKVReduce$_kv_reduce$arity$3 \x3d (function (this__5363__auto__,f__5364__auto__,init__5365__auto__){
var self__ \x3d this;
var this__5363__auto____$1 \x3d this;
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (ret__5366__auto__,p__54090){
var vec__54093 \x3d p__54090;
var k__5367__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54093,(0),null);
var v__5368__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54093,(1),null);
return (f__5364__auto__.cljs$core$IFn$_invoke$arity$3 ? f__5364__auto__.cljs$core$IFn$_invoke$arity$3(ret__5366__auto__,k__5367__auto__,v__5368__auto__) : f__5364__auto__.call(null,ret__5366__auto__,k__5367__auto__,v__5368__auto__));
}),init__5365__auto__,this__5363__auto____$1);
}));

(datascript.pull_api.ResultFrame.prototype.cljs$core$IPrintWithWriter$_pr_writer$arity$3 \x3d (function (this__5358__auto__,writer__5359__auto__,opts__5360__auto__){
var self__ \x3d this;
var this__5358__auto____$1 \x3d this;
var pr_pair__5361__auto__ \x3d (function (keyval__5362__auto__){
return cljs.core.pr_sequential_writer(writer__5359__auto__,cljs.core.pr_writer,\x22\x22,\x22 \x22,\x22\x22,opts__5360__auto__,keyval__5362__auto__);
});
return cljs.core.pr_sequential_writer(writer__5359__auto__,pr_pair__5361__auto__,\x22#datascript.pull-api.ResultFrame{\x22,\x22, \x22,\x22}\x22,opts__5360__auto__,cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22value\x22,\x22value\x22,305978217),self__.value],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22datoms\x22,\x22datoms\x22,-290874434),self__.datoms],null))], null),self__.__extmap));
}));

(datascript.pull_api.ResultFrame.prototype.cljs$core$IIterable$_iterator$arity$1 \x3d (function (G__54078){
var self__ \x3d this;
var G__54078__$1 \x3d this;
return (new cljs.core.RecordIter((0),G__54078__$1,2,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22value\x22,\x22value\x22,305978217),new cljs.core.Keyword(null,\x22datoms\x22,\x22datoms\x22,-290874434)], null),(cljs.core.truth_(self__.__extmap)?cljs.core._iterator(self__.__extmap):cljs.core.nil_iter())));
}));

(datascript.pull_api.ResultFrame.prototype.cljs$core$IMeta$_meta$arity$1 \x3d (function (this__5341__auto__){
var self__ \x3d this;
var this__5341__auto____$1 \x3d this;
return self__.__meta;
}));

(datascript.pull_api.ResultFrame.prototype.cljs$core$ICloneable$_clone$arity$1 \x3d (function (this__5338__auto__){
var self__ \x3d this;
var this__5338__auto____$1 \x3d this;
return (new datascript.pull_api.ResultFrame(self__.value,self__.datoms,self__.__meta,self__.__extmap,self__.__hash));
}));

(datascript.pull_api.ResultFrame.prototype.cljs$core$ICounted$_count$arity$1 \x3d (function (this__5347__auto__){
var self__ \x3d this;
var this__5347__auto____$1 \x3d this;
return (2 + cljs.core.count(self__.__extmap));
}));

(datascript.pull_api.ResultFrame.prototype.cljs$core$IHash$_hash$arity$1 \x3d (function (this__5339__auto__){
var self__ \x3d this;
var this__5339__auto____$1 \x3d this;
var h__5154__auto__ \x3d self__.__hash;
if((!((h__5154__auto__ \x3d\x3d null)))){
return h__5154__auto__;
} else {
var h__5154__auto____$1 \x3d (function (coll__5340__auto__){
return (836381841 ^ cljs.core.hash_unordered_coll(coll__5340__auto__));
})(this__5339__auto____$1);
(self__.__hash \x3d h__5154__auto____$1);

return h__5154__auto____$1;
}
}));

(datascript.pull_api.ResultFrame.prototype.cljs$core$IEquiv$_equiv$arity$2 \x3d (function (this54080,other54081){
var self__ \x3d this;
var this54080__$1 \x3d this;
return (((!((other54081 \x3d\x3d null)))) \x26\x26 ((((this54080__$1.constructor \x3d\x3d\x3d other54081.constructor)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54080__$1.value,other54081.value)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54080__$1.datoms,other54081.datoms)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54080__$1.__extmap,other54081.__extmap)))))))));
}));

(datascript.pull_api.ResultFrame.prototype.cljs$core$IMap$_dissoc$arity$2 \x3d (function (this__5353__auto__,k__5354__auto__){
var self__ \x3d this;
var this__5353__auto____$1 \x3d this;
if(cljs.core.contains_QMARK_(new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22value\x22,\x22value\x22,305978217),null,new cljs.core.Keyword(null,\x22datoms\x22,\x22datoms\x22,-290874434),null], null), null),k__5354__auto__)){
return cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(cljs.core._with_meta(cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,this__5353__auto____$1),self__.__meta),k__5354__auto__);
} else {
return (new datascript.pull_api.ResultFrame(self__.value,self__.datoms,self__.__meta,cljs.core.not_empty(cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(self__.__extmap,k__5354__auto__)),null));
}
}));

(datascript.pull_api.ResultFrame.prototype.cljs$core$IAssociative$_contains_key_QMARK_$arity$2 \x3d (function (this__5350__auto__,k54079){
var self__ \x3d this;
var this__5350__auto____$1 \x3d this;
var G__54101 \x3d k54079;
var G__54101__$1 \x3d (((G__54101 instanceof cljs.core.Keyword))?G__54101.fqn:null);
switch (G__54101__$1) {
case \x22value\x22:
case \x22datoms\x22:
return true;

break;
default:
return cljs.core.contains_QMARK_(self__.__extmap,k54079);

}
}));

(datascript.pull_api.ResultFrame.prototype.cljs$core$IAssociative$_assoc$arity$3 \x3d (function (this__5351__auto__,k__5352__auto__,G__54078){
var self__ \x3d this;
var this__5351__auto____$1 \x3d this;
var pred__54102 \x3d cljs.core.keyword_identical_QMARK_;
var expr__54103 \x3d k__5352__auto__;
if(cljs.core.truth_((pred__54102.cljs$core$IFn$_invoke$arity$2 ? pred__54102.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22value\x22,\x22value\x22,305978217),expr__54103) : pred__54102.call(null,new cljs.core.Keyword(null,\x22value\x22,\x22value\x22,305978217),expr__54103)))){
return (new datascript.pull_api.ResultFrame(G__54078,self__.datoms,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__54102.cljs$core$IFn$_invoke$arity$2 ? pred__54102.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22datoms\x22,\x22datoms\x22,-290874434),expr__54103) : pred__54102.call(null,new cljs.core.Keyword(null,\x22datoms\x22,\x22datoms\x22,-290874434),expr__54103)))){
return (new datascript.pull_api.ResultFrame(self__.value,G__54078,self__.__meta,self__.__extmap,null));
} else {
return (new datascript.pull_api.ResultFrame(self__.value,self__.datoms,self__.__meta,cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k__5352__auto__,G__54078),null));
}
}
}));

(datascript.pull_api.ResultFrame.prototype.cljs$core$ISeqable$_seq$arity$1 \x3d (function (this__5356__auto__){
var self__ \x3d this;
var this__5356__auto____$1 \x3d this;
return cljs.core.seq(cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22value\x22,\x22value\x22,305978217),self__.value,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22datoms\x22,\x22datoms\x22,-290874434),self__.datoms,null))], null),self__.__extmap));
}));

(datascript.pull_api.ResultFrame.prototype.cljs$core$IWithMeta$_with_meta$arity$2 \x3d (function (this__5342__auto__,G__54078){
var self__ \x3d this;
var this__5342__auto____$1 \x3d this;
return (new datascript.pull_api.ResultFrame(self__.value,self__.datoms,G__54078,self__.__extmap,self__.__hash));
}));

(datascript.pull_api.ResultFrame.prototype.cljs$core$ICollection$_conj$arity$2 \x3d (function (this__5348__auto__,entry__5349__auto__){
var self__ \x3d this;
var this__5348__auto____$1 \x3d this;
if(cljs.core.vector_QMARK_(entry__5349__auto__)){
return this__5348__auto____$1.cljs$core$IAssociative$_assoc$arity$3(null,cljs.core._nth(entry__5349__auto__,(0)),cljs.core._nth(entry__5349__auto__,(1)));
} else {
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(cljs.core._conj,this__5348__auto____$1,entry__5349__auto__);
}
}));

(datascript.pull_api.ResultFrame.getBasis \x3d (function (){
return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22value\x22,\x22value\x22,1946509744,null),new cljs.core.Symbol(null,\x22datoms\x22,\x22datoms\x22,1349657093,null)], null);
}));

(datascript.pull_api.ResultFrame.cljs$lang$type \x3d true);

(datascript.pull_api.ResultFrame.cljs$lang$ctorPrSeq \x3d (function (this__5389__auto__){
return (new cljs.core.List(null,\x22datascript.pull-api/ResultFrame\x22,null,(1),null));
}));

(datascript.pull_api.ResultFrame.cljs$lang$ctorPrWriter \x3d (function (this__5389__auto__,writer__5390__auto__){
return cljs.core._write(writer__5390__auto__,\x22datascript.pull-api/ResultFrame\x22);
}));

/**
 * Positional factory function for datascript.pull-api/ResultFrame.
 */
datascript.pull_api.__GT_ResultFrame \x3d (function datascript$pull_api$__GT_ResultFrame(value,datoms){
return (new datascript.pull_api.ResultFrame(value,datoms,null,null,null));
});

/**
 * Factory function for datascript.pull-api/ResultFrame, taking a map of keywords to field values.
 */
datascript.pull_api.map__GT_ResultFrame \x3d (function datascript$pull_api$map__GT_ResultFrame(G__54082){
var extmap__5385__auto__ \x3d (function (){var G__54109 \x3d cljs.core.dissoc.cljs$core$IFn$_invoke$arity$variadic(G__54082,new cljs.core.Keyword(null,\x22value\x22,\x22value\x22,305978217),cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,\x22datoms\x22,\x22datoms\x22,-290874434)], 0));
if(cljs.core.record_QMARK_(G__54082)){
return cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,G__54109);
} else {
return G__54109;
}
})();
return (new datascript.pull_api.ResultFrame(new cljs.core.Keyword(null,\x22value\x22,\x22value\x22,305978217).cljs$core$IFn$_invoke$arity$1(G__54082),new cljs.core.Keyword(null,\x22datoms\x22,\x22datoms\x22,-290874434).cljs$core$IFn$_invoke$arity$1(G__54082),null,cljs.core.not_empty(extmap__5385__auto__),null));
});


/**
* @constructor
 * @implements {cljs.core.IRecord}
 * @implements {datascript.pull_api.IFrame}
 * @implements {cljs.core.IKVReduce}
 * @implements {cljs.core.IEquiv}
 * @implements {cljs.core.IHash}
 * @implements {cljs.core.ICollection}
 * @implements {cljs.core.ICounted}
 * @implements {cljs.core.ISeqable}
 * @implements {cljs.core.IMeta}
 * @implements {cljs.core.ICloneable}
 * @implements {cljs.core.IPrintWithWriter}
 * @implements {cljs.core.IIterable}
 * @implements {cljs.core.IWithMeta}
 * @implements {cljs.core.IAssociative}
 * @implements {cljs.core.IMap}
 * @implements {cljs.core.ILookup}
*/
datascript.pull_api.MultivalAttrFrame \x3d (function (acc,attr,datoms,__meta,__extmap,__hash){
this.acc \x3d acc;
this.attr \x3d attr;
this.datoms \x3d datoms;
this.__meta \x3d __meta;
this.__extmap \x3d __extmap;
this.__hash \x3d __hash;
this.cljs$lang$protocol_mask$partition0$ \x3d 2230716170;
this.cljs$lang$protocol_mask$partition1$ \x3d 139264;
});
(datascript.pull_api.MultivalAttrFrame.prototype.cljs$core$ILookup$_lookup$arity$2 \x3d (function (this__5343__auto__,k__5344__auto__){
var self__ \x3d this;
var this__5343__auto____$1 \x3d this;
return this__5343__auto____$1.cljs$core$ILookup$_lookup$arity$3(null,k__5344__auto__,null);
}));

(datascript.pull_api.MultivalAttrFrame.prototype.cljs$core$ILookup$_lookup$arity$3 \x3d (function (this__5345__auto__,k54116,else__5346__auto__){
var self__ \x3d this;
var this__5345__auto____$1 \x3d this;
var G__54121 \x3d k54116;
var G__54121__$1 \x3d (((G__54121 instanceof cljs.core.Keyword))?G__54121.fqn:null);
switch (G__54121__$1) {
case \x22acc\x22:
return self__.acc;

break;
case \x22attr\x22:
return self__.attr;

break;
case \x22datoms\x22:
return self__.datoms;

break;
default:
return cljs.core.get.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k54116,else__5346__auto__);

}
}));

(datascript.pull_api.MultivalAttrFrame.prototype.cljs$core$IKVReduce$_kv_reduce$arity$3 \x3d (function (this__5363__auto__,f__5364__auto__,init__5365__auto__){
var self__ \x3d this;
var this__5363__auto____$1 \x3d this;
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (ret__5366__auto__,p__54126){
var vec__54127 \x3d p__54126;
var k__5367__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54127,(0),null);
var v__5368__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54127,(1),null);
return (f__5364__auto__.cljs$core$IFn$_invoke$arity$3 ? f__5364__auto__.cljs$core$IFn$_invoke$arity$3(ret__5366__auto__,k__5367__auto__,v__5368__auto__) : f__5364__auto__.call(null,ret__5366__auto__,k__5367__auto__,v__5368__auto__));
}),init__5365__auto__,this__5363__auto____$1);
}));

(datascript.pull_api.MultivalAttrFrame.prototype.cljs$core$IPrintWithWriter$_pr_writer$arity$3 \x3d (function (this__5358__auto__,writer__5359__auto__,opts__5360__auto__){
var self__ \x3d this;
var this__5358__auto____$1 \x3d this;
var pr_pair__5361__auto__ \x3d (function (keyval__5362__auto__){
return cljs.core.pr_sequential_writer(writer__5359__auto__,cljs.core.pr_writer,\x22\x22,\x22 \x22,\x22\x22,opts__5360__auto__,keyval__5362__auto__);
});
return cljs.core.pr_sequential_writer(writer__5359__auto__,pr_pair__5361__auto__,\x22#datascript.pull-api.MultivalAttrFrame{\x22,\x22, \x22,\x22}\x22,opts__5360__auto__,cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22acc\x22,\x22acc\x22,838566312),self__.acc],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22attr\x22,\x22attr\x22,-604132353),self__.attr],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22datoms\x22,\x22datoms\x22,-290874434),self__.datoms],null))], null),self__.__extmap));
}));

(datascript.pull_api.MultivalAttrFrame.prototype.cljs$core$IIterable$_iterator$arity$1 \x3d (function (G__54115){
var self__ \x3d this;
var G__54115__$1 \x3d this;
return (new cljs.core.RecordIter((0),G__54115__$1,3,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22acc\x22,\x22acc\x22,838566312),new cljs.core.Keyword(null,\x22attr\x22,\x22attr\x22,-604132353),new cljs.core.Keyword(null,\x22datoms\x22,\x22datoms\x22,-290874434)], null),(cljs.core.truth_(self__.__extmap)?cljs.core._iterator(self__.__extmap):cljs.core.nil_iter())));
}));

(datascript.pull_api.MultivalAttrFrame.prototype.cljs$core$IMeta$_meta$arity$1 \x3d (function (this__5341__auto__){
var self__ \x3d this;
var this__5341__auto____$1 \x3d this;
return self__.__meta;
}));

(datascript.pull_api.MultivalAttrFrame.prototype.cljs$core$ICloneable$_clone$arity$1 \x3d (function (this__5338__auto__){
var self__ \x3d this;
var this__5338__auto____$1 \x3d this;
return (new datascript.pull_api.MultivalAttrFrame(self__.acc,self__.attr,self__.datoms,self__.__meta,self__.__extmap,self__.__hash));
}));

(datascript.pull_api.MultivalAttrFrame.prototype.cljs$core$ICounted$_count$arity$1 \x3d (function (this__5347__auto__){
var self__ \x3d this;
var this__5347__auto____$1 \x3d this;
return (3 + cljs.core.count(self__.__extmap));
}));

(datascript.pull_api.MultivalAttrFrame.prototype.cljs$core$IHash$_hash$arity$1 \x3d (function (this__5339__auto__){
var self__ \x3d this;
var this__5339__auto____$1 \x3d this;
var h__5154__auto__ \x3d self__.__hash;
if((!((h__5154__auto__ \x3d\x3d null)))){
return h__5154__auto__;
} else {
var h__5154__auto____$1 \x3d (function (coll__5340__auto__){
return (1829867699 ^ cljs.core.hash_unordered_coll(coll__5340__auto__));
})(this__5339__auto____$1);
(self__.__hash \x3d h__5154__auto____$1);

return h__5154__auto____$1;
}
}));

(datascript.pull_api.MultivalAttrFrame.prototype.cljs$core$IEquiv$_equiv$arity$2 \x3d (function (this54117,other54118){
var self__ \x3d this;
var this54117__$1 \x3d this;
return (((!((other54118 \x3d\x3d null)))) \x26\x26 ((((this54117__$1.constructor \x3d\x3d\x3d other54118.constructor)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54117__$1.acc,other54118.acc)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54117__$1.attr,other54118.attr)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54117__$1.datoms,other54118.datoms)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54117__$1.__extmap,other54118.__extmap)))))))))));
}));

(datascript.pull_api.MultivalAttrFrame.prototype.cljs$core$IMap$_dissoc$arity$2 \x3d (function (this__5353__auto__,k__5354__auto__){
var self__ \x3d this;
var this__5353__auto____$1 \x3d this;
if(cljs.core.contains_QMARK_(new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,\x22acc\x22,\x22acc\x22,838566312),null,new cljs.core.Keyword(null,\x22datoms\x22,\x22datoms\x22,-290874434),null,new cljs.core.Keyword(null,\x22attr\x22,\x22attr\x22,-604132353),null], null), null),k__5354__auto__)){
return cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(cljs.core._with_meta(cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,this__5353__auto____$1),self__.__meta),k__5354__auto__);
} else {
return (new datascript.pull_api.MultivalAttrFrame(self__.acc,self__.attr,self__.datoms,self__.__meta,cljs.core.not_empty(cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(self__.__extmap,k__5354__auto__)),null));
}
}));

(datascript.pull_api.MultivalAttrFrame.prototype.cljs$core$IAssociative$_contains_key_QMARK_$arity$2 \x3d (function (this__5350__auto__,k54116){
var self__ \x3d this;
var this__5350__auto____$1 \x3d this;
var G__54134 \x3d k54116;
var G__54134__$1 \x3d (((G__54134 instanceof cljs.core.Keyword))?G__54134.fqn:null);
switch (G__54134__$1) {
case \x22acc\x22:
case \x22attr\x22:
case \x22datoms\x22:
return true;

break;
default:
return cljs.core.contains_QMARK_(self__.__extmap,k54116);

}
}));

(datascript.pull_api.MultivalAttrFrame.prototype.cljs$core$IAssociative$_assoc$arity$3 \x3d (function (this__5351__auto__,k__5352__auto__,G__54115){
var self__ \x3d this;
var this__5351__auto____$1 \x3d this;
var pred__54135 \x3d cljs.core.keyword_identical_QMARK_;
var expr__54136 \x3d k__5352__auto__;
if(cljs.core.truth_((pred__54135.cljs$core$IFn$_invoke$arity$2 ? pred__54135.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22acc\x22,\x22acc\x22,838566312),expr__54136) : pred__54135.call(null,new cljs.core.Keyword(null,\x22acc\x22,\x22acc\x22,838566312),expr__54136)))){
return (new datascript.pull_api.MultivalAttrFrame(G__54115,self__.attr,self__.datoms,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__54135.cljs$core$IFn$_invoke$arity$2 ? pred__54135.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22attr\x22,\x22attr\x22,-604132353),expr__54136) : pred__54135.call(null,new cljs.core.Keyword(null,\x22attr\x22,\x22attr\x22,-604132353),expr__54136)))){
return (new datascript.pull_api.MultivalAttrFrame(self__.acc,G__54115,self__.datoms,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__54135.cljs$core$IFn$_invoke$arity$2 ? pred__54135.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22datoms\x22,\x22datoms\x22,-290874434),expr__54136) : pred__54135.call(null,new cljs.core.Keyword(null,\x22datoms\x22,\x22datoms\x22,-290874434),expr__54136)))){
return (new datascript.pull_api.MultivalAttrFrame(self__.acc,self__.attr,G__54115,self__.__meta,self__.__extmap,null));
} else {
return (new datascript.pull_api.MultivalAttrFrame(self__.acc,self__.attr,self__.datoms,self__.__meta,cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k__5352__auto__,G__54115),null));
}
}
}
}));

(datascript.pull_api.MultivalAttrFrame.prototype.cljs$core$ISeqable$_seq$arity$1 \x3d (function (this__5356__auto__){
var self__ \x3d this;
var this__5356__auto____$1 \x3d this;
return cljs.core.seq(cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22acc\x22,\x22acc\x22,838566312),self__.acc,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22attr\x22,\x22attr\x22,-604132353),self__.attr,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22datoms\x22,\x22datoms\x22,-290874434),self__.datoms,null))], null),self__.__extmap));
}));

(datascript.pull_api.MultivalAttrFrame.prototype.cljs$core$IWithMeta$_with_meta$arity$2 \x3d (function (this__5342__auto__,G__54115){
var self__ \x3d this;
var this__5342__auto____$1 \x3d this;
return (new datascript.pull_api.MultivalAttrFrame(self__.acc,self__.attr,self__.datoms,G__54115,self__.__extmap,self__.__hash));
}));

(datascript.pull_api.MultivalAttrFrame.prototype.cljs$core$ICollection$_conj$arity$2 \x3d (function (this__5348__auto__,entry__5349__auto__){
var self__ \x3d this;
var this__5348__auto____$1 \x3d this;
if(cljs.core.vector_QMARK_(entry__5349__auto__)){
return this__5348__auto____$1.cljs$core$IAssociative$_assoc$arity$3(null,cljs.core._nth(entry__5349__auto__,(0)),cljs.core._nth(entry__5349__auto__,(1)));
} else {
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(cljs.core._conj,this__5348__auto____$1,entry__5349__auto__);
}
}));

(datascript.pull_api.MultivalAttrFrame.prototype.datascript$pull_api$IFrame$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.pull_api.MultivalAttrFrame.prototype.datascript$pull_api$IFrame$_run$arity$2 \x3d (function (this$,context){
var self__ \x3d this;
var this$__$1 \x3d this;
var acc__$1 \x3d self__.acc;
var datoms__$1 \x3d self__.datoms;
while(true){
var datom \x3d datascript.pull_api.first_seq(datoms__$1);
if((((datom \x3d\x3d null)) || (cljs.core.not_EQ_.cljs$core$IFn$_invoke$arity$2(datom.a,self__.attr.name)))){
return new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new datascript.pull_api.ResultFrame((function (){var G__54139 \x3d cljs.core.not_empty(cljs.core.persistent_BANG_(acc__$1));
var fexpr__54138 \x3d self__.attr.xform;
return (fexpr__54138.cljs$core$IFn$_invoke$arity$1 ? fexpr__54138.cljs$core$IFn$_invoke$arity$1(G__54139) : fexpr__54138.call(null,G__54139));
})(),(function (){var or__5045__auto__ \x3d datoms__$1;
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return cljs.core.List.EMPTY;
}
})(),null,null,null))], null);
} else {
if(cljs.core.truth_((function (){var and__5043__auto__ \x3d self__.attr.limit;
if(cljs.core.truth_(and__5043__auto__)){
return (cljs.core.count(acc__$1) \x3e\x3d self__.attr.limit);
} else {
return and__5043__auto__;
}
})())){
var datoms__$2 \x3d datoms__$1;
while(true){
var datom__$1 \x3d datascript.pull_api.first_seq(datoms__$2);
if((((datom__$1 \x3d\x3d null)) || (cljs.core.not_EQ_.cljs$core$IFn$_invoke$arity$2(datom__$1.a,self__.attr.name)))){
return new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new datascript.pull_api.ResultFrame(cljs.core.persistent_BANG_(acc__$1),(function (){var or__5045__auto__ \x3d datoms__$2;
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return cljs.core.List.EMPTY;
}
})(),null,null,null))], null);
} else {
var G__54409 \x3d datascript.pull_api.next_seq(datoms__$2);
datoms__$2 \x3d G__54409;
continue;
}
break;
}
} else {
var G__54410 \x3d cljs.core.conj_BANG_.cljs$core$IFn$_invoke$arity$2(acc__$1,datom.v);
var G__54411 \x3d datascript.pull_api.next_seq(datoms__$1);
acc__$1 \x3d G__54410;
datoms__$1 \x3d G__54411;
continue;

}
}
break;
}
}));

(datascript.pull_api.MultivalAttrFrame.getBasis \x3d (function (){
return new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22acc\x22,\x22acc\x22,-1815869457,null),cljs.core.with_meta(new cljs.core.Symbol(null,\x22attr\x22,\x22attr\x22,1036399174,null),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,\x22tag\x22,\x22tag\x22,-1290361223),new cljs.core.Symbol(null,\x22PullAttr\x22,\x22PullAttr\x22,1557473458,null)], null)),new cljs.core.Symbol(null,\x22datoms\x22,\x22datoms\x22,1349657093,null)], null);
}));

(datascript.pull_api.MultivalAttrFrame.cljs$lang$type \x3d true);

(datascript.pull_api.MultivalAttrFrame.cljs$lang$ctorPrSeq \x3d (function (this__5389__auto__){
return (new cljs.core.List(null,\x22datascript.pull-api/MultivalAttrFrame\x22,null,(1),null));
}));

(datascript.pull_api.MultivalAttrFrame.cljs$lang$ctorPrWriter \x3d (function (this__5389__auto__,writer__5390__auto__){
return cljs.core._write(writer__5390__auto__,\x22datascript.pull-api/MultivalAttrFrame\x22);
}));

/**
 * Positional factory function for datascript.pull-api/MultivalAttrFrame.
 */
datascript.pull_api.__GT_MultivalAttrFrame \x3d (function datascript$pull_api$__GT_MultivalAttrFrame(acc,attr,datoms){
return (new datascript.pull_api.MultivalAttrFrame(acc,attr,datoms,null,null,null));
});

/**
 * Factory function for datascript.pull-api/MultivalAttrFrame, taking a map of keywords to field values.
 */
datascript.pull_api.map__GT_MultivalAttrFrame \x3d (function datascript$pull_api$map__GT_MultivalAttrFrame(G__54119){
var extmap__5385__auto__ \x3d (function (){var G__54149 \x3d cljs.core.dissoc.cljs$core$IFn$_invoke$arity$variadic(G__54119,new cljs.core.Keyword(null,\x22acc\x22,\x22acc\x22,838566312),cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,\x22attr\x22,\x22attr\x22,-604132353),new cljs.core.Keyword(null,\x22datoms\x22,\x22datoms\x22,-290874434)], 0));
if(cljs.core.record_QMARK_(G__54119)){
return cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,G__54149);
} else {
return G__54149;
}
})();
return (new datascript.pull_api.MultivalAttrFrame(new cljs.core.Keyword(null,\x22acc\x22,\x22acc\x22,838566312).cljs$core$IFn$_invoke$arity$1(G__54119),new cljs.core.Keyword(null,\x22attr\x22,\x22attr\x22,-604132353).cljs$core$IFn$_invoke$arity$1(G__54119),new cljs.core.Keyword(null,\x22datoms\x22,\x22datoms\x22,-290874434).cljs$core$IFn$_invoke$arity$1(G__54119),null,cljs.core.not_empty(extmap__5385__auto__),null));
});


/**
* @constructor
 * @implements {cljs.core.IRecord}
 * @implements {datascript.pull_api.IFrame}
 * @implements {cljs.core.IKVReduce}
 * @implements {cljs.core.IEquiv}
 * @implements {cljs.core.IHash}
 * @implements {cljs.core.ICollection}
 * @implements {cljs.core.ICounted}
 * @implements {cljs.core.ISeqable}
 * @implements {cljs.core.IMeta}
 * @implements {cljs.core.ICloneable}
 * @implements {cljs.core.IPrintWithWriter}
 * @implements {cljs.core.IIterable}
 * @implements {cljs.core.IWithMeta}
 * @implements {cljs.core.IAssociative}
 * @implements {cljs.core.IMap}
 * @implements {cljs.core.ILookup}
*/
datascript.pull_api.MultivalRefAttrFrame \x3d (function (seen,recursion_limits,acc,pattern,attr,datoms,__meta,__extmap,__hash){
this.seen \x3d seen;
this.recursion_limits \x3d recursion_limits;
this.acc \x3d acc;
this.pattern \x3d pattern;
this.attr \x3d attr;
this.datoms \x3d datoms;
this.__meta \x3d __meta;
this.__extmap \x3d __extmap;
this.__hash \x3d __hash;
this.cljs$lang$protocol_mask$partition0$ \x3d 2230716170;
this.cljs$lang$protocol_mask$partition1$ \x3d 139264;
});
(datascript.pull_api.MultivalRefAttrFrame.prototype.cljs$core$ILookup$_lookup$arity$2 \x3d (function (this__5343__auto__,k__5344__auto__){
var self__ \x3d this;
var this__5343__auto____$1 \x3d this;
return this__5343__auto____$1.cljs$core$ILookup$_lookup$arity$3(null,k__5344__auto__,null);
}));

(datascript.pull_api.MultivalRefAttrFrame.prototype.cljs$core$ILookup$_lookup$arity$3 \x3d (function (this__5345__auto__,k54152,else__5346__auto__){
var self__ \x3d this;
var this__5345__auto____$1 \x3d this;
var G__54160 \x3d k54152;
var G__54160__$1 \x3d (((G__54160 instanceof cljs.core.Keyword))?G__54160.fqn:null);
switch (G__54160__$1) {
case \x22seen\x22:
return self__.seen;

break;
case \x22recursion-limits\x22:
return self__.recursion_limits;

break;
case \x22acc\x22:
return self__.acc;

break;
case \x22pattern\x22:
return self__.pattern;

break;
case \x22attr\x22:
return self__.attr;

break;
case \x22datoms\x22:
return self__.datoms;

break;
default:
return cljs.core.get.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k54152,else__5346__auto__);

}
}));

(datascript.pull_api.MultivalRefAttrFrame.prototype.cljs$core$IKVReduce$_kv_reduce$arity$3 \x3d (function (this__5363__auto__,f__5364__auto__,init__5365__auto__){
var self__ \x3d this;
var this__5363__auto____$1 \x3d this;
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (ret__5366__auto__,p__54161){
var vec__54162 \x3d p__54161;
var k__5367__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54162,(0),null);
var v__5368__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54162,(1),null);
return (f__5364__auto__.cljs$core$IFn$_invoke$arity$3 ? f__5364__auto__.cljs$core$IFn$_invoke$arity$3(ret__5366__auto__,k__5367__auto__,v__5368__auto__) : f__5364__auto__.call(null,ret__5366__auto__,k__5367__auto__,v__5368__auto__));
}),init__5365__auto__,this__5363__auto____$1);
}));

(datascript.pull_api.MultivalRefAttrFrame.prototype.cljs$core$IPrintWithWriter$_pr_writer$arity$3 \x3d (function (this__5358__auto__,writer__5359__auto__,opts__5360__auto__){
var self__ \x3d this;
var this__5358__auto____$1 \x3d this;
var pr_pair__5361__auto__ \x3d (function (keyval__5362__auto__){
return cljs.core.pr_sequential_writer(writer__5359__auto__,cljs.core.pr_writer,\x22\x22,\x22 \x22,\x22\x22,opts__5360__auto__,keyval__5362__auto__);
});
return cljs.core.pr_sequential_writer(writer__5359__auto__,pr_pair__5361__auto__,\x22#datascript.pull-api.MultivalRefAttrFrame{\x22,\x22, \x22,\x22}\x22,opts__5360__auto__,cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 6, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22seen\x22,\x22seen\x22,-518999789),self__.seen],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22recursion-limits\x22,\x22recursion-limits\x22,1762857814),self__.recursion_limits],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22acc\x22,\x22acc\x22,838566312),self__.acc],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423),self__.pattern],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22attr\x22,\x22attr\x22,-604132353),self__.attr],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22datoms\x22,\x22datoms\x22,-290874434),self__.datoms],null))], null),self__.__extmap));
}));

(datascript.pull_api.MultivalRefAttrFrame.prototype.cljs$core$IIterable$_iterator$arity$1 \x3d (function (G__54151){
var self__ \x3d this;
var G__54151__$1 \x3d this;
return (new cljs.core.RecordIter((0),G__54151__$1,6,new cljs.core.PersistentVector(null, 6, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22seen\x22,\x22seen\x22,-518999789),new cljs.core.Keyword(null,\x22recursion-limits\x22,\x22recursion-limits\x22,1762857814),new cljs.core.Keyword(null,\x22acc\x22,\x22acc\x22,838566312),new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423),new cljs.core.Keyword(null,\x22attr\x22,\x22attr\x22,-604132353),new cljs.core.Keyword(null,\x22datoms\x22,\x22datoms\x22,-290874434)], null),(cljs.core.truth_(self__.__extmap)?cljs.core._iterator(self__.__extmap):cljs.core.nil_iter())));
}));

(datascript.pull_api.MultivalRefAttrFrame.prototype.cljs$core$IMeta$_meta$arity$1 \x3d (function (this__5341__auto__){
var self__ \x3d this;
var this__5341__auto____$1 \x3d this;
return self__.__meta;
}));

(datascript.pull_api.MultivalRefAttrFrame.prototype.cljs$core$ICloneable$_clone$arity$1 \x3d (function (this__5338__auto__){
var self__ \x3d this;
var this__5338__auto____$1 \x3d this;
return (new datascript.pull_api.MultivalRefAttrFrame(self__.seen,self__.recursion_limits,self__.acc,self__.pattern,self__.attr,self__.datoms,self__.__meta,self__.__extmap,self__.__hash));
}));

(datascript.pull_api.MultivalRefAttrFrame.prototype.cljs$core$ICounted$_count$arity$1 \x3d (function (this__5347__auto__){
var self__ \x3d this;
var this__5347__auto____$1 \x3d this;
return (6 + cljs.core.count(self__.__extmap));
}));

(datascript.pull_api.MultivalRefAttrFrame.prototype.cljs$core$IHash$_hash$arity$1 \x3d (function (this__5339__auto__){
var self__ \x3d this;
var this__5339__auto____$1 \x3d this;
var h__5154__auto__ \x3d self__.__hash;
if((!((h__5154__auto__ \x3d\x3d null)))){
return h__5154__auto__;
} else {
var h__5154__auto____$1 \x3d (function (coll__5340__auto__){
return (1769511936 ^ cljs.core.hash_unordered_coll(coll__5340__auto__));
})(this__5339__auto____$1);
(self__.__hash \x3d h__5154__auto____$1);

return h__5154__auto____$1;
}
}));

(datascript.pull_api.MultivalRefAttrFrame.prototype.cljs$core$IEquiv$_equiv$arity$2 \x3d (function (this54153,other54154){
var self__ \x3d this;
var this54153__$1 \x3d this;
return (((!((other54154 \x3d\x3d null)))) \x26\x26 ((((this54153__$1.constructor \x3d\x3d\x3d other54154.constructor)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54153__$1.seen,other54154.seen)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54153__$1.recursion_limits,other54154.recursion_limits)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54153__$1.acc,other54154.acc)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54153__$1.pattern,other54154.pattern)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54153__$1.attr,other54154.attr)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54153__$1.datoms,other54154.datoms)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54153__$1.__extmap,other54154.__extmap)))))))))))))))));
}));

(datascript.pull_api.MultivalRefAttrFrame.prototype.cljs$core$IMap$_dissoc$arity$2 \x3d (function (this__5353__auto__,k__5354__auto__){
var self__ \x3d this;
var this__5353__auto____$1 \x3d this;
if(cljs.core.contains_QMARK_(new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 6, [new cljs.core.Keyword(null,\x22acc\x22,\x22acc\x22,838566312),null,new cljs.core.Keyword(null,\x22seen\x22,\x22seen\x22,-518999789),null,new cljs.core.Keyword(null,\x22recursion-limits\x22,\x22recursion-limits\x22,1762857814),null,new cljs.core.Keyword(null,\x22datoms\x22,\x22datoms\x22,-290874434),null,new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423),null,new cljs.core.Keyword(null,\x22attr\x22,\x22attr\x22,-604132353),null], null), null),k__5354__auto__)){
return cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(cljs.core._with_meta(cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,this__5353__auto____$1),self__.__meta),k__5354__auto__);
} else {
return (new datascript.pull_api.MultivalRefAttrFrame(self__.seen,self__.recursion_limits,self__.acc,self__.pattern,self__.attr,self__.datoms,self__.__meta,cljs.core.not_empty(cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(self__.__extmap,k__5354__auto__)),null));
}
}));

(datascript.pull_api.MultivalRefAttrFrame.prototype.cljs$core$IAssociative$_contains_key_QMARK_$arity$2 \x3d (function (this__5350__auto__,k54152){
var self__ \x3d this;
var this__5350__auto____$1 \x3d this;
var G__54169 \x3d k54152;
var G__54169__$1 \x3d (((G__54169 instanceof cljs.core.Keyword))?G__54169.fqn:null);
switch (G__54169__$1) {
case \x22seen\x22:
case \x22recursion-limits\x22:
case \x22acc\x22:
case \x22pattern\x22:
case \x22attr\x22:
case \x22datoms\x22:
return true;

break;
default:
return cljs.core.contains_QMARK_(self__.__extmap,k54152);

}
}));

(datascript.pull_api.MultivalRefAttrFrame.prototype.cljs$core$IAssociative$_assoc$arity$3 \x3d (function (this__5351__auto__,k__5352__auto__,G__54151){
var self__ \x3d this;
var this__5351__auto____$1 \x3d this;
var pred__54170 \x3d cljs.core.keyword_identical_QMARK_;
var expr__54171 \x3d k__5352__auto__;
if(cljs.core.truth_((pred__54170.cljs$core$IFn$_invoke$arity$2 ? pred__54170.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22seen\x22,\x22seen\x22,-518999789),expr__54171) : pred__54170.call(null,new cljs.core.Keyword(null,\x22seen\x22,\x22seen\x22,-518999789),expr__54171)))){
return (new datascript.pull_api.MultivalRefAttrFrame(G__54151,self__.recursion_limits,self__.acc,self__.pattern,self__.attr,self__.datoms,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__54170.cljs$core$IFn$_invoke$arity$2 ? pred__54170.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22recursion-limits\x22,\x22recursion-limits\x22,1762857814),expr__54171) : pred__54170.call(null,new cljs.core.Keyword(null,\x22recursion-limits\x22,\x22recursion-limits\x22,1762857814),expr__54171)))){
return (new datascript.pull_api.MultivalRefAttrFrame(self__.seen,G__54151,self__.acc,self__.pattern,self__.attr,self__.datoms,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__54170.cljs$core$IFn$_invoke$arity$2 ? pred__54170.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22acc\x22,\x22acc\x22,838566312),expr__54171) : pred__54170.call(null,new cljs.core.Keyword(null,\x22acc\x22,\x22acc\x22,838566312),expr__54171)))){
return (new datascript.pull_api.MultivalRefAttrFrame(self__.seen,self__.recursion_limits,G__54151,self__.pattern,self__.attr,self__.datoms,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__54170.cljs$core$IFn$_invoke$arity$2 ? pred__54170.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423),expr__54171) : pred__54170.call(null,new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423),expr__54171)))){
return (new datascript.pull_api.MultivalRefAttrFrame(self__.seen,self__.recursion_limits,self__.acc,G__54151,self__.attr,self__.datoms,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__54170.cljs$core$IFn$_invoke$arity$2 ? pred__54170.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22attr\x22,\x22attr\x22,-604132353),expr__54171) : pred__54170.call(null,new cljs.core.Keyword(null,\x22attr\x22,\x22attr\x22,-604132353),expr__54171)))){
return (new datascript.pull_api.MultivalRefAttrFrame(self__.seen,self__.recursion_limits,self__.acc,self__.pattern,G__54151,self__.datoms,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__54170.cljs$core$IFn$_invoke$arity$2 ? pred__54170.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22datoms\x22,\x22datoms\x22,-290874434),expr__54171) : pred__54170.call(null,new cljs.core.Keyword(null,\x22datoms\x22,\x22datoms\x22,-290874434),expr__54171)))){
return (new datascript.pull_api.MultivalRefAttrFrame(self__.seen,self__.recursion_limits,self__.acc,self__.pattern,self__.attr,G__54151,self__.__meta,self__.__extmap,null));
} else {
return (new datascript.pull_api.MultivalRefAttrFrame(self__.seen,self__.recursion_limits,self__.acc,self__.pattern,self__.attr,self__.datoms,self__.__meta,cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k__5352__auto__,G__54151),null));
}
}
}
}
}
}
}));

(datascript.pull_api.MultivalRefAttrFrame.prototype.cljs$core$ISeqable$_seq$arity$1 \x3d (function (this__5356__auto__){
var self__ \x3d this;
var this__5356__auto____$1 \x3d this;
return cljs.core.seq(cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 6, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22seen\x22,\x22seen\x22,-518999789),self__.seen,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22recursion-limits\x22,\x22recursion-limits\x22,1762857814),self__.recursion_limits,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22acc\x22,\x22acc\x22,838566312),self__.acc,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423),self__.pattern,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22attr\x22,\x22attr\x22,-604132353),self__.attr,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22datoms\x22,\x22datoms\x22,-290874434),self__.datoms,null))], null),self__.__extmap));
}));

(datascript.pull_api.MultivalRefAttrFrame.prototype.cljs$core$IWithMeta$_with_meta$arity$2 \x3d (function (this__5342__auto__,G__54151){
var self__ \x3d this;
var this__5342__auto____$1 \x3d this;
return (new datascript.pull_api.MultivalRefAttrFrame(self__.seen,self__.recursion_limits,self__.acc,self__.pattern,self__.attr,self__.datoms,G__54151,self__.__extmap,self__.__hash));
}));

(datascript.pull_api.MultivalRefAttrFrame.prototype.cljs$core$ICollection$_conj$arity$2 \x3d (function (this__5348__auto__,entry__5349__auto__){
var self__ \x3d this;
var this__5348__auto____$1 \x3d this;
if(cljs.core.vector_QMARK_(entry__5349__auto__)){
return this__5348__auto____$1.cljs$core$IAssociative$_assoc$arity$3(null,cljs.core._nth(entry__5349__auto__,(0)),cljs.core._nth(entry__5349__auto__,(1)));
} else {
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(cljs.core._conj,this__5348__auto____$1,entry__5349__auto__);
}
}));

(datascript.pull_api.MultivalRefAttrFrame.prototype.datascript$pull_api$IFrame$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.pull_api.MultivalRefAttrFrame.prototype.datascript$pull_api$IFrame$_merge$arity$2 \x3d (function (this$,result){
var self__ \x3d this;
var this$__$1 \x3d this;
return (new datascript.pull_api.MultivalRefAttrFrame(self__.seen,self__.recursion_limits,datascript.pull_api.conj_some_BANG_(self__.acc,result.value),self__.pattern,self__.attr,datascript.pull_api.next_seq(self__.datoms),null,null,null));
}));

(datascript.pull_api.MultivalRefAttrFrame.prototype.datascript$pull_api$IFrame$_run$arity$2 \x3d (function (this$,context){
var self__ \x3d this;
var this$__$1 \x3d this;
var datom \x3d datascript.pull_api.first_seq(self__.datoms);
if((((datom \x3d\x3d null)) || (cljs.core.not_EQ_.cljs$core$IFn$_invoke$arity$2(datom.a,self__.attr.name)))){
return new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new datascript.pull_api.ResultFrame((function (){var G__54185 \x3d cljs.core.not_empty(cljs.core.persistent_BANG_(self__.acc));
var fexpr__54184 \x3d self__.attr.xform;
return (fexpr__54184.cljs$core$IFn$_invoke$arity$1 ? fexpr__54184.cljs$core$IFn$_invoke$arity$1(G__54185) : fexpr__54184.call(null,G__54185));
})(),(function (){var or__5045__auto__ \x3d self__.datoms;
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return cljs.core.List.EMPTY;
}
})(),null,null,null))], null);
} else {
if(cljs.core.truth_((function (){var and__5043__auto__ \x3d self__.attr.limit;
if(cljs.core.truth_(and__5043__auto__)){
return (cljs.core.count(self__.acc) \x3e\x3d self__.attr.limit);
} else {
return and__5043__auto__;
}
})())){
var datoms__$1 \x3d self__.datoms;
while(true){
var datom__$1 \x3d datascript.pull_api.first_seq(datoms__$1);
if((((datom__$1 \x3d\x3d null)) || (cljs.core.not_EQ_.cljs$core$IFn$_invoke$arity$2(datom__$1.a,self__.attr.name)))){
return new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new datascript.pull_api.ResultFrame(cljs.core.persistent_BANG_(self__.acc),(function (){var or__5045__auto__ \x3d datoms__$1;
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return cljs.core.List.EMPTY;
}
})(),null,null,null))], null);
} else {
var G__54419 \x3d datascript.pull_api.next_seq(datoms__$1);
datoms__$1 \x3d G__54419;
continue;
}
break;
}
} else {
var id \x3d (cljs.core.truth_(self__.attr.reverse_QMARK_)?datom.e:datom.v);
return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [this$__$1,(datascript.pull_api.ref_frame.cljs$core$IFn$_invoke$arity$6 ? datascript.pull_api.ref_frame.cljs$core$IFn$_invoke$arity$6(context,self__.seen,self__.recursion_limits,self__.pattern,self__.attr,id) : datascript.pull_api.ref_frame.call(null,context,self__.seen,self__.recursion_limits,self__.pattern,self__.attr,id))], null);

}
}
}));

(datascript.pull_api.MultivalRefAttrFrame.getBasis \x3d (function (){
return new cljs.core.PersistentVector(null, 6, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22seen\x22,\x22seen\x22,1121531738,null),new cljs.core.Symbol(null,\x22recursion-limits\x22,\x22recursion-limits\x22,-891577955,null),new cljs.core.Symbol(null,\x22acc\x22,\x22acc\x22,-1815869457,null),new cljs.core.Symbol(null,\x22pattern\x22,\x22pattern\x22,1882666950,null),cljs.core.with_meta(new cljs.core.Symbol(null,\x22attr\x22,\x22attr\x22,1036399174,null),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,\x22tag\x22,\x22tag\x22,-1290361223),new cljs.core.Symbol(null,\x22PullAttr\x22,\x22PullAttr\x22,1557473458,null)], null)),new cljs.core.Symbol(null,\x22datoms\x22,\x22datoms\x22,1349657093,null)], null);
}));

(datascript.pull_api.MultivalRefAttrFrame.cljs$lang$type \x3d true);

(datascript.pull_api.MultivalRefAttrFrame.cljs$lang$ctorPrSeq \x3d (function (this__5389__auto__){
return (new cljs.core.List(null,\x22datascript.pull-api/MultivalRefAttrFrame\x22,null,(1),null));
}));

(datascript.pull_api.MultivalRefAttrFrame.cljs$lang$ctorPrWriter \x3d (function (this__5389__auto__,writer__5390__auto__){
return cljs.core._write(writer__5390__auto__,\x22datascript.pull-api/MultivalRefAttrFrame\x22);
}));

/**
 * Positional factory function for datascript.pull-api/MultivalRefAttrFrame.
 */
datascript.pull_api.__GT_MultivalRefAttrFrame \x3d (function datascript$pull_api$__GT_MultivalRefAttrFrame(seen,recursion_limits,acc,pattern,attr,datoms){
return (new datascript.pull_api.MultivalRefAttrFrame(seen,recursion_limits,acc,pattern,attr,datoms,null,null,null));
});

/**
 * Factory function for datascript.pull-api/MultivalRefAttrFrame, taking a map of keywords to field values.
 */
datascript.pull_api.map__GT_MultivalRefAttrFrame \x3d (function datascript$pull_api$map__GT_MultivalRefAttrFrame(G__54155){
var extmap__5385__auto__ \x3d (function (){var G__54189 \x3d cljs.core.dissoc.cljs$core$IFn$_invoke$arity$variadic(G__54155,new cljs.core.Keyword(null,\x22seen\x22,\x22seen\x22,-518999789),cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,\x22recursion-limits\x22,\x22recursion-limits\x22,1762857814),new cljs.core.Keyword(null,\x22acc\x22,\x22acc\x22,838566312),new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423),new cljs.core.Keyword(null,\x22attr\x22,\x22attr\x22,-604132353),new cljs.core.Keyword(null,\x22datoms\x22,\x22datoms\x22,-290874434)], 0));
if(cljs.core.record_QMARK_(G__54155)){
return cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,G__54189);
} else {
return G__54189;
}
})();
return (new datascript.pull_api.MultivalRefAttrFrame(new cljs.core.Keyword(null,\x22seen\x22,\x22seen\x22,-518999789).cljs$core$IFn$_invoke$arity$1(G__54155),new cljs.core.Keyword(null,\x22recursion-limits\x22,\x22recursion-limits\x22,1762857814).cljs$core$IFn$_invoke$arity$1(G__54155),new cljs.core.Keyword(null,\x22acc\x22,\x22acc\x22,838566312).cljs$core$IFn$_invoke$arity$1(G__54155),new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423).cljs$core$IFn$_invoke$arity$1(G__54155),new cljs.core.Keyword(null,\x22attr\x22,\x22attr\x22,-604132353).cljs$core$IFn$_invoke$arity$1(G__54155),new cljs.core.Keyword(null,\x22datoms\x22,\x22datoms\x22,-290874434).cljs$core$IFn$_invoke$arity$1(G__54155),null,cljs.core.not_empty(extmap__5385__auto__),null));
});


/**
* @constructor
 * @implements {cljs.core.IRecord}
 * @implements {datascript.pull_api.IFrame}
 * @implements {cljs.core.IKVReduce}
 * @implements {cljs.core.IEquiv}
 * @implements {cljs.core.IHash}
 * @implements {cljs.core.ICollection}
 * @implements {cljs.core.ICounted}
 * @implements {cljs.core.ISeqable}
 * @implements {cljs.core.IMeta}
 * @implements {cljs.core.ICloneable}
 * @implements {cljs.core.IPrintWithWriter}
 * @implements {cljs.core.IIterable}
 * @implements {cljs.core.IWithMeta}
 * @implements {cljs.core.IAssociative}
 * @implements {cljs.core.IMap}
 * @implements {cljs.core.ILookup}
*/
datascript.pull_api.AttrsFrame \x3d (function (seen,recursion_limits,acc,pattern,attr,attrs,datoms,id,__meta,__extmap,__hash){
this.seen \x3d seen;
this.recursion_limits \x3d recursion_limits;
this.acc \x3d acc;
this.pattern \x3d pattern;
this.attr \x3d attr;
this.attrs \x3d attrs;
this.datoms \x3d datoms;
this.id \x3d id;
this.__meta \x3d __meta;
this.__extmap \x3d __extmap;
this.__hash \x3d __hash;
this.cljs$lang$protocol_mask$partition0$ \x3d 2230716170;
this.cljs$lang$protocol_mask$partition1$ \x3d 139264;
});
(datascript.pull_api.AttrsFrame.prototype.cljs$core$ILookup$_lookup$arity$2 \x3d (function (this__5343__auto__,k__5344__auto__){
var self__ \x3d this;
var this__5343__auto____$1 \x3d this;
return this__5343__auto____$1.cljs$core$ILookup$_lookup$arity$3(null,k__5344__auto__,null);
}));

(datascript.pull_api.AttrsFrame.prototype.cljs$core$ILookup$_lookup$arity$3 \x3d (function (this__5345__auto__,k54195,else__5346__auto__){
var self__ \x3d this;
var this__5345__auto____$1 \x3d this;
var G__54199 \x3d k54195;
var G__54199__$1 \x3d (((G__54199 instanceof cljs.core.Keyword))?G__54199.fqn:null);
switch (G__54199__$1) {
case \x22seen\x22:
return self__.seen;

break;
case \x22recursion-limits\x22:
return self__.recursion_limits;

break;
case \x22acc\x22:
return self__.acc;

break;
case \x22pattern\x22:
return self__.pattern;

break;
case \x22attr\x22:
return self__.attr;

break;
case \x22attrs\x22:
return self__.attrs;

break;
case \x22datoms\x22:
return self__.datoms;

break;
case \x22id\x22:
return self__.id;

break;
default:
return cljs.core.get.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k54195,else__5346__auto__);

}
}));

(datascript.pull_api.AttrsFrame.prototype.cljs$core$IKVReduce$_kv_reduce$arity$3 \x3d (function (this__5363__auto__,f__5364__auto__,init__5365__auto__){
var self__ \x3d this;
var this__5363__auto____$1 \x3d this;
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (ret__5366__auto__,p__54200){
var vec__54201 \x3d p__54200;
var k__5367__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54201,(0),null);
var v__5368__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54201,(1),null);
return (f__5364__auto__.cljs$core$IFn$_invoke$arity$3 ? f__5364__auto__.cljs$core$IFn$_invoke$arity$3(ret__5366__auto__,k__5367__auto__,v__5368__auto__) : f__5364__auto__.call(null,ret__5366__auto__,k__5367__auto__,v__5368__auto__));
}),init__5365__auto__,this__5363__auto____$1);
}));

(datascript.pull_api.AttrsFrame.prototype.cljs$core$IPrintWithWriter$_pr_writer$arity$3 \x3d (function (this__5358__auto__,writer__5359__auto__,opts__5360__auto__){
var self__ \x3d this;
var this__5358__auto____$1 \x3d this;
var pr_pair__5361__auto__ \x3d (function (keyval__5362__auto__){
return cljs.core.pr_sequential_writer(writer__5359__auto__,cljs.core.pr_writer,\x22\x22,\x22 \x22,\x22\x22,opts__5360__auto__,keyval__5362__auto__);
});
return cljs.core.pr_sequential_writer(writer__5359__auto__,pr_pair__5361__auto__,\x22#datascript.pull-api.AttrsFrame{\x22,\x22, \x22,\x22}\x22,opts__5360__auto__,cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 8, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22seen\x22,\x22seen\x22,-518999789),self__.seen],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22recursion-limits\x22,\x22recursion-limits\x22,1762857814),self__.recursion_limits],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22acc\x22,\x22acc\x22,838566312),self__.acc],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423),self__.pattern],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22attr\x22,\x22attr\x22,-604132353),self__.attr],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713),self__.attrs],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22datoms\x22,\x22datoms\x22,-290874434),self__.datoms],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22id\x22,\x22id\x22,-1388402092),self__.id],null))], null),self__.__extmap));
}));

(datascript.pull_api.AttrsFrame.prototype.cljs$core$IIterable$_iterator$arity$1 \x3d (function (G__54194){
var self__ \x3d this;
var G__54194__$1 \x3d this;
return (new cljs.core.RecordIter((0),G__54194__$1,8,new cljs.core.PersistentVector(null, 8, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22seen\x22,\x22seen\x22,-518999789),new cljs.core.Keyword(null,\x22recursion-limits\x22,\x22recursion-limits\x22,1762857814),new cljs.core.Keyword(null,\x22acc\x22,\x22acc\x22,838566312),new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423),new cljs.core.Keyword(null,\x22attr\x22,\x22attr\x22,-604132353),new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713),new cljs.core.Keyword(null,\x22datoms\x22,\x22datoms\x22,-290874434),new cljs.core.Keyword(null,\x22id\x22,\x22id\x22,-1388402092)], null),(cljs.core.truth_(self__.__extmap)?cljs.core._iterator(self__.__extmap):cljs.core.nil_iter())));
}));

(datascript.pull_api.AttrsFrame.prototype.cljs$core$IMeta$_meta$arity$1 \x3d (function (this__5341__auto__){
var self__ \x3d this;
var this__5341__auto____$1 \x3d this;
return self__.__meta;
}));

(datascript.pull_api.AttrsFrame.prototype.cljs$core$ICloneable$_clone$arity$1 \x3d (function (this__5338__auto__){
var self__ \x3d this;
var this__5338__auto____$1 \x3d this;
return (new datascript.pull_api.AttrsFrame(self__.seen,self__.recursion_limits,self__.acc,self__.pattern,self__.attr,self__.attrs,self__.datoms,self__.id,self__.__meta,self__.__extmap,self__.__hash));
}));

(datascript.pull_api.AttrsFrame.prototype.cljs$core$ICounted$_count$arity$1 \x3d (function (this__5347__auto__){
var self__ \x3d this;
var this__5347__auto____$1 \x3d this;
return (8 + cljs.core.count(self__.__extmap));
}));

(datascript.pull_api.AttrsFrame.prototype.cljs$core$IHash$_hash$arity$1 \x3d (function (this__5339__auto__){
var self__ \x3d this;
var this__5339__auto____$1 \x3d this;
var h__5154__auto__ \x3d self__.__hash;
if((!((h__5154__auto__ \x3d\x3d null)))){
return h__5154__auto__;
} else {
var h__5154__auto____$1 \x3d (function (coll__5340__auto__){
return (1127179791 ^ cljs.core.hash_unordered_coll(coll__5340__auto__));
})(this__5339__auto____$1);
(self__.__hash \x3d h__5154__auto____$1);

return h__5154__auto____$1;
}
}));

(datascript.pull_api.AttrsFrame.prototype.cljs$core$IEquiv$_equiv$arity$2 \x3d (function (this54196,other54197){
var self__ \x3d this;
var this54196__$1 \x3d this;
return (((!((other54197 \x3d\x3d null)))) \x26\x26 ((((this54196__$1.constructor \x3d\x3d\x3d other54197.constructor)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54196__$1.seen,other54197.seen)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54196__$1.recursion_limits,other54197.recursion_limits)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54196__$1.acc,other54197.acc)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54196__$1.pattern,other54197.pattern)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54196__$1.attr,other54197.attr)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54196__$1.attrs,other54197.attrs)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54196__$1.datoms,other54197.datoms)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54196__$1.id,other54197.id)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54196__$1.__extmap,other54197.__extmap)))))))))))))))))))));
}));

(datascript.pull_api.AttrsFrame.prototype.cljs$core$IMap$_dissoc$arity$2 \x3d (function (this__5353__auto__,k__5354__auto__){
var self__ \x3d this;
var this__5353__auto____$1 \x3d this;
if(cljs.core.contains_QMARK_(new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 8, [new cljs.core.Keyword(null,\x22acc\x22,\x22acc\x22,838566312),null,new cljs.core.Keyword(null,\x22seen\x22,\x22seen\x22,-518999789),null,new cljs.core.Keyword(null,\x22id\x22,\x22id\x22,-1388402092),null,new cljs.core.Keyword(null,\x22recursion-limits\x22,\x22recursion-limits\x22,1762857814),null,new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713),null,new cljs.core.Keyword(null,\x22datoms\x22,\x22datoms\x22,-290874434),null,new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423),null,new cljs.core.Keyword(null,\x22attr\x22,\x22attr\x22,-604132353),null], null), null),k__5354__auto__)){
return cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(cljs.core._with_meta(cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,this__5353__auto____$1),self__.__meta),k__5354__auto__);
} else {
return (new datascript.pull_api.AttrsFrame(self__.seen,self__.recursion_limits,self__.acc,self__.pattern,self__.attr,self__.attrs,self__.datoms,self__.id,self__.__meta,cljs.core.not_empty(cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(self__.__extmap,k__5354__auto__)),null));
}
}));

(datascript.pull_api.AttrsFrame.prototype.cljs$core$IAssociative$_contains_key_QMARK_$arity$2 \x3d (function (this__5350__auto__,k54195){
var self__ \x3d this;
var this__5350__auto____$1 \x3d this;
var G__54206 \x3d k54195;
var G__54206__$1 \x3d (((G__54206 instanceof cljs.core.Keyword))?G__54206.fqn:null);
switch (G__54206__$1) {
case \x22seen\x22:
case \x22recursion-limits\x22:
case \x22acc\x22:
case \x22pattern\x22:
case \x22attr\x22:
case \x22attrs\x22:
case \x22datoms\x22:
case \x22id\x22:
return true;

break;
default:
return cljs.core.contains_QMARK_(self__.__extmap,k54195);

}
}));

(datascript.pull_api.AttrsFrame.prototype.cljs$core$IAssociative$_assoc$arity$3 \x3d (function (this__5351__auto__,k__5352__auto__,G__54194){
var self__ \x3d this;
var this__5351__auto____$1 \x3d this;
var pred__54207 \x3d cljs.core.keyword_identical_QMARK_;
var expr__54208 \x3d k__5352__auto__;
if(cljs.core.truth_((pred__54207.cljs$core$IFn$_invoke$arity$2 ? pred__54207.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22seen\x22,\x22seen\x22,-518999789),expr__54208) : pred__54207.call(null,new cljs.core.Keyword(null,\x22seen\x22,\x22seen\x22,-518999789),expr__54208)))){
return (new datascript.pull_api.AttrsFrame(G__54194,self__.recursion_limits,self__.acc,self__.pattern,self__.attr,self__.attrs,self__.datoms,self__.id,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__54207.cljs$core$IFn$_invoke$arity$2 ? pred__54207.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22recursion-limits\x22,\x22recursion-limits\x22,1762857814),expr__54208) : pred__54207.call(null,new cljs.core.Keyword(null,\x22recursion-limits\x22,\x22recursion-limits\x22,1762857814),expr__54208)))){
return (new datascript.pull_api.AttrsFrame(self__.seen,G__54194,self__.acc,self__.pattern,self__.attr,self__.attrs,self__.datoms,self__.id,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__54207.cljs$core$IFn$_invoke$arity$2 ? pred__54207.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22acc\x22,\x22acc\x22,838566312),expr__54208) : pred__54207.call(null,new cljs.core.Keyword(null,\x22acc\x22,\x22acc\x22,838566312),expr__54208)))){
return (new datascript.pull_api.AttrsFrame(self__.seen,self__.recursion_limits,G__54194,self__.pattern,self__.attr,self__.attrs,self__.datoms,self__.id,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__54207.cljs$core$IFn$_invoke$arity$2 ? pred__54207.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423),expr__54208) : pred__54207.call(null,new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423),expr__54208)))){
return (new datascript.pull_api.AttrsFrame(self__.seen,self__.recursion_limits,self__.acc,G__54194,self__.attr,self__.attrs,self__.datoms,self__.id,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__54207.cljs$core$IFn$_invoke$arity$2 ? pred__54207.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22attr\x22,\x22attr\x22,-604132353),expr__54208) : pred__54207.call(null,new cljs.core.Keyword(null,\x22attr\x22,\x22attr\x22,-604132353),expr__54208)))){
return (new datascript.pull_api.AttrsFrame(self__.seen,self__.recursion_limits,self__.acc,self__.pattern,G__54194,self__.attrs,self__.datoms,self__.id,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__54207.cljs$core$IFn$_invoke$arity$2 ? pred__54207.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713),expr__54208) : pred__54207.call(null,new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713),expr__54208)))){
return (new datascript.pull_api.AttrsFrame(self__.seen,self__.recursion_limits,self__.acc,self__.pattern,self__.attr,G__54194,self__.datoms,self__.id,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__54207.cljs$core$IFn$_invoke$arity$2 ? pred__54207.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22datoms\x22,\x22datoms\x22,-290874434),expr__54208) : pred__54207.call(null,new cljs.core.Keyword(null,\x22datoms\x22,\x22datoms\x22,-290874434),expr__54208)))){
return (new datascript.pull_api.AttrsFrame(self__.seen,self__.recursion_limits,self__.acc,self__.pattern,self__.attr,self__.attrs,G__54194,self__.id,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__54207.cljs$core$IFn$_invoke$arity$2 ? pred__54207.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22id\x22,\x22id\x22,-1388402092),expr__54208) : pred__54207.call(null,new cljs.core.Keyword(null,\x22id\x22,\x22id\x22,-1388402092),expr__54208)))){
return (new datascript.pull_api.AttrsFrame(self__.seen,self__.recursion_limits,self__.acc,self__.pattern,self__.attr,self__.attrs,self__.datoms,G__54194,self__.__meta,self__.__extmap,null));
} else {
return (new datascript.pull_api.AttrsFrame(self__.seen,self__.recursion_limits,self__.acc,self__.pattern,self__.attr,self__.attrs,self__.datoms,self__.id,self__.__meta,cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k__5352__auto__,G__54194),null));
}
}
}
}
}
}
}
}
}));

(datascript.pull_api.AttrsFrame.prototype.cljs$core$ISeqable$_seq$arity$1 \x3d (function (this__5356__auto__){
var self__ \x3d this;
var this__5356__auto____$1 \x3d this;
return cljs.core.seq(cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 8, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22seen\x22,\x22seen\x22,-518999789),self__.seen,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22recursion-limits\x22,\x22recursion-limits\x22,1762857814),self__.recursion_limits,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22acc\x22,\x22acc\x22,838566312),self__.acc,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423),self__.pattern,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22attr\x22,\x22attr\x22,-604132353),self__.attr,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713),self__.attrs,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22datoms\x22,\x22datoms\x22,-290874434),self__.datoms,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22id\x22,\x22id\x22,-1388402092),self__.id,null))], null),self__.__extmap));
}));

(datascript.pull_api.AttrsFrame.prototype.cljs$core$IWithMeta$_with_meta$arity$2 \x3d (function (this__5342__auto__,G__54194){
var self__ \x3d this;
var this__5342__auto____$1 \x3d this;
return (new datascript.pull_api.AttrsFrame(self__.seen,self__.recursion_limits,self__.acc,self__.pattern,self__.attr,self__.attrs,self__.datoms,self__.id,G__54194,self__.__extmap,self__.__hash));
}));

(datascript.pull_api.AttrsFrame.prototype.cljs$core$ICollection$_conj$arity$2 \x3d (function (this__5348__auto__,entry__5349__auto__){
var self__ \x3d this;
var this__5348__auto____$1 \x3d this;
if(cljs.core.vector_QMARK_(entry__5349__auto__)){
return this__5348__auto____$1.cljs$core$IAssociative$_assoc$arity$3(null,cljs.core._nth(entry__5349__auto__,(0)),cljs.core._nth(entry__5349__auto__,(1)));
} else {
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(cljs.core._conj,this__5348__auto____$1,entry__5349__auto__);
}
}));

(datascript.pull_api.AttrsFrame.prototype.datascript$pull_api$IFrame$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.pull_api.AttrsFrame.prototype.datascript$pull_api$IFrame$_merge$arity$2 \x3d (function (this$,result){
var self__ \x3d this;
var this$__$1 \x3d this;
return (new datascript.pull_api.AttrsFrame(self__.seen,self__.recursion_limits,datascript.pull_api.assoc_some_BANG_(self__.acc,self__.attr.as,result.value),self__.pattern,datascript.pull_api.first_seq(self__.attrs),datascript.pull_api.next_seq(self__.attrs),cljs.core.not_empty((function (){var or__5045__auto__ \x3d result.datoms;
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return datascript.pull_api.next_seq(self__.datoms);
}
})()),self__.id,null,null,null));
}));

(datascript.pull_api.AttrsFrame.prototype.datascript$pull_api$IFrame$_run$arity$2 \x3d (function (this$,context){
var self__ \x3d this;
var this$__$1 \x3d this;
var acc__$1 \x3d self__.acc;
var attr__$1 \x3d self__.attr;
var attrs__$1 \x3d self__.attrs;
var datoms__$1 \x3d self__.datoms;
while(true){
if((((datoms__$1 \x3d\x3d null)) \x26\x26 ((attr__$1 \x3d\x3d null)))){
return new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [(function (){var G__54240 \x3d self__.seen;
var G__54241 \x3d self__.recursion_limits;
var G__54242 \x3d acc__$1;
var G__54243 \x3d self__.pattern;
var G__54244 \x3d datascript.pull_api.first_seq(self__.pattern.reverse_attrs);
var G__54245 \x3d datascript.pull_api.next_seq(self__.pattern.reverse_attrs);
var G__54246 \x3d self__.id;
return (datascript.pull_api.__GT_ReverseAttrsFrame.cljs$core$IFn$_invoke$arity$7 ? datascript.pull_api.__GT_ReverseAttrsFrame.cljs$core$IFn$_invoke$arity$7(G__54240,G__54241,G__54242,G__54243,G__54244,G__54245,G__54246) : datascript.pull_api.__GT_ReverseAttrsFrame.call(null,G__54240,G__54241,G__54242,G__54243,G__54244,G__54245,G__54246));
})()], null);
} else {
if((((!((attr__$1 \x3d\x3d null)))) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(\x22db\x22,\x22id\x22,\x22db/id\x22,-1388397098),attr__$1.name)))){
var G__54435 \x3d cljs.core.assoc_BANG_.cljs$core$IFn$_invoke$arity$3(acc__$1,attr__$1.as,(function (){var fexpr__54248 \x3d attr__$1.xform;
return (fexpr__54248.cljs$core$IFn$_invoke$arity$1 ? fexpr__54248.cljs$core$IFn$_invoke$arity$1(self__.id) : fexpr__54248.call(null,self__.id));
})());
var G__54436 \x3d datascript.pull_api.first_seq(attrs__$1);
var G__54437 \x3d datascript.pull_api.next_seq(attrs__$1);
var G__54438 \x3d datoms__$1;
acc__$1 \x3d G__54435;
attr__$1 \x3d G__54436;
attrs__$1 \x3d G__54437;
datoms__$1 \x3d G__54438;
continue;
} else {
var datom \x3d datascript.pull_api.first_seq(datoms__$1);
var cmp \x3d (cljs.core.truth_((function (){var and__5043__auto__ \x3d datom;
if(cljs.core.truth_(and__5043__auto__)){
return attr__$1;
} else {
return and__5043__auto__;
}
})())?cljs.core.compare(attr__$1.name,datom.a):null);
var attr_ahead_QMARK_ \x3d (function (){var or__5045__auto__ \x3d (attr__$1 \x3d\x3d null);
if(or__5045__auto__){
return or__5045__auto__;
} else {
var and__5043__auto__ \x3d cmp;
if(cljs.core.truth_(and__5043__auto__)){
return (cmp \x3e (0));
} else {
return and__5043__auto__;
}
}
})();
var datom_ahead_QMARK_ \x3d (function (){var or__5045__auto__ \x3d (datom \x3d\x3d null);
if(or__5045__auto__){
return or__5045__auto__;
} else {
var and__5043__auto__ \x3d cmp;
if(cljs.core.truth_(and__5043__auto__)){
return (cmp \x3c (0));
} else {
return and__5043__auto__;
}
}
})();
if(cljs.core.truth_((function (){var and__5043__auto__ \x3d self__.pattern.wildcard_QMARK_;
if(cljs.core.truth_(and__5043__auto__)){
var and__5043__auto____$1 \x3d (!((datom \x3d\x3d null)));
if(and__5043__auto____$1){
return attr_ahead_QMARK_;
} else {
return and__5043__auto____$1;
}
} else {
return and__5043__auto__;
}
})())){
var datom_attr \x3d datascript.lru._get(datascript.db.unfiltered_db(context.db).pull_attrs,datom.a,((function (acc__$1,attr__$1,attrs__$1,datoms__$1,datom,cmp,attr_ahead_QMARK_,datom_ahead_QMARK_,this$__$1){
return (function (){
return datascript.pull_parser.parse_attr_name(context.db,datom.a);
});})(acc__$1,attr__$1,attrs__$1,datoms__$1,datom,cmp,attr_ahead_QMARK_,datom_ahead_QMARK_,this$__$1))
);
var G__54446 \x3d acc__$1;
var G__54447 \x3d datom_attr;
var G__54448 \x3d (cljs.core.truth_(attr__$1)?datascript.pull_api.conj_seq(attrs__$1,attr__$1):null);
var G__54449 \x3d datoms__$1;
acc__$1 \x3d G__54446;
attr__$1 \x3d G__54447;
attrs__$1 \x3d G__54448;
datoms__$1 \x3d G__54449;
continue;
} else {
if(cljs.core.truth_(attr_ahead_QMARK_)){
var G__54451 \x3d acc__$1;
var G__54452 \x3d attr__$1;
var G__54453 \x3d attrs__$1;
var G__54454 \x3d datascript.pull_api.next_seq(datoms__$1);
acc__$1 \x3d G__54451;
attr__$1 \x3d G__54452;
attrs__$1 \x3d G__54453;
datoms__$1 \x3d G__54454;
continue;
} else {
datascript.pull_api.visit(context,new cljs.core.Keyword(\x22db.pull\x22,\x22attr\x22,\x22db.pull/attr\x22,-533298746),self__.id,attr__$1.name,null);

if(cljs.core.truth_((function (){var and__5043__auto__ \x3d datom_ahead_QMARK_;
if(cljs.core.truth_(and__5043__auto__)){
return (attr__$1 \x3d\x3d null);
} else {
return and__5043__auto__;
}
})())){
var G__54455 \x3d acc__$1;
var G__54456 \x3d datascript.pull_api.first_seq(attrs__$1);
var G__54457 \x3d datascript.pull_api.next_seq(attrs__$1);
var G__54458 \x3d datoms__$1;
acc__$1 \x3d G__54455;
attr__$1 \x3d G__54456;
attrs__$1 \x3d G__54457;
datoms__$1 \x3d G__54458;
continue;
} else {
if(cljs.core.truth_((function (){var and__5043__auto__ \x3d datom_ahead_QMARK_;
if(cljs.core.truth_(and__5043__auto__)){
return (!((new cljs.core.Keyword(null,\x22default\x22,\x22default\x22,-1987822328).cljs$core$IFn$_invoke$arity$1(attr__$1) \x3d\x3d null)));
} else {
return and__5043__auto__;
}
})())){
var G__54459 \x3d cljs.core.assoc_BANG_.cljs$core$IFn$_invoke$arity$3(acc__$1,attr__$1.as,new cljs.core.Keyword(null,\x22default\x22,\x22default\x22,-1987822328).cljs$core$IFn$_invoke$arity$1(attr__$1));
var G__54460 \x3d datascript.pull_api.first_seq(attrs__$1);
var G__54461 \x3d datascript.pull_api.next_seq(attrs__$1);
var G__54462 \x3d datoms__$1;
acc__$1 \x3d G__54459;
attr__$1 \x3d G__54460;
attrs__$1 \x3d G__54461;
datoms__$1 \x3d G__54462;
continue;
} else {
if(cljs.core.truth_(datom_ahead_QMARK_)){
var temp__5806__auto__ \x3d (function (){var fexpr__54252 \x3d attr__$1.xform;
return (fexpr__54252.cljs$core$IFn$_invoke$arity$1 ? fexpr__54252.cljs$core$IFn$_invoke$arity$1(null) : fexpr__54252.call(null,null));
})();
if((temp__5806__auto__ \x3d\x3d null)){
var G__54463 \x3d acc__$1;
var G__54464 \x3d datascript.pull_api.first_seq(attrs__$1);
var G__54465 \x3d datascript.pull_api.next_seq(attrs__$1);
var G__54466 \x3d datoms__$1;
acc__$1 \x3d G__54463;
attr__$1 \x3d G__54464;
attrs__$1 \x3d G__54465;
datoms__$1 \x3d G__54466;
continue;
} else {
var value \x3d temp__5806__auto__;
var G__54467 \x3d cljs.core.assoc_BANG_.cljs$core$IFn$_invoke$arity$3(acc__$1,attr__$1.as,value);
var G__54468 \x3d datascript.pull_api.first_seq(attrs__$1);
var G__54469 \x3d datascript.pull_api.next_seq(attrs__$1);
var G__54470 \x3d datoms__$1;
acc__$1 \x3d G__54467;
attr__$1 \x3d G__54468;
attrs__$1 \x3d G__54469;
datoms__$1 \x3d G__54470;
continue;
}
} else {
if(cljs.core.truth_((function (){var and__5043__auto__ \x3d attr__$1.multival_QMARK_;
if(cljs.core.truth_(and__5043__auto__)){
return attr__$1.ref_QMARK_;
} else {
return and__5043__auto__;
}
})())){
return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new datascript.pull_api.AttrsFrame(self__.seen,self__.recursion_limits,acc__$1,self__.pattern,attr__$1,attrs__$1,datoms__$1,self__.id,null,null,null)),(new datascript.pull_api.MultivalRefAttrFrame(self__.seen,self__.recursion_limits,cljs.core.transient$(cljs.core.PersistentVector.EMPTY),self__.pattern,attr__$1,datoms__$1,null,null,null))], null);
} else {
if(cljs.core.truth_(attr__$1.multival_QMARK_)){
return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new datascript.pull_api.AttrsFrame(self__.seen,self__.recursion_limits,acc__$1,self__.pattern,attr__$1,attrs__$1,datoms__$1,self__.id,null,null,null)),(new datascript.pull_api.MultivalAttrFrame(cljs.core.transient$(cljs.core.PersistentVector.EMPTY),attr__$1,datoms__$1,null,null,null))], null);
} else {
if(cljs.core.truth_(attr__$1.ref_QMARK_)){
return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new datascript.pull_api.AttrsFrame(self__.seen,self__.recursion_limits,acc__$1,self__.pattern,attr__$1,attrs__$1,datoms__$1,self__.id,null,null,null)),(function (){var G__54255 \x3d context;
var G__54256 \x3d self__.seen;
var G__54257 \x3d self__.recursion_limits;
var G__54258 \x3d self__.pattern;
var G__54259 \x3d attr__$1;
var G__54260 \x3d datom.v;
return (datascript.pull_api.ref_frame.cljs$core$IFn$_invoke$arity$6 ? datascript.pull_api.ref_frame.cljs$core$IFn$_invoke$arity$6(G__54255,G__54256,G__54257,G__54258,G__54259,G__54260) : datascript.pull_api.ref_frame.call(null,G__54255,G__54256,G__54257,G__54258,G__54259,G__54260));
})()], null);
} else {
var G__54472 \x3d cljs.core.assoc_BANG_.cljs$core$IFn$_invoke$arity$3(acc__$1,attr__$1.as,(function (){var G__54262 \x3d datom.v;
var fexpr__54261 \x3d attr__$1.xform;
return (fexpr__54261.cljs$core$IFn$_invoke$arity$1 ? fexpr__54261.cljs$core$IFn$_invoke$arity$1(G__54262) : fexpr__54261.call(null,G__54262));
})());
var G__54473 \x3d datascript.pull_api.first_seq(attrs__$1);
var G__54474 \x3d datascript.pull_api.next_seq(attrs__$1);
var G__54475 \x3d datascript.pull_api.next_seq(datoms__$1);
acc__$1 \x3d G__54472;
attr__$1 \x3d G__54473;
attrs__$1 \x3d G__54474;
datoms__$1 \x3d G__54475;
continue;

}
}
}
}
}
}
}
}
}
}
break;
}
}));

(datascript.pull_api.AttrsFrame.getBasis \x3d (function (){
return new cljs.core.PersistentVector(null, 8, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22seen\x22,\x22seen\x22,1121531738,null),new cljs.core.Symbol(null,\x22recursion-limits\x22,\x22recursion-limits\x22,-891577955,null),new cljs.core.Symbol(null,\x22acc\x22,\x22acc\x22,-1815869457,null),cljs.core.with_meta(new cljs.core.Symbol(null,\x22pattern\x22,\x22pattern\x22,1882666950,null),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,\x22tag\x22,\x22tag\x22,-1290361223),new cljs.core.Symbol(null,\x22PullPattern\x22,\x22PullPattern\x22,1378528189,null)], null)),cljs.core.with_meta(new cljs.core.Symbol(null,\x22attr\x22,\x22attr\x22,1036399174,null),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,\x22tag\x22,\x22tag\x22,-1290361223),new cljs.core.Symbol(null,\x22PullAttr\x22,\x22PullAttr\x22,1557473458,null)], null)),new cljs.core.Symbol(null,\x22attrs\x22,\x22attrs\x22,-450137186,null),new cljs.core.Symbol(null,\x22datoms\x22,\x22datoms\x22,1349657093,null),new cljs.core.Symbol(null,\x22id\x22,\x22id\x22,252129435,null)], null);
}));

(datascript.pull_api.AttrsFrame.cljs$lang$type \x3d true);

(datascript.pull_api.AttrsFrame.cljs$lang$ctorPrSeq \x3d (function (this__5389__auto__){
return (new cljs.core.List(null,\x22datascript.pull-api/AttrsFrame\x22,null,(1),null));
}));

(datascript.pull_api.AttrsFrame.cljs$lang$ctorPrWriter \x3d (function (this__5389__auto__,writer__5390__auto__){
return cljs.core._write(writer__5390__auto__,\x22datascript.pull-api/AttrsFrame\x22);
}));

/**
 * Positional factory function for datascript.pull-api/AttrsFrame.
 */
datascript.pull_api.__GT_AttrsFrame \x3d (function datascript$pull_api$__GT_AttrsFrame(seen,recursion_limits,acc,pattern,attr,attrs,datoms,id){
return (new datascript.pull_api.AttrsFrame(seen,recursion_limits,acc,pattern,attr,attrs,datoms,id,null,null,null));
});

/**
 * Factory function for datascript.pull-api/AttrsFrame, taking a map of keywords to field values.
 */
datascript.pull_api.map__GT_AttrsFrame \x3d (function datascript$pull_api$map__GT_AttrsFrame(G__54198){
var extmap__5385__auto__ \x3d (function (){var G__54272 \x3d cljs.core.dissoc.cljs$core$IFn$_invoke$arity$variadic(G__54198,new cljs.core.Keyword(null,\x22seen\x22,\x22seen\x22,-518999789),cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,\x22recursion-limits\x22,\x22recursion-limits\x22,1762857814),new cljs.core.Keyword(null,\x22acc\x22,\x22acc\x22,838566312),new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423),new cljs.core.Keyword(null,\x22attr\x22,\x22attr\x22,-604132353),new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713),new cljs.core.Keyword(null,\x22datoms\x22,\x22datoms\x22,-290874434),new cljs.core.Keyword(null,\x22id\x22,\x22id\x22,-1388402092)], 0));
if(cljs.core.record_QMARK_(G__54198)){
return cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,G__54272);
} else {
return G__54272;
}
})();
return (new datascript.pull_api.AttrsFrame(new cljs.core.Keyword(null,\x22seen\x22,\x22seen\x22,-518999789).cljs$core$IFn$_invoke$arity$1(G__54198),new cljs.core.Keyword(null,\x22recursion-limits\x22,\x22recursion-limits\x22,1762857814).cljs$core$IFn$_invoke$arity$1(G__54198),new cljs.core.Keyword(null,\x22acc\x22,\x22acc\x22,838566312).cljs$core$IFn$_invoke$arity$1(G__54198),new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423).cljs$core$IFn$_invoke$arity$1(G__54198),new cljs.core.Keyword(null,\x22attr\x22,\x22attr\x22,-604132353).cljs$core$IFn$_invoke$arity$1(G__54198),new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713).cljs$core$IFn$_invoke$arity$1(G__54198),new cljs.core.Keyword(null,\x22datoms\x22,\x22datoms\x22,-290874434).cljs$core$IFn$_invoke$arity$1(G__54198),new cljs.core.Keyword(null,\x22id\x22,\x22id\x22,-1388402092).cljs$core$IFn$_invoke$arity$1(G__54198),null,cljs.core.not_empty(extmap__5385__auto__),null));
});


/**
* @constructor
 * @implements {cljs.core.IRecord}
 * @implements {datascript.pull_api.IFrame}
 * @implements {cljs.core.IKVReduce}
 * @implements {cljs.core.IEquiv}
 * @implements {cljs.core.IHash}
 * @implements {cljs.core.ICollection}
 * @implements {cljs.core.ICounted}
 * @implements {cljs.core.ISeqable}
 * @implements {cljs.core.IMeta}
 * @implements {cljs.core.ICloneable}
 * @implements {cljs.core.IPrintWithWriter}
 * @implements {cljs.core.IIterable}
 * @implements {cljs.core.IWithMeta}
 * @implements {cljs.core.IAssociative}
 * @implements {cljs.core.IMap}
 * @implements {cljs.core.ILookup}
*/
datascript.pull_api.ReverseAttrsFrame \x3d (function (seen,recursion_limits,acc,pattern,attr,attrs,id,__meta,__extmap,__hash){
this.seen \x3d seen;
this.recursion_limits \x3d recursion_limits;
this.acc \x3d acc;
this.pattern \x3d pattern;
this.attr \x3d attr;
this.attrs \x3d attrs;
this.id \x3d id;
this.__meta \x3d __meta;
this.__extmap \x3d __extmap;
this.__hash \x3d __hash;
this.cljs$lang$protocol_mask$partition0$ \x3d 2230716170;
this.cljs$lang$protocol_mask$partition1$ \x3d 139264;
});
(datascript.pull_api.ReverseAttrsFrame.prototype.cljs$core$ILookup$_lookup$arity$2 \x3d (function (this__5343__auto__,k__5344__auto__){
var self__ \x3d this;
var this__5343__auto____$1 \x3d this;
return this__5343__auto____$1.cljs$core$ILookup$_lookup$arity$3(null,k__5344__auto__,null);
}));

(datascript.pull_api.ReverseAttrsFrame.prototype.cljs$core$ILookup$_lookup$arity$3 \x3d (function (this__5345__auto__,k54274,else__5346__auto__){
var self__ \x3d this;
var this__5345__auto____$1 \x3d this;
var G__54283 \x3d k54274;
var G__54283__$1 \x3d (((G__54283 instanceof cljs.core.Keyword))?G__54283.fqn:null);
switch (G__54283__$1) {
case \x22seen\x22:
return self__.seen;

break;
case \x22recursion-limits\x22:
return self__.recursion_limits;

break;
case \x22acc\x22:
return self__.acc;

break;
case \x22pattern\x22:
return self__.pattern;

break;
case \x22attr\x22:
return self__.attr;

break;
case \x22attrs\x22:
return self__.attrs;

break;
case \x22id\x22:
return self__.id;

break;
default:
return cljs.core.get.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k54274,else__5346__auto__);

}
}));

(datascript.pull_api.ReverseAttrsFrame.prototype.cljs$core$IKVReduce$_kv_reduce$arity$3 \x3d (function (this__5363__auto__,f__5364__auto__,init__5365__auto__){
var self__ \x3d this;
var this__5363__auto____$1 \x3d this;
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (ret__5366__auto__,p__54284){
var vec__54285 \x3d p__54284;
var k__5367__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54285,(0),null);
var v__5368__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54285,(1),null);
return (f__5364__auto__.cljs$core$IFn$_invoke$arity$3 ? f__5364__auto__.cljs$core$IFn$_invoke$arity$3(ret__5366__auto__,k__5367__auto__,v__5368__auto__) : f__5364__auto__.call(null,ret__5366__auto__,k__5367__auto__,v__5368__auto__));
}),init__5365__auto__,this__5363__auto____$1);
}));

(datascript.pull_api.ReverseAttrsFrame.prototype.cljs$core$IPrintWithWriter$_pr_writer$arity$3 \x3d (function (this__5358__auto__,writer__5359__auto__,opts__5360__auto__){
var self__ \x3d this;
var this__5358__auto____$1 \x3d this;
var pr_pair__5361__auto__ \x3d (function (keyval__5362__auto__){
return cljs.core.pr_sequential_writer(writer__5359__auto__,cljs.core.pr_writer,\x22\x22,\x22 \x22,\x22\x22,opts__5360__auto__,keyval__5362__auto__);
});
return cljs.core.pr_sequential_writer(writer__5359__auto__,pr_pair__5361__auto__,\x22#datascript.pull-api.ReverseAttrsFrame{\x22,\x22, \x22,\x22}\x22,opts__5360__auto__,cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 7, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22seen\x22,\x22seen\x22,-518999789),self__.seen],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22recursion-limits\x22,\x22recursion-limits\x22,1762857814),self__.recursion_limits],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22acc\x22,\x22acc\x22,838566312),self__.acc],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423),self__.pattern],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22attr\x22,\x22attr\x22,-604132353),self__.attr],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713),self__.attrs],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22id\x22,\x22id\x22,-1388402092),self__.id],null))], null),self__.__extmap));
}));

(datascript.pull_api.ReverseAttrsFrame.prototype.cljs$core$IIterable$_iterator$arity$1 \x3d (function (G__54273){
var self__ \x3d this;
var G__54273__$1 \x3d this;
return (new cljs.core.RecordIter((0),G__54273__$1,7,new cljs.core.PersistentVector(null, 7, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22seen\x22,\x22seen\x22,-518999789),new cljs.core.Keyword(null,\x22recursion-limits\x22,\x22recursion-limits\x22,1762857814),new cljs.core.Keyword(null,\x22acc\x22,\x22acc\x22,838566312),new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423),new cljs.core.Keyword(null,\x22attr\x22,\x22attr\x22,-604132353),new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713),new cljs.core.Keyword(null,\x22id\x22,\x22id\x22,-1388402092)], null),(cljs.core.truth_(self__.__extmap)?cljs.core._iterator(self__.__extmap):cljs.core.nil_iter())));
}));

(datascript.pull_api.ReverseAttrsFrame.prototype.cljs$core$IMeta$_meta$arity$1 \x3d (function (this__5341__auto__){
var self__ \x3d this;
var this__5341__auto____$1 \x3d this;
return self__.__meta;
}));

(datascript.pull_api.ReverseAttrsFrame.prototype.cljs$core$ICloneable$_clone$arity$1 \x3d (function (this__5338__auto__){
var self__ \x3d this;
var this__5338__auto____$1 \x3d this;
return (new datascript.pull_api.ReverseAttrsFrame(self__.seen,self__.recursion_limits,self__.acc,self__.pattern,self__.attr,self__.attrs,self__.id,self__.__meta,self__.__extmap,self__.__hash));
}));

(datascript.pull_api.ReverseAttrsFrame.prototype.cljs$core$ICounted$_count$arity$1 \x3d (function (this__5347__auto__){
var self__ \x3d this;
var this__5347__auto____$1 \x3d this;
return (7 + cljs.core.count(self__.__extmap));
}));

(datascript.pull_api.ReverseAttrsFrame.prototype.cljs$core$IHash$_hash$arity$1 \x3d (function (this__5339__auto__){
var self__ \x3d this;
var this__5339__auto____$1 \x3d this;
var h__5154__auto__ \x3d self__.__hash;
if((!((h__5154__auto__ \x3d\x3d null)))){
return h__5154__auto__;
} else {
var h__5154__auto____$1 \x3d (function (coll__5340__auto__){
return (470210558 ^ cljs.core.hash_unordered_coll(coll__5340__auto__));
})(this__5339__auto____$1);
(self__.__hash \x3d h__5154__auto____$1);

return h__5154__auto____$1;
}
}));

(datascript.pull_api.ReverseAttrsFrame.prototype.cljs$core$IEquiv$_equiv$arity$2 \x3d (function (this54275,other54276){
var self__ \x3d this;
var this54275__$1 \x3d this;
return (((!((other54276 \x3d\x3d null)))) \x26\x26 ((((this54275__$1.constructor \x3d\x3d\x3d other54276.constructor)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54275__$1.seen,other54276.seen)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54275__$1.recursion_limits,other54276.recursion_limits)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54275__$1.acc,other54276.acc)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54275__$1.pattern,other54276.pattern)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54275__$1.attr,other54276.attr)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54275__$1.attrs,other54276.attrs)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54275__$1.id,other54276.id)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54275__$1.__extmap,other54276.__extmap)))))))))))))))))));
}));

(datascript.pull_api.ReverseAttrsFrame.prototype.cljs$core$IMap$_dissoc$arity$2 \x3d (function (this__5353__auto__,k__5354__auto__){
var self__ \x3d this;
var this__5353__auto____$1 \x3d this;
if(cljs.core.contains_QMARK_(new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 7, [new cljs.core.Keyword(null,\x22acc\x22,\x22acc\x22,838566312),null,new cljs.core.Keyword(null,\x22seen\x22,\x22seen\x22,-518999789),null,new cljs.core.Keyword(null,\x22id\x22,\x22id\x22,-1388402092),null,new cljs.core.Keyword(null,\x22recursion-limits\x22,\x22recursion-limits\x22,1762857814),null,new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713),null,new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423),null,new cljs.core.Keyword(null,\x22attr\x22,\x22attr\x22,-604132353),null], null), null),k__5354__auto__)){
return cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(cljs.core._with_meta(cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,this__5353__auto____$1),self__.__meta),k__5354__auto__);
} else {
return (new datascript.pull_api.ReverseAttrsFrame(self__.seen,self__.recursion_limits,self__.acc,self__.pattern,self__.attr,self__.attrs,self__.id,self__.__meta,cljs.core.not_empty(cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(self__.__extmap,k__5354__auto__)),null));
}
}));

(datascript.pull_api.ReverseAttrsFrame.prototype.cljs$core$IAssociative$_contains_key_QMARK_$arity$2 \x3d (function (this__5350__auto__,k54274){
var self__ \x3d this;
var this__5350__auto____$1 \x3d this;
var G__54292 \x3d k54274;
var G__54292__$1 \x3d (((G__54292 instanceof cljs.core.Keyword))?G__54292.fqn:null);
switch (G__54292__$1) {
case \x22seen\x22:
case \x22recursion-limits\x22:
case \x22acc\x22:
case \x22pattern\x22:
case \x22attr\x22:
case \x22attrs\x22:
case \x22id\x22:
return true;

break;
default:
return cljs.core.contains_QMARK_(self__.__extmap,k54274);

}
}));

(datascript.pull_api.ReverseAttrsFrame.prototype.cljs$core$IAssociative$_assoc$arity$3 \x3d (function (this__5351__auto__,k__5352__auto__,G__54273){
var self__ \x3d this;
var this__5351__auto____$1 \x3d this;
var pred__54293 \x3d cljs.core.keyword_identical_QMARK_;
var expr__54294 \x3d k__5352__auto__;
if(cljs.core.truth_((pred__54293.cljs$core$IFn$_invoke$arity$2 ? pred__54293.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22seen\x22,\x22seen\x22,-518999789),expr__54294) : pred__54293.call(null,new cljs.core.Keyword(null,\x22seen\x22,\x22seen\x22,-518999789),expr__54294)))){
return (new datascript.pull_api.ReverseAttrsFrame(G__54273,self__.recursion_limits,self__.acc,self__.pattern,self__.attr,self__.attrs,self__.id,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__54293.cljs$core$IFn$_invoke$arity$2 ? pred__54293.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22recursion-limits\x22,\x22recursion-limits\x22,1762857814),expr__54294) : pred__54293.call(null,new cljs.core.Keyword(null,\x22recursion-limits\x22,\x22recursion-limits\x22,1762857814),expr__54294)))){
return (new datascript.pull_api.ReverseAttrsFrame(self__.seen,G__54273,self__.acc,self__.pattern,self__.attr,self__.attrs,self__.id,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__54293.cljs$core$IFn$_invoke$arity$2 ? pred__54293.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22acc\x22,\x22acc\x22,838566312),expr__54294) : pred__54293.call(null,new cljs.core.Keyword(null,\x22acc\x22,\x22acc\x22,838566312),expr__54294)))){
return (new datascript.pull_api.ReverseAttrsFrame(self__.seen,self__.recursion_limits,G__54273,self__.pattern,self__.attr,self__.attrs,self__.id,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__54293.cljs$core$IFn$_invoke$arity$2 ? pred__54293.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423),expr__54294) : pred__54293.call(null,new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423),expr__54294)))){
return (new datascript.pull_api.ReverseAttrsFrame(self__.seen,self__.recursion_limits,self__.acc,G__54273,self__.attr,self__.attrs,self__.id,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__54293.cljs$core$IFn$_invoke$arity$2 ? pred__54293.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22attr\x22,\x22attr\x22,-604132353),expr__54294) : pred__54293.call(null,new cljs.core.Keyword(null,\x22attr\x22,\x22attr\x22,-604132353),expr__54294)))){
return (new datascript.pull_api.ReverseAttrsFrame(self__.seen,self__.recursion_limits,self__.acc,self__.pattern,G__54273,self__.attrs,self__.id,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__54293.cljs$core$IFn$_invoke$arity$2 ? pred__54293.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713),expr__54294) : pred__54293.call(null,new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713),expr__54294)))){
return (new datascript.pull_api.ReverseAttrsFrame(self__.seen,self__.recursion_limits,self__.acc,self__.pattern,self__.attr,G__54273,self__.id,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__54293.cljs$core$IFn$_invoke$arity$2 ? pred__54293.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22id\x22,\x22id\x22,-1388402092),expr__54294) : pred__54293.call(null,new cljs.core.Keyword(null,\x22id\x22,\x22id\x22,-1388402092),expr__54294)))){
return (new datascript.pull_api.ReverseAttrsFrame(self__.seen,self__.recursion_limits,self__.acc,self__.pattern,self__.attr,self__.attrs,G__54273,self__.__meta,self__.__extmap,null));
} else {
return (new datascript.pull_api.ReverseAttrsFrame(self__.seen,self__.recursion_limits,self__.acc,self__.pattern,self__.attr,self__.attrs,self__.id,self__.__meta,cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k__5352__auto__,G__54273),null));
}
}
}
}
}
}
}
}));

(datascript.pull_api.ReverseAttrsFrame.prototype.cljs$core$ISeqable$_seq$arity$1 \x3d (function (this__5356__auto__){
var self__ \x3d this;
var this__5356__auto____$1 \x3d this;
return cljs.core.seq(cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 7, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22seen\x22,\x22seen\x22,-518999789),self__.seen,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22recursion-limits\x22,\x22recursion-limits\x22,1762857814),self__.recursion_limits,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22acc\x22,\x22acc\x22,838566312),self__.acc,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423),self__.pattern,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22attr\x22,\x22attr\x22,-604132353),self__.attr,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713),self__.attrs,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22id\x22,\x22id\x22,-1388402092),self__.id,null))], null),self__.__extmap));
}));

(datascript.pull_api.ReverseAttrsFrame.prototype.cljs$core$IWithMeta$_with_meta$arity$2 \x3d (function (this__5342__auto__,G__54273){
var self__ \x3d this;
var this__5342__auto____$1 \x3d this;
return (new datascript.pull_api.ReverseAttrsFrame(self__.seen,self__.recursion_limits,self__.acc,self__.pattern,self__.attr,self__.attrs,self__.id,G__54273,self__.__extmap,self__.__hash));
}));

(datascript.pull_api.ReverseAttrsFrame.prototype.cljs$core$ICollection$_conj$arity$2 \x3d (function (this__5348__auto__,entry__5349__auto__){
var self__ \x3d this;
var this__5348__auto____$1 \x3d this;
if(cljs.core.vector_QMARK_(entry__5349__auto__)){
return this__5348__auto____$1.cljs$core$IAssociative$_assoc$arity$3(null,cljs.core._nth(entry__5349__auto__,(0)),cljs.core._nth(entry__5349__auto__,(1)));
} else {
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(cljs.core._conj,this__5348__auto____$1,entry__5349__auto__);
}
}));

(datascript.pull_api.ReverseAttrsFrame.prototype.datascript$pull_api$IFrame$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.pull_api.ReverseAttrsFrame.prototype.datascript$pull_api$IFrame$_merge$arity$2 \x3d (function (this$,result){
var self__ \x3d this;
var this$__$1 \x3d this;
return (new datascript.pull_api.ReverseAttrsFrame(self__.seen,self__.recursion_limits,datascript.pull_api.assoc_some_BANG_(self__.acc,self__.attr.as,result.value),self__.pattern,datascript.pull_api.first_seq(self__.attrs),datascript.pull_api.next_seq(self__.attrs),self__.id,null,null,null));
}));

(datascript.pull_api.ReverseAttrsFrame.prototype.datascript$pull_api$IFrame$_run$arity$2 \x3d (function (this$,context){
var self__ \x3d this;
var this$__$1 \x3d this;
var acc__$1 \x3d self__.acc;
var attr__$1 \x3d self__.attr;
var attrs__$1 \x3d self__.attrs;
while(true){
if((attr__$1 \x3d\x3d null)){
return new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new datascript.pull_api.ResultFrame(cljs.core.not_empty(cljs.core.persistent_BANG_(acc__$1)),null,null,null,null))], null);
} else {
var name \x3d attr__$1.name;
var db \x3d context.db;
var datoms \x3d (((db instanceof datascript.db.DB))?me.tonsky.persistent_sorted_set.slice.cljs$core$IFn$_invoke$arity$3(db.avet,datascript.db.datom.cljs$core$IFn$_invoke$arity$4((0),name,self__.id,(536870912)),datascript.db.datom.cljs$core$IFn$_invoke$arity$4((2147483647),name,self__.id,(2147483647))):datascript.db._search(db,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [null,name,self__.id], null)));
datascript.pull_api.visit(context,new cljs.core.Keyword(\x22db.pull\x22,\x22reverse\x22,\x22db.pull/reverse\x22,1999788297),null,name,self__.id);

if(((cljs.core.empty_QMARK_(datoms)) \x26\x26 ((!((new cljs.core.Keyword(null,\x22default\x22,\x22default\x22,-1987822328).cljs$core$IFn$_invoke$arity$1(attr__$1) \x3d\x3d null)))))){
var G__54489 \x3d cljs.core.assoc_BANG_.cljs$core$IFn$_invoke$arity$3(acc__$1,attr__$1.as,new cljs.core.Keyword(null,\x22default\x22,\x22default\x22,-1987822328).cljs$core$IFn$_invoke$arity$1(attr__$1));
var G__54490 \x3d datascript.pull_api.first_seq(attrs__$1);
var G__54491 \x3d datascript.pull_api.next_seq(attrs__$1);
acc__$1 \x3d G__54489;
attr__$1 \x3d G__54490;
attrs__$1 \x3d G__54491;
continue;
} else {
if(cljs.core.empty_QMARK_(datoms)){
var G__54492 \x3d acc__$1;
var G__54493 \x3d datascript.pull_api.first_seq(attrs__$1);
var G__54494 \x3d datascript.pull_api.next_seq(attrs__$1);
acc__$1 \x3d G__54492;
attr__$1 \x3d G__54493;
attrs__$1 \x3d G__54494;
continue;
} else {
if(cljs.core.truth_(attr__$1.component_QMARK_)){
return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new datascript.pull_api.ReverseAttrsFrame(self__.seen,self__.recursion_limits,acc__$1,self__.pattern,attr__$1,attrs__$1,self__.id,null,null,null)),(function (){var G__54315 \x3d context;
var G__54316 \x3d self__.seen;
var G__54317 \x3d self__.recursion_limits;
var G__54318 \x3d self__.pattern;
var G__54319 \x3d attr__$1;
var G__54320 \x3d datascript.pull_api.first_seq(datoms).e;
return (datascript.pull_api.ref_frame.cljs$core$IFn$_invoke$arity$6 ? datascript.pull_api.ref_frame.cljs$core$IFn$_invoke$arity$6(G__54315,G__54316,G__54317,G__54318,G__54319,G__54320) : datascript.pull_api.ref_frame.call(null,G__54315,G__54316,G__54317,G__54318,G__54319,G__54320));
})()], null);
} else {
return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new datascript.pull_api.ReverseAttrsFrame(self__.seen,self__.recursion_limits,acc__$1,self__.pattern,attr__$1,attrs__$1,self__.id,null,null,null)),(new datascript.pull_api.MultivalRefAttrFrame(self__.seen,self__.recursion_limits,cljs.core.transient$(cljs.core.PersistentVector.EMPTY),self__.pattern,attr__$1,datoms,null,null,null))], null);

}
}
}
}
break;
}
}));

(datascript.pull_api.ReverseAttrsFrame.getBasis \x3d (function (){
return new cljs.core.PersistentVector(null, 7, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22seen\x22,\x22seen\x22,1121531738,null),new cljs.core.Symbol(null,\x22recursion-limits\x22,\x22recursion-limits\x22,-891577955,null),new cljs.core.Symbol(null,\x22acc\x22,\x22acc\x22,-1815869457,null),new cljs.core.Symbol(null,\x22pattern\x22,\x22pattern\x22,1882666950,null),cljs.core.with_meta(new cljs.core.Symbol(null,\x22attr\x22,\x22attr\x22,1036399174,null),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,\x22tag\x22,\x22tag\x22,-1290361223),new cljs.core.Symbol(null,\x22PullAttr\x22,\x22PullAttr\x22,1557473458,null)], null)),new cljs.core.Symbol(null,\x22attrs\x22,\x22attrs\x22,-450137186,null),new cljs.core.Symbol(null,\x22id\x22,\x22id\x22,252129435,null)], null);
}));

(datascript.pull_api.ReverseAttrsFrame.cljs$lang$type \x3d true);

(datascript.pull_api.ReverseAttrsFrame.cljs$lang$ctorPrSeq \x3d (function (this__5389__auto__){
return (new cljs.core.List(null,\x22datascript.pull-api/ReverseAttrsFrame\x22,null,(1),null));
}));

(datascript.pull_api.ReverseAttrsFrame.cljs$lang$ctorPrWriter \x3d (function (this__5389__auto__,writer__5390__auto__){
return cljs.core._write(writer__5390__auto__,\x22datascript.pull-api/ReverseAttrsFrame\x22);
}));

/**
 * Positional factory function for datascript.pull-api/ReverseAttrsFrame.
 */
datascript.pull_api.__GT_ReverseAttrsFrame \x3d (function datascript$pull_api$__GT_ReverseAttrsFrame(seen,recursion_limits,acc,pattern,attr,attrs,id){
return (new datascript.pull_api.ReverseAttrsFrame(seen,recursion_limits,acc,pattern,attr,attrs,id,null,null,null));
});

/**
 * Factory function for datascript.pull-api/ReverseAttrsFrame, taking a map of keywords to field values.
 */
datascript.pull_api.map__GT_ReverseAttrsFrame \x3d (function datascript$pull_api$map__GT_ReverseAttrsFrame(G__54278){
var extmap__5385__auto__ \x3d (function (){var G__54326 \x3d cljs.core.dissoc.cljs$core$IFn$_invoke$arity$variadic(G__54278,new cljs.core.Keyword(null,\x22seen\x22,\x22seen\x22,-518999789),cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,\x22recursion-limits\x22,\x22recursion-limits\x22,1762857814),new cljs.core.Keyword(null,\x22acc\x22,\x22acc\x22,838566312),new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423),new cljs.core.Keyword(null,\x22attr\x22,\x22attr\x22,-604132353),new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713),new cljs.core.Keyword(null,\x22id\x22,\x22id\x22,-1388402092)], 0));
if(cljs.core.record_QMARK_(G__54278)){
return cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,G__54326);
} else {
return G__54326;
}
})();
return (new datascript.pull_api.ReverseAttrsFrame(new cljs.core.Keyword(null,\x22seen\x22,\x22seen\x22,-518999789).cljs$core$IFn$_invoke$arity$1(G__54278),new cljs.core.Keyword(null,\x22recursion-limits\x22,\x22recursion-limits\x22,1762857814).cljs$core$IFn$_invoke$arity$1(G__54278),new cljs.core.Keyword(null,\x22acc\x22,\x22acc\x22,838566312).cljs$core$IFn$_invoke$arity$1(G__54278),new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423).cljs$core$IFn$_invoke$arity$1(G__54278),new cljs.core.Keyword(null,\x22attr\x22,\x22attr\x22,-604132353).cljs$core$IFn$_invoke$arity$1(G__54278),new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713).cljs$core$IFn$_invoke$arity$1(G__54278),new cljs.core.Keyword(null,\x22id\x22,\x22id\x22,-1388402092).cljs$core$IFn$_invoke$arity$1(G__54278),null,cljs.core.not_empty(extmap__5385__auto__),null));
});

datascript.pull_api.auto_expanding_QMARK_ \x3d (function datascript$pull_api$auto_expanding_QMARK_(attr){
var or__5045__auto__ \x3d attr.recursive_QMARK_;
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
var and__5043__auto__ \x3d attr.component_QMARK_;
if(cljs.core.truth_(and__5043__auto__)){
return attr.pattern.wildcard_QMARK_;
} else {
return and__5043__auto__;
}
}
});
datascript.pull_api.ref_frame \x3d (function datascript$pull_api$ref_frame(context,seen,recursion_limits,pattern,attr,id){
if(cljs.core.not(datascript.pull_api.auto_expanding_QMARK_(attr))){
var G__54327 \x3d context;
var G__54328 \x3d seen;
var G__54329 \x3d recursion_limits;
var G__54330 \x3d attr.pattern;
var G__54331 \x3d id;
return (datascript.pull_api.attrs_frame.cljs$core$IFn$_invoke$arity$5 ? datascript.pull_api.attrs_frame.cljs$core$IFn$_invoke$arity$5(G__54327,G__54328,G__54329,G__54330,G__54331) : datascript.pull_api.attrs_frame.call(null,G__54327,G__54328,G__54329,G__54330,G__54331));
} else {
if(cljs.core.truth_((seen.cljs$core$IFn$_invoke$arity$1 ? seen.cljs$core$IFn$_invoke$arity$1(id) : seen.call(null,id)))){
return (new datascript.pull_api.ResultFrame(new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(\x22db\x22,\x22id\x22,\x22db/id\x22,-1388397098),id], null),null,null,null,null));
} else {
var lim \x3d (recursion_limits.cljs$core$IFn$_invoke$arity$1 ? recursion_limits.cljs$core$IFn$_invoke$arity$1(attr) : recursion_limits.call(null,attr));
if(cljs.core.truth_((function (){var and__5043__auto__ \x3d lim;
if(cljs.core.truth_(and__5043__auto__)){
return (lim \x3c\x3d (0));
} else {
return and__5043__auto__;
}
})())){
return (new datascript.pull_api.ResultFrame(null,null,null,null,null));
} else {
var seen_SINGLEQUOTE_ \x3d cljs.core.conj.cljs$core$IFn$_invoke$arity$2(seen,id);
var recursion_limits_SINGLEQUOTE_ \x3d (cljs.core.truth_(lim)?cljs.core.update.cljs$core$IFn$_invoke$arity$3(recursion_limits,attr,cljs.core.dec):(cljs.core.truth_(attr.recursion_limit)?cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(recursion_limits,attr,(attr.recursion_limit - (1))):recursion_limits
));
var G__54332 \x3d context;
var G__54333 \x3d seen_SINGLEQUOTE_;
var G__54334 \x3d recursion_limits_SINGLEQUOTE_;
var G__54335 \x3d (cljs.core.truth_(attr.recursive_QMARK_)?pattern:attr.pattern);
var G__54336 \x3d id;
return (datascript.pull_api.attrs_frame.cljs$core$IFn$_invoke$arity$5 ? datascript.pull_api.attrs_frame.cljs$core$IFn$_invoke$arity$5(G__54332,G__54333,G__54334,G__54335,G__54336) : datascript.pull_api.attrs_frame.call(null,G__54332,G__54333,G__54334,G__54335,G__54336));

}
}
}
});
datascript.pull_api.attrs_frame \x3d (function datascript$pull_api$attrs_frame(context,seen,recursion_limits,pattern,id){
var db \x3d context.db;
var datoms \x3d (cljs.core.truth_((function (){var and__5043__auto__ \x3d pattern.wildcard_QMARK_;
if(cljs.core.truth_(and__5043__auto__)){
return (db instanceof datascript.db.DB);
} else {
return and__5043__auto__;
}
})())?me.tonsky.persistent_sorted_set.slice.cljs$core$IFn$_invoke$arity$3(db.eavt,datascript.db.datom.cljs$core$IFn$_invoke$arity$4(id,null,null,(536870912)),datascript.db.datom.cljs$core$IFn$_invoke$arity$4(id,null,null,(2147483647))):(cljs.core.truth_(pattern.wildcard_QMARK_)?datascript.db._search(db,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [id], null)):(((pattern.first_attr \x3d\x3d null))?null:(function (){var from \x3d pattern.first_attr.name;
var to \x3d pattern.last_attr.name;
if((db instanceof datascript.db.DB)){
return me.tonsky.persistent_sorted_set.slice.cljs$core$IFn$_invoke$arity$3(db.eavt,datascript.db.datom.cljs$core$IFn$_invoke$arity$4(id,from,null,(536870912)),datascript.db.datom.cljs$core$IFn$_invoke$arity$4(id,to,null,(2147483647)));
} else {
return datascript.db._seek_datoms(db,new cljs.core.Keyword(null,\x22eavt\x22,\x22eavt\x22,-666437073),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [id], null));

}
})())));
if(cljs.core.truth_(pattern.wildcard_QMARK_)){
datascript.pull_api.visit(context,new cljs.core.Keyword(\x22db.pull\x22,\x22wildcard\x22,\x22db.pull/wildcard\x22,116316031),id,null,null);
} else {
}

return (new datascript.pull_api.AttrsFrame(seen,recursion_limits,cljs.core.transient$(cljs.core.PersistentArrayMap.EMPTY),pattern,datascript.pull_api.first_seq(pattern.attrs),datascript.pull_api.next_seq(pattern.attrs),datoms,id,null,null,null));
});
datascript.pull_api.pull_impl \x3d (function datascript$pull_api$pull_impl(parsed_opts,id){
var map__54341 \x3d parsed_opts;
var map__54341__$1 \x3d cljs.core.__destructure_map(map__54341);
var context \x3d cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__54341__$1,new cljs.core.Keyword(null,\x22context\x22,\x22context\x22,-830191113));
var pattern \x3d cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__54341__$1,new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423));
var temp__5808__auto__ \x3d datascript.db.entid(context.db,id);
if((temp__5808__auto__ \x3d\x3d null)){
return null;
} else {
var eid \x3d temp__5808__auto__;
var stack \x3d (new cljs.core.List(null,datascript.pull_api.attrs_frame(context,cljs.core.PersistentHashSet.EMPTY,cljs.core.PersistentArrayMap.EMPTY,pattern,eid),null,(1),null));
while(true){
var last \x3d datascript.pull_api.first_seq(stack);
var stack_SINGLEQUOTE_ \x3d datascript.pull_api.next_seq(stack);
if((!((last instanceof datascript.pull_api.ResultFrame)))){
var G__54504 \x3d cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(datascript.pull_api.conj_seq,stack_SINGLEQUOTE_,datascript.pull_api._run(last,context));
stack \x3d G__54504;
continue;
} else {
if((stack_SINGLEQUOTE_ \x3d\x3d null)){
return last.value;
} else {
var penultimate \x3d datascript.pull_api.first_seq(stack_SINGLEQUOTE_);
var stack_SINGLEQUOTE__SINGLEQUOTE_ \x3d datascript.pull_api.next_seq(stack_SINGLEQUOTE_);
var G__54505 \x3d datascript.pull_api.conj_seq(stack_SINGLEQUOTE__SINGLEQUOTE_,datascript.pull_api._merge(penultimate,last));
stack \x3d G__54505;
continue;

}
}
break;
}
}
});
datascript.pull_api.parse_opts \x3d (function datascript$pull_api$parse_opts(var_args){
var G__54352 \x3d arguments.length;
switch (G__54352) {
case 2:
return datascript.pull_api.parse_opts.cljs$core$IFn$_invoke$arity$2((arguments[(0)]),(arguments[(1)]));

break;
case 3:
return datascript.pull_api.parse_opts.cljs$core$IFn$_invoke$arity$3((arguments[(0)]),(arguments[(1)]),(arguments[(2)]));

break;
default:
throw (new Error([\x22Invalid arity: \x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1(arguments.length)].join(\x27\x27)));

}
});

(datascript.pull_api.parse_opts.cljs$core$IFn$_invoke$arity$2 \x3d (function (db,pattern){
return datascript.pull_api.parse_opts.cljs$core$IFn$_invoke$arity$3(db,pattern,null);
}));

(datascript.pull_api.parse_opts.cljs$core$IFn$_invoke$arity$3 \x3d (function (db,pattern,p__54353){
var map__54354 \x3d p__54353;
var map__54354__$1 \x3d cljs.core.__destructure_map(map__54354);
var visitor \x3d cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__54354__$1,new cljs.core.Keyword(null,\x22visitor\x22,\x22visitor\x22,-1026865865));
return new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423),datascript.lru._get(datascript.db.unfiltered_db(db).pull_patterns,pattern,(function (){
return datascript.pull_parser.parse_pattern(db,pattern);
})),new cljs.core.Keyword(null,\x22context\x22,\x22context\x22,-830191113),(new datascript.pull_api.Context(db,visitor,null,null,null))], null);
}));

(datascript.pull_api.parse_opts.cljs$lang$maxFixedArity \x3d 3);

/**
 * Supported opts:
 * 
 * :visitor a fn of 4 arguments, will be called for every entity/attribute pull touches
 * 
 * (:db.pull/attr     e   a   nil) - when pulling a normal attribute, no matter if it has value or not
 * (:db.pull/wildcard e   nil nil) - when pulling every attribute on an entity
 * (:db.pull/reverse  nil a   v  ) - when pulling reverse attribute
 */
datascript.pull_api.pull \x3d (function datascript$pull_api$pull(var_args){
var G__54361 \x3d arguments.length;
switch (G__54361) {
case 3:
return datascript.pull_api.pull.cljs$core$IFn$_invoke$arity$3((arguments[(0)]),(arguments[(1)]),(arguments[(2)]));

break;
case 4:
return datascript.pull_api.pull.cljs$core$IFn$_invoke$arity$4((arguments[(0)]),(arguments[(1)]),(arguments[(2)]),(arguments[(3)]));

break;
default:
throw (new Error([\x22Invalid arity: \x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1(arguments.length)].join(\x27\x27)));

}
});

(datascript.pull_api.pull.cljs$core$IFn$_invoke$arity$3 \x3d (function (db,pattern,id){
return datascript.pull_api.pull.cljs$core$IFn$_invoke$arity$4(db,pattern,id,cljs.core.PersistentArrayMap.EMPTY);
}));

(datascript.pull_api.pull.cljs$core$IFn$_invoke$arity$4 \x3d (function (db,pattern,id,opts){
if(datascript.db.db_QMARK_(db)){
} else {
throw (new Error(\x22Assert failed: (db/db? db)\x22));
}

var parsed_opts \x3d datascript.pull_api.parse_opts.cljs$core$IFn$_invoke$arity$3(db,pattern,opts);
return datascript.pull_api.pull_impl(parsed_opts,id);
}));

(datascript.pull_api.pull.cljs$lang$maxFixedArity \x3d 4);

datascript.pull_api.pull_many \x3d (function datascript$pull_api$pull_many(var_args){
var G__54364 \x3d arguments.length;
switch (G__54364) {
case 3:
return datascript.pull_api.pull_many.cljs$core$IFn$_invoke$arity$3((arguments[(0)]),(arguments[(1)]),(arguments[(2)]));

break;
case 4:
return datascript.pull_api.pull_many.cljs$core$IFn$_invoke$arity$4((arguments[(0)]),(arguments[(1)]),(arguments[(2)]),(arguments[(3)]));

break;
default:
throw (new Error([\x22Invalid arity: \x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1(arguments.length)].join(\x27\x27)));

}
});

(datascript.pull_api.pull_many.cljs$core$IFn$_invoke$arity$3 \x3d (function (db,pattern,ids){
return datascript.pull_api.pull_many.cljs$core$IFn$_invoke$arity$4(db,pattern,ids,cljs.core.PersistentArrayMap.EMPTY);
}));

(datascript.pull_api.pull_many.cljs$core$IFn$_invoke$arity$4 \x3d (function (db,pattern,ids,opts){
if(datascript.db.db_QMARK_(db)){
} else {
throw (new Error(\x22Assert failed: (db/db? db)\x22));
}

var parsed_opts \x3d datascript.pull_api.parse_opts.cljs$core$IFn$_invoke$arity$3(db,pattern,opts);
return cljs.core.mapv.cljs$core$IFn$_invoke$arity$2((function (p1__54362_SHARP_){
return datascript.pull_api.pull_impl(parsed_opts,p1__54362_SHARP_);
}),ids);
}));

(datascript.pull_api.pull_many.cljs$lang$maxFixedArity \x3d 4);

");
SHADOW_ENV.evalLoad("datascript.serialize.js", true , "goog.provide(\x27datascript.serialize\x27);
datascript.serialize.marker_kw \x3d (0);
datascript.serialize.marker_other \x3d (1);
datascript.serialize.marker_inf \x3d (2);
datascript.serialize.marker_minus_inf \x3d (3);
datascript.serialize.marker_nan \x3d (4);
datascript.serialize.if_cljs \x3d (function datascript$serialize$if_cljs(env,then,else$){
if(cljs.core.truth_(new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760).cljs$core$IFn$_invoke$arity$1(env))){
return then;
} else {
return else$;
}
});
datascript.serialize.array_get \x3d (function datascript$serialize$array_get(d,i){
if(cljs.core.array_QMARK_(d)){
return (d[i]);
} else {
return cljs.core.nth.cljs$core$IFn$_invoke$arity$2(d,i);
}
});
datascript.serialize.dict_get \x3d (function datascript$serialize$dict_get(d,k){
if(cljs.core.map_QMARK_(d)){
return (d.cljs$core$IFn$_invoke$arity$1 ? d.cljs$core$IFn$_invoke$arity$1(k) : d.call(null,k));
} else {
return (d[k]);
}
});
datascript.serialize.array_QMARK_ \x3d (function datascript$serialize$array_QMARK_(a){
return ((cljs.core.array_QMARK_(a)) || (cljs.core.vector_QMARK_(a)));
});
datascript.serialize.amap \x3d (function datascript$serialize$amap(f,xs){
var arr \x3d (new Array(cljs.core.count(xs)));
cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (idx,x){
(arr[idx] \x3d (f.cljs$core$IFn$_invoke$arity$1 ? f.cljs$core$IFn$_invoke$arity$1(x) : f.call(null,x)));

return (idx + (1));
}),(0),xs);

return arr;
});
datascript.serialize.amap_indexed \x3d (function datascript$serialize$amap_indexed(f,xs){
var arr \x3d (new Array(cljs.core.count(xs)));
cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (idx,x){
(arr[idx] \x3d (f.cljs$core$IFn$_invoke$arity$2 ? f.cljs$core$IFn$_invoke$arity$2(idx,x) : f.call(null,idx,x)));

return (idx + (1));
}),(0),xs);

return arr;
});
/**
 * Looks for a datom with attribute exactly bigger than the given one
 */
datascript.serialize.attr_comparator \x3d (function datascript$serialize$attr_comparator(d1,d2){
if((d2.a \x3d\x3d null)){
return (-1);
} else {
if((cljs.core.compare(d1.a,d2.a) \x3c\x3d (0))){
return (-1);
} else {
return (1);

}
}
});
/**
 * All attrs in a DB, distinct, sorted
 */
datascript.serialize.all_attrs \x3d (function datascript$serialize$all_attrs(db){
if(cljs.core.empty_QMARK_(new cljs.core.Keyword(null,\x22aevt\x22,\x22aevt\x22,-585148059).cljs$core$IFn$_invoke$arity$1(db))){
return cljs.core.PersistentVector.EMPTY;
} else {
var attrs \x3d cljs.core.transient$(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22a\x22,\x22a\x22,-2123407586).cljs$core$IFn$_invoke$arity$1(cljs.core.first(new cljs.core.Keyword(null,\x22aevt\x22,\x22aevt\x22,-585148059).cljs$core$IFn$_invoke$arity$1(db)))], null));
while(true){
var attr \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$2(attrs,(cljs.core.count(attrs) - (1)));
var left \x3d datascript.db.datom.cljs$core$IFn$_invoke$arity$3((0),attr,null);
var right \x3d datascript.db.datom.cljs$core$IFn$_invoke$arity$3((2147483647),null,null);
var next_attr \x3d new cljs.core.Keyword(null,\x22a\x22,\x22a\x22,-2123407586).cljs$core$IFn$_invoke$arity$1(cljs.core.first(me.tonsky.persistent_sorted_set.slice.cljs$core$IFn$_invoke$arity$4(new cljs.core.Keyword(null,\x22aevt\x22,\x22aevt\x22,-585148059).cljs$core$IFn$_invoke$arity$1(db),left,right,datascript.serialize.attr_comparator)));
if((!((next_attr \x3d\x3d null)))){
var G__52442 \x3d cljs.core.conj_BANG_.cljs$core$IFn$_invoke$arity$2(attrs,next_attr);
attrs \x3d G__52442;
continue;
} else {
return cljs.core.persistent_BANG_(attrs);
}
break;
}
}
});
datascript.serialize.freeze_kw \x3d cljs.core.str;
datascript.serialize.thaw_kw \x3d (function datascript$serialize$thaw_kw(s){
if(clojure.string.starts_with_QMARK_(s,\x22:\x22)){
return cljs.core.keyword.cljs$core$IFn$_invoke$arity$1(cljs.core.subs.cljs$core$IFn$_invoke$arity$2(s,(1)));
} else {
return s;
}
});
/**
 * Serialized structure breakdown:
 * 
 * count    :: number    
 * tx0      :: number
 * max-eid  :: number
 * max-tx   :: number
 * schema   :: freezed :schema
 * attrs    :: [keywords ...]
 * keywords :: [keywords ...]
 * eavt     :: [[e a-idx v dtx] ...]
 * a-idx    :: index in attrs
 * v        :: (string | number | boolean | [0 \x3cindex in keywords\x3e] | [1 \x3cfreezed v\x3e])
 * dtx      :: tx - tx0
 * aevt     :: [\x3cindex in eavt\x3e ...]
 * avet     :: [\x3cindex in eavt\x3e ...]
 */
datascript.serialize.serializable_impl \x3d (function datascript$serialize$serializable_impl(db,p__52294){
var map__52295 \x3d p__52294;
var map__52295__$1 \x3d cljs.core.__destructure_map(map__52295);
var freeze_fn \x3d cljs.core.get.cljs$core$IFn$_invoke$arity$3(map__52295__$1,new cljs.core.Keyword(null,\x22freeze-fn\x22,\x22freeze-fn\x22,-575885995),cljs.core.pr_str);
var freeze_kw \x3d cljs.core.get.cljs$core$IFn$_invoke$arity$3(map__52295__$1,new cljs.core.Keyword(null,\x22freeze-kw\x22,\x22freeze-kw\x22,391758233),datascript.serialize.freeze_kw);
var attrs \x3d datascript.serialize.all_attrs(db);
var attrs_map \x3d cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,cljs.core.map.cljs$core$IFn$_invoke$arity$3(cljs.core.vector,attrs,cljs.core.range.cljs$core$IFn$_invoke$arity$0()));
var _STAR_kws \x3d cljs.core.volatile_BANG_(cljs.core.transient$(cljs.core.PersistentVector.EMPTY));
var _STAR_kw_map \x3d cljs.core.volatile_BANG_(cljs.core.transient$(cljs.core.PersistentArrayMap.EMPTY));
var write_kw \x3d (function (kw){
var idx \x3d (function (){var or__5045__auto__ \x3d cljs.core.get.cljs$core$IFn$_invoke$arity$2(cljs.core.deref(_STAR_kw_map),kw);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
var keywords \x3d _STAR_kws.cljs$core$IVolatile$_vreset_BANG_$arity$2(null,cljs.core.conj_BANG_.cljs$core$IFn$_invoke$arity$2(_STAR_kws.cljs$core$IDeref$_deref$arity$1(null),kw));
var idx \x3d (cljs.core.count(keywords) - (1));
_STAR_kw_map.cljs$core$IVolatile$_vreset_BANG_$arity$2(null,cljs.core.assoc_BANG_.cljs$core$IFn$_invoke$arity$3(_STAR_kw_map.cljs$core$IDeref$_deref$arity$1(null),kw,idx));

return idx;
}
})();
return [(0),idx];
});
var write_other \x3d (function (v){
return [(1),(freeze_fn.cljs$core$IFn$_invoke$arity$1 ? freeze_fn.cljs$core$IFn$_invoke$arity$1(v) : freeze_fn.call(null,v))];
});
var write_v \x3d (function (v){
if(typeof v \x3d\x3d\x3d \x27string\x27){
return v;
} else {
if(typeof v \x3d\x3d\x3d \x27number\x27){
if((Infinity \x3d\x3d\x3d v)){
return [(2)];
} else {
if((-Infinity \x3d\x3d\x3d v)){
return [(3)];
} else {
if(cljs.core.truth_(isNaN(v))){
return [(4)];
} else {
return v;

}
}
}
} else {
if(cljs.core.boolean_QMARK_(v)){
return v;
} else {
if((v instanceof cljs.core.Keyword)){
return write_kw(v);
} else {
return write_other(v);

}
}
}
}
});
var eavt \x3d datascript.serialize.amap_indexed((function (idx,d){
d.datascript$db$IDatom$datom_set_idx$arity$2(null,idx);

var e \x3d d.e;
var a \x3d (function (){var G__52301 \x3d d.a;
return (attrs_map.cljs$core$IFn$_invoke$arity$1 ? attrs_map.cljs$core$IFn$_invoke$arity$1(G__52301) : attrs_map.call(null,G__52301));
})();
var v \x3d write_v(d.v);
var tx \x3d (d.tx - (536870912));
return [e,a,v,tx];
}),new cljs.core.Keyword(null,\x22eavt\x22,\x22eavt\x22,-666437073).cljs$core$IFn$_invoke$arity$1(db));
var aevt \x3d datascript.serialize.amap_indexed((function (_,d){
return d.datascript$db$IDatom$datom_get_idx$arity$1(null);
}),new cljs.core.Keyword(null,\x22aevt\x22,\x22aevt\x22,-585148059).cljs$core$IFn$_invoke$arity$1(db));
var avet \x3d datascript.serialize.amap_indexed((function (_,d){
return d.datascript$db$IDatom$datom_get_idx$arity$1(null);
}),new cljs.core.Keyword(null,\x22avet\x22,\x22avet\x22,1383857032).cljs$core$IFn$_invoke$arity$1(db));
var schema \x3d (function (){var G__52303 \x3d new cljs.core.Keyword(null,\x22schema\x22,\x22schema\x22,-1582001791).cljs$core$IFn$_invoke$arity$1(db);
return (freeze_fn.cljs$core$IFn$_invoke$arity$1 ? freeze_fn.cljs$core$IFn$_invoke$arity$1(G__52303) : freeze_fn.call(null,G__52303));
})();
var attrs__$1 \x3d datascript.serialize.amap(freeze_kw,attrs);
var kws \x3d datascript.serialize.amap(freeze_kw,cljs.core.persistent_BANG_(cljs.core.deref(_STAR_kws)));
return {\x22count\x22:cljs.core.count(new cljs.core.Keyword(null,\x22eavt\x22,\x22eavt\x22,-666437073).cljs$core$IFn$_invoke$arity$1(db)),\x22tx0\x22:(536870912),\x22max-eid\x22:new cljs.core.Keyword(null,\x22max-eid\x22,\x22max-eid\x22,2134868075).cljs$core$IFn$_invoke$arity$1(db),\x22max-tx\x22:new cljs.core.Keyword(null,\x22max-tx\x22,\x22max-tx\x22,1119558339).cljs$core$IFn$_invoke$arity$1(db),\x22schema\x22:schema,\x22attrs\x22:attrs__$1,\x22keywords\x22:kws,\x22eavt\x22:eavt,\x22aevt\x22:aevt,\x22avet\x22:avet};
});
datascript.serialize.serializable \x3d (function datascript$serialize$serializable(var_args){
var G__52337 \x3d arguments.length;
switch (G__52337) {
case 1:
return datascript.serialize.serializable.cljs$core$IFn$_invoke$arity$1((arguments[(0)]));

break;
case 2:
return datascript.serialize.serializable.cljs$core$IFn$_invoke$arity$2((arguments[(0)]),(arguments[(1)]));

break;
default:
throw (new Error([\x22Invalid arity: \x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1(arguments.length)].join(\x27\x27)));

}
});

(datascript.serialize.serializable.cljs$core$IFn$_invoke$arity$1 \x3d (function (db){
return datascript.serialize.serializable_impl(db,cljs.core.PersistentArrayMap.EMPTY);
}));

(datascript.serialize.serializable.cljs$core$IFn$_invoke$arity$2 \x3d (function (db,opts){
return datascript.serialize.serializable_impl(db,opts);
}));

(datascript.serialize.serializable.cljs$lang$maxFixedArity \x3d 2);

datascript.serialize.from_serializable \x3d (function datascript$serialize$from_serializable(var_args){
var G__52382 \x3d arguments.length;
switch (G__52382) {
case 1:
return datascript.serialize.from_serializable.cljs$core$IFn$_invoke$arity$1((arguments[(0)]));

break;
case 2:
return datascript.serialize.from_serializable.cljs$core$IFn$_invoke$arity$2((arguments[(0)]),(arguments[(1)]));

break;
default:
throw (new Error([\x22Invalid arity: \x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1(arguments.length)].join(\x27\x27)));

}
});

(datascript.serialize.from_serializable.cljs$core$IFn$_invoke$arity$1 \x3d (function (from){
return datascript.serialize.from_serializable.cljs$core$IFn$_invoke$arity$2(from,cljs.core.PersistentArrayMap.EMPTY);
}));

(datascript.serialize.from_serializable.cljs$core$IFn$_invoke$arity$2 \x3d (function (from,p__52388){
var map__52390 \x3d p__52388;
var map__52390__$1 \x3d cljs.core.__destructure_map(map__52390);
var thaw_fn \x3d cljs.core.get.cljs$core$IFn$_invoke$arity$3(map__52390__$1,new cljs.core.Keyword(null,\x22thaw-fn\x22,\x22thaw-fn\x22,-240544261),clojure.edn.read_string);
var thaw_kw \x3d cljs.core.get.cljs$core$IFn$_invoke$arity$3(map__52390__$1,new cljs.core.Keyword(null,\x22thaw-kw\x22,\x22thaw-kw\x22,1076733097),datascript.serialize.thaw_kw);
var tx0 \x3d datascript.serialize.dict_get(from,\x22tx0\x22);
var schema \x3d (function (){var G__52393 \x3d datascript.serialize.dict_get(from,\x22schema\x22);
return (thaw_fn.cljs$core$IFn$_invoke$arity$1 ? thaw_fn.cljs$core$IFn$_invoke$arity$1(G__52393) : thaw_fn.call(null,G__52393));
})();
var _ \x3d (function (){var fexpr__52396 \x3d new cljs.core.Var(function(){return datascript.db.validate_schema;},new cljs.core.Symbol(\x22datascript.db\x22,\x22validate-schema\x22,\x22datascript.db/validate-schema\x22,-783030261,null),cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,\x22private\x22,\x22private\x22,-558947994),new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),new cljs.core.Keyword(null,\x22file\x22,\x22file\x22,-1269645878),new cljs.core.Keyword(null,\x22end-column\x22,\x22end-column\x22,1425389514),new cljs.core.Keyword(null,\x22column\x22,\x22column\x22,2078222095),new cljs.core.Keyword(null,\x22line\x22,\x22line\x22,212345235),new cljs.core.Keyword(null,\x22end-line\x22,\x22end-line\x22,1837326455),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22test\x22,\x22test\x22,577538877)],[true,new cljs.core.Symbol(null,\x22datascript.db\x22,\x22datascript.db\x22,-444456104,null),new cljs.core.Symbol(null,\x22validate-schema\x22,\x22validate-schema\x22,758884380,null),\x22datascript/db.cljc\x22,23,1,726,726,cljs.core.list(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22schema\x22,\x22schema\x22,58529736,null)], null)),null,(cljs.core.truth_(datascript.db.validate_schema)?datascript.db.validate_schema.cljs$lang$test:null)]));
return (fexpr__52396.cljs$core$IFn$_invoke$arity$1 ? fexpr__52396.cljs$core$IFn$_invoke$arity$1(schema) : fexpr__52396.call(null,schema));
})();
var attrs \x3d cljs.core.mapv.cljs$core$IFn$_invoke$arity$2(thaw_kw,datascript.serialize.dict_get(from,\x22attrs\x22));
var keywords \x3d cljs.core.mapv.cljs$core$IFn$_invoke$arity$2(thaw_kw,datascript.serialize.dict_get(from,\x22keywords\x22));
var eavt \x3d datascript.serialize.amap((function (arr){
var e \x3d datascript.serialize.array_get(arr,(0));
var a \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$2(attrs,datascript.serialize.array_get(arr,(1)));
var v \x3d datascript.serialize.array_get(arr,(2));
var v__$1 \x3d ((typeof v \x3d\x3d\x3d \x27number\x27)?v:((typeof v \x3d\x3d\x3d \x27string\x27)?v:((cljs.core.boolean_QMARK_(v))?v:((datascript.serialize.array_QMARK_(v))?(function (){var marker \x3d datascript.serialize.array_get(v,(0));
var pred__52405 \x3d cljs.core._EQ__EQ_;
var expr__52406 \x3d marker;
if(cljs.core.truth_((pred__52405.cljs$core$IFn$_invoke$arity$2 ? pred__52405.cljs$core$IFn$_invoke$arity$2((0),expr__52406) : pred__52405.call(null,(0),expr__52406)))){
return cljs.core.nth.cljs$core$IFn$_invoke$arity$2(keywords,datascript.serialize.array_get(v,(1)));
} else {
if(cljs.core.truth_((pred__52405.cljs$core$IFn$_invoke$arity$2 ? pred__52405.cljs$core$IFn$_invoke$arity$2((1),expr__52406) : pred__52405.call(null,(1),expr__52406)))){
var G__52408 \x3d datascript.serialize.array_get(v,(1));
return (thaw_fn.cljs$core$IFn$_invoke$arity$1 ? thaw_fn.cljs$core$IFn$_invoke$arity$1(G__52408) : thaw_fn.call(null,G__52408));
} else {
if(cljs.core.truth_((pred__52405.cljs$core$IFn$_invoke$arity$2 ? pred__52405.cljs$core$IFn$_invoke$arity$2((2),expr__52406) : pred__52405.call(null,(2),expr__52406)))){
return Infinity;
} else {
if(cljs.core.truth_((pred__52405.cljs$core$IFn$_invoke$arity$2 ? pred__52405.cljs$core$IFn$_invoke$arity$2((3),expr__52406) : pred__52405.call(null,(3),expr__52406)))){
return -Infinity;
} else {
if(cljs.core.truth_((pred__52405.cljs$core$IFn$_invoke$arity$2 ? pred__52405.cljs$core$IFn$_invoke$arity$2((4),expr__52406) : pred__52405.call(null,(4),expr__52406)))){
return NaN;
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22Unexpected value marker \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([marker], 0)),\x22 in \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([v], 0))], 0))].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(null,\x22serialize\x22,\x22serialize\x22,-69216574),new cljs.core.Keyword(null,\x22value\x22,\x22value\x22,305978217),v], null));
}
}
}
}
}
})():(function(){throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22Unexpected value type \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([cljs.core.type(v)], 0)),\x22 (\x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([v], 0))], 0)),\x22)\x22].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(null,\x22serialize\x22,\x22serialize\x22,-69216574),new cljs.core.Keyword(null,\x22value\x22,\x22value\x22,305978217),v], null))})()
))));
var tx \x3d (tx0 + datascript.serialize.array_get(arr,(3)));
return datascript.db.datom.cljs$core$IFn$_invoke$arity$4(e,a,v__$1,tx);
}),datascript.serialize.dict_get(from,\x22eavt\x22));
var aevt \x3d (function (){var G__52415 \x3d datascript.serialize.dict_get(from,\x22aevt\x22);
if((G__52415 \x3d\x3d null)){
return null;
} else {
return datascript.serialize.amap((function (p1__52377_SHARP_){
return (eavt[p1__52377_SHARP_]);
}),G__52415);
}
})();
var avet \x3d (function (){var G__52418 \x3d datascript.serialize.dict_get(from,\x22avet\x22);
if((G__52418 \x3d\x3d null)){
return null;
} else {
return datascript.serialize.amap((function (p1__52378_SHARP_){
return (eavt[p1__52378_SHARP_]);
}),G__52418);
}
})();
return datascript.db.map__GT_DB(cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,\x22schema\x22,\x22schema\x22,-1582001791),new cljs.core.Keyword(null,\x22max-tx\x22,\x22max-tx\x22,1119558339),new cljs.core.Keyword(null,\x22hash\x22,\x22hash\x22,-13781596),new cljs.core.Keyword(null,\x22aevt\x22,\x22aevt\x22,-585148059),new cljs.core.Keyword(null,\x22avet\x22,\x22avet\x22,1383857032),new cljs.core.Keyword(null,\x22max-eid\x22,\x22max-eid\x22,2134868075),new cljs.core.Keyword(null,\x22eavt\x22,\x22eavt\x22,-666437073),new cljs.core.Keyword(null,\x22pull-attrs\x22,\x22pull-attrs\x22,-974863177),new cljs.core.Keyword(null,\x22pull-patterns\x22,\x22pull-patterns\x22,-343695048),new cljs.core.Keyword(null,\x22rschema\x22,\x22rschema\x22,-1196134054)],[schema,datascript.serialize.dict_get(from,\x22max-tx\x22),cljs.core.atom.cljs$core$IFn$_invoke$arity$1((0)),me.tonsky.persistent_sorted_set.from_sorted_array(datascript.db.cmp_datoms_aevt,aevt),me.tonsky.persistent_sorted_set.from_sorted_array(datascript.db.cmp_datoms_avet,avet),datascript.serialize.dict_get(from,\x22max-eid\x22),me.tonsky.persistent_sorted_set.from_sorted_array(datascript.db.cmp_datoms_eavt,eavt),datascript.lru.cache((100)),datascript.lru.cache((100)),(function (){var G__52430 \x3d cljs.core.merge.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(\x22db\x22,\x22ident\x22,\x22db/ident\x22,-737096),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(\x22db\x22,\x22unique\x22,\x22db/unique\x22,329396388),new cljs.core.Keyword(\x22db.unique\x22,\x22identity\x22,\x22db.unique/identity\x22,1675950722)], null)], null),schema], 0));
var fexpr__52429 \x3d new cljs.core.Var(function(){return datascript.db.rschema;},new cljs.core.Symbol(\x22datascript.db\x22,\x22rschema\x22,\x22datascript.db/rschema\x22,1982085018,null),cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,\x22private\x22,\x22private\x22,-558947994),new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),new cljs.core.Keyword(null,\x22file\x22,\x22file\x22,-1269645878),new cljs.core.Keyword(null,\x22end-column\x22,\x22end-column\x22,1425389514),new cljs.core.Keyword(null,\x22column\x22,\x22column\x22,2078222095),new cljs.core.Keyword(null,\x22line\x22,\x22line\x22,212345235),new cljs.core.Keyword(null,\x22end-line\x22,\x22end-line\x22,1837326455),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22test\x22,\x22test\x22,577538877)],[true,new cljs.core.Symbol(null,\x22datascript.db\x22,\x22datascript.db\x22,-444456104,null),new cljs.core.Symbol(null,\x22rschema\x22,\x22rschema\x22,444397473,null),\x22datascript/db.cljc\x22,15,1,694,694,cljs.core.list(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22schema\x22,\x22schema\x22,58529736,null)], null)),\x22:db/unique           \x3d\x3e #{attr ...}\
   :db.unique/identity  \x3d\x3e #{attr ...}\
   :db.unique/value     \x3d\x3e #{attr ...}\
   :db/index            \x3d\x3e #{attr ...}\
   :db.cardinality/many \x3d\x3e #{attr ...}\
   :db.type/ref         \x3d\x3e #{attr ...}\
   :db/isComponent      \x3d\x3e #{attr ...}\
   :db.type/tuple       \x3d\x3e #{attr ...}\
   :db/attrTuples       \x3d\x3e {attr \x3d\x3e {tuple-attr \x3d\x3e idx}}\x22,(cljs.core.truth_(datascript.db.rschema)?datascript.db.rschema.cljs$lang$test:null)]));
return (fexpr__52429.cljs$core$IFn$_invoke$arity$1 ? fexpr__52429.cljs$core$IFn$_invoke$arity$1(G__52430) : fexpr__52429.call(null,G__52430));
})()]));
}));

(datascript.serialize.from_serializable.cljs$lang$maxFixedArity \x3d 2);

");
SHADOW_ENV.evalLoad("datascript.parser.js", true , "goog.provide(\x27datascript.parser\x27);




/**
 * @interface
 */
datascript.parser.ITraversable \x3d function(){};

var datascript$parser$ITraversable$_collect$dyn_54782 \x3d (function (_,pred,acc){
var x__5393__auto__ \x3d (((_ \x3d\x3d null))?null:_);
var m__5394__auto__ \x3d (datascript.parser._collect[goog.typeOf(x__5393__auto__)]);
if((!((m__5394__auto__ \x3d\x3d null)))){
return (m__5394__auto__.cljs$core$IFn$_invoke$arity$3 ? m__5394__auto__.cljs$core$IFn$_invoke$arity$3(_,pred,acc) : m__5394__auto__.call(null,_,pred,acc));
} else {
var m__5392__auto__ \x3d (datascript.parser._collect[\x22_\x22]);
if((!((m__5392__auto__ \x3d\x3d null)))){
return (m__5392__auto__.cljs$core$IFn$_invoke$arity$3 ? m__5392__auto__.cljs$core$IFn$_invoke$arity$3(_,pred,acc) : m__5392__auto__.call(null,_,pred,acc));
} else {
throw cljs.core.missing_protocol(\x22ITraversable.-collect\x22,_);
}
}
});
datascript.parser._collect \x3d (function datascript$parser$_collect(_,pred,acc){
if((((!((_ \x3d\x3d null)))) \x26\x26 ((!((_.datascript$parser$ITraversable$_collect$arity$3 \x3d\x3d null)))))){
return _.datascript$parser$ITraversable$_collect$arity$3(_,pred,acc);
} else {
return datascript$parser$ITraversable$_collect$dyn_54782(_,pred,acc);
}
});

var datascript$parser$ITraversable$_collect_vars$dyn_54788 \x3d (function (_,acc){
var x__5393__auto__ \x3d (((_ \x3d\x3d null))?null:_);
var m__5394__auto__ \x3d (datascript.parser._collect_vars[goog.typeOf(x__5393__auto__)]);
if((!((m__5394__auto__ \x3d\x3d null)))){
return (m__5394__auto__.cljs$core$IFn$_invoke$arity$2 ? m__5394__auto__.cljs$core$IFn$_invoke$arity$2(_,acc) : m__5394__auto__.call(null,_,acc));
} else {
var m__5392__auto__ \x3d (datascript.parser._collect_vars[\x22_\x22]);
if((!((m__5392__auto__ \x3d\x3d null)))){
return (m__5392__auto__.cljs$core$IFn$_invoke$arity$2 ? m__5392__auto__.cljs$core$IFn$_invoke$arity$2(_,acc) : m__5392__auto__.call(null,_,acc));
} else {
throw cljs.core.missing_protocol(\x22ITraversable.-collect-vars\x22,_);
}
}
});
datascript.parser._collect_vars \x3d (function datascript$parser$_collect_vars(_,acc){
if((((!((_ \x3d\x3d null)))) \x26\x26 ((!((_.datascript$parser$ITraversable$_collect_vars$arity$2 \x3d\x3d null)))))){
return _.datascript$parser$ITraversable$_collect_vars$arity$2(_,acc);
} else {
return datascript$parser$ITraversable$_collect_vars$dyn_54788(_,acc);
}
});

var datascript$parser$ITraversable$_postwalk$dyn_54789 \x3d (function (_,f){
var x__5393__auto__ \x3d (((_ \x3d\x3d null))?null:_);
var m__5394__auto__ \x3d (datascript.parser._postwalk[goog.typeOf(x__5393__auto__)]);
if((!((m__5394__auto__ \x3d\x3d null)))){
return (m__5394__auto__.cljs$core$IFn$_invoke$arity$2 ? m__5394__auto__.cljs$core$IFn$_invoke$arity$2(_,f) : m__5394__auto__.call(null,_,f));
} else {
var m__5392__auto__ \x3d (datascript.parser._postwalk[\x22_\x22]);
if((!((m__5392__auto__ \x3d\x3d null)))){
return (m__5392__auto__.cljs$core$IFn$_invoke$arity$2 ? m__5392__auto__.cljs$core$IFn$_invoke$arity$2(_,f) : m__5392__auto__.call(null,_,f));
} else {
throw cljs.core.missing_protocol(\x22ITraversable.-postwalk\x22,_);
}
}
});
datascript.parser._postwalk \x3d (function datascript$parser$_postwalk(_,f){
if((((!((_ \x3d\x3d null)))) \x26\x26 ((!((_.datascript$parser$ITraversable$_postwalk$arity$2 \x3d\x3d null)))))){
return _.datascript$parser$ITraversable$_postwalk$arity$2(_,f);
} else {
return datascript$parser$ITraversable$_postwalk$dyn_54789(_,f);
}
});

datascript.parser.of_size_QMARK_ \x3d (function datascript$parser$of_size_QMARK_(form,size){
return ((cljs.core.sequential_QMARK_(form)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(cljs.core.count(form),size)));
});
datascript.parser.parse_seq \x3d (function datascript$parser$parse_seq(parse_el,form){
if(cljs.core.sequential_QMARK_(form)){
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (p1__53754_SHARP_,p2__53753_SHARP_){
var temp__5802__auto__ \x3d (parse_el.cljs$core$IFn$_invoke$arity$1 ? parse_el.cljs$core$IFn$_invoke$arity$1(p2__53753_SHARP_) : parse_el.call(null,p2__53753_SHARP_));
if(cljs.core.truth_(temp__5802__auto__)){
var parsed \x3d temp__5802__auto__;
return cljs.core.conj.cljs$core$IFn$_invoke$arity$2(p1__53754_SHARP_,parsed);
} else {
return cljs.core.reduced(null);
}
}),cljs.core.PersistentVector.EMPTY,form);
} else {
return null;
}
});
datascript.parser.collect \x3d (function datascript$parser$collect(var_args){
var G__53757 \x3d arguments.length;
switch (G__53757) {
case 2:
return datascript.parser.collect.cljs$core$IFn$_invoke$arity$2((arguments[(0)]),(arguments[(1)]));

break;
case 3:
return datascript.parser.collect.cljs$core$IFn$_invoke$arity$3((arguments[(0)]),(arguments[(1)]),(arguments[(2)]));

break;
default:
throw (new Error([\x22Invalid arity: \x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1(arguments.length)].join(\x27\x27)));

}
});

(datascript.parser.collect.cljs$core$IFn$_invoke$arity$2 \x3d (function (pred,form){
return datascript.parser.collect.cljs$core$IFn$_invoke$arity$3(pred,form,cljs.core.PersistentVector.EMPTY);
}));

(datascript.parser.collect.cljs$core$IFn$_invoke$arity$3 \x3d (function (pred,form,acc){
if(cljs.core.truth_((pred.cljs$core$IFn$_invoke$arity$1 ? pred.cljs$core$IFn$_invoke$arity$1(form) : pred.call(null,form)))){
return cljs.core.conj.cljs$core$IFn$_invoke$arity$2(acc,form);
} else {
if((((!((form \x3d\x3d null))))?((((false) || ((cljs.core.PROTOCOL_SENTINEL \x3d\x3d\x3d form.datascript$parser$ITraversable$))))?true:(((!form.cljs$lang$protocol_mask$partition$))?cljs.core.native_satisfies_QMARK_(datascript.parser.ITraversable,form):false)):cljs.core.native_satisfies_QMARK_(datascript.parser.ITraversable,form))){
return datascript.parser._collect(form,pred,acc);
} else {
if(datascript.db.seqable_QMARK_(form)){
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (acc__$1,form__$1){
return datascript.parser.collect.cljs$core$IFn$_invoke$arity$3(pred,form__$1,acc__$1);
}),acc,form);
} else {
return acc;

}
}
}
}));

(datascript.parser.collect.cljs$lang$maxFixedArity \x3d 3);

datascript.parser.distinct_QMARK_ \x3d (function datascript$parser$distinct_QMARK_(coll){
var or__5045__auto__ \x3d cljs.core.empty_QMARK_(coll);
if(or__5045__auto__){
return or__5045__auto__;
} else {
return cljs.core.apply.cljs$core$IFn$_invoke$arity$2(cljs.core.distinct_QMARK_,coll);
}
});
datascript.parser.postwalk \x3d (function datascript$parser$postwalk(form,f){
if((((!((form \x3d\x3d null))))?((((false) || ((cljs.core.PROTOCOL_SENTINEL \x3d\x3d\x3d form.datascript$parser$ITraversable$))))?true:(((!form.cljs$lang$protocol_mask$partition$))?cljs.core.native_satisfies_QMARK_(datascript.parser.ITraversable,form):false)):cljs.core.native_satisfies_QMARK_(datascript.parser.ITraversable,form))){
var G__53768 \x3d datascript.parser._postwalk(form,f);
return (f.cljs$core$IFn$_invoke$arity$1 ? f.cljs$core$IFn$_invoke$arity$1(G__53768) : f.call(null,G__53768));
} else {
if(cljs.core.map_QMARK_(form)){
var G__53769 \x3d cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (form__$1,p__53770){
var vec__53771 \x3d p__53770;
var k \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__53771,(0),null);
var v \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__53771,(1),null);
return cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(form__$1,k,(datascript.parser.postwalk.cljs$core$IFn$_invoke$arity$2 ? datascript.parser.postwalk.cljs$core$IFn$_invoke$arity$2(v,f) : datascript.parser.postwalk.call(null,v,f)));
}),form,form);
return (f.cljs$core$IFn$_invoke$arity$1 ? f.cljs$core$IFn$_invoke$arity$1(G__53769) : f.call(null,G__53769));
} else {
if(cljs.core.seq_QMARK_(form)){
var G__53774 \x3d cljs.core.map.cljs$core$IFn$_invoke$arity$2((function (p1__53760_SHARP_){
return (datascript.parser.postwalk.cljs$core$IFn$_invoke$arity$2 ? datascript.parser.postwalk.cljs$core$IFn$_invoke$arity$2(p1__53760_SHARP_,f) : datascript.parser.postwalk.call(null,p1__53760_SHARP_,f));
}),form);
return (f.cljs$core$IFn$_invoke$arity$1 ? f.cljs$core$IFn$_invoke$arity$1(G__53774) : f.call(null,G__53774));
} else {
if(cljs.core.coll_QMARK_(form)){
var G__53775 \x3d cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.empty(form),cljs.core.map.cljs$core$IFn$_invoke$arity$2((function (p1__53761_SHARP_){
return (datascript.parser.postwalk.cljs$core$IFn$_invoke$arity$2 ? datascript.parser.postwalk.cljs$core$IFn$_invoke$arity$2(p1__53761_SHARP_,f) : datascript.parser.postwalk.call(null,p1__53761_SHARP_,f));
}),form));
return (f.cljs$core$IFn$_invoke$arity$1 ? f.cljs$core$IFn$_invoke$arity$1(G__53775) : f.call(null,G__53775));
} else {
return (f.cljs$core$IFn$_invoke$arity$1 ? f.cljs$core$IFn$_invoke$arity$1(form) : f.call(null,form));

}
}
}
}
});
datascript.parser.with_source \x3d (function datascript$parser$with_source(obj,source){
return cljs.core.with_meta(obj,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,\x22source\x22,\x22source\x22,-433931539),source], null));
});
datascript.parser.source \x3d (function datascript$parser$source(obj){
var or__5045__auto__ \x3d new cljs.core.Keyword(null,\x22source\x22,\x22source\x22,-433931539).cljs$core$IFn$_invoke$arity$1(cljs.core.meta(obj));
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return obj;
}
});

/**
* @constructor
 * @implements {cljs.core.IRecord}
 * @implements {cljs.core.IKVReduce}
 * @implements {cljs.core.IEquiv}
 * @implements {cljs.core.IHash}
 * @implements {cljs.core.ICollection}
 * @implements {cljs.core.ICounted}
 * @implements {cljs.core.ISeqable}
 * @implements {cljs.core.IMeta}
 * @implements {cljs.core.ICloneable}
 * @implements {cljs.core.IPrintWithWriter}
 * @implements {cljs.core.IIterable}
 * @implements {datascript.parser.ITraversable}
 * @implements {cljs.core.IWithMeta}
 * @implements {cljs.core.IAssociative}
 * @implements {cljs.core.IMap}
 * @implements {cljs.core.ILookup}
*/
datascript.parser.Placeholder \x3d (function (__meta,__extmap,__hash){
this.__meta \x3d __meta;
this.__extmap \x3d __extmap;
this.__hash \x3d __hash;
this.cljs$lang$protocol_mask$partition0$ \x3d 2230716170;
this.cljs$lang$protocol_mask$partition1$ \x3d 139264;
});
(datascript.parser.Placeholder.prototype.cljs$core$ILookup$_lookup$arity$2 \x3d (function (this__5343__auto__,k__5344__auto__){
var self__ \x3d this;
var this__5343__auto____$1 \x3d this;
return this__5343__auto____$1.cljs$core$ILookup$_lookup$arity$3(null,k__5344__auto__,null);
}));

(datascript.parser.Placeholder.prototype.cljs$core$ILookup$_lookup$arity$3 \x3d (function (this__5345__auto__,k53780,else__5346__auto__){
var self__ \x3d this;
var this__5345__auto____$1 \x3d this;
var G__53789 \x3d k53780;
switch (G__53789) {
default:
return cljs.core.get.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k53780,else__5346__auto__);

}
}));

(datascript.parser.Placeholder.prototype.cljs$core$IKVReduce$_kv_reduce$arity$3 \x3d (function (this__5363__auto__,f__5364__auto__,init__5365__auto__){
var self__ \x3d this;
var this__5363__auto____$1 \x3d this;
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (ret__5366__auto__,p__53790){
var vec__53791 \x3d p__53790;
var k__5367__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__53791,(0),null);
var v__5368__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__53791,(1),null);
return (f__5364__auto__.cljs$core$IFn$_invoke$arity$3 ? f__5364__auto__.cljs$core$IFn$_invoke$arity$3(ret__5366__auto__,k__5367__auto__,v__5368__auto__) : f__5364__auto__.call(null,ret__5366__auto__,k__5367__auto__,v__5368__auto__));
}),init__5365__auto__,this__5363__auto____$1);
}));

(datascript.parser.Placeholder.prototype.cljs$core$IPrintWithWriter$_pr_writer$arity$3 \x3d (function (this__5358__auto__,writer__5359__auto__,opts__5360__auto__){
var self__ \x3d this;
var this__5358__auto____$1 \x3d this;
var pr_pair__5361__auto__ \x3d (function (keyval__5362__auto__){
return cljs.core.pr_sequential_writer(writer__5359__auto__,cljs.core.pr_writer,\x22\x22,\x22 \x22,\x22\x22,opts__5360__auto__,keyval__5362__auto__);
});
return cljs.core.pr_sequential_writer(writer__5359__auto__,pr_pair__5361__auto__,\x22#datascript.parser.Placeholder{\x22,\x22, \x22,\x22}\x22,opts__5360__auto__,cljs.core.concat.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentVector.EMPTY,self__.__extmap));
}));

(datascript.parser.Placeholder.prototype.cljs$core$IIterable$_iterator$arity$1 \x3d (function (G__53779){
var self__ \x3d this;
var G__53779__$1 \x3d this;
return (new cljs.core.RecordIter((0),G__53779__$1,0,cljs.core.PersistentVector.EMPTY,(cljs.core.truth_(self__.__extmap)?cljs.core._iterator(self__.__extmap):cljs.core.nil_iter())));
}));

(datascript.parser.Placeholder.prototype.cljs$core$IMeta$_meta$arity$1 \x3d (function (this__5341__auto__){
var self__ \x3d this;
var this__5341__auto____$1 \x3d this;
return self__.__meta;
}));

(datascript.parser.Placeholder.prototype.cljs$core$ICloneable$_clone$arity$1 \x3d (function (this__5338__auto__){
var self__ \x3d this;
var this__5338__auto____$1 \x3d this;
return (new datascript.parser.Placeholder(self__.__meta,self__.__extmap,self__.__hash));
}));

(datascript.parser.Placeholder.prototype.cljs$core$ICounted$_count$arity$1 \x3d (function (this__5347__auto__){
var self__ \x3d this;
var this__5347__auto____$1 \x3d this;
return (0 + cljs.core.count(self__.__extmap));
}));

(datascript.parser.Placeholder.prototype.cljs$core$IHash$_hash$arity$1 \x3d (function (this__5339__auto__){
var self__ \x3d this;
var this__5339__auto____$1 \x3d this;
var h__5154__auto__ \x3d self__.__hash;
if((!((h__5154__auto__ \x3d\x3d null)))){
return h__5154__auto__;
} else {
var h__5154__auto____$1 \x3d (function (coll__5340__auto__){
return (-528488587 ^ cljs.core.hash_unordered_coll(coll__5340__auto__));
})(this__5339__auto____$1);
(self__.__hash \x3d h__5154__auto____$1);

return h__5154__auto____$1;
}
}));

(datascript.parser.Placeholder.prototype.cljs$core$IEquiv$_equiv$arity$2 \x3d (function (this53781,other53782){
var self__ \x3d this;
var this53781__$1 \x3d this;
return (((!((other53782 \x3d\x3d null)))) \x26\x26 ((((this53781__$1.constructor \x3d\x3d\x3d other53782.constructor)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this53781__$1.__extmap,other53782.__extmap)))));
}));

(datascript.parser.Placeholder.prototype.cljs$core$IMap$_dissoc$arity$2 \x3d (function (this__5353__auto__,k__5354__auto__){
var self__ \x3d this;
var this__5353__auto____$1 \x3d this;
if(cljs.core.contains_QMARK_(cljs.core.PersistentHashSet.EMPTY,k__5354__auto__)){
return cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(cljs.core._with_meta(cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,this__5353__auto____$1),self__.__meta),k__5354__auto__);
} else {
return (new datascript.parser.Placeholder(self__.__meta,cljs.core.not_empty(cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(self__.__extmap,k__5354__auto__)),null));
}
}));

(datascript.parser.Placeholder.prototype.cljs$core$IAssociative$_contains_key_QMARK_$arity$2 \x3d (function (this__5350__auto__,k53780){
var self__ \x3d this;
var this__5350__auto____$1 \x3d this;
return cljs.core.contains_QMARK_(self__.__extmap,k53780);
}));

(datascript.parser.Placeholder.prototype.cljs$core$IAssociative$_assoc$arity$3 \x3d (function (this__5351__auto__,k__5352__auto__,G__53779){
var self__ \x3d this;
var this__5351__auto____$1 \x3d this;
var pred__53804 \x3d cljs.core.keyword_identical_QMARK_;
var expr__53805 \x3d k__5352__auto__;
return (new datascript.parser.Placeholder(self__.__meta,cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k__5352__auto__,G__53779),null));
}));

(datascript.parser.Placeholder.prototype.cljs$core$ISeqable$_seq$arity$1 \x3d (function (this__5356__auto__){
var self__ \x3d this;
var this__5356__auto____$1 \x3d this;
return cljs.core.seq(cljs.core.concat.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentVector.EMPTY,self__.__extmap));
}));

(datascript.parser.Placeholder.prototype.cljs$core$IWithMeta$_with_meta$arity$2 \x3d (function (this__5342__auto__,G__53779){
var self__ \x3d this;
var this__5342__auto____$1 \x3d this;
return (new datascript.parser.Placeholder(G__53779,self__.__extmap,self__.__hash));
}));

(datascript.parser.Placeholder.prototype.cljs$core$ICollection$_conj$arity$2 \x3d (function (this__5348__auto__,entry__5349__auto__){
var self__ \x3d this;
var this__5348__auto____$1 \x3d this;
if(cljs.core.vector_QMARK_(entry__5349__auto__)){
return this__5348__auto____$1.cljs$core$IAssociative$_assoc$arity$3(null,cljs.core._nth(entry__5349__auto__,(0)),cljs.core._nth(entry__5349__auto__,(1)));
} else {
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(cljs.core._conj,this__5348__auto____$1,entry__5349__auto__);
}
}));

(datascript.parser.Placeholder.prototype.datascript$parser$ITraversable$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.parser.Placeholder.prototype.datascript$parser$ITraversable$_postwalk$arity$2 \x3d (function (this__52373__auto__,f53776){
var self__ \x3d this;
var this__52373__auto____$1 \x3d this;
var new__52374__auto__ \x3d (new datascript.parser.Placeholder(null,null,null));
var temp__5802__auto__ \x3d cljs.core.meta(this__52373__auto____$1);
if(cljs.core.truth_(temp__5802__auto__)){
var meta__52375__auto__ \x3d temp__5802__auto__;
return cljs.core.with_meta(new__52374__auto__,meta__52375__auto__);
} else {
return new__52374__auto__;
}
}));

(datascript.parser.Placeholder.prototype.datascript$parser$ITraversable$_collect$arity$3 \x3d (function (___52376__auto__,pred53777,acc53778){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
return acc53778;
}));

(datascript.parser.Placeholder.prototype.datascript$parser$ITraversable$_collect_vars$arity$2 \x3d (function (___52376__auto__,acc53778){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
return acc53778;
}));

(datascript.parser.Placeholder.getBasis \x3d (function (){
return cljs.core.PersistentVector.EMPTY;
}));

(datascript.parser.Placeholder.cljs$lang$type \x3d true);

(datascript.parser.Placeholder.cljs$lang$ctorPrSeq \x3d (function (this__5389__auto__){
return (new cljs.core.List(null,\x22datascript.parser/Placeholder\x22,null,(1),null));
}));

(datascript.parser.Placeholder.cljs$lang$ctorPrWriter \x3d (function (this__5389__auto__,writer__5390__auto__){
return cljs.core._write(writer__5390__auto__,\x22datascript.parser/Placeholder\x22);
}));

/**
 * Positional factory function for datascript.parser/Placeholder.
 */
datascript.parser.__GT_Placeholder \x3d (function datascript$parser$__GT_Placeholder(){
return (new datascript.parser.Placeholder(null,null,null));
});

/**
 * Factory function for datascript.parser/Placeholder, taking a map of keywords to field values.
 */
datascript.parser.map__GT_Placeholder \x3d (function datascript$parser$map__GT_Placeholder(G__53788){
var extmap__5385__auto__ \x3d (function (){var G__53807 \x3d cljs.core.dissoc.cljs$core$IFn$_invoke$arity$1(G__53788);
if(cljs.core.record_QMARK_(G__53788)){
return cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,G__53807);
} else {
return G__53807;
}
})();
return (new datascript.parser.Placeholder(null,cljs.core.not_empty(extmap__5385__auto__),null));
});


/**
* @constructor
 * @implements {cljs.core.IRecord}
 * @implements {cljs.core.IKVReduce}
 * @implements {cljs.core.IEquiv}
 * @implements {cljs.core.IHash}
 * @implements {cljs.core.ICollection}
 * @implements {cljs.core.ICounted}
 * @implements {cljs.core.ISeqable}
 * @implements {cljs.core.IMeta}
 * @implements {cljs.core.ICloneable}
 * @implements {cljs.core.IPrintWithWriter}
 * @implements {cljs.core.IIterable}
 * @implements {datascript.parser.ITraversable}
 * @implements {cljs.core.IWithMeta}
 * @implements {cljs.core.IAssociative}
 * @implements {cljs.core.IMap}
 * @implements {cljs.core.ILookup}
*/
datascript.parser.Variable \x3d (function (symbol,__meta,__extmap,__hash){
this.symbol \x3d symbol;
this.__meta \x3d __meta;
this.__extmap \x3d __extmap;
this.__hash \x3d __hash;
this.cljs$lang$protocol_mask$partition0$ \x3d 2230716170;
this.cljs$lang$protocol_mask$partition1$ \x3d 139264;
});
(datascript.parser.Variable.prototype.cljs$core$ILookup$_lookup$arity$2 \x3d (function (this__5343__auto__,k__5344__auto__){
var self__ \x3d this;
var this__5343__auto____$1 \x3d this;
return this__5343__auto____$1.cljs$core$ILookup$_lookup$arity$3(null,k__5344__auto__,null);
}));

(datascript.parser.Variable.prototype.cljs$core$ILookup$_lookup$arity$3 \x3d (function (this__5345__auto__,k53812,else__5346__auto__){
var self__ \x3d this;
var this__5345__auto____$1 \x3d this;
var G__53817 \x3d k53812;
var G__53817__$1 \x3d (((G__53817 instanceof cljs.core.Keyword))?G__53817.fqn:null);
switch (G__53817__$1) {
case \x22symbol\x22:
return self__.symbol;

break;
default:
return cljs.core.get.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k53812,else__5346__auto__);

}
}));

(datascript.parser.Variable.prototype.cljs$core$IKVReduce$_kv_reduce$arity$3 \x3d (function (this__5363__auto__,f__5364__auto__,init__5365__auto__){
var self__ \x3d this;
var this__5363__auto____$1 \x3d this;
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (ret__5366__auto__,p__53822){
var vec__53823 \x3d p__53822;
var k__5367__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__53823,(0),null);
var v__5368__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__53823,(1),null);
return (f__5364__auto__.cljs$core$IFn$_invoke$arity$3 ? f__5364__auto__.cljs$core$IFn$_invoke$arity$3(ret__5366__auto__,k__5367__auto__,v__5368__auto__) : f__5364__auto__.call(null,ret__5366__auto__,k__5367__auto__,v__5368__auto__));
}),init__5365__auto__,this__5363__auto____$1);
}));

(datascript.parser.Variable.prototype.cljs$core$IPrintWithWriter$_pr_writer$arity$3 \x3d (function (this__5358__auto__,writer__5359__auto__,opts__5360__auto__){
var self__ \x3d this;
var this__5358__auto____$1 \x3d this;
var pr_pair__5361__auto__ \x3d (function (keyval__5362__auto__){
return cljs.core.pr_sequential_writer(writer__5359__auto__,cljs.core.pr_writer,\x22\x22,\x22 \x22,\x22\x22,opts__5360__auto__,keyval__5362__auto__);
});
return cljs.core.pr_sequential_writer(writer__5359__auto__,pr_pair__5361__auto__,\x22#datascript.parser.Variable{\x22,\x22, \x22,\x22}\x22,opts__5360__auto__,cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22symbol\x22,\x22symbol\x22,-1038572696),self__.symbol],null))], null),self__.__extmap));
}));

(datascript.parser.Variable.prototype.cljs$core$IIterable$_iterator$arity$1 \x3d (function (G__53811){
var self__ \x3d this;
var G__53811__$1 \x3d this;
return (new cljs.core.RecordIter((0),G__53811__$1,1,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22symbol\x22,\x22symbol\x22,-1038572696)], null),(cljs.core.truth_(self__.__extmap)?cljs.core._iterator(self__.__extmap):cljs.core.nil_iter())));
}));

(datascript.parser.Variable.prototype.cljs$core$IMeta$_meta$arity$1 \x3d (function (this__5341__auto__){
var self__ \x3d this;
var this__5341__auto____$1 \x3d this;
return self__.__meta;
}));

(datascript.parser.Variable.prototype.cljs$core$ICloneable$_clone$arity$1 \x3d (function (this__5338__auto__){
var self__ \x3d this;
var this__5338__auto____$1 \x3d this;
return (new datascript.parser.Variable(self__.symbol,self__.__meta,self__.__extmap,self__.__hash));
}));

(datascript.parser.Variable.prototype.cljs$core$ICounted$_count$arity$1 \x3d (function (this__5347__auto__){
var self__ \x3d this;
var this__5347__auto____$1 \x3d this;
return (1 + cljs.core.count(self__.__extmap));
}));

(datascript.parser.Variable.prototype.cljs$core$IHash$_hash$arity$1 \x3d (function (this__5339__auto__){
var self__ \x3d this;
var this__5339__auto____$1 \x3d this;
var h__5154__auto__ \x3d self__.__hash;
if((!((h__5154__auto__ \x3d\x3d null)))){
return h__5154__auto__;
} else {
var h__5154__auto____$1 \x3d (function (coll__5340__auto__){
return (736891289 ^ cljs.core.hash_unordered_coll(coll__5340__auto__));
})(this__5339__auto____$1);
(self__.__hash \x3d h__5154__auto____$1);

return h__5154__auto____$1;
}
}));

(datascript.parser.Variable.prototype.cljs$core$IEquiv$_equiv$arity$2 \x3d (function (this53813,other53814){
var self__ \x3d this;
var this53813__$1 \x3d this;
return (((!((other53814 \x3d\x3d null)))) \x26\x26 ((((this53813__$1.constructor \x3d\x3d\x3d other53814.constructor)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this53813__$1.symbol,other53814.symbol)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this53813__$1.__extmap,other53814.__extmap)))))));
}));

(datascript.parser.Variable.prototype.cljs$core$IMap$_dissoc$arity$2 \x3d (function (this__5353__auto__,k__5354__auto__){
var self__ \x3d this;
var this__5353__auto____$1 \x3d this;
if(cljs.core.contains_QMARK_(new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,\x22symbol\x22,\x22symbol\x22,-1038572696),null], null), null),k__5354__auto__)){
return cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(cljs.core._with_meta(cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,this__5353__auto____$1),self__.__meta),k__5354__auto__);
} else {
return (new datascript.parser.Variable(self__.symbol,self__.__meta,cljs.core.not_empty(cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(self__.__extmap,k__5354__auto__)),null));
}
}));

(datascript.parser.Variable.prototype.cljs$core$IAssociative$_contains_key_QMARK_$arity$2 \x3d (function (this__5350__auto__,k53812){
var self__ \x3d this;
var this__5350__auto____$1 \x3d this;
var G__53828 \x3d k53812;
var G__53828__$1 \x3d (((G__53828 instanceof cljs.core.Keyword))?G__53828.fqn:null);
switch (G__53828__$1) {
case \x22symbol\x22:
return true;

break;
default:
return cljs.core.contains_QMARK_(self__.__extmap,k53812);

}
}));

(datascript.parser.Variable.prototype.cljs$core$IAssociative$_assoc$arity$3 \x3d (function (this__5351__auto__,k__5352__auto__,G__53811){
var self__ \x3d this;
var this__5351__auto____$1 \x3d this;
var pred__53829 \x3d cljs.core.keyword_identical_QMARK_;
var expr__53830 \x3d k__5352__auto__;
if(cljs.core.truth_((pred__53829.cljs$core$IFn$_invoke$arity$2 ? pred__53829.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22symbol\x22,\x22symbol\x22,-1038572696),expr__53830) : pred__53829.call(null,new cljs.core.Keyword(null,\x22symbol\x22,\x22symbol\x22,-1038572696),expr__53830)))){
return (new datascript.parser.Variable(G__53811,self__.__meta,self__.__extmap,null));
} else {
return (new datascript.parser.Variable(self__.symbol,self__.__meta,cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k__5352__auto__,G__53811),null));
}
}));

(datascript.parser.Variable.prototype.cljs$core$ISeqable$_seq$arity$1 \x3d (function (this__5356__auto__){
var self__ \x3d this;
var this__5356__auto____$1 \x3d this;
return cljs.core.seq(cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22symbol\x22,\x22symbol\x22,-1038572696),self__.symbol,null))], null),self__.__extmap));
}));

(datascript.parser.Variable.prototype.cljs$core$IWithMeta$_with_meta$arity$2 \x3d (function (this__5342__auto__,G__53811){
var self__ \x3d this;
var this__5342__auto____$1 \x3d this;
return (new datascript.parser.Variable(self__.symbol,G__53811,self__.__extmap,self__.__hash));
}));

(datascript.parser.Variable.prototype.cljs$core$ICollection$_conj$arity$2 \x3d (function (this__5348__auto__,entry__5349__auto__){
var self__ \x3d this;
var this__5348__auto____$1 \x3d this;
if(cljs.core.vector_QMARK_(entry__5349__auto__)){
return this__5348__auto____$1.cljs$core$IAssociative$_assoc$arity$3(null,cljs.core._nth(entry__5349__auto__,(0)),cljs.core._nth(entry__5349__auto__,(1)));
} else {
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(cljs.core._conj,this__5348__auto____$1,entry__5349__auto__);
}
}));

(datascript.parser.Variable.prototype.datascript$parser$ITraversable$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.parser.Variable.prototype.datascript$parser$ITraversable$_postwalk$arity$2 \x3d (function (this__52373__auto__,f53808){
var self__ \x3d this;
var this__52373__auto____$1 \x3d this;
var new__52374__auto__ \x3d (new datascript.parser.Variable(datascript.parser.postwalk(self__.symbol,f53808),null,null,null));
var temp__5802__auto__ \x3d cljs.core.meta(this__52373__auto____$1);
if(cljs.core.truth_(temp__5802__auto__)){
var meta__52375__auto__ \x3d temp__5802__auto__;
return cljs.core.with_meta(new__52374__auto__,meta__52375__auto__);
} else {
return new__52374__auto__;
}
}));

(datascript.parser.Variable.prototype.datascript$parser$ITraversable$_collect$arity$3 \x3d (function (___52376__auto__,pred53809,acc53810){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
return datascript.parser.collect.cljs$core$IFn$_invoke$arity$3(pred53809,self__.symbol,acc53810);
}));

(datascript.parser.Variable.prototype.datascript$parser$ITraversable$_collect_vars$arity$2 \x3d (function (___52376__auto__,acc53810){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
return (datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2 ? datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2(acc53810,self__.symbol) : datascript.parser.collect_vars_acc.call(null,acc53810,self__.symbol));
}));

(datascript.parser.Variable.getBasis \x3d (function (){
return new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22symbol\x22,\x22symbol\x22,601958831,null)], null);
}));

(datascript.parser.Variable.cljs$lang$type \x3d true);

(datascript.parser.Variable.cljs$lang$ctorPrSeq \x3d (function (this__5389__auto__){
return (new cljs.core.List(null,\x22datascript.parser/Variable\x22,null,(1),null));
}));

(datascript.parser.Variable.cljs$lang$ctorPrWriter \x3d (function (this__5389__auto__,writer__5390__auto__){
return cljs.core._write(writer__5390__auto__,\x22datascript.parser/Variable\x22);
}));

/**
 * Positional factory function for datascript.parser/Variable.
 */
datascript.parser.__GT_Variable \x3d (function datascript$parser$__GT_Variable(symbol){
return (new datascript.parser.Variable(symbol,null,null,null));
});

/**
 * Factory function for datascript.parser/Variable, taking a map of keywords to field values.
 */
datascript.parser.map__GT_Variable \x3d (function datascript$parser$map__GT_Variable(G__53815){
var extmap__5385__auto__ \x3d (function (){var G__53836 \x3d cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(G__53815,new cljs.core.Keyword(null,\x22symbol\x22,\x22symbol\x22,-1038572696));
if(cljs.core.record_QMARK_(G__53815)){
return cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,G__53836);
} else {
return G__53836;
}
})();
return (new datascript.parser.Variable(new cljs.core.Keyword(null,\x22symbol\x22,\x22symbol\x22,-1038572696).cljs$core$IFn$_invoke$arity$1(G__53815),null,cljs.core.not_empty(extmap__5385__auto__),null));
});


/**
* @constructor
 * @implements {cljs.core.IRecord}
 * @implements {cljs.core.IKVReduce}
 * @implements {cljs.core.IEquiv}
 * @implements {cljs.core.IHash}
 * @implements {cljs.core.ICollection}
 * @implements {cljs.core.ICounted}
 * @implements {cljs.core.ISeqable}
 * @implements {cljs.core.IMeta}
 * @implements {cljs.core.ICloneable}
 * @implements {cljs.core.IPrintWithWriter}
 * @implements {cljs.core.IIterable}
 * @implements {datascript.parser.ITraversable}
 * @implements {cljs.core.IWithMeta}
 * @implements {cljs.core.IAssociative}
 * @implements {cljs.core.IMap}
 * @implements {cljs.core.ILookup}
*/
datascript.parser.SrcVar \x3d (function (symbol,__meta,__extmap,__hash){
this.symbol \x3d symbol;
this.__meta \x3d __meta;
this.__extmap \x3d __extmap;
this.__hash \x3d __hash;
this.cljs$lang$protocol_mask$partition0$ \x3d 2230716170;
this.cljs$lang$protocol_mask$partition1$ \x3d 139264;
});
(datascript.parser.SrcVar.prototype.cljs$core$ILookup$_lookup$arity$2 \x3d (function (this__5343__auto__,k__5344__auto__){
var self__ \x3d this;
var this__5343__auto____$1 \x3d this;
return this__5343__auto____$1.cljs$core$ILookup$_lookup$arity$3(null,k__5344__auto__,null);
}));

(datascript.parser.SrcVar.prototype.cljs$core$ILookup$_lookup$arity$3 \x3d (function (this__5345__auto__,k53841,else__5346__auto__){
var self__ \x3d this;
var this__5345__auto____$1 \x3d this;
var G__53845 \x3d k53841;
var G__53845__$1 \x3d (((G__53845 instanceof cljs.core.Keyword))?G__53845.fqn:null);
switch (G__53845__$1) {
case \x22symbol\x22:
return self__.symbol;

break;
default:
return cljs.core.get.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k53841,else__5346__auto__);

}
}));

(datascript.parser.SrcVar.prototype.cljs$core$IKVReduce$_kv_reduce$arity$3 \x3d (function (this__5363__auto__,f__5364__auto__,init__5365__auto__){
var self__ \x3d this;
var this__5363__auto____$1 \x3d this;
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (ret__5366__auto__,p__53854){
var vec__53855 \x3d p__53854;
var k__5367__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__53855,(0),null);
var v__5368__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__53855,(1),null);
return (f__5364__auto__.cljs$core$IFn$_invoke$arity$3 ? f__5364__auto__.cljs$core$IFn$_invoke$arity$3(ret__5366__auto__,k__5367__auto__,v__5368__auto__) : f__5364__auto__.call(null,ret__5366__auto__,k__5367__auto__,v__5368__auto__));
}),init__5365__auto__,this__5363__auto____$1);
}));

(datascript.parser.SrcVar.prototype.cljs$core$IPrintWithWriter$_pr_writer$arity$3 \x3d (function (this__5358__auto__,writer__5359__auto__,opts__5360__auto__){
var self__ \x3d this;
var this__5358__auto____$1 \x3d this;
var pr_pair__5361__auto__ \x3d (function (keyval__5362__auto__){
return cljs.core.pr_sequential_writer(writer__5359__auto__,cljs.core.pr_writer,\x22\x22,\x22 \x22,\x22\x22,opts__5360__auto__,keyval__5362__auto__);
});
return cljs.core.pr_sequential_writer(writer__5359__auto__,pr_pair__5361__auto__,\x22#datascript.parser.SrcVar{\x22,\x22, \x22,\x22}\x22,opts__5360__auto__,cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22symbol\x22,\x22symbol\x22,-1038572696),self__.symbol],null))], null),self__.__extmap));
}));

(datascript.parser.SrcVar.prototype.cljs$core$IIterable$_iterator$arity$1 \x3d (function (G__53840){
var self__ \x3d this;
var G__53840__$1 \x3d this;
return (new cljs.core.RecordIter((0),G__53840__$1,1,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22symbol\x22,\x22symbol\x22,-1038572696)], null),(cljs.core.truth_(self__.__extmap)?cljs.core._iterator(self__.__extmap):cljs.core.nil_iter())));
}));

(datascript.parser.SrcVar.prototype.cljs$core$IMeta$_meta$arity$1 \x3d (function (this__5341__auto__){
var self__ \x3d this;
var this__5341__auto____$1 \x3d this;
return self__.__meta;
}));

(datascript.parser.SrcVar.prototype.cljs$core$ICloneable$_clone$arity$1 \x3d (function (this__5338__auto__){
var self__ \x3d this;
var this__5338__auto____$1 \x3d this;
return (new datascript.parser.SrcVar(self__.symbol,self__.__meta,self__.__extmap,self__.__hash));
}));

(datascript.parser.SrcVar.prototype.cljs$core$ICounted$_count$arity$1 \x3d (function (this__5347__auto__){
var self__ \x3d this;
var this__5347__auto____$1 \x3d this;
return (1 + cljs.core.count(self__.__extmap));
}));

(datascript.parser.SrcVar.prototype.cljs$core$IHash$_hash$arity$1 \x3d (function (this__5339__auto__){
var self__ \x3d this;
var this__5339__auto____$1 \x3d this;
var h__5154__auto__ \x3d self__.__hash;
if((!((h__5154__auto__ \x3d\x3d null)))){
return h__5154__auto__;
} else {
var h__5154__auto____$1 \x3d (function (coll__5340__auto__){
return (-1648766309 ^ cljs.core.hash_unordered_coll(coll__5340__auto__));
})(this__5339__auto____$1);
(self__.__hash \x3d h__5154__auto____$1);

return h__5154__auto____$1;
}
}));

(datascript.parser.SrcVar.prototype.cljs$core$IEquiv$_equiv$arity$2 \x3d (function (this53842,other53843){
var self__ \x3d this;
var this53842__$1 \x3d this;
return (((!((other53843 \x3d\x3d null)))) \x26\x26 ((((this53842__$1.constructor \x3d\x3d\x3d other53843.constructor)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this53842__$1.symbol,other53843.symbol)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this53842__$1.__extmap,other53843.__extmap)))))));
}));

(datascript.parser.SrcVar.prototype.cljs$core$IMap$_dissoc$arity$2 \x3d (function (this__5353__auto__,k__5354__auto__){
var self__ \x3d this;
var this__5353__auto____$1 \x3d this;
if(cljs.core.contains_QMARK_(new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,\x22symbol\x22,\x22symbol\x22,-1038572696),null], null), null),k__5354__auto__)){
return cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(cljs.core._with_meta(cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,this__5353__auto____$1),self__.__meta),k__5354__auto__);
} else {
return (new datascript.parser.SrcVar(self__.symbol,self__.__meta,cljs.core.not_empty(cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(self__.__extmap,k__5354__auto__)),null));
}
}));

(datascript.parser.SrcVar.prototype.cljs$core$IAssociative$_contains_key_QMARK_$arity$2 \x3d (function (this__5350__auto__,k53841){
var self__ \x3d this;
var this__5350__auto____$1 \x3d this;
var G__53879 \x3d k53841;
var G__53879__$1 \x3d (((G__53879 instanceof cljs.core.Keyword))?G__53879.fqn:null);
switch (G__53879__$1) {
case \x22symbol\x22:
return true;

break;
default:
return cljs.core.contains_QMARK_(self__.__extmap,k53841);

}
}));

(datascript.parser.SrcVar.prototype.cljs$core$IAssociative$_assoc$arity$3 \x3d (function (this__5351__auto__,k__5352__auto__,G__53840){
var self__ \x3d this;
var this__5351__auto____$1 \x3d this;
var pred__53883 \x3d cljs.core.keyword_identical_QMARK_;
var expr__53884 \x3d k__5352__auto__;
if(cljs.core.truth_((pred__53883.cljs$core$IFn$_invoke$arity$2 ? pred__53883.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22symbol\x22,\x22symbol\x22,-1038572696),expr__53884) : pred__53883.call(null,new cljs.core.Keyword(null,\x22symbol\x22,\x22symbol\x22,-1038572696),expr__53884)))){
return (new datascript.parser.SrcVar(G__53840,self__.__meta,self__.__extmap,null));
} else {
return (new datascript.parser.SrcVar(self__.symbol,self__.__meta,cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k__5352__auto__,G__53840),null));
}
}));

(datascript.parser.SrcVar.prototype.cljs$core$ISeqable$_seq$arity$1 \x3d (function (this__5356__auto__){
var self__ \x3d this;
var this__5356__auto____$1 \x3d this;
return cljs.core.seq(cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22symbol\x22,\x22symbol\x22,-1038572696),self__.symbol,null))], null),self__.__extmap));
}));

(datascript.parser.SrcVar.prototype.cljs$core$IWithMeta$_with_meta$arity$2 \x3d (function (this__5342__auto__,G__53840){
var self__ \x3d this;
var this__5342__auto____$1 \x3d this;
return (new datascript.parser.SrcVar(self__.symbol,G__53840,self__.__extmap,self__.__hash));
}));

(datascript.parser.SrcVar.prototype.cljs$core$ICollection$_conj$arity$2 \x3d (function (this__5348__auto__,entry__5349__auto__){
var self__ \x3d this;
var this__5348__auto____$1 \x3d this;
if(cljs.core.vector_QMARK_(entry__5349__auto__)){
return this__5348__auto____$1.cljs$core$IAssociative$_assoc$arity$3(null,cljs.core._nth(entry__5349__auto__,(0)),cljs.core._nth(entry__5349__auto__,(1)));
} else {
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(cljs.core._conj,this__5348__auto____$1,entry__5349__auto__);
}
}));

(datascript.parser.SrcVar.prototype.datascript$parser$ITraversable$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.parser.SrcVar.prototype.datascript$parser$ITraversable$_postwalk$arity$2 \x3d (function (this__52373__auto__,f53837){
var self__ \x3d this;
var this__52373__auto____$1 \x3d this;
var new__52374__auto__ \x3d (new datascript.parser.SrcVar(datascript.parser.postwalk(self__.symbol,f53837),null,null,null));
var temp__5802__auto__ \x3d cljs.core.meta(this__52373__auto____$1);
if(cljs.core.truth_(temp__5802__auto__)){
var meta__52375__auto__ \x3d temp__5802__auto__;
return cljs.core.with_meta(new__52374__auto__,meta__52375__auto__);
} else {
return new__52374__auto__;
}
}));

(datascript.parser.SrcVar.prototype.datascript$parser$ITraversable$_collect$arity$3 \x3d (function (___52376__auto__,pred53838,acc53839){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
return datascript.parser.collect.cljs$core$IFn$_invoke$arity$3(pred53838,self__.symbol,acc53839);
}));

(datascript.parser.SrcVar.prototype.datascript$parser$ITraversable$_collect_vars$arity$2 \x3d (function (___52376__auto__,acc53839){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
return (datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2 ? datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2(acc53839,self__.symbol) : datascript.parser.collect_vars_acc.call(null,acc53839,self__.symbol));
}));

(datascript.parser.SrcVar.getBasis \x3d (function (){
return new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22symbol\x22,\x22symbol\x22,601958831,null)], null);
}));

(datascript.parser.SrcVar.cljs$lang$type \x3d true);

(datascript.parser.SrcVar.cljs$lang$ctorPrSeq \x3d (function (this__5389__auto__){
return (new cljs.core.List(null,\x22datascript.parser/SrcVar\x22,null,(1),null));
}));

(datascript.parser.SrcVar.cljs$lang$ctorPrWriter \x3d (function (this__5389__auto__,writer__5390__auto__){
return cljs.core._write(writer__5390__auto__,\x22datascript.parser/SrcVar\x22);
}));

/**
 * Positional factory function for datascript.parser/SrcVar.
 */
datascript.parser.__GT_SrcVar \x3d (function datascript$parser$__GT_SrcVar(symbol){
return (new datascript.parser.SrcVar(symbol,null,null,null));
});

/**
 * Factory function for datascript.parser/SrcVar, taking a map of keywords to field values.
 */
datascript.parser.map__GT_SrcVar \x3d (function datascript$parser$map__GT_SrcVar(G__53844){
var extmap__5385__auto__ \x3d (function (){var G__53904 \x3d cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(G__53844,new cljs.core.Keyword(null,\x22symbol\x22,\x22symbol\x22,-1038572696));
if(cljs.core.record_QMARK_(G__53844)){
return cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,G__53904);
} else {
return G__53904;
}
})();
return (new datascript.parser.SrcVar(new cljs.core.Keyword(null,\x22symbol\x22,\x22symbol\x22,-1038572696).cljs$core$IFn$_invoke$arity$1(G__53844),null,cljs.core.not_empty(extmap__5385__auto__),null));
});


/**
* @constructor
 * @implements {cljs.core.IRecord}
 * @implements {cljs.core.IKVReduce}
 * @implements {cljs.core.IEquiv}
 * @implements {cljs.core.IHash}
 * @implements {cljs.core.ICollection}
 * @implements {cljs.core.ICounted}
 * @implements {cljs.core.ISeqable}
 * @implements {cljs.core.IMeta}
 * @implements {cljs.core.ICloneable}
 * @implements {cljs.core.IPrintWithWriter}
 * @implements {cljs.core.IIterable}
 * @implements {datascript.parser.ITraversable}
 * @implements {cljs.core.IWithMeta}
 * @implements {cljs.core.IAssociative}
 * @implements {cljs.core.IMap}
 * @implements {cljs.core.ILookup}
*/
datascript.parser.DefaultSrc \x3d (function (__meta,__extmap,__hash){
this.__meta \x3d __meta;
this.__extmap \x3d __extmap;
this.__hash \x3d __hash;
this.cljs$lang$protocol_mask$partition0$ \x3d 2230716170;
this.cljs$lang$protocol_mask$partition1$ \x3d 139264;
});
(datascript.parser.DefaultSrc.prototype.cljs$core$ILookup$_lookup$arity$2 \x3d (function (this__5343__auto__,k__5344__auto__){
var self__ \x3d this;
var this__5343__auto____$1 \x3d this;
return this__5343__auto____$1.cljs$core$ILookup$_lookup$arity$3(null,k__5344__auto__,null);
}));

(datascript.parser.DefaultSrc.prototype.cljs$core$ILookup$_lookup$arity$3 \x3d (function (this__5345__auto__,k53909,else__5346__auto__){
var self__ \x3d this;
var this__5345__auto____$1 \x3d this;
var G__53917 \x3d k53909;
switch (G__53917) {
default:
return cljs.core.get.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k53909,else__5346__auto__);

}
}));

(datascript.parser.DefaultSrc.prototype.cljs$core$IKVReduce$_kv_reduce$arity$3 \x3d (function (this__5363__auto__,f__5364__auto__,init__5365__auto__){
var self__ \x3d this;
var this__5363__auto____$1 \x3d this;
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (ret__5366__auto__,p__53918){
var vec__53919 \x3d p__53918;
var k__5367__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__53919,(0),null);
var v__5368__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__53919,(1),null);
return (f__5364__auto__.cljs$core$IFn$_invoke$arity$3 ? f__5364__auto__.cljs$core$IFn$_invoke$arity$3(ret__5366__auto__,k__5367__auto__,v__5368__auto__) : f__5364__auto__.call(null,ret__5366__auto__,k__5367__auto__,v__5368__auto__));
}),init__5365__auto__,this__5363__auto____$1);
}));

(datascript.parser.DefaultSrc.prototype.cljs$core$IPrintWithWriter$_pr_writer$arity$3 \x3d (function (this__5358__auto__,writer__5359__auto__,opts__5360__auto__){
var self__ \x3d this;
var this__5358__auto____$1 \x3d this;
var pr_pair__5361__auto__ \x3d (function (keyval__5362__auto__){
return cljs.core.pr_sequential_writer(writer__5359__auto__,cljs.core.pr_writer,\x22\x22,\x22 \x22,\x22\x22,opts__5360__auto__,keyval__5362__auto__);
});
return cljs.core.pr_sequential_writer(writer__5359__auto__,pr_pair__5361__auto__,\x22#datascript.parser.DefaultSrc{\x22,\x22, \x22,\x22}\x22,opts__5360__auto__,cljs.core.concat.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentVector.EMPTY,self__.__extmap));
}));

(datascript.parser.DefaultSrc.prototype.cljs$core$IIterable$_iterator$arity$1 \x3d (function (G__53908){
var self__ \x3d this;
var G__53908__$1 \x3d this;
return (new cljs.core.RecordIter((0),G__53908__$1,0,cljs.core.PersistentVector.EMPTY,(cljs.core.truth_(self__.__extmap)?cljs.core._iterator(self__.__extmap):cljs.core.nil_iter())));
}));

(datascript.parser.DefaultSrc.prototype.cljs$core$IMeta$_meta$arity$1 \x3d (function (this__5341__auto__){
var self__ \x3d this;
var this__5341__auto____$1 \x3d this;
return self__.__meta;
}));

(datascript.parser.DefaultSrc.prototype.cljs$core$ICloneable$_clone$arity$1 \x3d (function (this__5338__auto__){
var self__ \x3d this;
var this__5338__auto____$1 \x3d this;
return (new datascript.parser.DefaultSrc(self__.__meta,self__.__extmap,self__.__hash));
}));

(datascript.parser.DefaultSrc.prototype.cljs$core$ICounted$_count$arity$1 \x3d (function (this__5347__auto__){
var self__ \x3d this;
var this__5347__auto____$1 \x3d this;
return (0 + cljs.core.count(self__.__extmap));
}));

(datascript.parser.DefaultSrc.prototype.cljs$core$IHash$_hash$arity$1 \x3d (function (this__5339__auto__){
var self__ \x3d this;
var this__5339__auto____$1 \x3d this;
var h__5154__auto__ \x3d self__.__hash;
if((!((h__5154__auto__ \x3d\x3d null)))){
return h__5154__auto__;
} else {
var h__5154__auto____$1 \x3d (function (coll__5340__auto__){
return (-350962559 ^ cljs.core.hash_unordered_coll(coll__5340__auto__));
})(this__5339__auto____$1);
(self__.__hash \x3d h__5154__auto____$1);

return h__5154__auto____$1;
}
}));

(datascript.parser.DefaultSrc.prototype.cljs$core$IEquiv$_equiv$arity$2 \x3d (function (this53910,other53911){
var self__ \x3d this;
var this53910__$1 \x3d this;
return (((!((other53911 \x3d\x3d null)))) \x26\x26 ((((this53910__$1.constructor \x3d\x3d\x3d other53911.constructor)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this53910__$1.__extmap,other53911.__extmap)))));
}));

(datascript.parser.DefaultSrc.prototype.cljs$core$IMap$_dissoc$arity$2 \x3d (function (this__5353__auto__,k__5354__auto__){
var self__ \x3d this;
var this__5353__auto____$1 \x3d this;
if(cljs.core.contains_QMARK_(cljs.core.PersistentHashSet.EMPTY,k__5354__auto__)){
return cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(cljs.core._with_meta(cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,this__5353__auto____$1),self__.__meta),k__5354__auto__);
} else {
return (new datascript.parser.DefaultSrc(self__.__meta,cljs.core.not_empty(cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(self__.__extmap,k__5354__auto__)),null));
}
}));

(datascript.parser.DefaultSrc.prototype.cljs$core$IAssociative$_contains_key_QMARK_$arity$2 \x3d (function (this__5350__auto__,k53909){
var self__ \x3d this;
var this__5350__auto____$1 \x3d this;
return cljs.core.contains_QMARK_(self__.__extmap,k53909);
}));

(datascript.parser.DefaultSrc.prototype.cljs$core$IAssociative$_assoc$arity$3 \x3d (function (this__5351__auto__,k__5352__auto__,G__53908){
var self__ \x3d this;
var this__5351__auto____$1 \x3d this;
var pred__53931 \x3d cljs.core.keyword_identical_QMARK_;
var expr__53932 \x3d k__5352__auto__;
return (new datascript.parser.DefaultSrc(self__.__meta,cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k__5352__auto__,G__53908),null));
}));

(datascript.parser.DefaultSrc.prototype.cljs$core$ISeqable$_seq$arity$1 \x3d (function (this__5356__auto__){
var self__ \x3d this;
var this__5356__auto____$1 \x3d this;
return cljs.core.seq(cljs.core.concat.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentVector.EMPTY,self__.__extmap));
}));

(datascript.parser.DefaultSrc.prototype.cljs$core$IWithMeta$_with_meta$arity$2 \x3d (function (this__5342__auto__,G__53908){
var self__ \x3d this;
var this__5342__auto____$1 \x3d this;
return (new datascript.parser.DefaultSrc(G__53908,self__.__extmap,self__.__hash));
}));

(datascript.parser.DefaultSrc.prototype.cljs$core$ICollection$_conj$arity$2 \x3d (function (this__5348__auto__,entry__5349__auto__){
var self__ \x3d this;
var this__5348__auto____$1 \x3d this;
if(cljs.core.vector_QMARK_(entry__5349__auto__)){
return this__5348__auto____$1.cljs$core$IAssociative$_assoc$arity$3(null,cljs.core._nth(entry__5349__auto__,(0)),cljs.core._nth(entry__5349__auto__,(1)));
} else {
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(cljs.core._conj,this__5348__auto____$1,entry__5349__auto__);
}
}));

(datascript.parser.DefaultSrc.prototype.datascript$parser$ITraversable$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.parser.DefaultSrc.prototype.datascript$parser$ITraversable$_postwalk$arity$2 \x3d (function (this__52373__auto__,f53905){
var self__ \x3d this;
var this__52373__auto____$1 \x3d this;
var new__52374__auto__ \x3d (new datascript.parser.DefaultSrc(null,null,null));
var temp__5802__auto__ \x3d cljs.core.meta(this__52373__auto____$1);
if(cljs.core.truth_(temp__5802__auto__)){
var meta__52375__auto__ \x3d temp__5802__auto__;
return cljs.core.with_meta(new__52374__auto__,meta__52375__auto__);
} else {
return new__52374__auto__;
}
}));

(datascript.parser.DefaultSrc.prototype.datascript$parser$ITraversable$_collect$arity$3 \x3d (function (___52376__auto__,pred53906,acc53907){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
return acc53907;
}));

(datascript.parser.DefaultSrc.prototype.datascript$parser$ITraversable$_collect_vars$arity$2 \x3d (function (___52376__auto__,acc53907){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
return acc53907;
}));

(datascript.parser.DefaultSrc.getBasis \x3d (function (){
return cljs.core.PersistentVector.EMPTY;
}));

(datascript.parser.DefaultSrc.cljs$lang$type \x3d true);

(datascript.parser.DefaultSrc.cljs$lang$ctorPrSeq \x3d (function (this__5389__auto__){
return (new cljs.core.List(null,\x22datascript.parser/DefaultSrc\x22,null,(1),null));
}));

(datascript.parser.DefaultSrc.cljs$lang$ctorPrWriter \x3d (function (this__5389__auto__,writer__5390__auto__){
return cljs.core._write(writer__5390__auto__,\x22datascript.parser/DefaultSrc\x22);
}));

/**
 * Positional factory function for datascript.parser/DefaultSrc.
 */
datascript.parser.__GT_DefaultSrc \x3d (function datascript$parser$__GT_DefaultSrc(){
return (new datascript.parser.DefaultSrc(null,null,null));
});

/**
 * Factory function for datascript.parser/DefaultSrc, taking a map of keywords to field values.
 */
datascript.parser.map__GT_DefaultSrc \x3d (function datascript$parser$map__GT_DefaultSrc(G__53913){
var extmap__5385__auto__ \x3d (function (){var G__53940 \x3d cljs.core.dissoc.cljs$core$IFn$_invoke$arity$1(G__53913);
if(cljs.core.record_QMARK_(G__53913)){
return cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,G__53940);
} else {
return G__53940;
}
})();
return (new datascript.parser.DefaultSrc(null,cljs.core.not_empty(extmap__5385__auto__),null));
});


/**
* @constructor
 * @implements {cljs.core.IRecord}
 * @implements {cljs.core.IKVReduce}
 * @implements {cljs.core.IEquiv}
 * @implements {cljs.core.IHash}
 * @implements {cljs.core.ICollection}
 * @implements {cljs.core.ICounted}
 * @implements {cljs.core.ISeqable}
 * @implements {cljs.core.IMeta}
 * @implements {cljs.core.ICloneable}
 * @implements {cljs.core.IPrintWithWriter}
 * @implements {cljs.core.IIterable}
 * @implements {datascript.parser.ITraversable}
 * @implements {cljs.core.IWithMeta}
 * @implements {cljs.core.IAssociative}
 * @implements {cljs.core.IMap}
 * @implements {cljs.core.ILookup}
*/
datascript.parser.RulesVar \x3d (function (__meta,__extmap,__hash){
this.__meta \x3d __meta;
this.__extmap \x3d __extmap;
this.__hash \x3d __hash;
this.cljs$lang$protocol_mask$partition0$ \x3d 2230716170;
this.cljs$lang$protocol_mask$partition1$ \x3d 139264;
});
(datascript.parser.RulesVar.prototype.cljs$core$ILookup$_lookup$arity$2 \x3d (function (this__5343__auto__,k__5344__auto__){
var self__ \x3d this;
var this__5343__auto____$1 \x3d this;
return this__5343__auto____$1.cljs$core$ILookup$_lookup$arity$3(null,k__5344__auto__,null);
}));

(datascript.parser.RulesVar.prototype.cljs$core$ILookup$_lookup$arity$3 \x3d (function (this__5345__auto__,k53945,else__5346__auto__){
var self__ \x3d this;
var this__5345__auto____$1 \x3d this;
var G__53949 \x3d k53945;
switch (G__53949) {
default:
return cljs.core.get.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k53945,else__5346__auto__);

}
}));

(datascript.parser.RulesVar.prototype.cljs$core$IKVReduce$_kv_reduce$arity$3 \x3d (function (this__5363__auto__,f__5364__auto__,init__5365__auto__){
var self__ \x3d this;
var this__5363__auto____$1 \x3d this;
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (ret__5366__auto__,p__53950){
var vec__53951 \x3d p__53950;
var k__5367__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__53951,(0),null);
var v__5368__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__53951,(1),null);
return (f__5364__auto__.cljs$core$IFn$_invoke$arity$3 ? f__5364__auto__.cljs$core$IFn$_invoke$arity$3(ret__5366__auto__,k__5367__auto__,v__5368__auto__) : f__5364__auto__.call(null,ret__5366__auto__,k__5367__auto__,v__5368__auto__));
}),init__5365__auto__,this__5363__auto____$1);
}));

(datascript.parser.RulesVar.prototype.cljs$core$IPrintWithWriter$_pr_writer$arity$3 \x3d (function (this__5358__auto__,writer__5359__auto__,opts__5360__auto__){
var self__ \x3d this;
var this__5358__auto____$1 \x3d this;
var pr_pair__5361__auto__ \x3d (function (keyval__5362__auto__){
return cljs.core.pr_sequential_writer(writer__5359__auto__,cljs.core.pr_writer,\x22\x22,\x22 \x22,\x22\x22,opts__5360__auto__,keyval__5362__auto__);
});
return cljs.core.pr_sequential_writer(writer__5359__auto__,pr_pair__5361__auto__,\x22#datascript.parser.RulesVar{\x22,\x22, \x22,\x22}\x22,opts__5360__auto__,cljs.core.concat.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentVector.EMPTY,self__.__extmap));
}));

(datascript.parser.RulesVar.prototype.cljs$core$IIterable$_iterator$arity$1 \x3d (function (G__53944){
var self__ \x3d this;
var G__53944__$1 \x3d this;
return (new cljs.core.RecordIter((0),G__53944__$1,0,cljs.core.PersistentVector.EMPTY,(cljs.core.truth_(self__.__extmap)?cljs.core._iterator(self__.__extmap):cljs.core.nil_iter())));
}));

(datascript.parser.RulesVar.prototype.cljs$core$IMeta$_meta$arity$1 \x3d (function (this__5341__auto__){
var self__ \x3d this;
var this__5341__auto____$1 \x3d this;
return self__.__meta;
}));

(datascript.parser.RulesVar.prototype.cljs$core$ICloneable$_clone$arity$1 \x3d (function (this__5338__auto__){
var self__ \x3d this;
var this__5338__auto____$1 \x3d this;
return (new datascript.parser.RulesVar(self__.__meta,self__.__extmap,self__.__hash));
}));

(datascript.parser.RulesVar.prototype.cljs$core$ICounted$_count$arity$1 \x3d (function (this__5347__auto__){
var self__ \x3d this;
var this__5347__auto____$1 \x3d this;
return (0 + cljs.core.count(self__.__extmap));
}));

(datascript.parser.RulesVar.prototype.cljs$core$IHash$_hash$arity$1 \x3d (function (this__5339__auto__){
var self__ \x3d this;
var this__5339__auto____$1 \x3d this;
var h__5154__auto__ \x3d self__.__hash;
if((!((h__5154__auto__ \x3d\x3d null)))){
return h__5154__auto__;
} else {
var h__5154__auto____$1 \x3d (function (coll__5340__auto__){
return (-1504050517 ^ cljs.core.hash_unordered_coll(coll__5340__auto__));
})(this__5339__auto____$1);
(self__.__hash \x3d h__5154__auto____$1);

return h__5154__auto____$1;
}
}));

(datascript.parser.RulesVar.prototype.cljs$core$IEquiv$_equiv$arity$2 \x3d (function (this53946,other53947){
var self__ \x3d this;
var this53946__$1 \x3d this;
return (((!((other53947 \x3d\x3d null)))) \x26\x26 ((((this53946__$1.constructor \x3d\x3d\x3d other53947.constructor)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this53946__$1.__extmap,other53947.__extmap)))));
}));

(datascript.parser.RulesVar.prototype.cljs$core$IMap$_dissoc$arity$2 \x3d (function (this__5353__auto__,k__5354__auto__){
var self__ \x3d this;
var this__5353__auto____$1 \x3d this;
if(cljs.core.contains_QMARK_(cljs.core.PersistentHashSet.EMPTY,k__5354__auto__)){
return cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(cljs.core._with_meta(cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,this__5353__auto____$1),self__.__meta),k__5354__auto__);
} else {
return (new datascript.parser.RulesVar(self__.__meta,cljs.core.not_empty(cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(self__.__extmap,k__5354__auto__)),null));
}
}));

(datascript.parser.RulesVar.prototype.cljs$core$IAssociative$_contains_key_QMARK_$arity$2 \x3d (function (this__5350__auto__,k53945){
var self__ \x3d this;
var this__5350__auto____$1 \x3d this;
return cljs.core.contains_QMARK_(self__.__extmap,k53945);
}));

(datascript.parser.RulesVar.prototype.cljs$core$IAssociative$_assoc$arity$3 \x3d (function (this__5351__auto__,k__5352__auto__,G__53944){
var self__ \x3d this;
var this__5351__auto____$1 \x3d this;
var pred__53958 \x3d cljs.core.keyword_identical_QMARK_;
var expr__53959 \x3d k__5352__auto__;
return (new datascript.parser.RulesVar(self__.__meta,cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k__5352__auto__,G__53944),null));
}));

(datascript.parser.RulesVar.prototype.cljs$core$ISeqable$_seq$arity$1 \x3d (function (this__5356__auto__){
var self__ \x3d this;
var this__5356__auto____$1 \x3d this;
return cljs.core.seq(cljs.core.concat.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentVector.EMPTY,self__.__extmap));
}));

(datascript.parser.RulesVar.prototype.cljs$core$IWithMeta$_with_meta$arity$2 \x3d (function (this__5342__auto__,G__53944){
var self__ \x3d this;
var this__5342__auto____$1 \x3d this;
return (new datascript.parser.RulesVar(G__53944,self__.__extmap,self__.__hash));
}));

(datascript.parser.RulesVar.prototype.cljs$core$ICollection$_conj$arity$2 \x3d (function (this__5348__auto__,entry__5349__auto__){
var self__ \x3d this;
var this__5348__auto____$1 \x3d this;
if(cljs.core.vector_QMARK_(entry__5349__auto__)){
return this__5348__auto____$1.cljs$core$IAssociative$_assoc$arity$3(null,cljs.core._nth(entry__5349__auto__,(0)),cljs.core._nth(entry__5349__auto__,(1)));
} else {
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(cljs.core._conj,this__5348__auto____$1,entry__5349__auto__);
}
}));

(datascript.parser.RulesVar.prototype.datascript$parser$ITraversable$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.parser.RulesVar.prototype.datascript$parser$ITraversable$_postwalk$arity$2 \x3d (function (this__52373__auto__,f53941){
var self__ \x3d this;
var this__52373__auto____$1 \x3d this;
var new__52374__auto__ \x3d (new datascript.parser.RulesVar(null,null,null));
var temp__5802__auto__ \x3d cljs.core.meta(this__52373__auto____$1);
if(cljs.core.truth_(temp__5802__auto__)){
var meta__52375__auto__ \x3d temp__5802__auto__;
return cljs.core.with_meta(new__52374__auto__,meta__52375__auto__);
} else {
return new__52374__auto__;
}
}));

(datascript.parser.RulesVar.prototype.datascript$parser$ITraversable$_collect$arity$3 \x3d (function (___52376__auto__,pred53942,acc53943){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
return acc53943;
}));

(datascript.parser.RulesVar.prototype.datascript$parser$ITraversable$_collect_vars$arity$2 \x3d (function (___52376__auto__,acc53943){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
return acc53943;
}));

(datascript.parser.RulesVar.getBasis \x3d (function (){
return cljs.core.PersistentVector.EMPTY;
}));

(datascript.parser.RulesVar.cljs$lang$type \x3d true);

(datascript.parser.RulesVar.cljs$lang$ctorPrSeq \x3d (function (this__5389__auto__){
return (new cljs.core.List(null,\x22datascript.parser/RulesVar\x22,null,(1),null));
}));

(datascript.parser.RulesVar.cljs$lang$ctorPrWriter \x3d (function (this__5389__auto__,writer__5390__auto__){
return cljs.core._write(writer__5390__auto__,\x22datascript.parser/RulesVar\x22);
}));

/**
 * Positional factory function for datascript.parser/RulesVar.
 */
datascript.parser.__GT_RulesVar \x3d (function datascript$parser$__GT_RulesVar(){
return (new datascript.parser.RulesVar(null,null,null));
});

/**
 * Factory function for datascript.parser/RulesVar, taking a map of keywords to field values.
 */
datascript.parser.map__GT_RulesVar \x3d (function datascript$parser$map__GT_RulesVar(G__53948){
var extmap__5385__auto__ \x3d (function (){var G__53962 \x3d cljs.core.dissoc.cljs$core$IFn$_invoke$arity$1(G__53948);
if(cljs.core.record_QMARK_(G__53948)){
return cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,G__53962);
} else {
return G__53962;
}
})();
return (new datascript.parser.RulesVar(null,cljs.core.not_empty(extmap__5385__auto__),null));
});


/**
* @constructor
 * @implements {cljs.core.IRecord}
 * @implements {cljs.core.IKVReduce}
 * @implements {cljs.core.IEquiv}
 * @implements {cljs.core.IHash}
 * @implements {cljs.core.ICollection}
 * @implements {cljs.core.ICounted}
 * @implements {cljs.core.ISeqable}
 * @implements {cljs.core.IMeta}
 * @implements {cljs.core.ICloneable}
 * @implements {cljs.core.IPrintWithWriter}
 * @implements {cljs.core.IIterable}
 * @implements {datascript.parser.ITraversable}
 * @implements {cljs.core.IWithMeta}
 * @implements {cljs.core.IAssociative}
 * @implements {cljs.core.IMap}
 * @implements {cljs.core.ILookup}
*/
datascript.parser.Constant \x3d (function (value,__meta,__extmap,__hash){
this.value \x3d value;
this.__meta \x3d __meta;
this.__extmap \x3d __extmap;
this.__hash \x3d __hash;
this.cljs$lang$protocol_mask$partition0$ \x3d 2230716170;
this.cljs$lang$protocol_mask$partition1$ \x3d 139264;
});
(datascript.parser.Constant.prototype.cljs$core$ILookup$_lookup$arity$2 \x3d (function (this__5343__auto__,k__5344__auto__){
var self__ \x3d this;
var this__5343__auto____$1 \x3d this;
return this__5343__auto____$1.cljs$core$ILookup$_lookup$arity$3(null,k__5344__auto__,null);
}));

(datascript.parser.Constant.prototype.cljs$core$ILookup$_lookup$arity$3 \x3d (function (this__5345__auto__,k53967,else__5346__auto__){
var self__ \x3d this;
var this__5345__auto____$1 \x3d this;
var G__53971 \x3d k53967;
var G__53971__$1 \x3d (((G__53971 instanceof cljs.core.Keyword))?G__53971.fqn:null);
switch (G__53971__$1) {
case \x22value\x22:
return self__.value;

break;
default:
return cljs.core.get.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k53967,else__5346__auto__);

}
}));

(datascript.parser.Constant.prototype.cljs$core$IKVReduce$_kv_reduce$arity$3 \x3d (function (this__5363__auto__,f__5364__auto__,init__5365__auto__){
var self__ \x3d this;
var this__5363__auto____$1 \x3d this;
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (ret__5366__auto__,p__53972){
var vec__53973 \x3d p__53972;
var k__5367__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__53973,(0),null);
var v__5368__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__53973,(1),null);
return (f__5364__auto__.cljs$core$IFn$_invoke$arity$3 ? f__5364__auto__.cljs$core$IFn$_invoke$arity$3(ret__5366__auto__,k__5367__auto__,v__5368__auto__) : f__5364__auto__.call(null,ret__5366__auto__,k__5367__auto__,v__5368__auto__));
}),init__5365__auto__,this__5363__auto____$1);
}));

(datascript.parser.Constant.prototype.cljs$core$IPrintWithWriter$_pr_writer$arity$3 \x3d (function (this__5358__auto__,writer__5359__auto__,opts__5360__auto__){
var self__ \x3d this;
var this__5358__auto____$1 \x3d this;
var pr_pair__5361__auto__ \x3d (function (keyval__5362__auto__){
return cljs.core.pr_sequential_writer(writer__5359__auto__,cljs.core.pr_writer,\x22\x22,\x22 \x22,\x22\x22,opts__5360__auto__,keyval__5362__auto__);
});
return cljs.core.pr_sequential_writer(writer__5359__auto__,pr_pair__5361__auto__,\x22#datascript.parser.Constant{\x22,\x22, \x22,\x22}\x22,opts__5360__auto__,cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22value\x22,\x22value\x22,305978217),self__.value],null))], null),self__.__extmap));
}));

(datascript.parser.Constant.prototype.cljs$core$IIterable$_iterator$arity$1 \x3d (function (G__53966){
var self__ \x3d this;
var G__53966__$1 \x3d this;
return (new cljs.core.RecordIter((0),G__53966__$1,1,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22value\x22,\x22value\x22,305978217)], null),(cljs.core.truth_(self__.__extmap)?cljs.core._iterator(self__.__extmap):cljs.core.nil_iter())));
}));

(datascript.parser.Constant.prototype.cljs$core$IMeta$_meta$arity$1 \x3d (function (this__5341__auto__){
var self__ \x3d this;
var this__5341__auto____$1 \x3d this;
return self__.__meta;
}));

(datascript.parser.Constant.prototype.cljs$core$ICloneable$_clone$arity$1 \x3d (function (this__5338__auto__){
var self__ \x3d this;
var this__5338__auto____$1 \x3d this;
return (new datascript.parser.Constant(self__.value,self__.__meta,self__.__extmap,self__.__hash));
}));

(datascript.parser.Constant.prototype.cljs$core$ICounted$_count$arity$1 \x3d (function (this__5347__auto__){
var self__ \x3d this;
var this__5347__auto____$1 \x3d this;
return (1 + cljs.core.count(self__.__extmap));
}));

(datascript.parser.Constant.prototype.cljs$core$IHash$_hash$arity$1 \x3d (function (this__5339__auto__){
var self__ \x3d this;
var this__5339__auto____$1 \x3d this;
var h__5154__auto__ \x3d self__.__hash;
if((!((h__5154__auto__ \x3d\x3d null)))){
return h__5154__auto__;
} else {
var h__5154__auto____$1 \x3d (function (coll__5340__auto__){
return (-812884714 ^ cljs.core.hash_unordered_coll(coll__5340__auto__));
})(this__5339__auto____$1);
(self__.__hash \x3d h__5154__auto____$1);

return h__5154__auto____$1;
}
}));

(datascript.parser.Constant.prototype.cljs$core$IEquiv$_equiv$arity$2 \x3d (function (this53968,other53969){
var self__ \x3d this;
var this53968__$1 \x3d this;
return (((!((other53969 \x3d\x3d null)))) \x26\x26 ((((this53968__$1.constructor \x3d\x3d\x3d other53969.constructor)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this53968__$1.value,other53969.value)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this53968__$1.__extmap,other53969.__extmap)))))));
}));

(datascript.parser.Constant.prototype.cljs$core$IMap$_dissoc$arity$2 \x3d (function (this__5353__auto__,k__5354__auto__){
var self__ \x3d this;
var this__5353__auto____$1 \x3d this;
if(cljs.core.contains_QMARK_(new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,\x22value\x22,\x22value\x22,305978217),null], null), null),k__5354__auto__)){
return cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(cljs.core._with_meta(cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,this__5353__auto____$1),self__.__meta),k__5354__auto__);
} else {
return (new datascript.parser.Constant(self__.value,self__.__meta,cljs.core.not_empty(cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(self__.__extmap,k__5354__auto__)),null));
}
}));

(datascript.parser.Constant.prototype.cljs$core$IAssociative$_contains_key_QMARK_$arity$2 \x3d (function (this__5350__auto__,k53967){
var self__ \x3d this;
var this__5350__auto____$1 \x3d this;
var G__53993 \x3d k53967;
var G__53993__$1 \x3d (((G__53993 instanceof cljs.core.Keyword))?G__53993.fqn:null);
switch (G__53993__$1) {
case \x22value\x22:
return true;

break;
default:
return cljs.core.contains_QMARK_(self__.__extmap,k53967);

}
}));

(datascript.parser.Constant.prototype.cljs$core$IAssociative$_assoc$arity$3 \x3d (function (this__5351__auto__,k__5352__auto__,G__53966){
var self__ \x3d this;
var this__5351__auto____$1 \x3d this;
var pred__53995 \x3d cljs.core.keyword_identical_QMARK_;
var expr__53996 \x3d k__5352__auto__;
if(cljs.core.truth_((pred__53995.cljs$core$IFn$_invoke$arity$2 ? pred__53995.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22value\x22,\x22value\x22,305978217),expr__53996) : pred__53995.call(null,new cljs.core.Keyword(null,\x22value\x22,\x22value\x22,305978217),expr__53996)))){
return (new datascript.parser.Constant(G__53966,self__.__meta,self__.__extmap,null));
} else {
return (new datascript.parser.Constant(self__.value,self__.__meta,cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k__5352__auto__,G__53966),null));
}
}));

(datascript.parser.Constant.prototype.cljs$core$ISeqable$_seq$arity$1 \x3d (function (this__5356__auto__){
var self__ \x3d this;
var this__5356__auto____$1 \x3d this;
return cljs.core.seq(cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22value\x22,\x22value\x22,305978217),self__.value,null))], null),self__.__extmap));
}));

(datascript.parser.Constant.prototype.cljs$core$IWithMeta$_with_meta$arity$2 \x3d (function (this__5342__auto__,G__53966){
var self__ \x3d this;
var this__5342__auto____$1 \x3d this;
return (new datascript.parser.Constant(self__.value,G__53966,self__.__extmap,self__.__hash));
}));

(datascript.parser.Constant.prototype.cljs$core$ICollection$_conj$arity$2 \x3d (function (this__5348__auto__,entry__5349__auto__){
var self__ \x3d this;
var this__5348__auto____$1 \x3d this;
if(cljs.core.vector_QMARK_(entry__5349__auto__)){
return this__5348__auto____$1.cljs$core$IAssociative$_assoc$arity$3(null,cljs.core._nth(entry__5349__auto__,(0)),cljs.core._nth(entry__5349__auto__,(1)));
} else {
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(cljs.core._conj,this__5348__auto____$1,entry__5349__auto__);
}
}));

(datascript.parser.Constant.prototype.datascript$parser$ITraversable$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.parser.Constant.prototype.datascript$parser$ITraversable$_postwalk$arity$2 \x3d (function (this__52373__auto__,f53963){
var self__ \x3d this;
var this__52373__auto____$1 \x3d this;
var new__52374__auto__ \x3d (new datascript.parser.Constant(datascript.parser.postwalk(self__.value,f53963),null,null,null));
var temp__5802__auto__ \x3d cljs.core.meta(this__52373__auto____$1);
if(cljs.core.truth_(temp__5802__auto__)){
var meta__52375__auto__ \x3d temp__5802__auto__;
return cljs.core.with_meta(new__52374__auto__,meta__52375__auto__);
} else {
return new__52374__auto__;
}
}));

(datascript.parser.Constant.prototype.datascript$parser$ITraversable$_collect$arity$3 \x3d (function (___52376__auto__,pred53964,acc53965){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
return datascript.parser.collect.cljs$core$IFn$_invoke$arity$3(pred53964,self__.value,acc53965);
}));

(datascript.parser.Constant.prototype.datascript$parser$ITraversable$_collect_vars$arity$2 \x3d (function (___52376__auto__,acc53965){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
return (datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2 ? datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2(acc53965,self__.value) : datascript.parser.collect_vars_acc.call(null,acc53965,self__.value));
}));

(datascript.parser.Constant.getBasis \x3d (function (){
return new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22value\x22,\x22value\x22,1946509744,null)], null);
}));

(datascript.parser.Constant.cljs$lang$type \x3d true);

(datascript.parser.Constant.cljs$lang$ctorPrSeq \x3d (function (this__5389__auto__){
return (new cljs.core.List(null,\x22datascript.parser/Constant\x22,null,(1),null));
}));

(datascript.parser.Constant.cljs$lang$ctorPrWriter \x3d (function (this__5389__auto__,writer__5390__auto__){
return cljs.core._write(writer__5390__auto__,\x22datascript.parser/Constant\x22);
}));

/**
 * Positional factory function for datascript.parser/Constant.
 */
datascript.parser.__GT_Constant \x3d (function datascript$parser$__GT_Constant(value){
return (new datascript.parser.Constant(value,null,null,null));
});

/**
 * Factory function for datascript.parser/Constant, taking a map of keywords to field values.
 */
datascript.parser.map__GT_Constant \x3d (function datascript$parser$map__GT_Constant(G__53970){
var extmap__5385__auto__ \x3d (function (){var G__54003 \x3d cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(G__53970,new cljs.core.Keyword(null,\x22value\x22,\x22value\x22,305978217));
if(cljs.core.record_QMARK_(G__53970)){
return cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,G__54003);
} else {
return G__54003;
}
})();
return (new datascript.parser.Constant(new cljs.core.Keyword(null,\x22value\x22,\x22value\x22,305978217).cljs$core$IFn$_invoke$arity$1(G__53970),null,cljs.core.not_empty(extmap__5385__auto__),null));
});


/**
* @constructor
 * @implements {cljs.core.IRecord}
 * @implements {cljs.core.IKVReduce}
 * @implements {cljs.core.IEquiv}
 * @implements {cljs.core.IHash}
 * @implements {cljs.core.ICollection}
 * @implements {cljs.core.ICounted}
 * @implements {cljs.core.ISeqable}
 * @implements {cljs.core.IMeta}
 * @implements {cljs.core.ICloneable}
 * @implements {cljs.core.IPrintWithWriter}
 * @implements {cljs.core.IIterable}
 * @implements {datascript.parser.ITraversable}
 * @implements {cljs.core.IWithMeta}
 * @implements {cljs.core.IAssociative}
 * @implements {cljs.core.IMap}
 * @implements {cljs.core.ILookup}
*/
datascript.parser.PlainSymbol \x3d (function (symbol,__meta,__extmap,__hash){
this.symbol \x3d symbol;
this.__meta \x3d __meta;
this.__extmap \x3d __extmap;
this.__hash \x3d __hash;
this.cljs$lang$protocol_mask$partition0$ \x3d 2230716170;
this.cljs$lang$protocol_mask$partition1$ \x3d 139264;
});
(datascript.parser.PlainSymbol.prototype.cljs$core$ILookup$_lookup$arity$2 \x3d (function (this__5343__auto__,k__5344__auto__){
var self__ \x3d this;
var this__5343__auto____$1 \x3d this;
return this__5343__auto____$1.cljs$core$ILookup$_lookup$arity$3(null,k__5344__auto__,null);
}));

(datascript.parser.PlainSymbol.prototype.cljs$core$ILookup$_lookup$arity$3 \x3d (function (this__5345__auto__,k54008,else__5346__auto__){
var self__ \x3d this;
var this__5345__auto____$1 \x3d this;
var G__54014 \x3d k54008;
var G__54014__$1 \x3d (((G__54014 instanceof cljs.core.Keyword))?G__54014.fqn:null);
switch (G__54014__$1) {
case \x22symbol\x22:
return self__.symbol;

break;
default:
return cljs.core.get.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k54008,else__5346__auto__);

}
}));

(datascript.parser.PlainSymbol.prototype.cljs$core$IKVReduce$_kv_reduce$arity$3 \x3d (function (this__5363__auto__,f__5364__auto__,init__5365__auto__){
var self__ \x3d this;
var this__5363__auto____$1 \x3d this;
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (ret__5366__auto__,p__54015){
var vec__54016 \x3d p__54015;
var k__5367__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54016,(0),null);
var v__5368__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54016,(1),null);
return (f__5364__auto__.cljs$core$IFn$_invoke$arity$3 ? f__5364__auto__.cljs$core$IFn$_invoke$arity$3(ret__5366__auto__,k__5367__auto__,v__5368__auto__) : f__5364__auto__.call(null,ret__5366__auto__,k__5367__auto__,v__5368__auto__));
}),init__5365__auto__,this__5363__auto____$1);
}));

(datascript.parser.PlainSymbol.prototype.cljs$core$IPrintWithWriter$_pr_writer$arity$3 \x3d (function (this__5358__auto__,writer__5359__auto__,opts__5360__auto__){
var self__ \x3d this;
var this__5358__auto____$1 \x3d this;
var pr_pair__5361__auto__ \x3d (function (keyval__5362__auto__){
return cljs.core.pr_sequential_writer(writer__5359__auto__,cljs.core.pr_writer,\x22\x22,\x22 \x22,\x22\x22,opts__5360__auto__,keyval__5362__auto__);
});
return cljs.core.pr_sequential_writer(writer__5359__auto__,pr_pair__5361__auto__,\x22#datascript.parser.PlainSymbol{\x22,\x22, \x22,\x22}\x22,opts__5360__auto__,cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22symbol\x22,\x22symbol\x22,-1038572696),self__.symbol],null))], null),self__.__extmap));
}));

(datascript.parser.PlainSymbol.prototype.cljs$core$IIterable$_iterator$arity$1 \x3d (function (G__54007){
var self__ \x3d this;
var G__54007__$1 \x3d this;
return (new cljs.core.RecordIter((0),G__54007__$1,1,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22symbol\x22,\x22symbol\x22,-1038572696)], null),(cljs.core.truth_(self__.__extmap)?cljs.core._iterator(self__.__extmap):cljs.core.nil_iter())));
}));

(datascript.parser.PlainSymbol.prototype.cljs$core$IMeta$_meta$arity$1 \x3d (function (this__5341__auto__){
var self__ \x3d this;
var this__5341__auto____$1 \x3d this;
return self__.__meta;
}));

(datascript.parser.PlainSymbol.prototype.cljs$core$ICloneable$_clone$arity$1 \x3d (function (this__5338__auto__){
var self__ \x3d this;
var this__5338__auto____$1 \x3d this;
return (new datascript.parser.PlainSymbol(self__.symbol,self__.__meta,self__.__extmap,self__.__hash));
}));

(datascript.parser.PlainSymbol.prototype.cljs$core$ICounted$_count$arity$1 \x3d (function (this__5347__auto__){
var self__ \x3d this;
var this__5347__auto____$1 \x3d this;
return (1 + cljs.core.count(self__.__extmap));
}));

(datascript.parser.PlainSymbol.prototype.cljs$core$IHash$_hash$arity$1 \x3d (function (this__5339__auto__){
var self__ \x3d this;
var this__5339__auto____$1 \x3d this;
var h__5154__auto__ \x3d self__.__hash;
if((!((h__5154__auto__ \x3d\x3d null)))){
return h__5154__auto__;
} else {
var h__5154__auto____$1 \x3d (function (coll__5340__auto__){
return (1509921913 ^ cljs.core.hash_unordered_coll(coll__5340__auto__));
})(this__5339__auto____$1);
(self__.__hash \x3d h__5154__auto____$1);

return h__5154__auto____$1;
}
}));

(datascript.parser.PlainSymbol.prototype.cljs$core$IEquiv$_equiv$arity$2 \x3d (function (this54009,other54010){
var self__ \x3d this;
var this54009__$1 \x3d this;
return (((!((other54010 \x3d\x3d null)))) \x26\x26 ((((this54009__$1.constructor \x3d\x3d\x3d other54010.constructor)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54009__$1.symbol,other54010.symbol)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54009__$1.__extmap,other54010.__extmap)))))));
}));

(datascript.parser.PlainSymbol.prototype.cljs$core$IMap$_dissoc$arity$2 \x3d (function (this__5353__auto__,k__5354__auto__){
var self__ \x3d this;
var this__5353__auto____$1 \x3d this;
if(cljs.core.contains_QMARK_(new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,\x22symbol\x22,\x22symbol\x22,-1038572696),null], null), null),k__5354__auto__)){
return cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(cljs.core._with_meta(cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,this__5353__auto____$1),self__.__meta),k__5354__auto__);
} else {
return (new datascript.parser.PlainSymbol(self__.symbol,self__.__meta,cljs.core.not_empty(cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(self__.__extmap,k__5354__auto__)),null));
}
}));

(datascript.parser.PlainSymbol.prototype.cljs$core$IAssociative$_contains_key_QMARK_$arity$2 \x3d (function (this__5350__auto__,k54008){
var self__ \x3d this;
var this__5350__auto____$1 \x3d this;
var G__54021 \x3d k54008;
var G__54021__$1 \x3d (((G__54021 instanceof cljs.core.Keyword))?G__54021.fqn:null);
switch (G__54021__$1) {
case \x22symbol\x22:
return true;

break;
default:
return cljs.core.contains_QMARK_(self__.__extmap,k54008);

}
}));

(datascript.parser.PlainSymbol.prototype.cljs$core$IAssociative$_assoc$arity$3 \x3d (function (this__5351__auto__,k__5352__auto__,G__54007){
var self__ \x3d this;
var this__5351__auto____$1 \x3d this;
var pred__54022 \x3d cljs.core.keyword_identical_QMARK_;
var expr__54023 \x3d k__5352__auto__;
if(cljs.core.truth_((pred__54022.cljs$core$IFn$_invoke$arity$2 ? pred__54022.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22symbol\x22,\x22symbol\x22,-1038572696),expr__54023) : pred__54022.call(null,new cljs.core.Keyword(null,\x22symbol\x22,\x22symbol\x22,-1038572696),expr__54023)))){
return (new datascript.parser.PlainSymbol(G__54007,self__.__meta,self__.__extmap,null));
} else {
return (new datascript.parser.PlainSymbol(self__.symbol,self__.__meta,cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k__5352__auto__,G__54007),null));
}
}));

(datascript.parser.PlainSymbol.prototype.cljs$core$ISeqable$_seq$arity$1 \x3d (function (this__5356__auto__){
var self__ \x3d this;
var this__5356__auto____$1 \x3d this;
return cljs.core.seq(cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22symbol\x22,\x22symbol\x22,-1038572696),self__.symbol,null))], null),self__.__extmap));
}));

(datascript.parser.PlainSymbol.prototype.cljs$core$IWithMeta$_with_meta$arity$2 \x3d (function (this__5342__auto__,G__54007){
var self__ \x3d this;
var this__5342__auto____$1 \x3d this;
return (new datascript.parser.PlainSymbol(self__.symbol,G__54007,self__.__extmap,self__.__hash));
}));

(datascript.parser.PlainSymbol.prototype.cljs$core$ICollection$_conj$arity$2 \x3d (function (this__5348__auto__,entry__5349__auto__){
var self__ \x3d this;
var this__5348__auto____$1 \x3d this;
if(cljs.core.vector_QMARK_(entry__5349__auto__)){
return this__5348__auto____$1.cljs$core$IAssociative$_assoc$arity$3(null,cljs.core._nth(entry__5349__auto__,(0)),cljs.core._nth(entry__5349__auto__,(1)));
} else {
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(cljs.core._conj,this__5348__auto____$1,entry__5349__auto__);
}
}));

(datascript.parser.PlainSymbol.prototype.datascript$parser$ITraversable$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.parser.PlainSymbol.prototype.datascript$parser$ITraversable$_postwalk$arity$2 \x3d (function (this__52373__auto__,f54004){
var self__ \x3d this;
var this__52373__auto____$1 \x3d this;
var new__52374__auto__ \x3d (new datascript.parser.PlainSymbol(datascript.parser.postwalk(self__.symbol,f54004),null,null,null));
var temp__5802__auto__ \x3d cljs.core.meta(this__52373__auto____$1);
if(cljs.core.truth_(temp__5802__auto__)){
var meta__52375__auto__ \x3d temp__5802__auto__;
return cljs.core.with_meta(new__52374__auto__,meta__52375__auto__);
} else {
return new__52374__auto__;
}
}));

(datascript.parser.PlainSymbol.prototype.datascript$parser$ITraversable$_collect$arity$3 \x3d (function (___52376__auto__,pred54005,acc54006){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
return datascript.parser.collect.cljs$core$IFn$_invoke$arity$3(pred54005,self__.symbol,acc54006);
}));

(datascript.parser.PlainSymbol.prototype.datascript$parser$ITraversable$_collect_vars$arity$2 \x3d (function (___52376__auto__,acc54006){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
return (datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2 ? datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2(acc54006,self__.symbol) : datascript.parser.collect_vars_acc.call(null,acc54006,self__.symbol));
}));

(datascript.parser.PlainSymbol.getBasis \x3d (function (){
return new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22symbol\x22,\x22symbol\x22,601958831,null)], null);
}));

(datascript.parser.PlainSymbol.cljs$lang$type \x3d true);

(datascript.parser.PlainSymbol.cljs$lang$ctorPrSeq \x3d (function (this__5389__auto__){
return (new cljs.core.List(null,\x22datascript.parser/PlainSymbol\x22,null,(1),null));
}));

(datascript.parser.PlainSymbol.cljs$lang$ctorPrWriter \x3d (function (this__5389__auto__,writer__5390__auto__){
return cljs.core._write(writer__5390__auto__,\x22datascript.parser/PlainSymbol\x22);
}));

/**
 * Positional factory function for datascript.parser/PlainSymbol.
 */
datascript.parser.__GT_PlainSymbol \x3d (function datascript$parser$__GT_PlainSymbol(symbol){
return (new datascript.parser.PlainSymbol(symbol,null,null,null));
});

/**
 * Factory function for datascript.parser/PlainSymbol, taking a map of keywords to field values.
 */
datascript.parser.map__GT_PlainSymbol \x3d (function datascript$parser$map__GT_PlainSymbol(G__54011){
var extmap__5385__auto__ \x3d (function (){var G__54026 \x3d cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(G__54011,new cljs.core.Keyword(null,\x22symbol\x22,\x22symbol\x22,-1038572696));
if(cljs.core.record_QMARK_(G__54011)){
return cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,G__54026);
} else {
return G__54026;
}
})();
return (new datascript.parser.PlainSymbol(new cljs.core.Keyword(null,\x22symbol\x22,\x22symbol\x22,-1038572696).cljs$core$IFn$_invoke$arity$1(G__54011),null,cljs.core.not_empty(extmap__5385__auto__),null));
});

datascript.parser.parse_placeholder \x3d (function datascript$parser$parse_placeholder(form){
if(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Symbol(null,\x22_\x22,\x22_\x22,-1201019570,null),form)){
return (new datascript.parser.Placeholder(null,null,null));
} else {
return null;
}
});
datascript.parser.parse_variable \x3d (function datascript$parser$parse_variable(form){
if((((form instanceof cljs.core.Symbol)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(cljs.core.first(cljs.core.name(form)),\x22?\x22)))){
return (new datascript.parser.Variable(form,null,null,null));
} else {
return null;
}
});
datascript.parser.parse_var_required \x3d (function datascript$parser$parse_var_required(form){
var or__5045__auto__ \x3d datascript.parser.parse_variable(form);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22Cannot parse var, expected symbol starting with ?, got: \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([form], 0))].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22parser\x22,\x22rule-var\x22,\x22parser/rule-var\x22,-1584354459),new cljs.core.Keyword(null,\x22form\x22,\x22form\x22,-1624062471),form], null));
}
});
datascript.parser.parse_src_var \x3d (function datascript$parser$parse_src_var(form){
if((((form instanceof cljs.core.Symbol)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(cljs.core.first(cljs.core.name(form)),\x22$\x22)))){
return (new datascript.parser.SrcVar(form,null,null,null));
} else {
return null;
}
});
datascript.parser.parse_rules_var \x3d (function datascript$parser$parse_rules_var(form){
if(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Symbol(null,\x22%\x22,\x22%\x22,-950237169,null),form)){
return (new datascript.parser.RulesVar(null,null,null));
} else {
return null;
}
});
datascript.parser.parse_constant \x3d (function datascript$parser$parse_constant(form){
if((((form instanceof cljs.core.Symbol)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(cljs.core.first(cljs.core.name(form)),\x22?\x22)))){
return null;
} else {
return (new datascript.parser.Constant(form,null,null,null));
}
});
datascript.parser.parse_plain_symbol \x3d (function datascript$parser$parse_plain_symbol(form){
if((((form instanceof cljs.core.Symbol)) \x26\x26 (((cljs.core.not(datascript.parser.parse_variable(form))) \x26\x26 (((cljs.core.not(datascript.parser.parse_src_var(form))) \x26\x26 (((cljs.core.not(datascript.parser.parse_rules_var(form))) \x26\x26 (cljs.core.not(datascript.parser.parse_placeholder(form))))))))))){
return (new datascript.parser.PlainSymbol(form,null,null,null));
} else {
return null;
}
});
datascript.parser.parse_plain_variable \x3d (function datascript$parser$parse_plain_variable(form){
if(cljs.core.truth_(datascript.parser.parse_plain_symbol(form))){
return (new datascript.parser.Variable(form,null,null,null));
} else {
return null;
}
});
datascript.parser.parse_fn_arg \x3d (function datascript$parser$parse_fn_arg(form){
var or__5045__auto__ \x3d datascript.parser.parse_variable(form);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
var or__5045__auto____$1 \x3d datascript.parser.parse_src_var(form);
if(cljs.core.truth_(or__5045__auto____$1)){
return or__5045__auto____$1;
} else {
return datascript.parser.parse_constant(form);
}
}
});

/**
* @constructor
 * @implements {cljs.core.IRecord}
 * @implements {cljs.core.IKVReduce}
 * @implements {cljs.core.IEquiv}
 * @implements {cljs.core.IHash}
 * @implements {cljs.core.ICollection}
 * @implements {cljs.core.ICounted}
 * @implements {cljs.core.ISeqable}
 * @implements {cljs.core.IMeta}
 * @implements {cljs.core.ICloneable}
 * @implements {cljs.core.IPrintWithWriter}
 * @implements {cljs.core.IIterable}
 * @implements {datascript.parser.ITraversable}
 * @implements {cljs.core.IWithMeta}
 * @implements {cljs.core.IAssociative}
 * @implements {cljs.core.IMap}
 * @implements {cljs.core.ILookup}
*/
datascript.parser.RuleVars \x3d (function (required,free,__meta,__extmap,__hash){
this.required \x3d required;
this.free \x3d free;
this.__meta \x3d __meta;
this.__extmap \x3d __extmap;
this.__hash \x3d __hash;
this.cljs$lang$protocol_mask$partition0$ \x3d 2230716170;
this.cljs$lang$protocol_mask$partition1$ \x3d 139264;
});
(datascript.parser.RuleVars.prototype.cljs$core$ILookup$_lookup$arity$2 \x3d (function (this__5343__auto__,k__5344__auto__){
var self__ \x3d this;
var this__5343__auto____$1 \x3d this;
return this__5343__auto____$1.cljs$core$ILookup$_lookup$arity$3(null,k__5344__auto__,null);
}));

(datascript.parser.RuleVars.prototype.cljs$core$ILookup$_lookup$arity$3 \x3d (function (this__5345__auto__,k54032,else__5346__auto__){
var self__ \x3d this;
var this__5345__auto____$1 \x3d this;
var G__54036 \x3d k54032;
var G__54036__$1 \x3d (((G__54036 instanceof cljs.core.Keyword))?G__54036.fqn:null);
switch (G__54036__$1) {
case \x22required\x22:
return self__.required;

break;
case \x22free\x22:
return self__.free;

break;
default:
return cljs.core.get.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k54032,else__5346__auto__);

}
}));

(datascript.parser.RuleVars.prototype.cljs$core$IKVReduce$_kv_reduce$arity$3 \x3d (function (this__5363__auto__,f__5364__auto__,init__5365__auto__){
var self__ \x3d this;
var this__5363__auto____$1 \x3d this;
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (ret__5366__auto__,p__54041){
var vec__54042 \x3d p__54041;
var k__5367__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54042,(0),null);
var v__5368__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54042,(1),null);
return (f__5364__auto__.cljs$core$IFn$_invoke$arity$3 ? f__5364__auto__.cljs$core$IFn$_invoke$arity$3(ret__5366__auto__,k__5367__auto__,v__5368__auto__) : f__5364__auto__.call(null,ret__5366__auto__,k__5367__auto__,v__5368__auto__));
}),init__5365__auto__,this__5363__auto____$1);
}));

(datascript.parser.RuleVars.prototype.cljs$core$IPrintWithWriter$_pr_writer$arity$3 \x3d (function (this__5358__auto__,writer__5359__auto__,opts__5360__auto__){
var self__ \x3d this;
var this__5358__auto____$1 \x3d this;
var pr_pair__5361__auto__ \x3d (function (keyval__5362__auto__){
return cljs.core.pr_sequential_writer(writer__5359__auto__,cljs.core.pr_writer,\x22\x22,\x22 \x22,\x22\x22,opts__5360__auto__,keyval__5362__auto__);
});
return cljs.core.pr_sequential_writer(writer__5359__auto__,pr_pair__5361__auto__,\x22#datascript.parser.RuleVars{\x22,\x22, \x22,\x22}\x22,opts__5360__auto__,cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22required\x22,\x22required\x22,1807647006),self__.required],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22free\x22,\x22free\x22,801364328),self__.free],null))], null),self__.__extmap));
}));

(datascript.parser.RuleVars.prototype.cljs$core$IIterable$_iterator$arity$1 \x3d (function (G__54031){
var self__ \x3d this;
var G__54031__$1 \x3d this;
return (new cljs.core.RecordIter((0),G__54031__$1,2,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22required\x22,\x22required\x22,1807647006),new cljs.core.Keyword(null,\x22free\x22,\x22free\x22,801364328)], null),(cljs.core.truth_(self__.__extmap)?cljs.core._iterator(self__.__extmap):cljs.core.nil_iter())));
}));

(datascript.parser.RuleVars.prototype.cljs$core$IMeta$_meta$arity$1 \x3d (function (this__5341__auto__){
var self__ \x3d this;
var this__5341__auto____$1 \x3d this;
return self__.__meta;
}));

(datascript.parser.RuleVars.prototype.cljs$core$ICloneable$_clone$arity$1 \x3d (function (this__5338__auto__){
var self__ \x3d this;
var this__5338__auto____$1 \x3d this;
return (new datascript.parser.RuleVars(self__.required,self__.free,self__.__meta,self__.__extmap,self__.__hash));
}));

(datascript.parser.RuleVars.prototype.cljs$core$ICounted$_count$arity$1 \x3d (function (this__5347__auto__){
var self__ \x3d this;
var this__5347__auto____$1 \x3d this;
return (2 + cljs.core.count(self__.__extmap));
}));

(datascript.parser.RuleVars.prototype.cljs$core$IHash$_hash$arity$1 \x3d (function (this__5339__auto__){
var self__ \x3d this;
var this__5339__auto____$1 \x3d this;
var h__5154__auto__ \x3d self__.__hash;
if((!((h__5154__auto__ \x3d\x3d null)))){
return h__5154__auto__;
} else {
var h__5154__auto____$1 \x3d (function (coll__5340__auto__){
return (892963297 ^ cljs.core.hash_unordered_coll(coll__5340__auto__));
})(this__5339__auto____$1);
(self__.__hash \x3d h__5154__auto____$1);

return h__5154__auto____$1;
}
}));

(datascript.parser.RuleVars.prototype.cljs$core$IEquiv$_equiv$arity$2 \x3d (function (this54033,other54034){
var self__ \x3d this;
var this54033__$1 \x3d this;
return (((!((other54034 \x3d\x3d null)))) \x26\x26 ((((this54033__$1.constructor \x3d\x3d\x3d other54034.constructor)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54033__$1.required,other54034.required)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54033__$1.free,other54034.free)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54033__$1.__extmap,other54034.__extmap)))))))));
}));

(datascript.parser.RuleVars.prototype.cljs$core$IMap$_dissoc$arity$2 \x3d (function (this__5353__auto__,k__5354__auto__){
var self__ \x3d this;
var this__5353__auto____$1 \x3d this;
if(cljs.core.contains_QMARK_(new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22free\x22,\x22free\x22,801364328),null,new cljs.core.Keyword(null,\x22required\x22,\x22required\x22,1807647006),null], null), null),k__5354__auto__)){
return cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(cljs.core._with_meta(cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,this__5353__auto____$1),self__.__meta),k__5354__auto__);
} else {
return (new datascript.parser.RuleVars(self__.required,self__.free,self__.__meta,cljs.core.not_empty(cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(self__.__extmap,k__5354__auto__)),null));
}
}));

(datascript.parser.RuleVars.prototype.cljs$core$IAssociative$_contains_key_QMARK_$arity$2 \x3d (function (this__5350__auto__,k54032){
var self__ \x3d this;
var this__5350__auto____$1 \x3d this;
var G__54053 \x3d k54032;
var G__54053__$1 \x3d (((G__54053 instanceof cljs.core.Keyword))?G__54053.fqn:null);
switch (G__54053__$1) {
case \x22required\x22:
case \x22free\x22:
return true;

break;
default:
return cljs.core.contains_QMARK_(self__.__extmap,k54032);

}
}));

(datascript.parser.RuleVars.prototype.cljs$core$IAssociative$_assoc$arity$3 \x3d (function (this__5351__auto__,k__5352__auto__,G__54031){
var self__ \x3d this;
var this__5351__auto____$1 \x3d this;
var pred__54054 \x3d cljs.core.keyword_identical_QMARK_;
var expr__54055 \x3d k__5352__auto__;
if(cljs.core.truth_((pred__54054.cljs$core$IFn$_invoke$arity$2 ? pred__54054.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22required\x22,\x22required\x22,1807647006),expr__54055) : pred__54054.call(null,new cljs.core.Keyword(null,\x22required\x22,\x22required\x22,1807647006),expr__54055)))){
return (new datascript.parser.RuleVars(G__54031,self__.free,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__54054.cljs$core$IFn$_invoke$arity$2 ? pred__54054.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22free\x22,\x22free\x22,801364328),expr__54055) : pred__54054.call(null,new cljs.core.Keyword(null,\x22free\x22,\x22free\x22,801364328),expr__54055)))){
return (new datascript.parser.RuleVars(self__.required,G__54031,self__.__meta,self__.__extmap,null));
} else {
return (new datascript.parser.RuleVars(self__.required,self__.free,self__.__meta,cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k__5352__auto__,G__54031),null));
}
}
}));

(datascript.parser.RuleVars.prototype.cljs$core$ISeqable$_seq$arity$1 \x3d (function (this__5356__auto__){
var self__ \x3d this;
var this__5356__auto____$1 \x3d this;
return cljs.core.seq(cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22required\x22,\x22required\x22,1807647006),self__.required,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22free\x22,\x22free\x22,801364328),self__.free,null))], null),self__.__extmap));
}));

(datascript.parser.RuleVars.prototype.cljs$core$IWithMeta$_with_meta$arity$2 \x3d (function (this__5342__auto__,G__54031){
var self__ \x3d this;
var this__5342__auto____$1 \x3d this;
return (new datascript.parser.RuleVars(self__.required,self__.free,G__54031,self__.__extmap,self__.__hash));
}));

(datascript.parser.RuleVars.prototype.cljs$core$ICollection$_conj$arity$2 \x3d (function (this__5348__auto__,entry__5349__auto__){
var self__ \x3d this;
var this__5348__auto____$1 \x3d this;
if(cljs.core.vector_QMARK_(entry__5349__auto__)){
return this__5348__auto____$1.cljs$core$IAssociative$_assoc$arity$3(null,cljs.core._nth(entry__5349__auto__,(0)),cljs.core._nth(entry__5349__auto__,(1)));
} else {
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(cljs.core._conj,this__5348__auto____$1,entry__5349__auto__);
}
}));

(datascript.parser.RuleVars.prototype.datascript$parser$ITraversable$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.parser.RuleVars.prototype.datascript$parser$ITraversable$_postwalk$arity$2 \x3d (function (this__52373__auto__,f54028){
var self__ \x3d this;
var this__52373__auto____$1 \x3d this;
var new__52374__auto__ \x3d (new datascript.parser.RuleVars(datascript.parser.postwalk(self__.required,f54028),datascript.parser.postwalk(self__.free,f54028),null,null,null));
var temp__5802__auto__ \x3d cljs.core.meta(this__52373__auto____$1);
if(cljs.core.truth_(temp__5802__auto__)){
var meta__52375__auto__ \x3d temp__5802__auto__;
return cljs.core.with_meta(new__52374__auto__,meta__52375__auto__);
} else {
return new__52374__auto__;
}
}));

(datascript.parser.RuleVars.prototype.datascript$parser$ITraversable$_collect$arity$3 \x3d (function (___52376__auto__,pred54029,acc54030){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
return datascript.parser.collect.cljs$core$IFn$_invoke$arity$3(pred54029,self__.free,datascript.parser.collect.cljs$core$IFn$_invoke$arity$3(pred54029,self__.required,acc54030));
}));

(datascript.parser.RuleVars.prototype.datascript$parser$ITraversable$_collect_vars$arity$2 \x3d (function (___52376__auto__,acc54030){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
var G__54061 \x3d (datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2 ? datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2(acc54030,self__.required) : datascript.parser.collect_vars_acc.call(null,acc54030,self__.required));
var G__54062 \x3d self__.free;
return (datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2 ? datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2(G__54061,G__54062) : datascript.parser.collect_vars_acc.call(null,G__54061,G__54062));
}));

(datascript.parser.RuleVars.getBasis \x3d (function (){
return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22required\x22,\x22required\x22,-846788763,null),new cljs.core.Symbol(null,\x22free\x22,\x22free\x22,-1853071441,null)], null);
}));

(datascript.parser.RuleVars.cljs$lang$type \x3d true);

(datascript.parser.RuleVars.cljs$lang$ctorPrSeq \x3d (function (this__5389__auto__){
return (new cljs.core.List(null,\x22datascript.parser/RuleVars\x22,null,(1),null));
}));

(datascript.parser.RuleVars.cljs$lang$ctorPrWriter \x3d (function (this__5389__auto__,writer__5390__auto__){
return cljs.core._write(writer__5390__auto__,\x22datascript.parser/RuleVars\x22);
}));

/**
 * Positional factory function for datascript.parser/RuleVars.
 */
datascript.parser.__GT_RuleVars \x3d (function datascript$parser$__GT_RuleVars(required,free){
return (new datascript.parser.RuleVars(required,free,null,null,null));
});

/**
 * Factory function for datascript.parser/RuleVars, taking a map of keywords to field values.
 */
datascript.parser.map__GT_RuleVars \x3d (function datascript$parser$map__GT_RuleVars(G__54035){
var extmap__5385__auto__ \x3d (function (){var G__54063 \x3d cljs.core.dissoc.cljs$core$IFn$_invoke$arity$variadic(G__54035,new cljs.core.Keyword(null,\x22required\x22,\x22required\x22,1807647006),cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,\x22free\x22,\x22free\x22,801364328)], 0));
if(cljs.core.record_QMARK_(G__54035)){
return cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,G__54063);
} else {
return G__54063;
}
})();
return (new datascript.parser.RuleVars(new cljs.core.Keyword(null,\x22required\x22,\x22required\x22,1807647006).cljs$core$IFn$_invoke$arity$1(G__54035),new cljs.core.Keyword(null,\x22free\x22,\x22free\x22,801364328).cljs$core$IFn$_invoke$arity$1(G__54035),null,cljs.core.not_empty(extmap__5385__auto__),null));
});

datascript.parser.parse_rule_vars \x3d (function datascript$parser$parse_rule_vars(form){
if(cljs.core.sequential_QMARK_(form)){
var vec__54066 \x3d ((cljs.core.sequential_QMARK_(cljs.core.first(form)))?new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.first(form),cljs.core.next(form)], null):new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [null,form], null));
var required \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54066,(0),null);
var rest \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54066,(1),null);
var required_STAR_ \x3d datascript.parser.parse_seq(datascript.parser.parse_var_required,required);
var free_STAR_ \x3d datascript.parser.parse_seq(datascript.parser.parse_var_required,rest);
if(((cljs.core.empty_QMARK_(required_STAR_)) \x26\x26 (cljs.core.empty_QMARK_(free_STAR_)))){
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2(\x22Cannot parse rule-vars, expected [ variable+ | ([ variable+ ] variable*) ]\x22,new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22parser\x22,\x22rule-vars\x22,\x22parser/rule-vars\x22,-1493174969),new cljs.core.Keyword(null,\x22form\x22,\x22form\x22,-1624062471),form], null));
} else {
}

if(cljs.core.truth_(datascript.parser.distinct_QMARK_(cljs.core.concat.cljs$core$IFn$_invoke$arity$2(required_STAR_,free_STAR_)))){
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2(\x22Rule variables should be distinct\x22,new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22parser\x22,\x22rule-vars\x22,\x22parser/rule-vars\x22,-1493174969),new cljs.core.Keyword(null,\x22form\x22,\x22form\x22,-1624062471),form], null));
}

return (new datascript.parser.RuleVars(required_STAR_,free_STAR_,null,null,null));
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2(\x22Cannot parse rule-vars, expected [ variable+ | ([ variable+ ] variable*) ]\x22,new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22parser\x22,\x22rule-vars\x22,\x22parser/rule-vars\x22,-1493174969),new cljs.core.Keyword(null,\x22form\x22,\x22form\x22,-1624062471),form], null));
}
});
datascript.parser.flatten_rule_vars \x3d (function datascript$parser$flatten_rule_vars(rule_vars){
return cljs.core.concat.cljs$core$IFn$_invoke$arity$2((cljs.core.truth_(new cljs.core.Keyword(null,\x22required\x22,\x22required\x22,1807647006).cljs$core$IFn$_invoke$arity$1(rule_vars))?new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.mapv.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22symbol\x22,\x22symbol\x22,-1038572696),new cljs.core.Keyword(null,\x22required\x22,\x22required\x22,1807647006).cljs$core$IFn$_invoke$arity$1(rule_vars))], null):null),cljs.core.mapv.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22symbol\x22,\x22symbol\x22,-1038572696),new cljs.core.Keyword(null,\x22free\x22,\x22free\x22,801364328).cljs$core$IFn$_invoke$arity$1(rule_vars)));
});
datascript.parser.rule_vars_arity \x3d (function datascript$parser$rule_vars_arity(rule_vars){
return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.count(new cljs.core.Keyword(null,\x22required\x22,\x22required\x22,1807647006).cljs$core$IFn$_invoke$arity$1(rule_vars)),cljs.core.count(new cljs.core.Keyword(null,\x22free\x22,\x22free\x22,801364328).cljs$core$IFn$_invoke$arity$1(rule_vars))], null);
});

/**
* @constructor
 * @implements {cljs.core.IRecord}
 * @implements {cljs.core.IKVReduce}
 * @implements {cljs.core.IEquiv}
 * @implements {cljs.core.IHash}
 * @implements {cljs.core.ICollection}
 * @implements {cljs.core.ICounted}
 * @implements {cljs.core.ISeqable}
 * @implements {cljs.core.IMeta}
 * @implements {cljs.core.ICloneable}
 * @implements {cljs.core.IPrintWithWriter}
 * @implements {cljs.core.IIterable}
 * @implements {datascript.parser.ITraversable}
 * @implements {cljs.core.IWithMeta}
 * @implements {cljs.core.IAssociative}
 * @implements {cljs.core.IMap}
 * @implements {cljs.core.ILookup}
*/
datascript.parser.BindIgnore \x3d (function (__meta,__extmap,__hash){
this.__meta \x3d __meta;
this.__extmap \x3d __extmap;
this.__hash \x3d __hash;
this.cljs$lang$protocol_mask$partition0$ \x3d 2230716170;
this.cljs$lang$protocol_mask$partition1$ \x3d 139264;
});
(datascript.parser.BindIgnore.prototype.cljs$core$ILookup$_lookup$arity$2 \x3d (function (this__5343__auto__,k__5344__auto__){
var self__ \x3d this;
var this__5343__auto____$1 \x3d this;
return this__5343__auto____$1.cljs$core$ILookup$_lookup$arity$3(null,k__5344__auto__,null);
}));

(datascript.parser.BindIgnore.prototype.cljs$core$ILookup$_lookup$arity$3 \x3d (function (this__5345__auto__,k54073,else__5346__auto__){
var self__ \x3d this;
var this__5345__auto____$1 \x3d this;
var G__54077 \x3d k54073;
switch (G__54077) {
default:
return cljs.core.get.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k54073,else__5346__auto__);

}
}));

(datascript.parser.BindIgnore.prototype.cljs$core$IKVReduce$_kv_reduce$arity$3 \x3d (function (this__5363__auto__,f__5364__auto__,init__5365__auto__){
var self__ \x3d this;
var this__5363__auto____$1 \x3d this;
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (ret__5366__auto__,p__54083){
var vec__54084 \x3d p__54083;
var k__5367__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54084,(0),null);
var v__5368__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54084,(1),null);
return (f__5364__auto__.cljs$core$IFn$_invoke$arity$3 ? f__5364__auto__.cljs$core$IFn$_invoke$arity$3(ret__5366__auto__,k__5367__auto__,v__5368__auto__) : f__5364__auto__.call(null,ret__5366__auto__,k__5367__auto__,v__5368__auto__));
}),init__5365__auto__,this__5363__auto____$1);
}));

(datascript.parser.BindIgnore.prototype.cljs$core$IPrintWithWriter$_pr_writer$arity$3 \x3d (function (this__5358__auto__,writer__5359__auto__,opts__5360__auto__){
var self__ \x3d this;
var this__5358__auto____$1 \x3d this;
var pr_pair__5361__auto__ \x3d (function (keyval__5362__auto__){
return cljs.core.pr_sequential_writer(writer__5359__auto__,cljs.core.pr_writer,\x22\x22,\x22 \x22,\x22\x22,opts__5360__auto__,keyval__5362__auto__);
});
return cljs.core.pr_sequential_writer(writer__5359__auto__,pr_pair__5361__auto__,\x22#datascript.parser.BindIgnore{\x22,\x22, \x22,\x22}\x22,opts__5360__auto__,cljs.core.concat.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentVector.EMPTY,self__.__extmap));
}));

(datascript.parser.BindIgnore.prototype.cljs$core$IIterable$_iterator$arity$1 \x3d (function (G__54072){
var self__ \x3d this;
var G__54072__$1 \x3d this;
return (new cljs.core.RecordIter((0),G__54072__$1,0,cljs.core.PersistentVector.EMPTY,(cljs.core.truth_(self__.__extmap)?cljs.core._iterator(self__.__extmap):cljs.core.nil_iter())));
}));

(datascript.parser.BindIgnore.prototype.cljs$core$IMeta$_meta$arity$1 \x3d (function (this__5341__auto__){
var self__ \x3d this;
var this__5341__auto____$1 \x3d this;
return self__.__meta;
}));

(datascript.parser.BindIgnore.prototype.cljs$core$ICloneable$_clone$arity$1 \x3d (function (this__5338__auto__){
var self__ \x3d this;
var this__5338__auto____$1 \x3d this;
return (new datascript.parser.BindIgnore(self__.__meta,self__.__extmap,self__.__hash));
}));

(datascript.parser.BindIgnore.prototype.cljs$core$ICounted$_count$arity$1 \x3d (function (this__5347__auto__){
var self__ \x3d this;
var this__5347__auto____$1 \x3d this;
return (0 + cljs.core.count(self__.__extmap));
}));

(datascript.parser.BindIgnore.prototype.cljs$core$IHash$_hash$arity$1 \x3d (function (this__5339__auto__){
var self__ \x3d this;
var this__5339__auto____$1 \x3d this;
var h__5154__auto__ \x3d self__.__hash;
if((!((h__5154__auto__ \x3d\x3d null)))){
return h__5154__auto__;
} else {
var h__5154__auto____$1 \x3d (function (coll__5340__auto__){
return (-890522983 ^ cljs.core.hash_unordered_coll(coll__5340__auto__));
})(this__5339__auto____$1);
(self__.__hash \x3d h__5154__auto____$1);

return h__5154__auto____$1;
}
}));

(datascript.parser.BindIgnore.prototype.cljs$core$IEquiv$_equiv$arity$2 \x3d (function (this54074,other54075){
var self__ \x3d this;
var this54074__$1 \x3d this;
return (((!((other54075 \x3d\x3d null)))) \x26\x26 ((((this54074__$1.constructor \x3d\x3d\x3d other54075.constructor)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54074__$1.__extmap,other54075.__extmap)))));
}));

(datascript.parser.BindIgnore.prototype.cljs$core$IMap$_dissoc$arity$2 \x3d (function (this__5353__auto__,k__5354__auto__){
var self__ \x3d this;
var this__5353__auto____$1 \x3d this;
if(cljs.core.contains_QMARK_(cljs.core.PersistentHashSet.EMPTY,k__5354__auto__)){
return cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(cljs.core._with_meta(cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,this__5353__auto____$1),self__.__meta),k__5354__auto__);
} else {
return (new datascript.parser.BindIgnore(self__.__meta,cljs.core.not_empty(cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(self__.__extmap,k__5354__auto__)),null));
}
}));

(datascript.parser.BindIgnore.prototype.cljs$core$IAssociative$_contains_key_QMARK_$arity$2 \x3d (function (this__5350__auto__,k54073){
var self__ \x3d this;
var this__5350__auto____$1 \x3d this;
return cljs.core.contains_QMARK_(self__.__extmap,k54073);
}));

(datascript.parser.BindIgnore.prototype.cljs$core$IAssociative$_assoc$arity$3 \x3d (function (this__5351__auto__,k__5352__auto__,G__54072){
var self__ \x3d this;
var this__5351__auto____$1 \x3d this;
var pred__54098 \x3d cljs.core.keyword_identical_QMARK_;
var expr__54099 \x3d k__5352__auto__;
return (new datascript.parser.BindIgnore(self__.__meta,cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k__5352__auto__,G__54072),null));
}));

(datascript.parser.BindIgnore.prototype.cljs$core$ISeqable$_seq$arity$1 \x3d (function (this__5356__auto__){
var self__ \x3d this;
var this__5356__auto____$1 \x3d this;
return cljs.core.seq(cljs.core.concat.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentVector.EMPTY,self__.__extmap));
}));

(datascript.parser.BindIgnore.prototype.cljs$core$IWithMeta$_with_meta$arity$2 \x3d (function (this__5342__auto__,G__54072){
var self__ \x3d this;
var this__5342__auto____$1 \x3d this;
return (new datascript.parser.BindIgnore(G__54072,self__.__extmap,self__.__hash));
}));

(datascript.parser.BindIgnore.prototype.cljs$core$ICollection$_conj$arity$2 \x3d (function (this__5348__auto__,entry__5349__auto__){
var self__ \x3d this;
var this__5348__auto____$1 \x3d this;
if(cljs.core.vector_QMARK_(entry__5349__auto__)){
return this__5348__auto____$1.cljs$core$IAssociative$_assoc$arity$3(null,cljs.core._nth(entry__5349__auto__,(0)),cljs.core._nth(entry__5349__auto__,(1)));
} else {
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(cljs.core._conj,this__5348__auto____$1,entry__5349__auto__);
}
}));

(datascript.parser.BindIgnore.prototype.datascript$parser$ITraversable$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.parser.BindIgnore.prototype.datascript$parser$ITraversable$_postwalk$arity$2 \x3d (function (this__52373__auto__,f54069){
var self__ \x3d this;
var this__52373__auto____$1 \x3d this;
var new__52374__auto__ \x3d (new datascript.parser.BindIgnore(null,null,null));
var temp__5802__auto__ \x3d cljs.core.meta(this__52373__auto____$1);
if(cljs.core.truth_(temp__5802__auto__)){
var meta__52375__auto__ \x3d temp__5802__auto__;
return cljs.core.with_meta(new__52374__auto__,meta__52375__auto__);
} else {
return new__52374__auto__;
}
}));

(datascript.parser.BindIgnore.prototype.datascript$parser$ITraversable$_collect$arity$3 \x3d (function (___52376__auto__,pred54070,acc54071){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
return acc54071;
}));

(datascript.parser.BindIgnore.prototype.datascript$parser$ITraversable$_collect_vars$arity$2 \x3d (function (___52376__auto__,acc54071){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
return acc54071;
}));

(datascript.parser.BindIgnore.getBasis \x3d (function (){
return cljs.core.PersistentVector.EMPTY;
}));

(datascript.parser.BindIgnore.cljs$lang$type \x3d true);

(datascript.parser.BindIgnore.cljs$lang$ctorPrSeq \x3d (function (this__5389__auto__){
return (new cljs.core.List(null,\x22datascript.parser/BindIgnore\x22,null,(1),null));
}));

(datascript.parser.BindIgnore.cljs$lang$ctorPrWriter \x3d (function (this__5389__auto__,writer__5390__auto__){
return cljs.core._write(writer__5390__auto__,\x22datascript.parser/BindIgnore\x22);
}));

/**
 * Positional factory function for datascript.parser/BindIgnore.
 */
datascript.parser.__GT_BindIgnore \x3d (function datascript$parser$__GT_BindIgnore(){
return (new datascript.parser.BindIgnore(null,null,null));
});

/**
 * Factory function for datascript.parser/BindIgnore, taking a map of keywords to field values.
 */
datascript.parser.map__GT_BindIgnore \x3d (function datascript$parser$map__GT_BindIgnore(G__54076){
var extmap__5385__auto__ \x3d (function (){var G__54105 \x3d cljs.core.dissoc.cljs$core$IFn$_invoke$arity$1(G__54076);
if(cljs.core.record_QMARK_(G__54076)){
return cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,G__54105);
} else {
return G__54105;
}
})();
return (new datascript.parser.BindIgnore(null,cljs.core.not_empty(extmap__5385__auto__),null));
});


/**
* @constructor
 * @implements {cljs.core.IRecord}
 * @implements {cljs.core.IKVReduce}
 * @implements {cljs.core.IEquiv}
 * @implements {cljs.core.IHash}
 * @implements {cljs.core.ICollection}
 * @implements {cljs.core.ICounted}
 * @implements {cljs.core.ISeqable}
 * @implements {cljs.core.IMeta}
 * @implements {cljs.core.ICloneable}
 * @implements {cljs.core.IPrintWithWriter}
 * @implements {cljs.core.IIterable}
 * @implements {datascript.parser.ITraversable}
 * @implements {cljs.core.IWithMeta}
 * @implements {cljs.core.IAssociative}
 * @implements {cljs.core.IMap}
 * @implements {cljs.core.ILookup}
*/
datascript.parser.BindScalar \x3d (function (variable,__meta,__extmap,__hash){
this.variable \x3d variable;
this.__meta \x3d __meta;
this.__extmap \x3d __extmap;
this.__hash \x3d __hash;
this.cljs$lang$protocol_mask$partition0$ \x3d 2230716170;
this.cljs$lang$protocol_mask$partition1$ \x3d 139264;
});
(datascript.parser.BindScalar.prototype.cljs$core$ILookup$_lookup$arity$2 \x3d (function (this__5343__auto__,k__5344__auto__){
var self__ \x3d this;
var this__5343__auto____$1 \x3d this;
return this__5343__auto____$1.cljs$core$ILookup$_lookup$arity$3(null,k__5344__auto__,null);
}));

(datascript.parser.BindScalar.prototype.cljs$core$ILookup$_lookup$arity$3 \x3d (function (this__5345__auto__,k54111,else__5346__auto__){
var self__ \x3d this;
var this__5345__auto____$1 \x3d this;
var G__54120 \x3d k54111;
var G__54120__$1 \x3d (((G__54120 instanceof cljs.core.Keyword))?G__54120.fqn:null);
switch (G__54120__$1) {
case \x22variable\x22:
return self__.variable;

break;
default:
return cljs.core.get.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k54111,else__5346__auto__);

}
}));

(datascript.parser.BindScalar.prototype.cljs$core$IKVReduce$_kv_reduce$arity$3 \x3d (function (this__5363__auto__,f__5364__auto__,init__5365__auto__){
var self__ \x3d this;
var this__5363__auto____$1 \x3d this;
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (ret__5366__auto__,p__54122){
var vec__54123 \x3d p__54122;
var k__5367__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54123,(0),null);
var v__5368__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54123,(1),null);
return (f__5364__auto__.cljs$core$IFn$_invoke$arity$3 ? f__5364__auto__.cljs$core$IFn$_invoke$arity$3(ret__5366__auto__,k__5367__auto__,v__5368__auto__) : f__5364__auto__.call(null,ret__5366__auto__,k__5367__auto__,v__5368__auto__));
}),init__5365__auto__,this__5363__auto____$1);
}));

(datascript.parser.BindScalar.prototype.cljs$core$IPrintWithWriter$_pr_writer$arity$3 \x3d (function (this__5358__auto__,writer__5359__auto__,opts__5360__auto__){
var self__ \x3d this;
var this__5358__auto____$1 \x3d this;
var pr_pair__5361__auto__ \x3d (function (keyval__5362__auto__){
return cljs.core.pr_sequential_writer(writer__5359__auto__,cljs.core.pr_writer,\x22\x22,\x22 \x22,\x22\x22,opts__5360__auto__,keyval__5362__auto__);
});
return cljs.core.pr_sequential_writer(writer__5359__auto__,pr_pair__5361__auto__,\x22#datascript.parser.BindScalar{\x22,\x22, \x22,\x22}\x22,opts__5360__auto__,cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22variable\x22,\x22variable\x22,-281346492),self__.variable],null))], null),self__.__extmap));
}));

(datascript.parser.BindScalar.prototype.cljs$core$IIterable$_iterator$arity$1 \x3d (function (G__54110){
var self__ \x3d this;
var G__54110__$1 \x3d this;
return (new cljs.core.RecordIter((0),G__54110__$1,1,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22variable\x22,\x22variable\x22,-281346492)], null),(cljs.core.truth_(self__.__extmap)?cljs.core._iterator(self__.__extmap):cljs.core.nil_iter())));
}));

(datascript.parser.BindScalar.prototype.cljs$core$IMeta$_meta$arity$1 \x3d (function (this__5341__auto__){
var self__ \x3d this;
var this__5341__auto____$1 \x3d this;
return self__.__meta;
}));

(datascript.parser.BindScalar.prototype.cljs$core$ICloneable$_clone$arity$1 \x3d (function (this__5338__auto__){
var self__ \x3d this;
var this__5338__auto____$1 \x3d this;
return (new datascript.parser.BindScalar(self__.variable,self__.__meta,self__.__extmap,self__.__hash));
}));

(datascript.parser.BindScalar.prototype.cljs$core$ICounted$_count$arity$1 \x3d (function (this__5347__auto__){
var self__ \x3d this;
var this__5347__auto____$1 \x3d this;
return (1 + cljs.core.count(self__.__extmap));
}));

(datascript.parser.BindScalar.prototype.cljs$core$IHash$_hash$arity$1 \x3d (function (this__5339__auto__){
var self__ \x3d this;
var this__5339__auto____$1 \x3d this;
var h__5154__auto__ \x3d self__.__hash;
if((!((h__5154__auto__ \x3d\x3d null)))){
return h__5154__auto__;
} else {
var h__5154__auto____$1 \x3d (function (coll__5340__auto__){
return (-1522792445 ^ cljs.core.hash_unordered_coll(coll__5340__auto__));
})(this__5339__auto____$1);
(self__.__hash \x3d h__5154__auto____$1);

return h__5154__auto____$1;
}
}));

(datascript.parser.BindScalar.prototype.cljs$core$IEquiv$_equiv$arity$2 \x3d (function (this54112,other54113){
var self__ \x3d this;
var this54112__$1 \x3d this;
return (((!((other54113 \x3d\x3d null)))) \x26\x26 ((((this54112__$1.constructor \x3d\x3d\x3d other54113.constructor)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54112__$1.variable,other54113.variable)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54112__$1.__extmap,other54113.__extmap)))))));
}));

(datascript.parser.BindScalar.prototype.cljs$core$IMap$_dissoc$arity$2 \x3d (function (this__5353__auto__,k__5354__auto__){
var self__ \x3d this;
var this__5353__auto____$1 \x3d this;
if(cljs.core.contains_QMARK_(new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,\x22variable\x22,\x22variable\x22,-281346492),null], null), null),k__5354__auto__)){
return cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(cljs.core._with_meta(cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,this__5353__auto____$1),self__.__meta),k__5354__auto__);
} else {
return (new datascript.parser.BindScalar(self__.variable,self__.__meta,cljs.core.not_empty(cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(self__.__extmap,k__5354__auto__)),null));
}
}));

(datascript.parser.BindScalar.prototype.cljs$core$IAssociative$_contains_key_QMARK_$arity$2 \x3d (function (this__5350__auto__,k54111){
var self__ \x3d this;
var this__5350__auto____$1 \x3d this;
var G__54130 \x3d k54111;
var G__54130__$1 \x3d (((G__54130 instanceof cljs.core.Keyword))?G__54130.fqn:null);
switch (G__54130__$1) {
case \x22variable\x22:
return true;

break;
default:
return cljs.core.contains_QMARK_(self__.__extmap,k54111);

}
}));

(datascript.parser.BindScalar.prototype.cljs$core$IAssociative$_assoc$arity$3 \x3d (function (this__5351__auto__,k__5352__auto__,G__54110){
var self__ \x3d this;
var this__5351__auto____$1 \x3d this;
var pred__54131 \x3d cljs.core.keyword_identical_QMARK_;
var expr__54132 \x3d k__5352__auto__;
if(cljs.core.truth_((pred__54131.cljs$core$IFn$_invoke$arity$2 ? pred__54131.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22variable\x22,\x22variable\x22,-281346492),expr__54132) : pred__54131.call(null,new cljs.core.Keyword(null,\x22variable\x22,\x22variable\x22,-281346492),expr__54132)))){
return (new datascript.parser.BindScalar(G__54110,self__.__meta,self__.__extmap,null));
} else {
return (new datascript.parser.BindScalar(self__.variable,self__.__meta,cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k__5352__auto__,G__54110),null));
}
}));

(datascript.parser.BindScalar.prototype.cljs$core$ISeqable$_seq$arity$1 \x3d (function (this__5356__auto__){
var self__ \x3d this;
var this__5356__auto____$1 \x3d this;
return cljs.core.seq(cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22variable\x22,\x22variable\x22,-281346492),self__.variable,null))], null),self__.__extmap));
}));

(datascript.parser.BindScalar.prototype.cljs$core$IWithMeta$_with_meta$arity$2 \x3d (function (this__5342__auto__,G__54110){
var self__ \x3d this;
var this__5342__auto____$1 \x3d this;
return (new datascript.parser.BindScalar(self__.variable,G__54110,self__.__extmap,self__.__hash));
}));

(datascript.parser.BindScalar.prototype.cljs$core$ICollection$_conj$arity$2 \x3d (function (this__5348__auto__,entry__5349__auto__){
var self__ \x3d this;
var this__5348__auto____$1 \x3d this;
if(cljs.core.vector_QMARK_(entry__5349__auto__)){
return this__5348__auto____$1.cljs$core$IAssociative$_assoc$arity$3(null,cljs.core._nth(entry__5349__auto__,(0)),cljs.core._nth(entry__5349__auto__,(1)));
} else {
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(cljs.core._conj,this__5348__auto____$1,entry__5349__auto__);
}
}));

(datascript.parser.BindScalar.prototype.datascript$parser$ITraversable$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.parser.BindScalar.prototype.datascript$parser$ITraversable$_postwalk$arity$2 \x3d (function (this__52373__auto__,f54106){
var self__ \x3d this;
var this__52373__auto____$1 \x3d this;
var new__52374__auto__ \x3d (new datascript.parser.BindScalar(datascript.parser.postwalk(self__.variable,f54106),null,null,null));
var temp__5802__auto__ \x3d cljs.core.meta(this__52373__auto____$1);
if(cljs.core.truth_(temp__5802__auto__)){
var meta__52375__auto__ \x3d temp__5802__auto__;
return cljs.core.with_meta(new__52374__auto__,meta__52375__auto__);
} else {
return new__52374__auto__;
}
}));

(datascript.parser.BindScalar.prototype.datascript$parser$ITraversable$_collect$arity$3 \x3d (function (___52376__auto__,pred54107,acc54108){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
return datascript.parser.collect.cljs$core$IFn$_invoke$arity$3(pred54107,self__.variable,acc54108);
}));

(datascript.parser.BindScalar.prototype.datascript$parser$ITraversable$_collect_vars$arity$2 \x3d (function (___52376__auto__,acc54108){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
return (datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2 ? datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2(acc54108,self__.variable) : datascript.parser.collect_vars_acc.call(null,acc54108,self__.variable));
}));

(datascript.parser.BindScalar.getBasis \x3d (function (){
return new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22variable\x22,\x22variable\x22,1359185035,null)], null);
}));

(datascript.parser.BindScalar.cljs$lang$type \x3d true);

(datascript.parser.BindScalar.cljs$lang$ctorPrSeq \x3d (function (this__5389__auto__){
return (new cljs.core.List(null,\x22datascript.parser/BindScalar\x22,null,(1),null));
}));

(datascript.parser.BindScalar.cljs$lang$ctorPrWriter \x3d (function (this__5389__auto__,writer__5390__auto__){
return cljs.core._write(writer__5390__auto__,\x22datascript.parser/BindScalar\x22);
}));

/**
 * Positional factory function for datascript.parser/BindScalar.
 */
datascript.parser.__GT_BindScalar \x3d (function datascript$parser$__GT_BindScalar(variable){
return (new datascript.parser.BindScalar(variable,null,null,null));
});

/**
 * Factory function for datascript.parser/BindScalar, taking a map of keywords to field values.
 */
datascript.parser.map__GT_BindScalar \x3d (function datascript$parser$map__GT_BindScalar(G__54114){
var extmap__5385__auto__ \x3d (function (){var G__54140 \x3d cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(G__54114,new cljs.core.Keyword(null,\x22variable\x22,\x22variable\x22,-281346492));
if(cljs.core.record_QMARK_(G__54114)){
return cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,G__54140);
} else {
return G__54140;
}
})();
return (new datascript.parser.BindScalar(new cljs.core.Keyword(null,\x22variable\x22,\x22variable\x22,-281346492).cljs$core$IFn$_invoke$arity$1(G__54114),null,cljs.core.not_empty(extmap__5385__auto__),null));
});


/**
* @constructor
 * @implements {cljs.core.IRecord}
 * @implements {cljs.core.IKVReduce}
 * @implements {cljs.core.IEquiv}
 * @implements {cljs.core.IHash}
 * @implements {cljs.core.ICollection}
 * @implements {cljs.core.ICounted}
 * @implements {cljs.core.ISeqable}
 * @implements {cljs.core.IMeta}
 * @implements {cljs.core.ICloneable}
 * @implements {cljs.core.IPrintWithWriter}
 * @implements {cljs.core.IIterable}
 * @implements {datascript.parser.ITraversable}
 * @implements {cljs.core.IWithMeta}
 * @implements {cljs.core.IAssociative}
 * @implements {cljs.core.IMap}
 * @implements {cljs.core.ILookup}
*/
datascript.parser.BindTuple \x3d (function (bindings,__meta,__extmap,__hash){
this.bindings \x3d bindings;
this.__meta \x3d __meta;
this.__extmap \x3d __extmap;
this.__hash \x3d __hash;
this.cljs$lang$protocol_mask$partition0$ \x3d 2230716170;
this.cljs$lang$protocol_mask$partition1$ \x3d 139264;
});
(datascript.parser.BindTuple.prototype.cljs$core$ILookup$_lookup$arity$2 \x3d (function (this__5343__auto__,k__5344__auto__){
var self__ \x3d this;
var this__5343__auto____$1 \x3d this;
return this__5343__auto____$1.cljs$core$ILookup$_lookup$arity$3(null,k__5344__auto__,null);
}));

(datascript.parser.BindTuple.prototype.cljs$core$ILookup$_lookup$arity$3 \x3d (function (this__5345__auto__,k54145,else__5346__auto__){
var self__ \x3d this;
var this__5345__auto____$1 \x3d this;
var G__54150 \x3d k54145;
var G__54150__$1 \x3d (((G__54150 instanceof cljs.core.Keyword))?G__54150.fqn:null);
switch (G__54150__$1) {
case \x22bindings\x22:
return self__.bindings;

break;
default:
return cljs.core.get.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k54145,else__5346__auto__);

}
}));

(datascript.parser.BindTuple.prototype.cljs$core$IKVReduce$_kv_reduce$arity$3 \x3d (function (this__5363__auto__,f__5364__auto__,init__5365__auto__){
var self__ \x3d this;
var this__5363__auto____$1 \x3d this;
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (ret__5366__auto__,p__54156){
var vec__54157 \x3d p__54156;
var k__5367__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54157,(0),null);
var v__5368__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54157,(1),null);
return (f__5364__auto__.cljs$core$IFn$_invoke$arity$3 ? f__5364__auto__.cljs$core$IFn$_invoke$arity$3(ret__5366__auto__,k__5367__auto__,v__5368__auto__) : f__5364__auto__.call(null,ret__5366__auto__,k__5367__auto__,v__5368__auto__));
}),init__5365__auto__,this__5363__auto____$1);
}));

(datascript.parser.BindTuple.prototype.cljs$core$IPrintWithWriter$_pr_writer$arity$3 \x3d (function (this__5358__auto__,writer__5359__auto__,opts__5360__auto__){
var self__ \x3d this;
var this__5358__auto____$1 \x3d this;
var pr_pair__5361__auto__ \x3d (function (keyval__5362__auto__){
return cljs.core.pr_sequential_writer(writer__5359__auto__,cljs.core.pr_writer,\x22\x22,\x22 \x22,\x22\x22,opts__5360__auto__,keyval__5362__auto__);
});
return cljs.core.pr_sequential_writer(writer__5359__auto__,pr_pair__5361__auto__,\x22#datascript.parser.BindTuple{\x22,\x22, \x22,\x22}\x22,opts__5360__auto__,cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22bindings\x22,\x22bindings\x22,1271397192),self__.bindings],null))], null),self__.__extmap));
}));

(datascript.parser.BindTuple.prototype.cljs$core$IIterable$_iterator$arity$1 \x3d (function (G__54144){
var self__ \x3d this;
var G__54144__$1 \x3d this;
return (new cljs.core.RecordIter((0),G__54144__$1,1,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22bindings\x22,\x22bindings\x22,1271397192)], null),(cljs.core.truth_(self__.__extmap)?cljs.core._iterator(self__.__extmap):cljs.core.nil_iter())));
}));

(datascript.parser.BindTuple.prototype.cljs$core$IMeta$_meta$arity$1 \x3d (function (this__5341__auto__){
var self__ \x3d this;
var this__5341__auto____$1 \x3d this;
return self__.__meta;
}));

(datascript.parser.BindTuple.prototype.cljs$core$ICloneable$_clone$arity$1 \x3d (function (this__5338__auto__){
var self__ \x3d this;
var this__5338__auto____$1 \x3d this;
return (new datascript.parser.BindTuple(self__.bindings,self__.__meta,self__.__extmap,self__.__hash));
}));

(datascript.parser.BindTuple.prototype.cljs$core$ICounted$_count$arity$1 \x3d (function (this__5347__auto__){
var self__ \x3d this;
var this__5347__auto____$1 \x3d this;
return (1 + cljs.core.count(self__.__extmap));
}));

(datascript.parser.BindTuple.prototype.cljs$core$IHash$_hash$arity$1 \x3d (function (this__5339__auto__){
var self__ \x3d this;
var this__5339__auto____$1 \x3d this;
var h__5154__auto__ \x3d self__.__hash;
if((!((h__5154__auto__ \x3d\x3d null)))){
return h__5154__auto__;
} else {
var h__5154__auto____$1 \x3d (function (coll__5340__auto__){
return (-1637239347 ^ cljs.core.hash_unordered_coll(coll__5340__auto__));
})(this__5339__auto____$1);
(self__.__hash \x3d h__5154__auto____$1);

return h__5154__auto____$1;
}
}));

(datascript.parser.BindTuple.prototype.cljs$core$IEquiv$_equiv$arity$2 \x3d (function (this54146,other54147){
var self__ \x3d this;
var this54146__$1 \x3d this;
return (((!((other54147 \x3d\x3d null)))) \x26\x26 ((((this54146__$1.constructor \x3d\x3d\x3d other54147.constructor)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54146__$1.bindings,other54147.bindings)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54146__$1.__extmap,other54147.__extmap)))))));
}));

(datascript.parser.BindTuple.prototype.cljs$core$IMap$_dissoc$arity$2 \x3d (function (this__5353__auto__,k__5354__auto__){
var self__ \x3d this;
var this__5353__auto____$1 \x3d this;
if(cljs.core.contains_QMARK_(new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,\x22bindings\x22,\x22bindings\x22,1271397192),null], null), null),k__5354__auto__)){
return cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(cljs.core._with_meta(cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,this__5353__auto____$1),self__.__meta),k__5354__auto__);
} else {
return (new datascript.parser.BindTuple(self__.bindings,self__.__meta,cljs.core.not_empty(cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(self__.__extmap,k__5354__auto__)),null));
}
}));

(datascript.parser.BindTuple.prototype.cljs$core$IAssociative$_contains_key_QMARK_$arity$2 \x3d (function (this__5350__auto__,k54145){
var self__ \x3d this;
var this__5350__auto____$1 \x3d this;
var G__54165 \x3d k54145;
var G__54165__$1 \x3d (((G__54165 instanceof cljs.core.Keyword))?G__54165.fqn:null);
switch (G__54165__$1) {
case \x22bindings\x22:
return true;

break;
default:
return cljs.core.contains_QMARK_(self__.__extmap,k54145);

}
}));

(datascript.parser.BindTuple.prototype.cljs$core$IAssociative$_assoc$arity$3 \x3d (function (this__5351__auto__,k__5352__auto__,G__54144){
var self__ \x3d this;
var this__5351__auto____$1 \x3d this;
var pred__54166 \x3d cljs.core.keyword_identical_QMARK_;
var expr__54167 \x3d k__5352__auto__;
if(cljs.core.truth_((pred__54166.cljs$core$IFn$_invoke$arity$2 ? pred__54166.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22bindings\x22,\x22bindings\x22,1271397192),expr__54167) : pred__54166.call(null,new cljs.core.Keyword(null,\x22bindings\x22,\x22bindings\x22,1271397192),expr__54167)))){
return (new datascript.parser.BindTuple(G__54144,self__.__meta,self__.__extmap,null));
} else {
return (new datascript.parser.BindTuple(self__.bindings,self__.__meta,cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k__5352__auto__,G__54144),null));
}
}));

(datascript.parser.BindTuple.prototype.cljs$core$ISeqable$_seq$arity$1 \x3d (function (this__5356__auto__){
var self__ \x3d this;
var this__5356__auto____$1 \x3d this;
return cljs.core.seq(cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22bindings\x22,\x22bindings\x22,1271397192),self__.bindings,null))], null),self__.__extmap));
}));

(datascript.parser.BindTuple.prototype.cljs$core$IWithMeta$_with_meta$arity$2 \x3d (function (this__5342__auto__,G__54144){
var self__ \x3d this;
var this__5342__auto____$1 \x3d this;
return (new datascript.parser.BindTuple(self__.bindings,G__54144,self__.__extmap,self__.__hash));
}));

(datascript.parser.BindTuple.prototype.cljs$core$ICollection$_conj$arity$2 \x3d (function (this__5348__auto__,entry__5349__auto__){
var self__ \x3d this;
var this__5348__auto____$1 \x3d this;
if(cljs.core.vector_QMARK_(entry__5349__auto__)){
return this__5348__auto____$1.cljs$core$IAssociative$_assoc$arity$3(null,cljs.core._nth(entry__5349__auto__,(0)),cljs.core._nth(entry__5349__auto__,(1)));
} else {
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(cljs.core._conj,this__5348__auto____$1,entry__5349__auto__);
}
}));

(datascript.parser.BindTuple.prototype.datascript$parser$ITraversable$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.parser.BindTuple.prototype.datascript$parser$ITraversable$_postwalk$arity$2 \x3d (function (this__52373__auto__,f54141){
var self__ \x3d this;
var this__52373__auto____$1 \x3d this;
var new__52374__auto__ \x3d (new datascript.parser.BindTuple(datascript.parser.postwalk(self__.bindings,f54141),null,null,null));
var temp__5802__auto__ \x3d cljs.core.meta(this__52373__auto____$1);
if(cljs.core.truth_(temp__5802__auto__)){
var meta__52375__auto__ \x3d temp__5802__auto__;
return cljs.core.with_meta(new__52374__auto__,meta__52375__auto__);
} else {
return new__52374__auto__;
}
}));

(datascript.parser.BindTuple.prototype.datascript$parser$ITraversable$_collect$arity$3 \x3d (function (___52376__auto__,pred54142,acc54143){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
return datascript.parser.collect.cljs$core$IFn$_invoke$arity$3(pred54142,self__.bindings,acc54143);
}));

(datascript.parser.BindTuple.prototype.datascript$parser$ITraversable$_collect_vars$arity$2 \x3d (function (___52376__auto__,acc54143){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
return (datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2 ? datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2(acc54143,self__.bindings) : datascript.parser.collect_vars_acc.call(null,acc54143,self__.bindings));
}));

(datascript.parser.BindTuple.getBasis \x3d (function (){
return new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22bindings\x22,\x22bindings\x22,-1383038577,null)], null);
}));

(datascript.parser.BindTuple.cljs$lang$type \x3d true);

(datascript.parser.BindTuple.cljs$lang$ctorPrSeq \x3d (function (this__5389__auto__){
return (new cljs.core.List(null,\x22datascript.parser/BindTuple\x22,null,(1),null));
}));

(datascript.parser.BindTuple.cljs$lang$ctorPrWriter \x3d (function (this__5389__auto__,writer__5390__auto__){
return cljs.core._write(writer__5390__auto__,\x22datascript.parser/BindTuple\x22);
}));

/**
 * Positional factory function for datascript.parser/BindTuple.
 */
datascript.parser.__GT_BindTuple \x3d (function datascript$parser$__GT_BindTuple(bindings){
return (new datascript.parser.BindTuple(bindings,null,null,null));
});

/**
 * Factory function for datascript.parser/BindTuple, taking a map of keywords to field values.
 */
datascript.parser.map__GT_BindTuple \x3d (function datascript$parser$map__GT_BindTuple(G__54148){
var extmap__5385__auto__ \x3d (function (){var G__54173 \x3d cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(G__54148,new cljs.core.Keyword(null,\x22bindings\x22,\x22bindings\x22,1271397192));
if(cljs.core.record_QMARK_(G__54148)){
return cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,G__54173);
} else {
return G__54173;
}
})();
return (new datascript.parser.BindTuple(new cljs.core.Keyword(null,\x22bindings\x22,\x22bindings\x22,1271397192).cljs$core$IFn$_invoke$arity$1(G__54148),null,cljs.core.not_empty(extmap__5385__auto__),null));
});


/**
* @constructor
 * @implements {cljs.core.IRecord}
 * @implements {cljs.core.IKVReduce}
 * @implements {cljs.core.IEquiv}
 * @implements {cljs.core.IHash}
 * @implements {cljs.core.ICollection}
 * @implements {cljs.core.ICounted}
 * @implements {cljs.core.ISeqable}
 * @implements {cljs.core.IMeta}
 * @implements {cljs.core.ICloneable}
 * @implements {cljs.core.IPrintWithWriter}
 * @implements {cljs.core.IIterable}
 * @implements {datascript.parser.ITraversable}
 * @implements {cljs.core.IWithMeta}
 * @implements {cljs.core.IAssociative}
 * @implements {cljs.core.IMap}
 * @implements {cljs.core.ILookup}
*/
datascript.parser.BindColl \x3d (function (binding,__meta,__extmap,__hash){
this.binding \x3d binding;
this.__meta \x3d __meta;
this.__extmap \x3d __extmap;
this.__hash \x3d __hash;
this.cljs$lang$protocol_mask$partition0$ \x3d 2230716170;
this.cljs$lang$protocol_mask$partition1$ \x3d 139264;
});
(datascript.parser.BindColl.prototype.cljs$core$ILookup$_lookup$arity$2 \x3d (function (this__5343__auto__,k__5344__auto__){
var self__ \x3d this;
var this__5343__auto____$1 \x3d this;
return this__5343__auto____$1.cljs$core$ILookup$_lookup$arity$3(null,k__5344__auto__,null);
}));

(datascript.parser.BindColl.prototype.cljs$core$ILookup$_lookup$arity$3 \x3d (function (this__5345__auto__,k54178,else__5346__auto__){
var self__ \x3d this;
var this__5345__auto____$1 \x3d this;
var G__54182 \x3d k54178;
var G__54182__$1 \x3d (((G__54182 instanceof cljs.core.Keyword))?G__54182.fqn:null);
switch (G__54182__$1) {
case \x22binding\x22:
return self__.binding;

break;
default:
return cljs.core.get.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k54178,else__5346__auto__);

}
}));

(datascript.parser.BindColl.prototype.cljs$core$IKVReduce$_kv_reduce$arity$3 \x3d (function (this__5363__auto__,f__5364__auto__,init__5365__auto__){
var self__ \x3d this;
var this__5363__auto____$1 \x3d this;
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (ret__5366__auto__,p__54183){
var vec__54186 \x3d p__54183;
var k__5367__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54186,(0),null);
var v__5368__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54186,(1),null);
return (f__5364__auto__.cljs$core$IFn$_invoke$arity$3 ? f__5364__auto__.cljs$core$IFn$_invoke$arity$3(ret__5366__auto__,k__5367__auto__,v__5368__auto__) : f__5364__auto__.call(null,ret__5366__auto__,k__5367__auto__,v__5368__auto__));
}),init__5365__auto__,this__5363__auto____$1);
}));

(datascript.parser.BindColl.prototype.cljs$core$IPrintWithWriter$_pr_writer$arity$3 \x3d (function (this__5358__auto__,writer__5359__auto__,opts__5360__auto__){
var self__ \x3d this;
var this__5358__auto____$1 \x3d this;
var pr_pair__5361__auto__ \x3d (function (keyval__5362__auto__){
return cljs.core.pr_sequential_writer(writer__5359__auto__,cljs.core.pr_writer,\x22\x22,\x22 \x22,\x22\x22,opts__5360__auto__,keyval__5362__auto__);
});
return cljs.core.pr_sequential_writer(writer__5359__auto__,pr_pair__5361__auto__,\x22#datascript.parser.BindColl{\x22,\x22, \x22,\x22}\x22,opts__5360__auto__,cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22binding\x22,\x22binding\x22,539932593),self__.binding],null))], null),self__.__extmap));
}));

(datascript.parser.BindColl.prototype.cljs$core$IIterable$_iterator$arity$1 \x3d (function (G__54177){
var self__ \x3d this;
var G__54177__$1 \x3d this;
return (new cljs.core.RecordIter((0),G__54177__$1,1,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22binding\x22,\x22binding\x22,539932593)], null),(cljs.core.truth_(self__.__extmap)?cljs.core._iterator(self__.__extmap):cljs.core.nil_iter())));
}));

(datascript.parser.BindColl.prototype.cljs$core$IMeta$_meta$arity$1 \x3d (function (this__5341__auto__){
var self__ \x3d this;
var this__5341__auto____$1 \x3d this;
return self__.__meta;
}));

(datascript.parser.BindColl.prototype.cljs$core$ICloneable$_clone$arity$1 \x3d (function (this__5338__auto__){
var self__ \x3d this;
var this__5338__auto____$1 \x3d this;
return (new datascript.parser.BindColl(self__.binding,self__.__meta,self__.__extmap,self__.__hash));
}));

(datascript.parser.BindColl.prototype.cljs$core$ICounted$_count$arity$1 \x3d (function (this__5347__auto__){
var self__ \x3d this;
var this__5347__auto____$1 \x3d this;
return (1 + cljs.core.count(self__.__extmap));
}));

(datascript.parser.BindColl.prototype.cljs$core$IHash$_hash$arity$1 \x3d (function (this__5339__auto__){
var self__ \x3d this;
var this__5339__auto____$1 \x3d this;
var h__5154__auto__ \x3d self__.__hash;
if((!((h__5154__auto__ \x3d\x3d null)))){
return h__5154__auto__;
} else {
var h__5154__auto____$1 \x3d (function (coll__5340__auto__){
return (-1930368089 ^ cljs.core.hash_unordered_coll(coll__5340__auto__));
})(this__5339__auto____$1);
(self__.__hash \x3d h__5154__auto____$1);

return h__5154__auto____$1;
}
}));

(datascript.parser.BindColl.prototype.cljs$core$IEquiv$_equiv$arity$2 \x3d (function (this54179,other54180){
var self__ \x3d this;
var this54179__$1 \x3d this;
return (((!((other54180 \x3d\x3d null)))) \x26\x26 ((((this54179__$1.constructor \x3d\x3d\x3d other54180.constructor)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54179__$1.binding,other54180.binding)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54179__$1.__extmap,other54180.__extmap)))))));
}));

(datascript.parser.BindColl.prototype.cljs$core$IMap$_dissoc$arity$2 \x3d (function (this__5353__auto__,k__5354__auto__){
var self__ \x3d this;
var this__5353__auto____$1 \x3d this;
if(cljs.core.contains_QMARK_(new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,\x22binding\x22,\x22binding\x22,539932593),null], null), null),k__5354__auto__)){
return cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(cljs.core._with_meta(cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,this__5353__auto____$1),self__.__meta),k__5354__auto__);
} else {
return (new datascript.parser.BindColl(self__.binding,self__.__meta,cljs.core.not_empty(cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(self__.__extmap,k__5354__auto__)),null));
}
}));

(datascript.parser.BindColl.prototype.cljs$core$IAssociative$_contains_key_QMARK_$arity$2 \x3d (function (this__5350__auto__,k54178){
var self__ \x3d this;
var this__5350__auto____$1 \x3d this;
var G__54190 \x3d k54178;
var G__54190__$1 \x3d (((G__54190 instanceof cljs.core.Keyword))?G__54190.fqn:null);
switch (G__54190__$1) {
case \x22binding\x22:
return true;

break;
default:
return cljs.core.contains_QMARK_(self__.__extmap,k54178);

}
}));

(datascript.parser.BindColl.prototype.cljs$core$IAssociative$_assoc$arity$3 \x3d (function (this__5351__auto__,k__5352__auto__,G__54177){
var self__ \x3d this;
var this__5351__auto____$1 \x3d this;
var pred__54191 \x3d cljs.core.keyword_identical_QMARK_;
var expr__54192 \x3d k__5352__auto__;
if(cljs.core.truth_((pred__54191.cljs$core$IFn$_invoke$arity$2 ? pred__54191.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22binding\x22,\x22binding\x22,539932593),expr__54192) : pred__54191.call(null,new cljs.core.Keyword(null,\x22binding\x22,\x22binding\x22,539932593),expr__54192)))){
return (new datascript.parser.BindColl(G__54177,self__.__meta,self__.__extmap,null));
} else {
return (new datascript.parser.BindColl(self__.binding,self__.__meta,cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k__5352__auto__,G__54177),null));
}
}));

(datascript.parser.BindColl.prototype.cljs$core$ISeqable$_seq$arity$1 \x3d (function (this__5356__auto__){
var self__ \x3d this;
var this__5356__auto____$1 \x3d this;
return cljs.core.seq(cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22binding\x22,\x22binding\x22,539932593),self__.binding,null))], null),self__.__extmap));
}));

(datascript.parser.BindColl.prototype.cljs$core$IWithMeta$_with_meta$arity$2 \x3d (function (this__5342__auto__,G__54177){
var self__ \x3d this;
var this__5342__auto____$1 \x3d this;
return (new datascript.parser.BindColl(self__.binding,G__54177,self__.__extmap,self__.__hash));
}));

(datascript.parser.BindColl.prototype.cljs$core$ICollection$_conj$arity$2 \x3d (function (this__5348__auto__,entry__5349__auto__){
var self__ \x3d this;
var this__5348__auto____$1 \x3d this;
if(cljs.core.vector_QMARK_(entry__5349__auto__)){
return this__5348__auto____$1.cljs$core$IAssociative$_assoc$arity$3(null,cljs.core._nth(entry__5349__auto__,(0)),cljs.core._nth(entry__5349__auto__,(1)));
} else {
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(cljs.core._conj,this__5348__auto____$1,entry__5349__auto__);
}
}));

(datascript.parser.BindColl.prototype.datascript$parser$ITraversable$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.parser.BindColl.prototype.datascript$parser$ITraversable$_postwalk$arity$2 \x3d (function (this__52373__auto__,f54174){
var self__ \x3d this;
var this__52373__auto____$1 \x3d this;
var new__52374__auto__ \x3d (new datascript.parser.BindColl(datascript.parser.postwalk(self__.binding,f54174),null,null,null));
var temp__5802__auto__ \x3d cljs.core.meta(this__52373__auto____$1);
if(cljs.core.truth_(temp__5802__auto__)){
var meta__52375__auto__ \x3d temp__5802__auto__;
return cljs.core.with_meta(new__52374__auto__,meta__52375__auto__);
} else {
return new__52374__auto__;
}
}));

(datascript.parser.BindColl.prototype.datascript$parser$ITraversable$_collect$arity$3 \x3d (function (___52376__auto__,pred54175,acc54176){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
return datascript.parser.collect.cljs$core$IFn$_invoke$arity$3(pred54175,self__.binding,acc54176);
}));

(datascript.parser.BindColl.prototype.datascript$parser$ITraversable$_collect_vars$arity$2 \x3d (function (___52376__auto__,acc54176){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
return (datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2 ? datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2(acc54176,self__.binding) : datascript.parser.collect_vars_acc.call(null,acc54176,self__.binding));
}));

(datascript.parser.BindColl.getBasis \x3d (function (){
return new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22binding\x22,\x22binding\x22,-2114503176,null)], null);
}));

(datascript.parser.BindColl.cljs$lang$type \x3d true);

(datascript.parser.BindColl.cljs$lang$ctorPrSeq \x3d (function (this__5389__auto__){
return (new cljs.core.List(null,\x22datascript.parser/BindColl\x22,null,(1),null));
}));

(datascript.parser.BindColl.cljs$lang$ctorPrWriter \x3d (function (this__5389__auto__,writer__5390__auto__){
return cljs.core._write(writer__5390__auto__,\x22datascript.parser/BindColl\x22);
}));

/**
 * Positional factory function for datascript.parser/BindColl.
 */
datascript.parser.__GT_BindColl \x3d (function datascript$parser$__GT_BindColl(binding){
return (new datascript.parser.BindColl(binding,null,null,null));
});

/**
 * Factory function for datascript.parser/BindColl, taking a map of keywords to field values.
 */
datascript.parser.map__GT_BindColl \x3d (function datascript$parser$map__GT_BindColl(G__54181){
var extmap__5385__auto__ \x3d (function (){var G__54204 \x3d cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(G__54181,new cljs.core.Keyword(null,\x22binding\x22,\x22binding\x22,539932593));
if(cljs.core.record_QMARK_(G__54181)){
return cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,G__54204);
} else {
return G__54204;
}
})();
return (new datascript.parser.BindColl(new cljs.core.Keyword(null,\x22binding\x22,\x22binding\x22,539932593).cljs$core$IFn$_invoke$arity$1(G__54181),null,cljs.core.not_empty(extmap__5385__auto__),null));
});

datascript.parser.parse_bind_ignore \x3d (function datascript$parser$parse_bind_ignore(form){
if(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Symbol(null,\x22_\x22,\x22_\x22,-1201019570,null),form)){
return datascript.parser.with_source((new datascript.parser.BindIgnore(null,null,null)),form);
} else {
return null;
}
});
datascript.parser.parse_bind_scalar \x3d (function datascript$parser$parse_bind_scalar(form){
var temp__5804__auto__ \x3d datascript.parser.parse_variable(form);
if(cljs.core.truth_(temp__5804__auto__)){
var var$ \x3d temp__5804__auto__;
return datascript.parser.with_source((new datascript.parser.BindScalar(var$,null,null,null)),form);
} else {
return null;
}
});
datascript.parser.parse_bind_coll \x3d (function datascript$parser$parse_bind_coll(form){
if(((datascript.parser.of_size_QMARK_(form,(2))) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(cljs.core.second(form),new cljs.core.Symbol(null,\x22...\x22,\x22...\x22,-1926939749,null))))){
var temp__5802__auto__ \x3d (function (){var G__54205 \x3d cljs.core.first(form);
return (datascript.parser.parse_binding.cljs$core$IFn$_invoke$arity$1 ? datascript.parser.parse_binding.cljs$core$IFn$_invoke$arity$1(G__54205) : datascript.parser.parse_binding.call(null,G__54205));
})();
if(cljs.core.truth_(temp__5802__auto__)){
var sub_bind \x3d temp__5802__auto__;
return datascript.parser.with_source((new datascript.parser.BindColl(sub_bind,null,null,null)),form);
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2(\x22Cannot parse collection binding\x22,new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22parser\x22,\x22binding\x22,\x22parser/binding\x22,-346395752),new cljs.core.Keyword(null,\x22form\x22,\x22form\x22,-1624062471),form], null));
}
} else {
return null;
}
});
datascript.parser.parse_tuple_el \x3d (function datascript$parser$parse_tuple_el(form){
var or__5045__auto__ \x3d datascript.parser.parse_bind_ignore(form);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return (datascript.parser.parse_binding.cljs$core$IFn$_invoke$arity$1 ? datascript.parser.parse_binding.cljs$core$IFn$_invoke$arity$1(form) : datascript.parser.parse_binding.call(null,form));
}
});
datascript.parser.parse_bind_tuple \x3d (function datascript$parser$parse_bind_tuple(form){
var temp__5804__auto__ \x3d datascript.parser.parse_seq(datascript.parser.parse_tuple_el,form);
if(cljs.core.truth_(temp__5804__auto__)){
var sub_bindings \x3d temp__5804__auto__;
if((!(cljs.core.empty_QMARK_(sub_bindings)))){
return datascript.parser.with_source((new datascript.parser.BindTuple(sub_bindings,null,null,null)),form);
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2(\x22Tuple binding cannot be empty\x22,new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22parser\x22,\x22binding\x22,\x22parser/binding\x22,-346395752),new cljs.core.Keyword(null,\x22form\x22,\x22form\x22,-1624062471),form], null));
}
} else {
return null;
}
});
datascript.parser.parse_bind_rel \x3d (function datascript$parser$parse_bind_rel(form){
if(((datascript.parser.of_size_QMARK_(form,(1))) \x26\x26 (cljs.core.sequential_QMARK_(cljs.core.first(form))))){
return datascript.parser.with_source((new datascript.parser.BindColl(datascript.parser.parse_bind_tuple(cljs.core.first(form)),null,null,null)),form);
} else {
return null;
}
});
datascript.parser.parse_binding \x3d (function datascript$parser$parse_binding(form){
var or__5045__auto__ \x3d datascript.parser.parse_bind_coll(form);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
var or__5045__auto____$1 \x3d datascript.parser.parse_bind_rel(form);
if(cljs.core.truth_(or__5045__auto____$1)){
return or__5045__auto____$1;
} else {
var or__5045__auto____$2 \x3d datascript.parser.parse_bind_tuple(form);
if(cljs.core.truth_(or__5045__auto____$2)){
return or__5045__auto____$2;
} else {
var or__5045__auto____$3 \x3d datascript.parser.parse_bind_ignore(form);
if(cljs.core.truth_(or__5045__auto____$3)){
return or__5045__auto____$3;
} else {
var or__5045__auto____$4 \x3d datascript.parser.parse_bind_scalar(form);
if(cljs.core.truth_(or__5045__auto____$4)){
return or__5045__auto____$4;
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2(\x22Cannot parse binding, expected (bind-scalar | bind-tuple | bind-coll | bind-rel)\x22,new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22parser\x22,\x22binding\x22,\x22parser/binding\x22,-346395752),new cljs.core.Keyword(null,\x22form\x22,\x22form\x22,-1624062471),form], null));
}
}
}
}
}
});

/**
 * @interface
 */
datascript.parser.IFindVars \x3d function(){};

var datascript$parser$IFindVars$_find_vars$dyn_54910 \x3d (function (this$){
var x__5393__auto__ \x3d (((this$ \x3d\x3d null))?null:this$);
var m__5394__auto__ \x3d (datascript.parser._find_vars[goog.typeOf(x__5393__auto__)]);
if((!((m__5394__auto__ \x3d\x3d null)))){
return (m__5394__auto__.cljs$core$IFn$_invoke$arity$1 ? m__5394__auto__.cljs$core$IFn$_invoke$arity$1(this$) : m__5394__auto__.call(null,this$));
} else {
var m__5392__auto__ \x3d (datascript.parser._find_vars[\x22_\x22]);
if((!((m__5392__auto__ \x3d\x3d null)))){
return (m__5392__auto__.cljs$core$IFn$_invoke$arity$1 ? m__5392__auto__.cljs$core$IFn$_invoke$arity$1(this$) : m__5392__auto__.call(null,this$));
} else {
throw cljs.core.missing_protocol(\x22IFindVars.-find-vars\x22,this$);
}
}
});
datascript.parser._find_vars \x3d (function datascript$parser$_find_vars(this$){
if((((!((this$ \x3d\x3d null)))) \x26\x26 ((!((this$.datascript$parser$IFindVars$_find_vars$arity$1 \x3d\x3d null)))))){
return this$.datascript$parser$IFindVars$_find_vars$arity$1(this$);
} else {
return datascript$parser$IFindVars$_find_vars$dyn_54910(this$);
}
});

(datascript.parser.Variable.prototype.datascript$parser$IFindVars$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.parser.Variable.prototype.datascript$parser$IFindVars$_find_vars$arity$1 \x3d (function (this$){
var this$__$1 \x3d this;
return new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [this$__$1.symbol], null);
}));

/**
* @constructor
 * @implements {cljs.core.IRecord}
 * @implements {cljs.core.IKVReduce}
 * @implements {cljs.core.IEquiv}
 * @implements {cljs.core.IHash}
 * @implements {cljs.core.ICollection}
 * @implements {cljs.core.ICounted}
 * @implements {cljs.core.ISeqable}
 * @implements {cljs.core.IMeta}
 * @implements {cljs.core.ICloneable}
 * @implements {datascript.parser.IFindVars}
 * @implements {cljs.core.IPrintWithWriter}
 * @implements {cljs.core.IIterable}
 * @implements {datascript.parser.ITraversable}
 * @implements {cljs.core.IWithMeta}
 * @implements {cljs.core.IAssociative}
 * @implements {cljs.core.IMap}
 * @implements {cljs.core.ILookup}
*/
datascript.parser.Aggregate \x3d (function (fn,args,__meta,__extmap,__hash){
this.fn \x3d fn;
this.args \x3d args;
this.__meta \x3d __meta;
this.__extmap \x3d __extmap;
this.__hash \x3d __hash;
this.cljs$lang$protocol_mask$partition0$ \x3d 2230716170;
this.cljs$lang$protocol_mask$partition1$ \x3d 139264;
});
(datascript.parser.Aggregate.prototype.datascript$parser$IFindVars$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.parser.Aggregate.prototype.datascript$parser$IFindVars$_find_vars$arity$1 \x3d (function (_){
var self__ \x3d this;
var ___$1 \x3d this;
return datascript.parser._find_vars(cljs.core.last(self__.args));
}));

(datascript.parser.Aggregate.prototype.cljs$core$ILookup$_lookup$arity$2 \x3d (function (this__5343__auto__,k__5344__auto__){
var self__ \x3d this;
var this__5343__auto____$1 \x3d this;
return this__5343__auto____$1.cljs$core$ILookup$_lookup$arity$3(null,k__5344__auto__,null);
}));

(datascript.parser.Aggregate.prototype.cljs$core$ILookup$_lookup$arity$3 \x3d (function (this__5345__auto__,k54214,else__5346__auto__){
var self__ \x3d this;
var this__5345__auto____$1 \x3d this;
var G__54225 \x3d k54214;
var G__54225__$1 \x3d (((G__54225 instanceof cljs.core.Keyword))?G__54225.fqn:null);
switch (G__54225__$1) {
case \x22fn\x22:
return self__.fn;

break;
case \x22args\x22:
return self__.args;

break;
default:
return cljs.core.get.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k54214,else__5346__auto__);

}
}));

(datascript.parser.Aggregate.prototype.cljs$core$IKVReduce$_kv_reduce$arity$3 \x3d (function (this__5363__auto__,f__5364__auto__,init__5365__auto__){
var self__ \x3d this;
var this__5363__auto____$1 \x3d this;
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (ret__5366__auto__,p__54227){
var vec__54228 \x3d p__54227;
var k__5367__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54228,(0),null);
var v__5368__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54228,(1),null);
return (f__5364__auto__.cljs$core$IFn$_invoke$arity$3 ? f__5364__auto__.cljs$core$IFn$_invoke$arity$3(ret__5366__auto__,k__5367__auto__,v__5368__auto__) : f__5364__auto__.call(null,ret__5366__auto__,k__5367__auto__,v__5368__auto__));
}),init__5365__auto__,this__5363__auto____$1);
}));

(datascript.parser.Aggregate.prototype.cljs$core$IPrintWithWriter$_pr_writer$arity$3 \x3d (function (this__5358__auto__,writer__5359__auto__,opts__5360__auto__){
var self__ \x3d this;
var this__5358__auto____$1 \x3d this;
var pr_pair__5361__auto__ \x3d (function (keyval__5362__auto__){
return cljs.core.pr_sequential_writer(writer__5359__auto__,cljs.core.pr_writer,\x22\x22,\x22 \x22,\x22\x22,opts__5360__auto__,keyval__5362__auto__);
});
return cljs.core.pr_sequential_writer(writer__5359__auto__,pr_pair__5361__auto__,\x22#datascript.parser.Aggregate{\x22,\x22, \x22,\x22}\x22,opts__5360__auto__,cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22fn\x22,\x22fn\x22,-1175266204),self__.fn],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22args\x22,\x22args\x22,1315556576),self__.args],null))], null),self__.__extmap));
}));

(datascript.parser.Aggregate.prototype.cljs$core$IIterable$_iterator$arity$1 \x3d (function (G__54213){
var self__ \x3d this;
var G__54213__$1 \x3d this;
return (new cljs.core.RecordIter((0),G__54213__$1,2,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22fn\x22,\x22fn\x22,-1175266204),new cljs.core.Keyword(null,\x22args\x22,\x22args\x22,1315556576)], null),(cljs.core.truth_(self__.__extmap)?cljs.core._iterator(self__.__extmap):cljs.core.nil_iter())));
}));

(datascript.parser.Aggregate.prototype.cljs$core$IMeta$_meta$arity$1 \x3d (function (this__5341__auto__){
var self__ \x3d this;
var this__5341__auto____$1 \x3d this;
return self__.__meta;
}));

(datascript.parser.Aggregate.prototype.cljs$core$ICloneable$_clone$arity$1 \x3d (function (this__5338__auto__){
var self__ \x3d this;
var this__5338__auto____$1 \x3d this;
return (new datascript.parser.Aggregate(self__.fn,self__.args,self__.__meta,self__.__extmap,self__.__hash));
}));

(datascript.parser.Aggregate.prototype.cljs$core$ICounted$_count$arity$1 \x3d (function (this__5347__auto__){
var self__ \x3d this;
var this__5347__auto____$1 \x3d this;
return (2 + cljs.core.count(self__.__extmap));
}));

(datascript.parser.Aggregate.prototype.cljs$core$IHash$_hash$arity$1 \x3d (function (this__5339__auto__){
var self__ \x3d this;
var this__5339__auto____$1 \x3d this;
var h__5154__auto__ \x3d self__.__hash;
if((!((h__5154__auto__ \x3d\x3d null)))){
return h__5154__auto__;
} else {
var h__5154__auto____$1 \x3d (function (coll__5340__auto__){
return (-91097383 ^ cljs.core.hash_unordered_coll(coll__5340__auto__));
})(this__5339__auto____$1);
(self__.__hash \x3d h__5154__auto____$1);

return h__5154__auto____$1;
}
}));

(datascript.parser.Aggregate.prototype.cljs$core$IEquiv$_equiv$arity$2 \x3d (function (this54215,other54216){
var self__ \x3d this;
var this54215__$1 \x3d this;
return (((!((other54216 \x3d\x3d null)))) \x26\x26 ((((this54215__$1.constructor \x3d\x3d\x3d other54216.constructor)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54215__$1.fn,other54216.fn)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54215__$1.args,other54216.args)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54215__$1.__extmap,other54216.__extmap)))))))));
}));

(datascript.parser.Aggregate.prototype.cljs$core$IMap$_dissoc$arity$2 \x3d (function (this__5353__auto__,k__5354__auto__){
var self__ \x3d this;
var this__5353__auto____$1 \x3d this;
if(cljs.core.contains_QMARK_(new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22args\x22,\x22args\x22,1315556576),null,new cljs.core.Keyword(null,\x22fn\x22,\x22fn\x22,-1175266204),null], null), null),k__5354__auto__)){
return cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(cljs.core._with_meta(cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,this__5353__auto____$1),self__.__meta),k__5354__auto__);
} else {
return (new datascript.parser.Aggregate(self__.fn,self__.args,self__.__meta,cljs.core.not_empty(cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(self__.__extmap,k__5354__auto__)),null));
}
}));

(datascript.parser.Aggregate.prototype.cljs$core$IAssociative$_contains_key_QMARK_$arity$2 \x3d (function (this__5350__auto__,k54214){
var self__ \x3d this;
var this__5350__auto____$1 \x3d this;
var G__54247 \x3d k54214;
var G__54247__$1 \x3d (((G__54247 instanceof cljs.core.Keyword))?G__54247.fqn:null);
switch (G__54247__$1) {
case \x22fn\x22:
case \x22args\x22:
return true;

break;
default:
return cljs.core.contains_QMARK_(self__.__extmap,k54214);

}
}));

(datascript.parser.Aggregate.prototype.cljs$core$IAssociative$_assoc$arity$3 \x3d (function (this__5351__auto__,k__5352__auto__,G__54213){
var self__ \x3d this;
var this__5351__auto____$1 \x3d this;
var pred__54249 \x3d cljs.core.keyword_identical_QMARK_;
var expr__54250 \x3d k__5352__auto__;
if(cljs.core.truth_((pred__54249.cljs$core$IFn$_invoke$arity$2 ? pred__54249.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22fn\x22,\x22fn\x22,-1175266204),expr__54250) : pred__54249.call(null,new cljs.core.Keyword(null,\x22fn\x22,\x22fn\x22,-1175266204),expr__54250)))){
return (new datascript.parser.Aggregate(G__54213,self__.args,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__54249.cljs$core$IFn$_invoke$arity$2 ? pred__54249.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22args\x22,\x22args\x22,1315556576),expr__54250) : pred__54249.call(null,new cljs.core.Keyword(null,\x22args\x22,\x22args\x22,1315556576),expr__54250)))){
return (new datascript.parser.Aggregate(self__.fn,G__54213,self__.__meta,self__.__extmap,null));
} else {
return (new datascript.parser.Aggregate(self__.fn,self__.args,self__.__meta,cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k__5352__auto__,G__54213),null));
}
}
}));

(datascript.parser.Aggregate.prototype.cljs$core$ISeqable$_seq$arity$1 \x3d (function (this__5356__auto__){
var self__ \x3d this;
var this__5356__auto____$1 \x3d this;
return cljs.core.seq(cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22fn\x22,\x22fn\x22,-1175266204),self__.fn,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22args\x22,\x22args\x22,1315556576),self__.args,null))], null),self__.__extmap));
}));

(datascript.parser.Aggregate.prototype.cljs$core$IWithMeta$_with_meta$arity$2 \x3d (function (this__5342__auto__,G__54213){
var self__ \x3d this;
var this__5342__auto____$1 \x3d this;
return (new datascript.parser.Aggregate(self__.fn,self__.args,G__54213,self__.__extmap,self__.__hash));
}));

(datascript.parser.Aggregate.prototype.cljs$core$ICollection$_conj$arity$2 \x3d (function (this__5348__auto__,entry__5349__auto__){
var self__ \x3d this;
var this__5348__auto____$1 \x3d this;
if(cljs.core.vector_QMARK_(entry__5349__auto__)){
return this__5348__auto____$1.cljs$core$IAssociative$_assoc$arity$3(null,cljs.core._nth(entry__5349__auto__,(0)),cljs.core._nth(entry__5349__auto__,(1)));
} else {
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(cljs.core._conj,this__5348__auto____$1,entry__5349__auto__);
}
}));

(datascript.parser.Aggregate.prototype.datascript$parser$ITraversable$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.parser.Aggregate.prototype.datascript$parser$ITraversable$_postwalk$arity$2 \x3d (function (this__52373__auto__,f54210){
var self__ \x3d this;
var this__52373__auto____$1 \x3d this;
var new__52374__auto__ \x3d (new datascript.parser.Aggregate(datascript.parser.postwalk(self__.fn,f54210),datascript.parser.postwalk(self__.args,f54210),null,null,null));
var temp__5802__auto__ \x3d cljs.core.meta(this__52373__auto____$1);
if(cljs.core.truth_(temp__5802__auto__)){
var meta__52375__auto__ \x3d temp__5802__auto__;
return cljs.core.with_meta(new__52374__auto__,meta__52375__auto__);
} else {
return new__52374__auto__;
}
}));

(datascript.parser.Aggregate.prototype.datascript$parser$ITraversable$_collect$arity$3 \x3d (function (___52376__auto__,pred54211,acc54212){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
return datascript.parser.collect.cljs$core$IFn$_invoke$arity$3(pred54211,self__.args,datascript.parser.collect.cljs$core$IFn$_invoke$arity$3(pred54211,self__.fn,acc54212));
}));

(datascript.parser.Aggregate.prototype.datascript$parser$ITraversable$_collect_vars$arity$2 \x3d (function (___52376__auto__,acc54212){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
var G__54253 \x3d (datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2 ? datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2(acc54212,self__.fn) : datascript.parser.collect_vars_acc.call(null,acc54212,self__.fn));
var G__54254 \x3d self__.args;
return (datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2 ? datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2(G__54253,G__54254) : datascript.parser.collect_vars_acc.call(null,G__54253,G__54254));
}));

(datascript.parser.Aggregate.getBasis \x3d (function (){
return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22fn\x22,\x22fn\x22,465265323,null),new cljs.core.Symbol(null,\x22args\x22,\x22args\x22,-1338879193,null)], null);
}));

(datascript.parser.Aggregate.cljs$lang$type \x3d true);

(datascript.parser.Aggregate.cljs$lang$ctorPrSeq \x3d (function (this__5389__auto__){
return (new cljs.core.List(null,\x22datascript.parser/Aggregate\x22,null,(1),null));
}));

(datascript.parser.Aggregate.cljs$lang$ctorPrWriter \x3d (function (this__5389__auto__,writer__5390__auto__){
return cljs.core._write(writer__5390__auto__,\x22datascript.parser/Aggregate\x22);
}));

/**
 * Positional factory function for datascript.parser/Aggregate.
 */
datascript.parser.__GT_Aggregate \x3d (function datascript$parser$__GT_Aggregate(fn,args){
return (new datascript.parser.Aggregate(fn,args,null,null,null));
});

/**
 * Factory function for datascript.parser/Aggregate, taking a map of keywords to field values.
 */
datascript.parser.map__GT_Aggregate \x3d (function datascript$parser$map__GT_Aggregate(G__54217){
var extmap__5385__auto__ \x3d (function (){var G__54263 \x3d cljs.core.dissoc.cljs$core$IFn$_invoke$arity$variadic(G__54217,new cljs.core.Keyword(null,\x22fn\x22,\x22fn\x22,-1175266204),cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,\x22args\x22,\x22args\x22,1315556576)], 0));
if(cljs.core.record_QMARK_(G__54217)){
return cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,G__54263);
} else {
return G__54263;
}
})();
return (new datascript.parser.Aggregate(new cljs.core.Keyword(null,\x22fn\x22,\x22fn\x22,-1175266204).cljs$core$IFn$_invoke$arity$1(G__54217),new cljs.core.Keyword(null,\x22args\x22,\x22args\x22,1315556576).cljs$core$IFn$_invoke$arity$1(G__54217),null,cljs.core.not_empty(extmap__5385__auto__),null));
});


/**
* @constructor
 * @implements {cljs.core.IRecord}
 * @implements {cljs.core.IKVReduce}
 * @implements {cljs.core.IEquiv}
 * @implements {cljs.core.IHash}
 * @implements {cljs.core.ICollection}
 * @implements {cljs.core.ICounted}
 * @implements {cljs.core.ISeqable}
 * @implements {cljs.core.IMeta}
 * @implements {cljs.core.ICloneable}
 * @implements {datascript.parser.IFindVars}
 * @implements {cljs.core.IPrintWithWriter}
 * @implements {cljs.core.IIterable}
 * @implements {datascript.parser.ITraversable}
 * @implements {cljs.core.IWithMeta}
 * @implements {cljs.core.IAssociative}
 * @implements {cljs.core.IMap}
 * @implements {cljs.core.ILookup}
*/
datascript.parser.Pull \x3d (function (source,variable,pattern,__meta,__extmap,__hash){
this.source \x3d source;
this.variable \x3d variable;
this.pattern \x3d pattern;
this.__meta \x3d __meta;
this.__extmap \x3d __extmap;
this.__hash \x3d __hash;
this.cljs$lang$protocol_mask$partition0$ \x3d 2230716170;
this.cljs$lang$protocol_mask$partition1$ \x3d 139264;
});
(datascript.parser.Pull.prototype.datascript$parser$IFindVars$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.parser.Pull.prototype.datascript$parser$IFindVars$_find_vars$arity$1 \x3d (function (_){
var self__ \x3d this;
var ___$1 \x3d this;
return datascript.parser._find_vars(self__.variable);
}));

(datascript.parser.Pull.prototype.cljs$core$ILookup$_lookup$arity$2 \x3d (function (this__5343__auto__,k__5344__auto__){
var self__ \x3d this;
var this__5343__auto____$1 \x3d this;
return this__5343__auto____$1.cljs$core$ILookup$_lookup$arity$3(null,k__5344__auto__,null);
}));

(datascript.parser.Pull.prototype.cljs$core$ILookup$_lookup$arity$3 \x3d (function (this__5345__auto__,k54268,else__5346__auto__){
var self__ \x3d this;
var this__5345__auto____$1 \x3d this;
var G__54277 \x3d k54268;
var G__54277__$1 \x3d (((G__54277 instanceof cljs.core.Keyword))?G__54277.fqn:null);
switch (G__54277__$1) {
case \x22source\x22:
return self__.source;

break;
case \x22variable\x22:
return self__.variable;

break;
case \x22pattern\x22:
return self__.pattern;

break;
default:
return cljs.core.get.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k54268,else__5346__auto__);

}
}));

(datascript.parser.Pull.prototype.cljs$core$IKVReduce$_kv_reduce$arity$3 \x3d (function (this__5363__auto__,f__5364__auto__,init__5365__auto__){
var self__ \x3d this;
var this__5363__auto____$1 \x3d this;
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (ret__5366__auto__,p__54279){
var vec__54280 \x3d p__54279;
var k__5367__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54280,(0),null);
var v__5368__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54280,(1),null);
return (f__5364__auto__.cljs$core$IFn$_invoke$arity$3 ? f__5364__auto__.cljs$core$IFn$_invoke$arity$3(ret__5366__auto__,k__5367__auto__,v__5368__auto__) : f__5364__auto__.call(null,ret__5366__auto__,k__5367__auto__,v__5368__auto__));
}),init__5365__auto__,this__5363__auto____$1);
}));

(datascript.parser.Pull.prototype.cljs$core$IPrintWithWriter$_pr_writer$arity$3 \x3d (function (this__5358__auto__,writer__5359__auto__,opts__5360__auto__){
var self__ \x3d this;
var this__5358__auto____$1 \x3d this;
var pr_pair__5361__auto__ \x3d (function (keyval__5362__auto__){
return cljs.core.pr_sequential_writer(writer__5359__auto__,cljs.core.pr_writer,\x22\x22,\x22 \x22,\x22\x22,opts__5360__auto__,keyval__5362__auto__);
});
return cljs.core.pr_sequential_writer(writer__5359__auto__,pr_pair__5361__auto__,\x22#datascript.parser.Pull{\x22,\x22, \x22,\x22}\x22,opts__5360__auto__,cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22source\x22,\x22source\x22,-433931539),self__.source],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22variable\x22,\x22variable\x22,-281346492),self__.variable],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423),self__.pattern],null))], null),self__.__extmap));
}));

(datascript.parser.Pull.prototype.cljs$core$IIterable$_iterator$arity$1 \x3d (function (G__54267){
var self__ \x3d this;
var G__54267__$1 \x3d this;
return (new cljs.core.RecordIter((0),G__54267__$1,3,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22source\x22,\x22source\x22,-433931539),new cljs.core.Keyword(null,\x22variable\x22,\x22variable\x22,-281346492),new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423)], null),(cljs.core.truth_(self__.__extmap)?cljs.core._iterator(self__.__extmap):cljs.core.nil_iter())));
}));

(datascript.parser.Pull.prototype.cljs$core$IMeta$_meta$arity$1 \x3d (function (this__5341__auto__){
var self__ \x3d this;
var this__5341__auto____$1 \x3d this;
return self__.__meta;
}));

(datascript.parser.Pull.prototype.cljs$core$ICloneable$_clone$arity$1 \x3d (function (this__5338__auto__){
var self__ \x3d this;
var this__5338__auto____$1 \x3d this;
return (new datascript.parser.Pull(self__.source,self__.variable,self__.pattern,self__.__meta,self__.__extmap,self__.__hash));
}));

(datascript.parser.Pull.prototype.cljs$core$ICounted$_count$arity$1 \x3d (function (this__5347__auto__){
var self__ \x3d this;
var this__5347__auto____$1 \x3d this;
return (3 + cljs.core.count(self__.__extmap));
}));

(datascript.parser.Pull.prototype.cljs$core$IHash$_hash$arity$1 \x3d (function (this__5339__auto__){
var self__ \x3d this;
var this__5339__auto____$1 \x3d this;
var h__5154__auto__ \x3d self__.__hash;
if((!((h__5154__auto__ \x3d\x3d null)))){
return h__5154__auto__;
} else {
var h__5154__auto____$1 \x3d (function (coll__5340__auto__){
return (-2108867663 ^ cljs.core.hash_unordered_coll(coll__5340__auto__));
})(this__5339__auto____$1);
(self__.__hash \x3d h__5154__auto____$1);

return h__5154__auto____$1;
}
}));

(datascript.parser.Pull.prototype.cljs$core$IEquiv$_equiv$arity$2 \x3d (function (this54269,other54270){
var self__ \x3d this;
var this54269__$1 \x3d this;
return (((!((other54270 \x3d\x3d null)))) \x26\x26 ((((this54269__$1.constructor \x3d\x3d\x3d other54270.constructor)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54269__$1.source,other54270.source)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54269__$1.variable,other54270.variable)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54269__$1.pattern,other54270.pattern)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54269__$1.__extmap,other54270.__extmap)))))))))));
}));

(datascript.parser.Pull.prototype.cljs$core$IMap$_dissoc$arity$2 \x3d (function (this__5353__auto__,k__5354__auto__){
var self__ \x3d this;
var this__5353__auto____$1 \x3d this;
if(cljs.core.contains_QMARK_(new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,\x22variable\x22,\x22variable\x22,-281346492),null,new cljs.core.Keyword(null,\x22source\x22,\x22source\x22,-433931539),null,new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423),null], null), null),k__5354__auto__)){
return cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(cljs.core._with_meta(cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,this__5353__auto____$1),self__.__meta),k__5354__auto__);
} else {
return (new datascript.parser.Pull(self__.source,self__.variable,self__.pattern,self__.__meta,cljs.core.not_empty(cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(self__.__extmap,k__5354__auto__)),null));
}
}));

(datascript.parser.Pull.prototype.cljs$core$IAssociative$_contains_key_QMARK_$arity$2 \x3d (function (this__5350__auto__,k54268){
var self__ \x3d this;
var this__5350__auto____$1 \x3d this;
var G__54288 \x3d k54268;
var G__54288__$1 \x3d (((G__54288 instanceof cljs.core.Keyword))?G__54288.fqn:null);
switch (G__54288__$1) {
case \x22source\x22:
case \x22variable\x22:
case \x22pattern\x22:
return true;

break;
default:
return cljs.core.contains_QMARK_(self__.__extmap,k54268);

}
}));

(datascript.parser.Pull.prototype.cljs$core$IAssociative$_assoc$arity$3 \x3d (function (this__5351__auto__,k__5352__auto__,G__54267){
var self__ \x3d this;
var this__5351__auto____$1 \x3d this;
var pred__54289 \x3d cljs.core.keyword_identical_QMARK_;
var expr__54290 \x3d k__5352__auto__;
if(cljs.core.truth_((pred__54289.cljs$core$IFn$_invoke$arity$2 ? pred__54289.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22source\x22,\x22source\x22,-433931539),expr__54290) : pred__54289.call(null,new cljs.core.Keyword(null,\x22source\x22,\x22source\x22,-433931539),expr__54290)))){
return (new datascript.parser.Pull(G__54267,self__.variable,self__.pattern,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__54289.cljs$core$IFn$_invoke$arity$2 ? pred__54289.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22variable\x22,\x22variable\x22,-281346492),expr__54290) : pred__54289.call(null,new cljs.core.Keyword(null,\x22variable\x22,\x22variable\x22,-281346492),expr__54290)))){
return (new datascript.parser.Pull(self__.source,G__54267,self__.pattern,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__54289.cljs$core$IFn$_invoke$arity$2 ? pred__54289.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423),expr__54290) : pred__54289.call(null,new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423),expr__54290)))){
return (new datascript.parser.Pull(self__.source,self__.variable,G__54267,self__.__meta,self__.__extmap,null));
} else {
return (new datascript.parser.Pull(self__.source,self__.variable,self__.pattern,self__.__meta,cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k__5352__auto__,G__54267),null));
}
}
}
}));

(datascript.parser.Pull.prototype.cljs$core$ISeqable$_seq$arity$1 \x3d (function (this__5356__auto__){
var self__ \x3d this;
var this__5356__auto____$1 \x3d this;
return cljs.core.seq(cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22source\x22,\x22source\x22,-433931539),self__.source,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22variable\x22,\x22variable\x22,-281346492),self__.variable,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423),self__.pattern,null))], null),self__.__extmap));
}));

(datascript.parser.Pull.prototype.cljs$core$IWithMeta$_with_meta$arity$2 \x3d (function (this__5342__auto__,G__54267){
var self__ \x3d this;
var this__5342__auto____$1 \x3d this;
return (new datascript.parser.Pull(self__.source,self__.variable,self__.pattern,G__54267,self__.__extmap,self__.__hash));
}));

(datascript.parser.Pull.prototype.cljs$core$ICollection$_conj$arity$2 \x3d (function (this__5348__auto__,entry__5349__auto__){
var self__ \x3d this;
var this__5348__auto____$1 \x3d this;
if(cljs.core.vector_QMARK_(entry__5349__auto__)){
return this__5348__auto____$1.cljs$core$IAssociative$_assoc$arity$3(null,cljs.core._nth(entry__5349__auto__,(0)),cljs.core._nth(entry__5349__auto__,(1)));
} else {
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(cljs.core._conj,this__5348__auto____$1,entry__5349__auto__);
}
}));

(datascript.parser.Pull.prototype.datascript$parser$ITraversable$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.parser.Pull.prototype.datascript$parser$ITraversable$_postwalk$arity$2 \x3d (function (this__52373__auto__,f54264){
var self__ \x3d this;
var this__52373__auto____$1 \x3d this;
var new__52374__auto__ \x3d (new datascript.parser.Pull(datascript.parser.postwalk(self__.source,f54264),datascript.parser.postwalk(self__.variable,f54264),datascript.parser.postwalk(self__.pattern,f54264),null,null,null));
var temp__5802__auto__ \x3d cljs.core.meta(this__52373__auto____$1);
if(cljs.core.truth_(temp__5802__auto__)){
var meta__52375__auto__ \x3d temp__5802__auto__;
return cljs.core.with_meta(new__52374__auto__,meta__52375__auto__);
} else {
return new__52374__auto__;
}
}));

(datascript.parser.Pull.prototype.datascript$parser$ITraversable$_collect$arity$3 \x3d (function (___52376__auto__,pred54265,acc54266){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
return datascript.parser.collect.cljs$core$IFn$_invoke$arity$3(pred54265,self__.pattern,datascript.parser.collect.cljs$core$IFn$_invoke$arity$3(pred54265,self__.variable,datascript.parser.collect.cljs$core$IFn$_invoke$arity$3(pred54265,self__.source,acc54266)));
}));

(datascript.parser.Pull.prototype.datascript$parser$ITraversable$_collect_vars$arity$2 \x3d (function (___52376__auto__,acc54266){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
var G__54296 \x3d (function (){var G__54298 \x3d (datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2 ? datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2(acc54266,self__.source) : datascript.parser.collect_vars_acc.call(null,acc54266,self__.source));
var G__54299 \x3d self__.variable;
return (datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2 ? datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2(G__54298,G__54299) : datascript.parser.collect_vars_acc.call(null,G__54298,G__54299));
})();
var G__54297 \x3d self__.pattern;
return (datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2 ? datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2(G__54296,G__54297) : datascript.parser.collect_vars_acc.call(null,G__54296,G__54297));
}));

(datascript.parser.Pull.getBasis \x3d (function (){
return new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22source\x22,\x22source\x22,1206599988,null),new cljs.core.Symbol(null,\x22variable\x22,\x22variable\x22,1359185035,null),new cljs.core.Symbol(null,\x22pattern\x22,\x22pattern\x22,1882666950,null)], null);
}));

(datascript.parser.Pull.cljs$lang$type \x3d true);

(datascript.parser.Pull.cljs$lang$ctorPrSeq \x3d (function (this__5389__auto__){
return (new cljs.core.List(null,\x22datascript.parser/Pull\x22,null,(1),null));
}));

(datascript.parser.Pull.cljs$lang$ctorPrWriter \x3d (function (this__5389__auto__,writer__5390__auto__){
return cljs.core._write(writer__5390__auto__,\x22datascript.parser/Pull\x22);
}));

/**
 * Positional factory function for datascript.parser/Pull.
 */
datascript.parser.__GT_Pull \x3d (function datascript$parser$__GT_Pull(source,variable,pattern){
return (new datascript.parser.Pull(source,variable,pattern,null,null,null));
});

/**
 * Factory function for datascript.parser/Pull, taking a map of keywords to field values.
 */
datascript.parser.map__GT_Pull \x3d (function datascript$parser$map__GT_Pull(G__54271){
var extmap__5385__auto__ \x3d (function (){var G__54300 \x3d cljs.core.dissoc.cljs$core$IFn$_invoke$arity$variadic(G__54271,new cljs.core.Keyword(null,\x22source\x22,\x22source\x22,-433931539),cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,\x22variable\x22,\x22variable\x22,-281346492),new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423)], 0));
if(cljs.core.record_QMARK_(G__54271)){
return cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,G__54300);
} else {
return G__54300;
}
})();
return (new datascript.parser.Pull(new cljs.core.Keyword(null,\x22source\x22,\x22source\x22,-433931539).cljs$core$IFn$_invoke$arity$1(G__54271),new cljs.core.Keyword(null,\x22variable\x22,\x22variable\x22,-281346492).cljs$core$IFn$_invoke$arity$1(G__54271),new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423).cljs$core$IFn$_invoke$arity$1(G__54271),null,cljs.core.not_empty(extmap__5385__auto__),null));
});


/**
 * @interface
 */
datascript.parser.IFindElements \x3d function(){};

var datascript$parser$IFindElements$find_elements$dyn_54926 \x3d (function (this$){
var x__5393__auto__ \x3d (((this$ \x3d\x3d null))?null:this$);
var m__5394__auto__ \x3d (datascript.parser.find_elements[goog.typeOf(x__5393__auto__)]);
if((!((m__5394__auto__ \x3d\x3d null)))){
return (m__5394__auto__.cljs$core$IFn$_invoke$arity$1 ? m__5394__auto__.cljs$core$IFn$_invoke$arity$1(this$) : m__5394__auto__.call(null,this$));
} else {
var m__5392__auto__ \x3d (datascript.parser.find_elements[\x22_\x22]);
if((!((m__5392__auto__ \x3d\x3d null)))){
return (m__5392__auto__.cljs$core$IFn$_invoke$arity$1 ? m__5392__auto__.cljs$core$IFn$_invoke$arity$1(this$) : m__5392__auto__.call(null,this$));
} else {
throw cljs.core.missing_protocol(\x22IFindElements.find-elements\x22,this$);
}
}
});
datascript.parser.find_elements \x3d (function datascript$parser$find_elements(this$){
if((((!((this$ \x3d\x3d null)))) \x26\x26 ((!((this$.datascript$parser$IFindElements$find_elements$arity$1 \x3d\x3d null)))))){
return this$.datascript$parser$IFindElements$find_elements$arity$1(this$);
} else {
return datascript$parser$IFindElements$find_elements$dyn_54926(this$);
}
});


/**
* @constructor
 * @implements {cljs.core.IRecord}
 * @implements {cljs.core.IKVReduce}
 * @implements {cljs.core.IEquiv}
 * @implements {cljs.core.IHash}
 * @implements {cljs.core.ICollection}
 * @implements {cljs.core.ICounted}
 * @implements {cljs.core.ISeqable}
 * @implements {cljs.core.IMeta}
 * @implements {cljs.core.ICloneable}
 * @implements {cljs.core.IPrintWithWriter}
 * @implements {cljs.core.IIterable}
 * @implements {datascript.parser.ITraversable}
 * @implements {cljs.core.IWithMeta}
 * @implements {cljs.core.IAssociative}
 * @implements {datascript.parser.IFindElements}
 * @implements {cljs.core.IMap}
 * @implements {cljs.core.ILookup}
*/
datascript.parser.FindRel \x3d (function (elements,__meta,__extmap,__hash){
this.elements \x3d elements;
this.__meta \x3d __meta;
this.__extmap \x3d __extmap;
this.__hash \x3d __hash;
this.cljs$lang$protocol_mask$partition0$ \x3d 2230716170;
this.cljs$lang$protocol_mask$partition1$ \x3d 139264;
});
(datascript.parser.FindRel.prototype.cljs$core$ILookup$_lookup$arity$2 \x3d (function (this__5343__auto__,k__5344__auto__){
var self__ \x3d this;
var this__5343__auto____$1 \x3d this;
return this__5343__auto____$1.cljs$core$ILookup$_lookup$arity$3(null,k__5344__auto__,null);
}));

(datascript.parser.FindRel.prototype.cljs$core$ILookup$_lookup$arity$3 \x3d (function (this__5345__auto__,k54311,else__5346__auto__){
var self__ \x3d this;
var this__5345__auto____$1 \x3d this;
var G__54321 \x3d k54311;
var G__54321__$1 \x3d (((G__54321 instanceof cljs.core.Keyword))?G__54321.fqn:null);
switch (G__54321__$1) {
case \x22elements\x22:
return self__.elements;

break;
default:
return cljs.core.get.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k54311,else__5346__auto__);

}
}));

(datascript.parser.FindRel.prototype.cljs$core$IKVReduce$_kv_reduce$arity$3 \x3d (function (this__5363__auto__,f__5364__auto__,init__5365__auto__){
var self__ \x3d this;
var this__5363__auto____$1 \x3d this;
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (ret__5366__auto__,p__54322){
var vec__54323 \x3d p__54322;
var k__5367__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54323,(0),null);
var v__5368__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54323,(1),null);
return (f__5364__auto__.cljs$core$IFn$_invoke$arity$3 ? f__5364__auto__.cljs$core$IFn$_invoke$arity$3(ret__5366__auto__,k__5367__auto__,v__5368__auto__) : f__5364__auto__.call(null,ret__5366__auto__,k__5367__auto__,v__5368__auto__));
}),init__5365__auto__,this__5363__auto____$1);
}));

(datascript.parser.FindRel.prototype.cljs$core$IPrintWithWriter$_pr_writer$arity$3 \x3d (function (this__5358__auto__,writer__5359__auto__,opts__5360__auto__){
var self__ \x3d this;
var this__5358__auto____$1 \x3d this;
var pr_pair__5361__auto__ \x3d (function (keyval__5362__auto__){
return cljs.core.pr_sequential_writer(writer__5359__auto__,cljs.core.pr_writer,\x22\x22,\x22 \x22,\x22\x22,opts__5360__auto__,keyval__5362__auto__);
});
return cljs.core.pr_sequential_writer(writer__5359__auto__,pr_pair__5361__auto__,\x22#datascript.parser.FindRel{\x22,\x22, \x22,\x22}\x22,opts__5360__auto__,cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22elements\x22,\x22elements\x22,657646735),self__.elements],null))], null),self__.__extmap));
}));

(datascript.parser.FindRel.prototype.cljs$core$IIterable$_iterator$arity$1 \x3d (function (G__54310){
var self__ \x3d this;
var G__54310__$1 \x3d this;
return (new cljs.core.RecordIter((0),G__54310__$1,1,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22elements\x22,\x22elements\x22,657646735)], null),(cljs.core.truth_(self__.__extmap)?cljs.core._iterator(self__.__extmap):cljs.core.nil_iter())));
}));

(datascript.parser.FindRel.prototype.cljs$core$IMeta$_meta$arity$1 \x3d (function (this__5341__auto__){
var self__ \x3d this;
var this__5341__auto____$1 \x3d this;
return self__.__meta;
}));

(datascript.parser.FindRel.prototype.cljs$core$ICloneable$_clone$arity$1 \x3d (function (this__5338__auto__){
var self__ \x3d this;
var this__5338__auto____$1 \x3d this;
return (new datascript.parser.FindRel(self__.elements,self__.__meta,self__.__extmap,self__.__hash));
}));

(datascript.parser.FindRel.prototype.cljs$core$ICounted$_count$arity$1 \x3d (function (this__5347__auto__){
var self__ \x3d this;
var this__5347__auto____$1 \x3d this;
return (1 + cljs.core.count(self__.__extmap));
}));

(datascript.parser.FindRel.prototype.cljs$core$IHash$_hash$arity$1 \x3d (function (this__5339__auto__){
var self__ \x3d this;
var this__5339__auto____$1 \x3d this;
var h__5154__auto__ \x3d self__.__hash;
if((!((h__5154__auto__ \x3d\x3d null)))){
return h__5154__auto__;
} else {
var h__5154__auto____$1 \x3d (function (coll__5340__auto__){
return (744809563 ^ cljs.core.hash_unordered_coll(coll__5340__auto__));
})(this__5339__auto____$1);
(self__.__hash \x3d h__5154__auto____$1);

return h__5154__auto____$1;
}
}));

(datascript.parser.FindRel.prototype.cljs$core$IEquiv$_equiv$arity$2 \x3d (function (this54312,other54313){
var self__ \x3d this;
var this54312__$1 \x3d this;
return (((!((other54313 \x3d\x3d null)))) \x26\x26 ((((this54312__$1.constructor \x3d\x3d\x3d other54313.constructor)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54312__$1.elements,other54313.elements)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54312__$1.__extmap,other54313.__extmap)))))));
}));

(datascript.parser.FindRel.prototype.cljs$core$IMap$_dissoc$arity$2 \x3d (function (this__5353__auto__,k__5354__auto__){
var self__ \x3d this;
var this__5353__auto____$1 \x3d this;
if(cljs.core.contains_QMARK_(new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,\x22elements\x22,\x22elements\x22,657646735),null], null), null),k__5354__auto__)){
return cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(cljs.core._with_meta(cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,this__5353__auto____$1),self__.__meta),k__5354__auto__);
} else {
return (new datascript.parser.FindRel(self__.elements,self__.__meta,cljs.core.not_empty(cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(self__.__extmap,k__5354__auto__)),null));
}
}));

(datascript.parser.FindRel.prototype.datascript$parser$IFindElements$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.parser.FindRel.prototype.datascript$parser$IFindElements$find_elements$arity$1 \x3d (function (_){
var self__ \x3d this;
var ___$1 \x3d this;
return self__.elements;
}));

(datascript.parser.FindRel.prototype.cljs$core$IAssociative$_contains_key_QMARK_$arity$2 \x3d (function (this__5350__auto__,k54311){
var self__ \x3d this;
var this__5350__auto____$1 \x3d this;
var G__54337 \x3d k54311;
var G__54337__$1 \x3d (((G__54337 instanceof cljs.core.Keyword))?G__54337.fqn:null);
switch (G__54337__$1) {
case \x22elements\x22:
return true;

break;
default:
return cljs.core.contains_QMARK_(self__.__extmap,k54311);

}
}));

(datascript.parser.FindRel.prototype.cljs$core$IAssociative$_assoc$arity$3 \x3d (function (this__5351__auto__,k__5352__auto__,G__54310){
var self__ \x3d this;
var this__5351__auto____$1 \x3d this;
var pred__54338 \x3d cljs.core.keyword_identical_QMARK_;
var expr__54339 \x3d k__5352__auto__;
if(cljs.core.truth_((pred__54338.cljs$core$IFn$_invoke$arity$2 ? pred__54338.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22elements\x22,\x22elements\x22,657646735),expr__54339) : pred__54338.call(null,new cljs.core.Keyword(null,\x22elements\x22,\x22elements\x22,657646735),expr__54339)))){
return (new datascript.parser.FindRel(G__54310,self__.__meta,self__.__extmap,null));
} else {
return (new datascript.parser.FindRel(self__.elements,self__.__meta,cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k__5352__auto__,G__54310),null));
}
}));

(datascript.parser.FindRel.prototype.cljs$core$ISeqable$_seq$arity$1 \x3d (function (this__5356__auto__){
var self__ \x3d this;
var this__5356__auto____$1 \x3d this;
return cljs.core.seq(cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22elements\x22,\x22elements\x22,657646735),self__.elements,null))], null),self__.__extmap));
}));

(datascript.parser.FindRel.prototype.cljs$core$IWithMeta$_with_meta$arity$2 \x3d (function (this__5342__auto__,G__54310){
var self__ \x3d this;
var this__5342__auto____$1 \x3d this;
return (new datascript.parser.FindRel(self__.elements,G__54310,self__.__extmap,self__.__hash));
}));

(datascript.parser.FindRel.prototype.cljs$core$ICollection$_conj$arity$2 \x3d (function (this__5348__auto__,entry__5349__auto__){
var self__ \x3d this;
var this__5348__auto____$1 \x3d this;
if(cljs.core.vector_QMARK_(entry__5349__auto__)){
return this__5348__auto____$1.cljs$core$IAssociative$_assoc$arity$3(null,cljs.core._nth(entry__5349__auto__,(0)),cljs.core._nth(entry__5349__auto__,(1)));
} else {
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(cljs.core._conj,this__5348__auto____$1,entry__5349__auto__);
}
}));

(datascript.parser.FindRel.prototype.datascript$parser$ITraversable$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.parser.FindRel.prototype.datascript$parser$ITraversable$_postwalk$arity$2 \x3d (function (this__52373__auto__,f54307){
var self__ \x3d this;
var this__52373__auto____$1 \x3d this;
var new__52374__auto__ \x3d (new datascript.parser.FindRel(datascript.parser.postwalk(self__.elements,f54307),null,null,null));
var temp__5802__auto__ \x3d cljs.core.meta(this__52373__auto____$1);
if(cljs.core.truth_(temp__5802__auto__)){
var meta__52375__auto__ \x3d temp__5802__auto__;
return cljs.core.with_meta(new__52374__auto__,meta__52375__auto__);
} else {
return new__52374__auto__;
}
}));

(datascript.parser.FindRel.prototype.datascript$parser$ITraversable$_collect$arity$3 \x3d (function (___52376__auto__,pred54308,acc54309){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
return datascript.parser.collect.cljs$core$IFn$_invoke$arity$3(pred54308,self__.elements,acc54309);
}));

(datascript.parser.FindRel.prototype.datascript$parser$ITraversable$_collect_vars$arity$2 \x3d (function (___52376__auto__,acc54309){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
return (datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2 ? datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2(acc54309,self__.elements) : datascript.parser.collect_vars_acc.call(null,acc54309,self__.elements));
}));

(datascript.parser.FindRel.getBasis \x3d (function (){
return new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22elements\x22,\x22elements\x22,-1996789034,null)], null);
}));

(datascript.parser.FindRel.cljs$lang$type \x3d true);

(datascript.parser.FindRel.cljs$lang$ctorPrSeq \x3d (function (this__5389__auto__){
return (new cljs.core.List(null,\x22datascript.parser/FindRel\x22,null,(1),null));
}));

(datascript.parser.FindRel.cljs$lang$ctorPrWriter \x3d (function (this__5389__auto__,writer__5390__auto__){
return cljs.core._write(writer__5390__auto__,\x22datascript.parser/FindRel\x22);
}));

/**
 * Positional factory function for datascript.parser/FindRel.
 */
datascript.parser.__GT_FindRel \x3d (function datascript$parser$__GT_FindRel(elements){
return (new datascript.parser.FindRel(elements,null,null,null));
});

/**
 * Factory function for datascript.parser/FindRel, taking a map of keywords to field values.
 */
datascript.parser.map__GT_FindRel \x3d (function datascript$parser$map__GT_FindRel(G__54314){
var extmap__5385__auto__ \x3d (function (){var G__54342 \x3d cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(G__54314,new cljs.core.Keyword(null,\x22elements\x22,\x22elements\x22,657646735));
if(cljs.core.record_QMARK_(G__54314)){
return cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,G__54342);
} else {
return G__54342;
}
})();
return (new datascript.parser.FindRel(new cljs.core.Keyword(null,\x22elements\x22,\x22elements\x22,657646735).cljs$core$IFn$_invoke$arity$1(G__54314),null,cljs.core.not_empty(extmap__5385__auto__),null));
});


/**
* @constructor
 * @implements {cljs.core.IRecord}
 * @implements {cljs.core.IKVReduce}
 * @implements {cljs.core.IEquiv}
 * @implements {cljs.core.IHash}
 * @implements {cljs.core.ICollection}
 * @implements {cljs.core.ICounted}
 * @implements {cljs.core.ISeqable}
 * @implements {cljs.core.IMeta}
 * @implements {cljs.core.ICloneable}
 * @implements {cljs.core.IPrintWithWriter}
 * @implements {cljs.core.IIterable}
 * @implements {datascript.parser.ITraversable}
 * @implements {cljs.core.IWithMeta}
 * @implements {cljs.core.IAssociative}
 * @implements {datascript.parser.IFindElements}
 * @implements {cljs.core.IMap}
 * @implements {cljs.core.ILookup}
*/
datascript.parser.FindColl \x3d (function (element,__meta,__extmap,__hash){
this.element \x3d element;
this.__meta \x3d __meta;
this.__extmap \x3d __extmap;
this.__hash \x3d __hash;
this.cljs$lang$protocol_mask$partition0$ \x3d 2230716170;
this.cljs$lang$protocol_mask$partition1$ \x3d 139264;
});
(datascript.parser.FindColl.prototype.cljs$core$ILookup$_lookup$arity$2 \x3d (function (this__5343__auto__,k__5344__auto__){
var self__ \x3d this;
var this__5343__auto____$1 \x3d this;
return this__5343__auto____$1.cljs$core$ILookup$_lookup$arity$3(null,k__5344__auto__,null);
}));

(datascript.parser.FindColl.prototype.cljs$core$ILookup$_lookup$arity$3 \x3d (function (this__5345__auto__,k54347,else__5346__auto__){
var self__ \x3d this;
var this__5345__auto____$1 \x3d this;
var G__54355 \x3d k54347;
var G__54355__$1 \x3d (((G__54355 instanceof cljs.core.Keyword))?G__54355.fqn:null);
switch (G__54355__$1) {
case \x22element\x22:
return self__.element;

break;
default:
return cljs.core.get.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k54347,else__5346__auto__);

}
}));

(datascript.parser.FindColl.prototype.cljs$core$IKVReduce$_kv_reduce$arity$3 \x3d (function (this__5363__auto__,f__5364__auto__,init__5365__auto__){
var self__ \x3d this;
var this__5363__auto____$1 \x3d this;
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (ret__5366__auto__,p__54356){
var vec__54358 \x3d p__54356;
var k__5367__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54358,(0),null);
var v__5368__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54358,(1),null);
return (f__5364__auto__.cljs$core$IFn$_invoke$arity$3 ? f__5364__auto__.cljs$core$IFn$_invoke$arity$3(ret__5366__auto__,k__5367__auto__,v__5368__auto__) : f__5364__auto__.call(null,ret__5366__auto__,k__5367__auto__,v__5368__auto__));
}),init__5365__auto__,this__5363__auto____$1);
}));

(datascript.parser.FindColl.prototype.cljs$core$IPrintWithWriter$_pr_writer$arity$3 \x3d (function (this__5358__auto__,writer__5359__auto__,opts__5360__auto__){
var self__ \x3d this;
var this__5358__auto____$1 \x3d this;
var pr_pair__5361__auto__ \x3d (function (keyval__5362__auto__){
return cljs.core.pr_sequential_writer(writer__5359__auto__,cljs.core.pr_writer,\x22\x22,\x22 \x22,\x22\x22,opts__5360__auto__,keyval__5362__auto__);
});
return cljs.core.pr_sequential_writer(writer__5359__auto__,pr_pair__5361__auto__,\x22#datascript.parser.FindColl{\x22,\x22, \x22,\x22}\x22,opts__5360__auto__,cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22element\x22,\x22element\x22,1974019749),self__.element],null))], null),self__.__extmap));
}));

(datascript.parser.FindColl.prototype.cljs$core$IIterable$_iterator$arity$1 \x3d (function (G__54346){
var self__ \x3d this;
var G__54346__$1 \x3d this;
return (new cljs.core.RecordIter((0),G__54346__$1,1,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22element\x22,\x22element\x22,1974019749)], null),(cljs.core.truth_(self__.__extmap)?cljs.core._iterator(self__.__extmap):cljs.core.nil_iter())));
}));

(datascript.parser.FindColl.prototype.cljs$core$IMeta$_meta$arity$1 \x3d (function (this__5341__auto__){
var self__ \x3d this;
var this__5341__auto____$1 \x3d this;
return self__.__meta;
}));

(datascript.parser.FindColl.prototype.cljs$core$ICloneable$_clone$arity$1 \x3d (function (this__5338__auto__){
var self__ \x3d this;
var this__5338__auto____$1 \x3d this;
return (new datascript.parser.FindColl(self__.element,self__.__meta,self__.__extmap,self__.__hash));
}));

(datascript.parser.FindColl.prototype.cljs$core$ICounted$_count$arity$1 \x3d (function (this__5347__auto__){
var self__ \x3d this;
var this__5347__auto____$1 \x3d this;
return (1 + cljs.core.count(self__.__extmap));
}));

(datascript.parser.FindColl.prototype.cljs$core$IHash$_hash$arity$1 \x3d (function (this__5339__auto__){
var self__ \x3d this;
var this__5339__auto____$1 \x3d this;
var h__5154__auto__ \x3d self__.__hash;
if((!((h__5154__auto__ \x3d\x3d null)))){
return h__5154__auto__;
} else {
var h__5154__auto____$1 \x3d (function (coll__5340__auto__){
return (124241361 ^ cljs.core.hash_unordered_coll(coll__5340__auto__));
})(this__5339__auto____$1);
(self__.__hash \x3d h__5154__auto____$1);

return h__5154__auto____$1;
}
}));

(datascript.parser.FindColl.prototype.cljs$core$IEquiv$_equiv$arity$2 \x3d (function (this54348,other54349){
var self__ \x3d this;
var this54348__$1 \x3d this;
return (((!((other54349 \x3d\x3d null)))) \x26\x26 ((((this54348__$1.constructor \x3d\x3d\x3d other54349.constructor)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54348__$1.element,other54349.element)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54348__$1.__extmap,other54349.__extmap)))))));
}));

(datascript.parser.FindColl.prototype.cljs$core$IMap$_dissoc$arity$2 \x3d (function (this__5353__auto__,k__5354__auto__){
var self__ \x3d this;
var this__5353__auto____$1 \x3d this;
if(cljs.core.contains_QMARK_(new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,\x22element\x22,\x22element\x22,1974019749),null], null), null),k__5354__auto__)){
return cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(cljs.core._with_meta(cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,this__5353__auto____$1),self__.__meta),k__5354__auto__);
} else {
return (new datascript.parser.FindColl(self__.element,self__.__meta,cljs.core.not_empty(cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(self__.__extmap,k__5354__auto__)),null));
}
}));

(datascript.parser.FindColl.prototype.datascript$parser$IFindElements$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.parser.FindColl.prototype.datascript$parser$IFindElements$find_elements$arity$1 \x3d (function (_){
var self__ \x3d this;
var ___$1 \x3d this;
return new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [self__.element], null);
}));

(datascript.parser.FindColl.prototype.cljs$core$IAssociative$_contains_key_QMARK_$arity$2 \x3d (function (this__5350__auto__,k54347){
var self__ \x3d this;
var this__5350__auto____$1 \x3d this;
var G__54365 \x3d k54347;
var G__54365__$1 \x3d (((G__54365 instanceof cljs.core.Keyword))?G__54365.fqn:null);
switch (G__54365__$1) {
case \x22element\x22:
return true;

break;
default:
return cljs.core.contains_QMARK_(self__.__extmap,k54347);

}
}));

(datascript.parser.FindColl.prototype.cljs$core$IAssociative$_assoc$arity$3 \x3d (function (this__5351__auto__,k__5352__auto__,G__54346){
var self__ \x3d this;
var this__5351__auto____$1 \x3d this;
var pred__54366 \x3d cljs.core.keyword_identical_QMARK_;
var expr__54367 \x3d k__5352__auto__;
if(cljs.core.truth_((pred__54366.cljs$core$IFn$_invoke$arity$2 ? pred__54366.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22element\x22,\x22element\x22,1974019749),expr__54367) : pred__54366.call(null,new cljs.core.Keyword(null,\x22element\x22,\x22element\x22,1974019749),expr__54367)))){
return (new datascript.parser.FindColl(G__54346,self__.__meta,self__.__extmap,null));
} else {
return (new datascript.parser.FindColl(self__.element,self__.__meta,cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k__5352__auto__,G__54346),null));
}
}));

(datascript.parser.FindColl.prototype.cljs$core$ISeqable$_seq$arity$1 \x3d (function (this__5356__auto__){
var self__ \x3d this;
var this__5356__auto____$1 \x3d this;
return cljs.core.seq(cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22element\x22,\x22element\x22,1974019749),self__.element,null))], null),self__.__extmap));
}));

(datascript.parser.FindColl.prototype.cljs$core$IWithMeta$_with_meta$arity$2 \x3d (function (this__5342__auto__,G__54346){
var self__ \x3d this;
var this__5342__auto____$1 \x3d this;
return (new datascript.parser.FindColl(self__.element,G__54346,self__.__extmap,self__.__hash));
}));

(datascript.parser.FindColl.prototype.cljs$core$ICollection$_conj$arity$2 \x3d (function (this__5348__auto__,entry__5349__auto__){
var self__ \x3d this;
var this__5348__auto____$1 \x3d this;
if(cljs.core.vector_QMARK_(entry__5349__auto__)){
return this__5348__auto____$1.cljs$core$IAssociative$_assoc$arity$3(null,cljs.core._nth(entry__5349__auto__,(0)),cljs.core._nth(entry__5349__auto__,(1)));
} else {
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(cljs.core._conj,this__5348__auto____$1,entry__5349__auto__);
}
}));

(datascript.parser.FindColl.prototype.datascript$parser$ITraversable$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.parser.FindColl.prototype.datascript$parser$ITraversable$_postwalk$arity$2 \x3d (function (this__52373__auto__,f54343){
var self__ \x3d this;
var this__52373__auto____$1 \x3d this;
var new__52374__auto__ \x3d (new datascript.parser.FindColl(datascript.parser.postwalk(self__.element,f54343),null,null,null));
var temp__5802__auto__ \x3d cljs.core.meta(this__52373__auto____$1);
if(cljs.core.truth_(temp__5802__auto__)){
var meta__52375__auto__ \x3d temp__5802__auto__;
return cljs.core.with_meta(new__52374__auto__,meta__52375__auto__);
} else {
return new__52374__auto__;
}
}));

(datascript.parser.FindColl.prototype.datascript$parser$ITraversable$_collect$arity$3 \x3d (function (___52376__auto__,pred54344,acc54345){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
return datascript.parser.collect.cljs$core$IFn$_invoke$arity$3(pred54344,self__.element,acc54345);
}));

(datascript.parser.FindColl.prototype.datascript$parser$ITraversable$_collect_vars$arity$2 \x3d (function (___52376__auto__,acc54345){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
return (datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2 ? datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2(acc54345,self__.element) : datascript.parser.collect_vars_acc.call(null,acc54345,self__.element));
}));

(datascript.parser.FindColl.getBasis \x3d (function (){
return new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22element\x22,\x22element\x22,-680416020,null)], null);
}));

(datascript.parser.FindColl.cljs$lang$type \x3d true);

(datascript.parser.FindColl.cljs$lang$ctorPrSeq \x3d (function (this__5389__auto__){
return (new cljs.core.List(null,\x22datascript.parser/FindColl\x22,null,(1),null));
}));

(datascript.parser.FindColl.cljs$lang$ctorPrWriter \x3d (function (this__5389__auto__,writer__5390__auto__){
return cljs.core._write(writer__5390__auto__,\x22datascript.parser/FindColl\x22);
}));

/**
 * Positional factory function for datascript.parser/FindColl.
 */
datascript.parser.__GT_FindColl \x3d (function datascript$parser$__GT_FindColl(element){
return (new datascript.parser.FindColl(element,null,null,null));
});

/**
 * Factory function for datascript.parser/FindColl, taking a map of keywords to field values.
 */
datascript.parser.map__GT_FindColl \x3d (function datascript$parser$map__GT_FindColl(G__54351){
var extmap__5385__auto__ \x3d (function (){var G__54369 \x3d cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(G__54351,new cljs.core.Keyword(null,\x22element\x22,\x22element\x22,1974019749));
if(cljs.core.record_QMARK_(G__54351)){
return cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,G__54369);
} else {
return G__54369;
}
})();
return (new datascript.parser.FindColl(new cljs.core.Keyword(null,\x22element\x22,\x22element\x22,1974019749).cljs$core$IFn$_invoke$arity$1(G__54351),null,cljs.core.not_empty(extmap__5385__auto__),null));
});


/**
* @constructor
 * @implements {cljs.core.IRecord}
 * @implements {cljs.core.IKVReduce}
 * @implements {cljs.core.IEquiv}
 * @implements {cljs.core.IHash}
 * @implements {cljs.core.ICollection}
 * @implements {cljs.core.ICounted}
 * @implements {cljs.core.ISeqable}
 * @implements {cljs.core.IMeta}
 * @implements {cljs.core.ICloneable}
 * @implements {cljs.core.IPrintWithWriter}
 * @implements {cljs.core.IIterable}
 * @implements {datascript.parser.ITraversable}
 * @implements {cljs.core.IWithMeta}
 * @implements {cljs.core.IAssociative}
 * @implements {datascript.parser.IFindElements}
 * @implements {cljs.core.IMap}
 * @implements {cljs.core.ILookup}
*/
datascript.parser.FindScalar \x3d (function (element,__meta,__extmap,__hash){
this.element \x3d element;
this.__meta \x3d __meta;
this.__extmap \x3d __extmap;
this.__hash \x3d __hash;
this.cljs$lang$protocol_mask$partition0$ \x3d 2230716170;
this.cljs$lang$protocol_mask$partition1$ \x3d 139264;
});
(datascript.parser.FindScalar.prototype.cljs$core$ILookup$_lookup$arity$2 \x3d (function (this__5343__auto__,k__5344__auto__){
var self__ \x3d this;
var this__5343__auto____$1 \x3d this;
return this__5343__auto____$1.cljs$core$ILookup$_lookup$arity$3(null,k__5344__auto__,null);
}));

(datascript.parser.FindScalar.prototype.cljs$core$ILookup$_lookup$arity$3 \x3d (function (this__5345__auto__,k54375,else__5346__auto__){
var self__ \x3d this;
var this__5345__auto____$1 \x3d this;
var G__54379 \x3d k54375;
var G__54379__$1 \x3d (((G__54379 instanceof cljs.core.Keyword))?G__54379.fqn:null);
switch (G__54379__$1) {
case \x22element\x22:
return self__.element;

break;
default:
return cljs.core.get.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k54375,else__5346__auto__);

}
}));

(datascript.parser.FindScalar.prototype.cljs$core$IKVReduce$_kv_reduce$arity$3 \x3d (function (this__5363__auto__,f__5364__auto__,init__5365__auto__){
var self__ \x3d this;
var this__5363__auto____$1 \x3d this;
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (ret__5366__auto__,p__54381){
var vec__54382 \x3d p__54381;
var k__5367__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54382,(0),null);
var v__5368__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54382,(1),null);
return (f__5364__auto__.cljs$core$IFn$_invoke$arity$3 ? f__5364__auto__.cljs$core$IFn$_invoke$arity$3(ret__5366__auto__,k__5367__auto__,v__5368__auto__) : f__5364__auto__.call(null,ret__5366__auto__,k__5367__auto__,v__5368__auto__));
}),init__5365__auto__,this__5363__auto____$1);
}));

(datascript.parser.FindScalar.prototype.cljs$core$IPrintWithWriter$_pr_writer$arity$3 \x3d (function (this__5358__auto__,writer__5359__auto__,opts__5360__auto__){
var self__ \x3d this;
var this__5358__auto____$1 \x3d this;
var pr_pair__5361__auto__ \x3d (function (keyval__5362__auto__){
return cljs.core.pr_sequential_writer(writer__5359__auto__,cljs.core.pr_writer,\x22\x22,\x22 \x22,\x22\x22,opts__5360__auto__,keyval__5362__auto__);
});
return cljs.core.pr_sequential_writer(writer__5359__auto__,pr_pair__5361__auto__,\x22#datascript.parser.FindScalar{\x22,\x22, \x22,\x22}\x22,opts__5360__auto__,cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22element\x22,\x22element\x22,1974019749),self__.element],null))], null),self__.__extmap));
}));

(datascript.parser.FindScalar.prototype.cljs$core$IIterable$_iterator$arity$1 \x3d (function (G__54374){
var self__ \x3d this;
var G__54374__$1 \x3d this;
return (new cljs.core.RecordIter((0),G__54374__$1,1,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22element\x22,\x22element\x22,1974019749)], null),(cljs.core.truth_(self__.__extmap)?cljs.core._iterator(self__.__extmap):cljs.core.nil_iter())));
}));

(datascript.parser.FindScalar.prototype.cljs$core$IMeta$_meta$arity$1 \x3d (function (this__5341__auto__){
var self__ \x3d this;
var this__5341__auto____$1 \x3d this;
return self__.__meta;
}));

(datascript.parser.FindScalar.prototype.cljs$core$ICloneable$_clone$arity$1 \x3d (function (this__5338__auto__){
var self__ \x3d this;
var this__5338__auto____$1 \x3d this;
return (new datascript.parser.FindScalar(self__.element,self__.__meta,self__.__extmap,self__.__hash));
}));

(datascript.parser.FindScalar.prototype.cljs$core$ICounted$_count$arity$1 \x3d (function (this__5347__auto__){
var self__ \x3d this;
var this__5347__auto____$1 \x3d this;
return (1 + cljs.core.count(self__.__extmap));
}));

(datascript.parser.FindScalar.prototype.cljs$core$IHash$_hash$arity$1 \x3d (function (this__5339__auto__){
var self__ \x3d this;
var this__5339__auto____$1 \x3d this;
var h__5154__auto__ \x3d self__.__hash;
if((!((h__5154__auto__ \x3d\x3d null)))){
return h__5154__auto__;
} else {
var h__5154__auto____$1 \x3d (function (coll__5340__auto__){
return (-661542332 ^ cljs.core.hash_unordered_coll(coll__5340__auto__));
})(this__5339__auto____$1);
(self__.__hash \x3d h__5154__auto____$1);

return h__5154__auto____$1;
}
}));

(datascript.parser.FindScalar.prototype.cljs$core$IEquiv$_equiv$arity$2 \x3d (function (this54376,other54377){
var self__ \x3d this;
var this54376__$1 \x3d this;
return (((!((other54377 \x3d\x3d null)))) \x26\x26 ((((this54376__$1.constructor \x3d\x3d\x3d other54377.constructor)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54376__$1.element,other54377.element)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54376__$1.__extmap,other54377.__extmap)))))));
}));

(datascript.parser.FindScalar.prototype.cljs$core$IMap$_dissoc$arity$2 \x3d (function (this__5353__auto__,k__5354__auto__){
var self__ \x3d this;
var this__5353__auto____$1 \x3d this;
if(cljs.core.contains_QMARK_(new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,\x22element\x22,\x22element\x22,1974019749),null], null), null),k__5354__auto__)){
return cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(cljs.core._with_meta(cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,this__5353__auto____$1),self__.__meta),k__5354__auto__);
} else {
return (new datascript.parser.FindScalar(self__.element,self__.__meta,cljs.core.not_empty(cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(self__.__extmap,k__5354__auto__)),null));
}
}));

(datascript.parser.FindScalar.prototype.datascript$parser$IFindElements$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.parser.FindScalar.prototype.datascript$parser$IFindElements$find_elements$arity$1 \x3d (function (_){
var self__ \x3d this;
var ___$1 \x3d this;
return new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [self__.element], null);
}));

(datascript.parser.FindScalar.prototype.cljs$core$IAssociative$_contains_key_QMARK_$arity$2 \x3d (function (this__5350__auto__,k54375){
var self__ \x3d this;
var this__5350__auto____$1 \x3d this;
var G__54388 \x3d k54375;
var G__54388__$1 \x3d (((G__54388 instanceof cljs.core.Keyword))?G__54388.fqn:null);
switch (G__54388__$1) {
case \x22element\x22:
return true;

break;
default:
return cljs.core.contains_QMARK_(self__.__extmap,k54375);

}
}));

(datascript.parser.FindScalar.prototype.cljs$core$IAssociative$_assoc$arity$3 \x3d (function (this__5351__auto__,k__5352__auto__,G__54374){
var self__ \x3d this;
var this__5351__auto____$1 \x3d this;
var pred__54389 \x3d cljs.core.keyword_identical_QMARK_;
var expr__54390 \x3d k__5352__auto__;
if(cljs.core.truth_((pred__54389.cljs$core$IFn$_invoke$arity$2 ? pred__54389.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22element\x22,\x22element\x22,1974019749),expr__54390) : pred__54389.call(null,new cljs.core.Keyword(null,\x22element\x22,\x22element\x22,1974019749),expr__54390)))){
return (new datascript.parser.FindScalar(G__54374,self__.__meta,self__.__extmap,null));
} else {
return (new datascript.parser.FindScalar(self__.element,self__.__meta,cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k__5352__auto__,G__54374),null));
}
}));

(datascript.parser.FindScalar.prototype.cljs$core$ISeqable$_seq$arity$1 \x3d (function (this__5356__auto__){
var self__ \x3d this;
var this__5356__auto____$1 \x3d this;
return cljs.core.seq(cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22element\x22,\x22element\x22,1974019749),self__.element,null))], null),self__.__extmap));
}));

(datascript.parser.FindScalar.prototype.cljs$core$IWithMeta$_with_meta$arity$2 \x3d (function (this__5342__auto__,G__54374){
var self__ \x3d this;
var this__5342__auto____$1 \x3d this;
return (new datascript.parser.FindScalar(self__.element,G__54374,self__.__extmap,self__.__hash));
}));

(datascript.parser.FindScalar.prototype.cljs$core$ICollection$_conj$arity$2 \x3d (function (this__5348__auto__,entry__5349__auto__){
var self__ \x3d this;
var this__5348__auto____$1 \x3d this;
if(cljs.core.vector_QMARK_(entry__5349__auto__)){
return this__5348__auto____$1.cljs$core$IAssociative$_assoc$arity$3(null,cljs.core._nth(entry__5349__auto__,(0)),cljs.core._nth(entry__5349__auto__,(1)));
} else {
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(cljs.core._conj,this__5348__auto____$1,entry__5349__auto__);
}
}));

(datascript.parser.FindScalar.prototype.datascript$parser$ITraversable$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.parser.FindScalar.prototype.datascript$parser$ITraversable$_postwalk$arity$2 \x3d (function (this__52373__auto__,f54371){
var self__ \x3d this;
var this__52373__auto____$1 \x3d this;
var new__52374__auto__ \x3d (new datascript.parser.FindScalar(datascript.parser.postwalk(self__.element,f54371),null,null,null));
var temp__5802__auto__ \x3d cljs.core.meta(this__52373__auto____$1);
if(cljs.core.truth_(temp__5802__auto__)){
var meta__52375__auto__ \x3d temp__5802__auto__;
return cljs.core.with_meta(new__52374__auto__,meta__52375__auto__);
} else {
return new__52374__auto__;
}
}));

(datascript.parser.FindScalar.prototype.datascript$parser$ITraversable$_collect$arity$3 \x3d (function (___52376__auto__,pred54372,acc54373){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
return datascript.parser.collect.cljs$core$IFn$_invoke$arity$3(pred54372,self__.element,acc54373);
}));

(datascript.parser.FindScalar.prototype.datascript$parser$ITraversable$_collect_vars$arity$2 \x3d (function (___52376__auto__,acc54373){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
return (datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2 ? datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2(acc54373,self__.element) : datascript.parser.collect_vars_acc.call(null,acc54373,self__.element));
}));

(datascript.parser.FindScalar.getBasis \x3d (function (){
return new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22element\x22,\x22element\x22,-680416020,null)], null);
}));

(datascript.parser.FindScalar.cljs$lang$type \x3d true);

(datascript.parser.FindScalar.cljs$lang$ctorPrSeq \x3d (function (this__5389__auto__){
return (new cljs.core.List(null,\x22datascript.parser/FindScalar\x22,null,(1),null));
}));

(datascript.parser.FindScalar.cljs$lang$ctorPrWriter \x3d (function (this__5389__auto__,writer__5390__auto__){
return cljs.core._write(writer__5390__auto__,\x22datascript.parser/FindScalar\x22);
}));

/**
 * Positional factory function for datascript.parser/FindScalar.
 */
datascript.parser.__GT_FindScalar \x3d (function datascript$parser$__GT_FindScalar(element){
return (new datascript.parser.FindScalar(element,null,null,null));
});

/**
 * Factory function for datascript.parser/FindScalar, taking a map of keywords to field values.
 */
datascript.parser.map__GT_FindScalar \x3d (function datascript$parser$map__GT_FindScalar(G__54378){
var extmap__5385__auto__ \x3d (function (){var G__54393 \x3d cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(G__54378,new cljs.core.Keyword(null,\x22element\x22,\x22element\x22,1974019749));
if(cljs.core.record_QMARK_(G__54378)){
return cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,G__54393);
} else {
return G__54393;
}
})();
return (new datascript.parser.FindScalar(new cljs.core.Keyword(null,\x22element\x22,\x22element\x22,1974019749).cljs$core$IFn$_invoke$arity$1(G__54378),null,cljs.core.not_empty(extmap__5385__auto__),null));
});


/**
* @constructor
 * @implements {cljs.core.IRecord}
 * @implements {cljs.core.IKVReduce}
 * @implements {cljs.core.IEquiv}
 * @implements {cljs.core.IHash}
 * @implements {cljs.core.ICollection}
 * @implements {cljs.core.ICounted}
 * @implements {cljs.core.ISeqable}
 * @implements {cljs.core.IMeta}
 * @implements {cljs.core.ICloneable}
 * @implements {cljs.core.IPrintWithWriter}
 * @implements {cljs.core.IIterable}
 * @implements {datascript.parser.ITraversable}
 * @implements {cljs.core.IWithMeta}
 * @implements {cljs.core.IAssociative}
 * @implements {datascript.parser.IFindElements}
 * @implements {cljs.core.IMap}
 * @implements {cljs.core.ILookup}
*/
datascript.parser.FindTuple \x3d (function (elements,__meta,__extmap,__hash){
this.elements \x3d elements;
this.__meta \x3d __meta;
this.__extmap \x3d __extmap;
this.__hash \x3d __hash;
this.cljs$lang$protocol_mask$partition0$ \x3d 2230716170;
this.cljs$lang$protocol_mask$partition1$ \x3d 139264;
});
(datascript.parser.FindTuple.prototype.cljs$core$ILookup$_lookup$arity$2 \x3d (function (this__5343__auto__,k__5344__auto__){
var self__ \x3d this;
var this__5343__auto____$1 \x3d this;
return this__5343__auto____$1.cljs$core$ILookup$_lookup$arity$3(null,k__5344__auto__,null);
}));

(datascript.parser.FindTuple.prototype.cljs$core$ILookup$_lookup$arity$3 \x3d (function (this__5345__auto__,k54399,else__5346__auto__){
var self__ \x3d this;
var this__5345__auto____$1 \x3d this;
var G__54403 \x3d k54399;
var G__54403__$1 \x3d (((G__54403 instanceof cljs.core.Keyword))?G__54403.fqn:null);
switch (G__54403__$1) {
case \x22elements\x22:
return self__.elements;

break;
default:
return cljs.core.get.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k54399,else__5346__auto__);

}
}));

(datascript.parser.FindTuple.prototype.cljs$core$IKVReduce$_kv_reduce$arity$3 \x3d (function (this__5363__auto__,f__5364__auto__,init__5365__auto__){
var self__ \x3d this;
var this__5363__auto____$1 \x3d this;
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (ret__5366__auto__,p__54404){
var vec__54406 \x3d p__54404;
var k__5367__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54406,(0),null);
var v__5368__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54406,(1),null);
return (f__5364__auto__.cljs$core$IFn$_invoke$arity$3 ? f__5364__auto__.cljs$core$IFn$_invoke$arity$3(ret__5366__auto__,k__5367__auto__,v__5368__auto__) : f__5364__auto__.call(null,ret__5366__auto__,k__5367__auto__,v__5368__auto__));
}),init__5365__auto__,this__5363__auto____$1);
}));

(datascript.parser.FindTuple.prototype.cljs$core$IPrintWithWriter$_pr_writer$arity$3 \x3d (function (this__5358__auto__,writer__5359__auto__,opts__5360__auto__){
var self__ \x3d this;
var this__5358__auto____$1 \x3d this;
var pr_pair__5361__auto__ \x3d (function (keyval__5362__auto__){
return cljs.core.pr_sequential_writer(writer__5359__auto__,cljs.core.pr_writer,\x22\x22,\x22 \x22,\x22\x22,opts__5360__auto__,keyval__5362__auto__);
});
return cljs.core.pr_sequential_writer(writer__5359__auto__,pr_pair__5361__auto__,\x22#datascript.parser.FindTuple{\x22,\x22, \x22,\x22}\x22,opts__5360__auto__,cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22elements\x22,\x22elements\x22,657646735),self__.elements],null))], null),self__.__extmap));
}));

(datascript.parser.FindTuple.prototype.cljs$core$IIterable$_iterator$arity$1 \x3d (function (G__54398){
var self__ \x3d this;
var G__54398__$1 \x3d this;
return (new cljs.core.RecordIter((0),G__54398__$1,1,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22elements\x22,\x22elements\x22,657646735)], null),(cljs.core.truth_(self__.__extmap)?cljs.core._iterator(self__.__extmap):cljs.core.nil_iter())));
}));

(datascript.parser.FindTuple.prototype.cljs$core$IMeta$_meta$arity$1 \x3d (function (this__5341__auto__){
var self__ \x3d this;
var this__5341__auto____$1 \x3d this;
return self__.__meta;
}));

(datascript.parser.FindTuple.prototype.cljs$core$ICloneable$_clone$arity$1 \x3d (function (this__5338__auto__){
var self__ \x3d this;
var this__5338__auto____$1 \x3d this;
return (new datascript.parser.FindTuple(self__.elements,self__.__meta,self__.__extmap,self__.__hash));
}));

(datascript.parser.FindTuple.prototype.cljs$core$ICounted$_count$arity$1 \x3d (function (this__5347__auto__){
var self__ \x3d this;
var this__5347__auto____$1 \x3d this;
return (1 + cljs.core.count(self__.__extmap));
}));

(datascript.parser.FindTuple.prototype.cljs$core$IHash$_hash$arity$1 \x3d (function (this__5339__auto__){
var self__ \x3d this;
var this__5339__auto____$1 \x3d this;
var h__5154__auto__ \x3d self__.__hash;
if((!((h__5154__auto__ \x3d\x3d null)))){
return h__5154__auto__;
} else {
var h__5154__auto____$1 \x3d (function (coll__5340__auto__){
return (681530371 ^ cljs.core.hash_unordered_coll(coll__5340__auto__));
})(this__5339__auto____$1);
(self__.__hash \x3d h__5154__auto____$1);

return h__5154__auto____$1;
}
}));

(datascript.parser.FindTuple.prototype.cljs$core$IEquiv$_equiv$arity$2 \x3d (function (this54400,other54401){
var self__ \x3d this;
var this54400__$1 \x3d this;
return (((!((other54401 \x3d\x3d null)))) \x26\x26 ((((this54400__$1.constructor \x3d\x3d\x3d other54401.constructor)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54400__$1.elements,other54401.elements)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54400__$1.__extmap,other54401.__extmap)))))));
}));

(datascript.parser.FindTuple.prototype.cljs$core$IMap$_dissoc$arity$2 \x3d (function (this__5353__auto__,k__5354__auto__){
var self__ \x3d this;
var this__5353__auto____$1 \x3d this;
if(cljs.core.contains_QMARK_(new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,\x22elements\x22,\x22elements\x22,657646735),null], null), null),k__5354__auto__)){
return cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(cljs.core._with_meta(cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,this__5353__auto____$1),self__.__meta),k__5354__auto__);
} else {
return (new datascript.parser.FindTuple(self__.elements,self__.__meta,cljs.core.not_empty(cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(self__.__extmap,k__5354__auto__)),null));
}
}));

(datascript.parser.FindTuple.prototype.datascript$parser$IFindElements$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.parser.FindTuple.prototype.datascript$parser$IFindElements$find_elements$arity$1 \x3d (function (_){
var self__ \x3d this;
var ___$1 \x3d this;
return self__.elements;
}));

(datascript.parser.FindTuple.prototype.cljs$core$IAssociative$_contains_key_QMARK_$arity$2 \x3d (function (this__5350__auto__,k54399){
var self__ \x3d this;
var this__5350__auto____$1 \x3d this;
var G__54413 \x3d k54399;
var G__54413__$1 \x3d (((G__54413 instanceof cljs.core.Keyword))?G__54413.fqn:null);
switch (G__54413__$1) {
case \x22elements\x22:
return true;

break;
default:
return cljs.core.contains_QMARK_(self__.__extmap,k54399);

}
}));

(datascript.parser.FindTuple.prototype.cljs$core$IAssociative$_assoc$arity$3 \x3d (function (this__5351__auto__,k__5352__auto__,G__54398){
var self__ \x3d this;
var this__5351__auto____$1 \x3d this;
var pred__54414 \x3d cljs.core.keyword_identical_QMARK_;
var expr__54415 \x3d k__5352__auto__;
if(cljs.core.truth_((pred__54414.cljs$core$IFn$_invoke$arity$2 ? pred__54414.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22elements\x22,\x22elements\x22,657646735),expr__54415) : pred__54414.call(null,new cljs.core.Keyword(null,\x22elements\x22,\x22elements\x22,657646735),expr__54415)))){
return (new datascript.parser.FindTuple(G__54398,self__.__meta,self__.__extmap,null));
} else {
return (new datascript.parser.FindTuple(self__.elements,self__.__meta,cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k__5352__auto__,G__54398),null));
}
}));

(datascript.parser.FindTuple.prototype.cljs$core$ISeqable$_seq$arity$1 \x3d (function (this__5356__auto__){
var self__ \x3d this;
var this__5356__auto____$1 \x3d this;
return cljs.core.seq(cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22elements\x22,\x22elements\x22,657646735),self__.elements,null))], null),self__.__extmap));
}));

(datascript.parser.FindTuple.prototype.cljs$core$IWithMeta$_with_meta$arity$2 \x3d (function (this__5342__auto__,G__54398){
var self__ \x3d this;
var this__5342__auto____$1 \x3d this;
return (new datascript.parser.FindTuple(self__.elements,G__54398,self__.__extmap,self__.__hash));
}));

(datascript.parser.FindTuple.prototype.cljs$core$ICollection$_conj$arity$2 \x3d (function (this__5348__auto__,entry__5349__auto__){
var self__ \x3d this;
var this__5348__auto____$1 \x3d this;
if(cljs.core.vector_QMARK_(entry__5349__auto__)){
return this__5348__auto____$1.cljs$core$IAssociative$_assoc$arity$3(null,cljs.core._nth(entry__5349__auto__,(0)),cljs.core._nth(entry__5349__auto__,(1)));
} else {
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(cljs.core._conj,this__5348__auto____$1,entry__5349__auto__);
}
}));

(datascript.parser.FindTuple.prototype.datascript$parser$ITraversable$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.parser.FindTuple.prototype.datascript$parser$ITraversable$_postwalk$arity$2 \x3d (function (this__52373__auto__,f54395){
var self__ \x3d this;
var this__52373__auto____$1 \x3d this;
var new__52374__auto__ \x3d (new datascript.parser.FindTuple(datascript.parser.postwalk(self__.elements,f54395),null,null,null));
var temp__5802__auto__ \x3d cljs.core.meta(this__52373__auto____$1);
if(cljs.core.truth_(temp__5802__auto__)){
var meta__52375__auto__ \x3d temp__5802__auto__;
return cljs.core.with_meta(new__52374__auto__,meta__52375__auto__);
} else {
return new__52374__auto__;
}
}));

(datascript.parser.FindTuple.prototype.datascript$parser$ITraversable$_collect$arity$3 \x3d (function (___52376__auto__,pred54396,acc54397){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
return datascript.parser.collect.cljs$core$IFn$_invoke$arity$3(pred54396,self__.elements,acc54397);
}));

(datascript.parser.FindTuple.prototype.datascript$parser$ITraversable$_collect_vars$arity$2 \x3d (function (___52376__auto__,acc54397){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
return (datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2 ? datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2(acc54397,self__.elements) : datascript.parser.collect_vars_acc.call(null,acc54397,self__.elements));
}));

(datascript.parser.FindTuple.getBasis \x3d (function (){
return new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22elements\x22,\x22elements\x22,-1996789034,null)], null);
}));

(datascript.parser.FindTuple.cljs$lang$type \x3d true);

(datascript.parser.FindTuple.cljs$lang$ctorPrSeq \x3d (function (this__5389__auto__){
return (new cljs.core.List(null,\x22datascript.parser/FindTuple\x22,null,(1),null));
}));

(datascript.parser.FindTuple.cljs$lang$ctorPrWriter \x3d (function (this__5389__auto__,writer__5390__auto__){
return cljs.core._write(writer__5390__auto__,\x22datascript.parser/FindTuple\x22);
}));

/**
 * Positional factory function for datascript.parser/FindTuple.
 */
datascript.parser.__GT_FindTuple \x3d (function datascript$parser$__GT_FindTuple(elements){
return (new datascript.parser.FindTuple(elements,null,null,null));
});

/**
 * Factory function for datascript.parser/FindTuple, taking a map of keywords to field values.
 */
datascript.parser.map__GT_FindTuple \x3d (function datascript$parser$map__GT_FindTuple(G__54402){
var extmap__5385__auto__ \x3d (function (){var G__54418 \x3d cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(G__54402,new cljs.core.Keyword(null,\x22elements\x22,\x22elements\x22,657646735));
if(cljs.core.record_QMARK_(G__54402)){
return cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,G__54418);
} else {
return G__54418;
}
})();
return (new datascript.parser.FindTuple(new cljs.core.Keyword(null,\x22elements\x22,\x22elements\x22,657646735).cljs$core$IFn$_invoke$arity$1(G__54402),null,cljs.core.not_empty(extmap__5385__auto__),null));
});

datascript.parser.find_vars \x3d (function datascript$parser$find_vars(find){
return cljs.core.mapcat.cljs$core$IFn$_invoke$arity$variadic(datascript.parser._find_vars,cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([datascript.parser.find_elements(find)], 0));
});
datascript.parser.aggregate_QMARK_ \x3d (function datascript$parser$aggregate_QMARK_(element){
return (element instanceof datascript.parser.Aggregate);
});
datascript.parser.pull_QMARK_ \x3d (function datascript$parser$pull_QMARK_(element){
return (element instanceof datascript.parser.Pull);
});
datascript.parser.parse_aggregate \x3d (function datascript$parser$parse_aggregate(form){
if(((cljs.core.sequential_QMARK_(form)) \x26\x26 ((cljs.core.count(form) \x3e\x3d (2))))){
var vec__54420 \x3d form;
var seq__54421 \x3d cljs.core.seq(vec__54420);
var first__54422 \x3d cljs.core.first(seq__54421);
var seq__54421__$1 \x3d cljs.core.next(seq__54421);
var fn \x3d first__54422;
var args \x3d seq__54421__$1;
var fn_STAR_ \x3d datascript.parser.parse_plain_symbol(fn);
var args_STAR_ \x3d datascript.parser.parse_seq(datascript.parser.parse_fn_arg,args);
if(cljs.core.truth_((function (){var and__5043__auto__ \x3d fn_STAR_;
if(cljs.core.truth_(and__5043__auto__)){
return args_STAR_;
} else {
return and__5043__auto__;
}
})())){
return (new datascript.parser.Aggregate(fn_STAR_,args_STAR_,null,null,null));
} else {
return null;
}
} else {
return null;
}
});
datascript.parser.parse_aggregate_custom \x3d (function datascript$parser$parse_aggregate_custom(form){
if(((cljs.core.sequential_QMARK_(form)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(cljs.core.first(form),new cljs.core.Symbol(null,\x22aggregate\x22,\x22aggregate\x22,-1142967327,null))))){
if((cljs.core.count(form) \x3e\x3d (3))){
var vec__54423 \x3d form;
var seq__54424 \x3d cljs.core.seq(vec__54423);
var first__54425 \x3d cljs.core.first(seq__54424);
var seq__54424__$1 \x3d cljs.core.next(seq__54424);
var _ \x3d first__54425;
var first__54425__$1 \x3d cljs.core.first(seq__54424__$1);
var seq__54424__$2 \x3d cljs.core.next(seq__54424__$1);
var fn \x3d first__54425__$1;
var args \x3d seq__54424__$2;
var fn_STAR_ \x3d datascript.parser.parse_variable(fn);
var args_STAR_ \x3d datascript.parser.parse_seq(datascript.parser.parse_fn_arg,args);
if(cljs.core.truth_((function (){var and__5043__auto__ \x3d fn_STAR_;
if(cljs.core.truth_(and__5043__auto__)){
return args_STAR_;
} else {
return and__5043__auto__;
}
})())){
return (new datascript.parser.Aggregate(fn_STAR_,args_STAR_,null,null,null));
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2(\x22Cannot parse custom aggregate call, expect [\x27aggregate\x27 variable fn-arg+]\x22,new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22parser\x22,\x22find\x22,\x22parser/find\x22,-801023103),new cljs.core.Keyword(null,\x22fragment\x22,\x22fragment\x22,826775688),form], null));
}
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2(\x22Cannot parse custom aggregate call, expect [\x27aggregate\x27 variable fn-arg+]\x22,new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22parser\x22,\x22find\x22,\x22parser/find\x22,-801023103),new cljs.core.Keyword(null,\x22fragment\x22,\x22fragment\x22,826775688),form], null));
}
} else {
return null;
}
});
datascript.parser.parse_pull_expr \x3d (function datascript$parser$parse_pull_expr(form){
if(((cljs.core.sequential_QMARK_(form)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(cljs.core.first(form),new cljs.core.Symbol(null,\x22pull\x22,\x22pull\x22,779986722,null))))){
if(((((3) \x3c\x3d cljs.core.count(form))) \x26\x26 ((cljs.core.count(form) \x3c\x3d (4))))){
var long_QMARK_ \x3d cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(cljs.core.count(form),(4));
var src \x3d ((long_QMARK_)?cljs.core.nth.cljs$core$IFn$_invoke$arity$2(form,(1)):new cljs.core.Symbol(null,\x22$\x22,\x22$\x22,-1580747756,null));
var vec__54427 \x3d ((long_QMARK_)?cljs.core.nnext(form):cljs.core.next(form));
var var$ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54427,(0),null);
var pattern \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54427,(1),null);
var src_STAR_ \x3d datascript.parser.parse_src_var(src);
var var_STAR_ \x3d datascript.parser.parse_variable(var$);
var pattern_STAR_ \x3d (function (){var or__5045__auto__ \x3d datascript.parser.parse_variable(pattern);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
var or__5045__auto____$1 \x3d datascript.parser.parse_plain_variable(pattern);
if(cljs.core.truth_(or__5045__auto____$1)){
return or__5045__auto____$1;
} else {
return datascript.parser.parse_constant(pattern);
}
}
})();
if(cljs.core.truth_((function (){var and__5043__auto__ \x3d src_STAR_;
if(cljs.core.truth_(and__5043__auto__)){
var and__5043__auto____$1 \x3d var_STAR_;
if(cljs.core.truth_(and__5043__auto____$1)){
return pattern_STAR_;
} else {
return and__5043__auto____$1;
}
} else {
return and__5043__auto__;
}
})())){
return (new datascript.parser.Pull(src_STAR_,var_STAR_,pattern_STAR_,null,null,null));
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2(\x22Cannot parse pull expression, expect [\x27pull\x27 src-var? variable (constant | variable | plain-symbol)]\x22,new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22parser\x22,\x22find\x22,\x22parser/find\x22,-801023103),new cljs.core.Keyword(null,\x22fragment\x22,\x22fragment\x22,826775688),form], null));
}
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2(\x22Cannot parse pull expression, expect [\x27pull\x27 src-var? variable (constant | variable | plain-symbol)]\x22,new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22parser\x22,\x22find\x22,\x22parser/find\x22,-801023103),new cljs.core.Keyword(null,\x22fragment\x22,\x22fragment\x22,826775688),form], null));
}
} else {
return null;
}
});
datascript.parser.parse_find_elem \x3d (function datascript$parser$parse_find_elem(form){
var or__5045__auto__ \x3d datascript.parser.parse_variable(form);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
var or__5045__auto____$1 \x3d datascript.parser.parse_pull_expr(form);
if(cljs.core.truth_(or__5045__auto____$1)){
return or__5045__auto____$1;
} else {
var or__5045__auto____$2 \x3d datascript.parser.parse_aggregate_custom(form);
if(cljs.core.truth_(or__5045__auto____$2)){
return or__5045__auto____$2;
} else {
return datascript.parser.parse_aggregate(form);
}
}
}
});
datascript.parser.parse_find_rel \x3d (function datascript$parser$parse_find_rel(form){
var G__54431 \x3d datascript.parser.parse_seq(datascript.parser.parse_find_elem,form);
if((G__54431 \x3d\x3d null)){
return null;
} else {
return (new datascript.parser.FindRel(G__54431,null,null,null));
}
});
datascript.parser.parse_find_coll \x3d (function datascript$parser$parse_find_coll(form){
if(((cljs.core.sequential_QMARK_(form)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(cljs.core.count(form),(1))))){
var inner \x3d cljs.core.first(form);
if(((cljs.core.sequential_QMARK_(inner)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(cljs.core.count(inner),(2))) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(cljs.core.second(inner),new cljs.core.Symbol(null,\x22...\x22,\x22...\x22,-1926939749,null))))))){
var G__54432 \x3d datascript.parser.parse_find_elem(cljs.core.first(inner));
if((G__54432 \x3d\x3d null)){
return null;
} else {
return (new datascript.parser.FindColl(G__54432,null,null,null));
}
} else {
return null;
}
} else {
return null;
}
});
datascript.parser.parse_find_scalar \x3d (function datascript$parser$parse_find_scalar(form){
if(((cljs.core.sequential_QMARK_(form)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(cljs.core.count(form),(2))) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(cljs.core.second(form),new cljs.core.Symbol(null,\x22.\x22,\x22.\x22,1975675962,null))))))){
var G__54433 \x3d datascript.parser.parse_find_elem(cljs.core.first(form));
if((G__54433 \x3d\x3d null)){
return null;
} else {
return (new datascript.parser.FindScalar(G__54433,null,null,null));
}
} else {
return null;
}
});
datascript.parser.parse_find_tuple \x3d (function datascript$parser$parse_find_tuple(form){
if(((cljs.core.sequential_QMARK_(form)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(cljs.core.count(form),(1))))){
var inner \x3d cljs.core.first(form);
var G__54434 \x3d datascript.parser.parse_seq(datascript.parser.parse_find_elem,inner);
if((G__54434 \x3d\x3d null)){
return null;
} else {
return (new datascript.parser.FindTuple(G__54434,null,null,null));
}
} else {
return null;
}
});
datascript.parser.parse_find \x3d (function datascript$parser$parse_find(form){
var or__5045__auto__ \x3d datascript.parser.parse_find_rel(form);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
var or__5045__auto____$1 \x3d datascript.parser.parse_find_coll(form);
if(cljs.core.truth_(or__5045__auto____$1)){
return or__5045__auto____$1;
} else {
var or__5045__auto____$2 \x3d datascript.parser.parse_find_scalar(form);
if(cljs.core.truth_(or__5045__auto____$2)){
return or__5045__auto____$2;
} else {
var or__5045__auto____$3 \x3d datascript.parser.parse_find_tuple(form);
if(cljs.core.truth_(or__5045__auto____$3)){
return or__5045__auto____$3;
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2(\x22Cannot parse :find, expected: (find-rel | find-coll | find-tuple | find-scalar)\x22,new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22parser\x22,\x22find\x22,\x22parser/find\x22,-801023103),new cljs.core.Keyword(null,\x22fragment\x22,\x22fragment\x22,826775688),form], null));
}
}
}
}
});

/**
* @constructor
 * @implements {cljs.core.IRecord}
 * @implements {cljs.core.IKVReduce}
 * @implements {cljs.core.IEquiv}
 * @implements {cljs.core.IHash}
 * @implements {cljs.core.ICollection}
 * @implements {cljs.core.ICounted}
 * @implements {cljs.core.ISeqable}
 * @implements {cljs.core.IMeta}
 * @implements {cljs.core.ICloneable}
 * @implements {cljs.core.IPrintWithWriter}
 * @implements {cljs.core.IIterable}
 * @implements {datascript.parser.ITraversable}
 * @implements {cljs.core.IWithMeta}
 * @implements {cljs.core.IAssociative}
 * @implements {cljs.core.IMap}
 * @implements {cljs.core.ILookup}
*/
datascript.parser.ReturnMap \x3d (function (type,symbols,__meta,__extmap,__hash){
this.type \x3d type;
this.symbols \x3d symbols;
this.__meta \x3d __meta;
this.__extmap \x3d __extmap;
this.__hash \x3d __hash;
this.cljs$lang$protocol_mask$partition0$ \x3d 2230716170;
this.cljs$lang$protocol_mask$partition1$ \x3d 139264;
});
(datascript.parser.ReturnMap.prototype.cljs$core$ILookup$_lookup$arity$2 \x3d (function (this__5343__auto__,k__5344__auto__){
var self__ \x3d this;
var this__5343__auto____$1 \x3d this;
return this__5343__auto____$1.cljs$core$ILookup$_lookup$arity$3(null,k__5344__auto__,null);
}));

(datascript.parser.ReturnMap.prototype.cljs$core$ILookup$_lookup$arity$3 \x3d (function (this__5345__auto__,k54443,else__5346__auto__){
var self__ \x3d this;
var this__5345__auto____$1 \x3d this;
var G__54471 \x3d k54443;
var G__54471__$1 \x3d (((G__54471 instanceof cljs.core.Keyword))?G__54471.fqn:null);
switch (G__54471__$1) {
case \x22type\x22:
return self__.type;

break;
case \x22symbols\x22:
return self__.symbols;

break;
default:
return cljs.core.get.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k54443,else__5346__auto__);

}
}));

(datascript.parser.ReturnMap.prototype.cljs$core$IKVReduce$_kv_reduce$arity$3 \x3d (function (this__5363__auto__,f__5364__auto__,init__5365__auto__){
var self__ \x3d this;
var this__5363__auto____$1 \x3d this;
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (ret__5366__auto__,p__54476){
var vec__54477 \x3d p__54476;
var k__5367__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54477,(0),null);
var v__5368__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54477,(1),null);
return (f__5364__auto__.cljs$core$IFn$_invoke$arity$3 ? f__5364__auto__.cljs$core$IFn$_invoke$arity$3(ret__5366__auto__,k__5367__auto__,v__5368__auto__) : f__5364__auto__.call(null,ret__5366__auto__,k__5367__auto__,v__5368__auto__));
}),init__5365__auto__,this__5363__auto____$1);
}));

(datascript.parser.ReturnMap.prototype.cljs$core$IPrintWithWriter$_pr_writer$arity$3 \x3d (function (this__5358__auto__,writer__5359__auto__,opts__5360__auto__){
var self__ \x3d this;
var this__5358__auto____$1 \x3d this;
var pr_pair__5361__auto__ \x3d (function (keyval__5362__auto__){
return cljs.core.pr_sequential_writer(writer__5359__auto__,cljs.core.pr_writer,\x22\x22,\x22 \x22,\x22\x22,opts__5360__auto__,keyval__5362__auto__);
});
return cljs.core.pr_sequential_writer(writer__5359__auto__,pr_pair__5361__auto__,\x22#datascript.parser.ReturnMap{\x22,\x22, \x22,\x22}\x22,opts__5360__auto__,cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22type\x22,\x22type\x22,1174270348),self__.type],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22symbols\x22,\x22symbols\x22,1211743),self__.symbols],null))], null),self__.__extmap));
}));

(datascript.parser.ReturnMap.prototype.cljs$core$IIterable$_iterator$arity$1 \x3d (function (G__54442){
var self__ \x3d this;
var G__54442__$1 \x3d this;
return (new cljs.core.RecordIter((0),G__54442__$1,2,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22type\x22,\x22type\x22,1174270348),new cljs.core.Keyword(null,\x22symbols\x22,\x22symbols\x22,1211743)], null),(cljs.core.truth_(self__.__extmap)?cljs.core._iterator(self__.__extmap):cljs.core.nil_iter())));
}));

(datascript.parser.ReturnMap.prototype.cljs$core$IMeta$_meta$arity$1 \x3d (function (this__5341__auto__){
var self__ \x3d this;
var this__5341__auto____$1 \x3d this;
return self__.__meta;
}));

(datascript.parser.ReturnMap.prototype.cljs$core$ICloneable$_clone$arity$1 \x3d (function (this__5338__auto__){
var self__ \x3d this;
var this__5338__auto____$1 \x3d this;
return (new datascript.parser.ReturnMap(self__.type,self__.symbols,self__.__meta,self__.__extmap,self__.__hash));
}));

(datascript.parser.ReturnMap.prototype.cljs$core$ICounted$_count$arity$1 \x3d (function (this__5347__auto__){
var self__ \x3d this;
var this__5347__auto____$1 \x3d this;
return (2 + cljs.core.count(self__.__extmap));
}));

(datascript.parser.ReturnMap.prototype.cljs$core$IHash$_hash$arity$1 \x3d (function (this__5339__auto__){
var self__ \x3d this;
var this__5339__auto____$1 \x3d this;
var h__5154__auto__ \x3d self__.__hash;
if((!((h__5154__auto__ \x3d\x3d null)))){
return h__5154__auto__;
} else {
var h__5154__auto____$1 \x3d (function (coll__5340__auto__){
return (-2025547471 ^ cljs.core.hash_unordered_coll(coll__5340__auto__));
})(this__5339__auto____$1);
(self__.__hash \x3d h__5154__auto____$1);

return h__5154__auto____$1;
}
}));

(datascript.parser.ReturnMap.prototype.cljs$core$IEquiv$_equiv$arity$2 \x3d (function (this54444,other54445){
var self__ \x3d this;
var this54444__$1 \x3d this;
return (((!((other54445 \x3d\x3d null)))) \x26\x26 ((((this54444__$1.constructor \x3d\x3d\x3d other54445.constructor)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54444__$1.type,other54445.type)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54444__$1.symbols,other54445.symbols)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54444__$1.__extmap,other54445.__extmap)))))))));
}));

(datascript.parser.ReturnMap.prototype.cljs$core$IMap$_dissoc$arity$2 \x3d (function (this__5353__auto__,k__5354__auto__){
var self__ \x3d this;
var this__5353__auto____$1 \x3d this;
if(cljs.core.contains_QMARK_(new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22type\x22,\x22type\x22,1174270348),null,new cljs.core.Keyword(null,\x22symbols\x22,\x22symbols\x22,1211743),null], null), null),k__5354__auto__)){
return cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(cljs.core._with_meta(cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,this__5353__auto____$1),self__.__meta),k__5354__auto__);
} else {
return (new datascript.parser.ReturnMap(self__.type,self__.symbols,self__.__meta,cljs.core.not_empty(cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(self__.__extmap,k__5354__auto__)),null));
}
}));

(datascript.parser.ReturnMap.prototype.cljs$core$IAssociative$_contains_key_QMARK_$arity$2 \x3d (function (this__5350__auto__,k54443){
var self__ \x3d this;
var this__5350__auto____$1 \x3d this;
var G__54481 \x3d k54443;
var G__54481__$1 \x3d (((G__54481 instanceof cljs.core.Keyword))?G__54481.fqn:null);
switch (G__54481__$1) {
case \x22type\x22:
case \x22symbols\x22:
return true;

break;
default:
return cljs.core.contains_QMARK_(self__.__extmap,k54443);

}
}));

(datascript.parser.ReturnMap.prototype.cljs$core$IAssociative$_assoc$arity$3 \x3d (function (this__5351__auto__,k__5352__auto__,G__54442){
var self__ \x3d this;
var this__5351__auto____$1 \x3d this;
var pred__54482 \x3d cljs.core.keyword_identical_QMARK_;
var expr__54483 \x3d k__5352__auto__;
if(cljs.core.truth_((pred__54482.cljs$core$IFn$_invoke$arity$2 ? pred__54482.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22type\x22,\x22type\x22,1174270348),expr__54483) : pred__54482.call(null,new cljs.core.Keyword(null,\x22type\x22,\x22type\x22,1174270348),expr__54483)))){
return (new datascript.parser.ReturnMap(G__54442,self__.symbols,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__54482.cljs$core$IFn$_invoke$arity$2 ? pred__54482.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22symbols\x22,\x22symbols\x22,1211743),expr__54483) : pred__54482.call(null,new cljs.core.Keyword(null,\x22symbols\x22,\x22symbols\x22,1211743),expr__54483)))){
return (new datascript.parser.ReturnMap(self__.type,G__54442,self__.__meta,self__.__extmap,null));
} else {
return (new datascript.parser.ReturnMap(self__.type,self__.symbols,self__.__meta,cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k__5352__auto__,G__54442),null));
}
}
}));

(datascript.parser.ReturnMap.prototype.cljs$core$ISeqable$_seq$arity$1 \x3d (function (this__5356__auto__){
var self__ \x3d this;
var this__5356__auto____$1 \x3d this;
return cljs.core.seq(cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22type\x22,\x22type\x22,1174270348),self__.type,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22symbols\x22,\x22symbols\x22,1211743),self__.symbols,null))], null),self__.__extmap));
}));

(datascript.parser.ReturnMap.prototype.cljs$core$IWithMeta$_with_meta$arity$2 \x3d (function (this__5342__auto__,G__54442){
var self__ \x3d this;
var this__5342__auto____$1 \x3d this;
return (new datascript.parser.ReturnMap(self__.type,self__.symbols,G__54442,self__.__extmap,self__.__hash));
}));

(datascript.parser.ReturnMap.prototype.cljs$core$ICollection$_conj$arity$2 \x3d (function (this__5348__auto__,entry__5349__auto__){
var self__ \x3d this;
var this__5348__auto____$1 \x3d this;
if(cljs.core.vector_QMARK_(entry__5349__auto__)){
return this__5348__auto____$1.cljs$core$IAssociative$_assoc$arity$3(null,cljs.core._nth(entry__5349__auto__,(0)),cljs.core._nth(entry__5349__auto__,(1)));
} else {
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(cljs.core._conj,this__5348__auto____$1,entry__5349__auto__);
}
}));

(datascript.parser.ReturnMap.prototype.datascript$parser$ITraversable$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.parser.ReturnMap.prototype.datascript$parser$ITraversable$_postwalk$arity$2 \x3d (function (this__52373__auto__,f54439){
var self__ \x3d this;
var this__52373__auto____$1 \x3d this;
var new__52374__auto__ \x3d (new datascript.parser.ReturnMap(datascript.parser.postwalk(self__.type,f54439),datascript.parser.postwalk(self__.symbols,f54439),null,null,null));
var temp__5802__auto__ \x3d cljs.core.meta(this__52373__auto____$1);
if(cljs.core.truth_(temp__5802__auto__)){
var meta__52375__auto__ \x3d temp__5802__auto__;
return cljs.core.with_meta(new__52374__auto__,meta__52375__auto__);
} else {
return new__52374__auto__;
}
}));

(datascript.parser.ReturnMap.prototype.datascript$parser$ITraversable$_collect$arity$3 \x3d (function (___52376__auto__,pred54440,acc54441){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
return datascript.parser.collect.cljs$core$IFn$_invoke$arity$3(pred54440,self__.symbols,datascript.parser.collect.cljs$core$IFn$_invoke$arity$3(pred54440,self__.type,acc54441));
}));

(datascript.parser.ReturnMap.prototype.datascript$parser$ITraversable$_collect_vars$arity$2 \x3d (function (___52376__auto__,acc54441){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
var G__54486 \x3d (datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2 ? datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2(acc54441,self__.type) : datascript.parser.collect_vars_acc.call(null,acc54441,self__.type));
var G__54487 \x3d self__.symbols;
return (datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2 ? datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2(G__54486,G__54487) : datascript.parser.collect_vars_acc.call(null,G__54486,G__54487));
}));

(datascript.parser.ReturnMap.getBasis \x3d (function (){
return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22type\x22,\x22type\x22,-1480165421,null),new cljs.core.Symbol(null,\x22symbols\x22,\x22symbols\x22,1641743270,null)], null);
}));

(datascript.parser.ReturnMap.cljs$lang$type \x3d true);

(datascript.parser.ReturnMap.cljs$lang$ctorPrSeq \x3d (function (this__5389__auto__){
return (new cljs.core.List(null,\x22datascript.parser/ReturnMap\x22,null,(1),null));
}));

(datascript.parser.ReturnMap.cljs$lang$ctorPrWriter \x3d (function (this__5389__auto__,writer__5390__auto__){
return cljs.core._write(writer__5390__auto__,\x22datascript.parser/ReturnMap\x22);
}));

/**
 * Positional factory function for datascript.parser/ReturnMap.
 */
datascript.parser.__GT_ReturnMap \x3d (function datascript$parser$__GT_ReturnMap(type,symbols){
return (new datascript.parser.ReturnMap(type,symbols,null,null,null));
});

/**
 * Factory function for datascript.parser/ReturnMap, taking a map of keywords to field values.
 */
datascript.parser.map__GT_ReturnMap \x3d (function datascript$parser$map__GT_ReturnMap(G__54450){
var extmap__5385__auto__ \x3d (function (){var G__54488 \x3d cljs.core.dissoc.cljs$core$IFn$_invoke$arity$variadic(G__54450,new cljs.core.Keyword(null,\x22type\x22,\x22type\x22,1174270348),cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,\x22symbols\x22,\x22symbols\x22,1211743)], 0));
if(cljs.core.record_QMARK_(G__54450)){
return cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,G__54488);
} else {
return G__54488;
}
})();
return (new datascript.parser.ReturnMap(new cljs.core.Keyword(null,\x22type\x22,\x22type\x22,1174270348).cljs$core$IFn$_invoke$arity$1(G__54450),new cljs.core.Keyword(null,\x22symbols\x22,\x22symbols\x22,1211743).cljs$core$IFn$_invoke$arity$1(G__54450),null,cljs.core.not_empty(extmap__5385__auto__),null));
});

datascript.parser.parse_return_map \x3d (function datascript$parser$parse_return_map(type,form){
if((((!(cljs.core.empty_QMARK_(form)))) \x26\x26 (cljs.core.every_QMARK_(cljs.core.symbol_QMARK_,form)))){
var G__54495 \x3d type;
var G__54495__$1 \x3d (((G__54495 instanceof cljs.core.Keyword))?G__54495.fqn:null);
switch (G__54495__$1) {
case \x22keys\x22:
return (new datascript.parser.ReturnMap(type,cljs.core.mapv.cljs$core$IFn$_invoke$arity$2(cljs.core.keyword,form),null,null,null));

break;
case \x22syms\x22:
return (new datascript.parser.ReturnMap(type,cljs.core.vec(form),null,null,null));

break;
case \x22strs\x22:
return (new datascript.parser.ReturnMap(type,cljs.core.mapv.cljs$core$IFn$_invoke$arity$2(cljs.core.str,form),null,null,null));

break;
default:
return null;

}
} else {
return null;
}
});
datascript.parser.parse_with \x3d (function datascript$parser$parse_with(form){
var or__5045__auto__ \x3d datascript.parser.parse_seq(datascript.parser.parse_variable,form);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2(\x22Cannot parse :with clause, expected [ variable+ ]\x22,new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22parser\x22,\x22with\x22,\x22parser/with\x22,-386255821),new cljs.core.Keyword(null,\x22form\x22,\x22form\x22,-1624062471),form], null));
}
});
datascript.parser.parse_in_binding \x3d (function datascript$parser$parse_in_binding(form){
var temp__5802__auto__ \x3d (function (){var or__5045__auto__ \x3d datascript.parser.parse_src_var(form);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
var or__5045__auto____$1 \x3d datascript.parser.parse_rules_var(form);
if(cljs.core.truth_(or__5045__auto____$1)){
return or__5045__auto____$1;
} else {
return datascript.parser.parse_plain_variable(form);
}
}
})();
if(cljs.core.truth_(temp__5802__auto__)){
var var$ \x3d temp__5802__auto__;
return datascript.parser.with_source((new datascript.parser.BindScalar(var$,null,null,null)),form);
} else {
return datascript.parser.parse_binding(form);
}
});
datascript.parser.parse_in \x3d (function datascript$parser$parse_in(form){
var or__5045__auto__ \x3d datascript.parser.parse_seq(datascript.parser.parse_in_binding,form);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2(\x22Cannot parse :in clause, expected (src-var | % | plain-symbol | bind-scalar | bind-tuple | bind-coll | bind-rel)\x22,new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22parser\x22,\x22in\x22,\x22parser/in\x22,1617442048),new cljs.core.Keyword(null,\x22form\x22,\x22form\x22,-1624062471),form], null));
}
});

/**
* @constructor
 * @implements {cljs.core.IRecord}
 * @implements {cljs.core.IKVReduce}
 * @implements {cljs.core.IEquiv}
 * @implements {cljs.core.IHash}
 * @implements {cljs.core.ICollection}
 * @implements {cljs.core.ICounted}
 * @implements {cljs.core.ISeqable}
 * @implements {cljs.core.IMeta}
 * @implements {cljs.core.ICloneable}
 * @implements {cljs.core.IPrintWithWriter}
 * @implements {cljs.core.IIterable}
 * @implements {datascript.parser.ITraversable}
 * @implements {cljs.core.IWithMeta}
 * @implements {cljs.core.IAssociative}
 * @implements {cljs.core.IMap}
 * @implements {cljs.core.ILookup}
*/
datascript.parser.Pattern \x3d (function (source,pattern,__meta,__extmap,__hash){
this.source \x3d source;
this.pattern \x3d pattern;
this.__meta \x3d __meta;
this.__extmap \x3d __extmap;
this.__hash \x3d __hash;
this.cljs$lang$protocol_mask$partition0$ \x3d 2230716170;
this.cljs$lang$protocol_mask$partition1$ \x3d 139264;
});
(datascript.parser.Pattern.prototype.cljs$core$ILookup$_lookup$arity$2 \x3d (function (this__5343__auto__,k__5344__auto__){
var self__ \x3d this;
var this__5343__auto____$1 \x3d this;
return this__5343__auto____$1.cljs$core$ILookup$_lookup$arity$3(null,k__5344__auto__,null);
}));

(datascript.parser.Pattern.prototype.cljs$core$ILookup$_lookup$arity$3 \x3d (function (this__5345__auto__,k54500,else__5346__auto__){
var self__ \x3d this;
var this__5345__auto____$1 \x3d this;
var G__54507 \x3d k54500;
var G__54507__$1 \x3d (((G__54507 instanceof cljs.core.Keyword))?G__54507.fqn:null);
switch (G__54507__$1) {
case \x22source\x22:
return self__.source;

break;
case \x22pattern\x22:
return self__.pattern;

break;
default:
return cljs.core.get.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k54500,else__5346__auto__);

}
}));

(datascript.parser.Pattern.prototype.cljs$core$IKVReduce$_kv_reduce$arity$3 \x3d (function (this__5363__auto__,f__5364__auto__,init__5365__auto__){
var self__ \x3d this;
var this__5363__auto____$1 \x3d this;
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (ret__5366__auto__,p__54509){
var vec__54510 \x3d p__54509;
var k__5367__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54510,(0),null);
var v__5368__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54510,(1),null);
return (f__5364__auto__.cljs$core$IFn$_invoke$arity$3 ? f__5364__auto__.cljs$core$IFn$_invoke$arity$3(ret__5366__auto__,k__5367__auto__,v__5368__auto__) : f__5364__auto__.call(null,ret__5366__auto__,k__5367__auto__,v__5368__auto__));
}),init__5365__auto__,this__5363__auto____$1);
}));

(datascript.parser.Pattern.prototype.cljs$core$IPrintWithWriter$_pr_writer$arity$3 \x3d (function (this__5358__auto__,writer__5359__auto__,opts__5360__auto__){
var self__ \x3d this;
var this__5358__auto____$1 \x3d this;
var pr_pair__5361__auto__ \x3d (function (keyval__5362__auto__){
return cljs.core.pr_sequential_writer(writer__5359__auto__,cljs.core.pr_writer,\x22\x22,\x22 \x22,\x22\x22,opts__5360__auto__,keyval__5362__auto__);
});
return cljs.core.pr_sequential_writer(writer__5359__auto__,pr_pair__5361__auto__,\x22#datascript.parser.Pattern{\x22,\x22, \x22,\x22}\x22,opts__5360__auto__,cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22source\x22,\x22source\x22,-433931539),self__.source],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423),self__.pattern],null))], null),self__.__extmap));
}));

(datascript.parser.Pattern.prototype.cljs$core$IIterable$_iterator$arity$1 \x3d (function (G__54499){
var self__ \x3d this;
var G__54499__$1 \x3d this;
return (new cljs.core.RecordIter((0),G__54499__$1,2,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22source\x22,\x22source\x22,-433931539),new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423)], null),(cljs.core.truth_(self__.__extmap)?cljs.core._iterator(self__.__extmap):cljs.core.nil_iter())));
}));

(datascript.parser.Pattern.prototype.cljs$core$IMeta$_meta$arity$1 \x3d (function (this__5341__auto__){
var self__ \x3d this;
var this__5341__auto____$1 \x3d this;
return self__.__meta;
}));

(datascript.parser.Pattern.prototype.cljs$core$ICloneable$_clone$arity$1 \x3d (function (this__5338__auto__){
var self__ \x3d this;
var this__5338__auto____$1 \x3d this;
return (new datascript.parser.Pattern(self__.source,self__.pattern,self__.__meta,self__.__extmap,self__.__hash));
}));

(datascript.parser.Pattern.prototype.cljs$core$ICounted$_count$arity$1 \x3d (function (this__5347__auto__){
var self__ \x3d this;
var this__5347__auto____$1 \x3d this;
return (2 + cljs.core.count(self__.__extmap));
}));

(datascript.parser.Pattern.prototype.cljs$core$IHash$_hash$arity$1 \x3d (function (this__5339__auto__){
var self__ \x3d this;
var this__5339__auto____$1 \x3d this;
var h__5154__auto__ \x3d self__.__hash;
if((!((h__5154__auto__ \x3d\x3d null)))){
return h__5154__auto__;
} else {
var h__5154__auto____$1 \x3d (function (coll__5340__auto__){
return (575220587 ^ cljs.core.hash_unordered_coll(coll__5340__auto__));
})(this__5339__auto____$1);
(self__.__hash \x3d h__5154__auto____$1);

return h__5154__auto____$1;
}
}));

(datascript.parser.Pattern.prototype.cljs$core$IEquiv$_equiv$arity$2 \x3d (function (this54501,other54502){
var self__ \x3d this;
var this54501__$1 \x3d this;
return (((!((other54502 \x3d\x3d null)))) \x26\x26 ((((this54501__$1.constructor \x3d\x3d\x3d other54502.constructor)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54501__$1.source,other54502.source)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54501__$1.pattern,other54502.pattern)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54501__$1.__extmap,other54502.__extmap)))))))));
}));

(datascript.parser.Pattern.prototype.cljs$core$IMap$_dissoc$arity$2 \x3d (function (this__5353__auto__,k__5354__auto__){
var self__ \x3d this;
var this__5353__auto____$1 \x3d this;
if(cljs.core.contains_QMARK_(new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22source\x22,\x22source\x22,-433931539),null,new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423),null], null), null),k__5354__auto__)){
return cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(cljs.core._with_meta(cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,this__5353__auto____$1),self__.__meta),k__5354__auto__);
} else {
return (new datascript.parser.Pattern(self__.source,self__.pattern,self__.__meta,cljs.core.not_empty(cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(self__.__extmap,k__5354__auto__)),null));
}
}));

(datascript.parser.Pattern.prototype.cljs$core$IAssociative$_contains_key_QMARK_$arity$2 \x3d (function (this__5350__auto__,k54500){
var self__ \x3d this;
var this__5350__auto____$1 \x3d this;
var G__54514 \x3d k54500;
var G__54514__$1 \x3d (((G__54514 instanceof cljs.core.Keyword))?G__54514.fqn:null);
switch (G__54514__$1) {
case \x22source\x22:
case \x22pattern\x22:
return true;

break;
default:
return cljs.core.contains_QMARK_(self__.__extmap,k54500);

}
}));

(datascript.parser.Pattern.prototype.cljs$core$IAssociative$_assoc$arity$3 \x3d (function (this__5351__auto__,k__5352__auto__,G__54499){
var self__ \x3d this;
var this__5351__auto____$1 \x3d this;
var pred__54515 \x3d cljs.core.keyword_identical_QMARK_;
var expr__54516 \x3d k__5352__auto__;
if(cljs.core.truth_((pred__54515.cljs$core$IFn$_invoke$arity$2 ? pred__54515.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22source\x22,\x22source\x22,-433931539),expr__54516) : pred__54515.call(null,new cljs.core.Keyword(null,\x22source\x22,\x22source\x22,-433931539),expr__54516)))){
return (new datascript.parser.Pattern(G__54499,self__.pattern,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__54515.cljs$core$IFn$_invoke$arity$2 ? pred__54515.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423),expr__54516) : pred__54515.call(null,new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423),expr__54516)))){
return (new datascript.parser.Pattern(self__.source,G__54499,self__.__meta,self__.__extmap,null));
} else {
return (new datascript.parser.Pattern(self__.source,self__.pattern,self__.__meta,cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k__5352__auto__,G__54499),null));
}
}
}));

(datascript.parser.Pattern.prototype.cljs$core$ISeqable$_seq$arity$1 \x3d (function (this__5356__auto__){
var self__ \x3d this;
var this__5356__auto____$1 \x3d this;
return cljs.core.seq(cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22source\x22,\x22source\x22,-433931539),self__.source,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423),self__.pattern,null))], null),self__.__extmap));
}));

(datascript.parser.Pattern.prototype.cljs$core$IWithMeta$_with_meta$arity$2 \x3d (function (this__5342__auto__,G__54499){
var self__ \x3d this;
var this__5342__auto____$1 \x3d this;
return (new datascript.parser.Pattern(self__.source,self__.pattern,G__54499,self__.__extmap,self__.__hash));
}));

(datascript.parser.Pattern.prototype.cljs$core$ICollection$_conj$arity$2 \x3d (function (this__5348__auto__,entry__5349__auto__){
var self__ \x3d this;
var this__5348__auto____$1 \x3d this;
if(cljs.core.vector_QMARK_(entry__5349__auto__)){
return this__5348__auto____$1.cljs$core$IAssociative$_assoc$arity$3(null,cljs.core._nth(entry__5349__auto__,(0)),cljs.core._nth(entry__5349__auto__,(1)));
} else {
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(cljs.core._conj,this__5348__auto____$1,entry__5349__auto__);
}
}));

(datascript.parser.Pattern.prototype.datascript$parser$ITraversable$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.parser.Pattern.prototype.datascript$parser$ITraversable$_postwalk$arity$2 \x3d (function (this__52373__auto__,f54496){
var self__ \x3d this;
var this__52373__auto____$1 \x3d this;
var new__52374__auto__ \x3d (new datascript.parser.Pattern(datascript.parser.postwalk(self__.source,f54496),datascript.parser.postwalk(self__.pattern,f54496),null,null,null));
var temp__5802__auto__ \x3d cljs.core.meta(this__52373__auto____$1);
if(cljs.core.truth_(temp__5802__auto__)){
var meta__52375__auto__ \x3d temp__5802__auto__;
return cljs.core.with_meta(new__52374__auto__,meta__52375__auto__);
} else {
return new__52374__auto__;
}
}));

(datascript.parser.Pattern.prototype.datascript$parser$ITraversable$_collect$arity$3 \x3d (function (___52376__auto__,pred54497,acc54498){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
return datascript.parser.collect.cljs$core$IFn$_invoke$arity$3(pred54497,self__.pattern,datascript.parser.collect.cljs$core$IFn$_invoke$arity$3(pred54497,self__.source,acc54498));
}));

(datascript.parser.Pattern.prototype.datascript$parser$ITraversable$_collect_vars$arity$2 \x3d (function (___52376__auto__,acc54498){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
var G__54518 \x3d (datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2 ? datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2(acc54498,self__.source) : datascript.parser.collect_vars_acc.call(null,acc54498,self__.source));
var G__54519 \x3d self__.pattern;
return (datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2 ? datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2(G__54518,G__54519) : datascript.parser.collect_vars_acc.call(null,G__54518,G__54519));
}));

(datascript.parser.Pattern.getBasis \x3d (function (){
return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22source\x22,\x22source\x22,1206599988,null),new cljs.core.Symbol(null,\x22pattern\x22,\x22pattern\x22,1882666950,null)], null);
}));

(datascript.parser.Pattern.cljs$lang$type \x3d true);

(datascript.parser.Pattern.cljs$lang$ctorPrSeq \x3d (function (this__5389__auto__){
return (new cljs.core.List(null,\x22datascript.parser/Pattern\x22,null,(1),null));
}));

(datascript.parser.Pattern.cljs$lang$ctorPrWriter \x3d (function (this__5389__auto__,writer__5390__auto__){
return cljs.core._write(writer__5390__auto__,\x22datascript.parser/Pattern\x22);
}));

/**
 * Positional factory function for datascript.parser/Pattern.
 */
datascript.parser.__GT_Pattern \x3d (function datascript$parser$__GT_Pattern(source,pattern){
return (new datascript.parser.Pattern(source,pattern,null,null,null));
});

/**
 * Factory function for datascript.parser/Pattern, taking a map of keywords to field values.
 */
datascript.parser.map__GT_Pattern \x3d (function datascript$parser$map__GT_Pattern(G__54503){
var extmap__5385__auto__ \x3d (function (){var G__54520 \x3d cljs.core.dissoc.cljs$core$IFn$_invoke$arity$variadic(G__54503,new cljs.core.Keyword(null,\x22source\x22,\x22source\x22,-433931539),cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423)], 0));
if(cljs.core.record_QMARK_(G__54503)){
return cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,G__54520);
} else {
return G__54520;
}
})();
return (new datascript.parser.Pattern(new cljs.core.Keyword(null,\x22source\x22,\x22source\x22,-433931539).cljs$core$IFn$_invoke$arity$1(G__54503),new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423).cljs$core$IFn$_invoke$arity$1(G__54503),null,cljs.core.not_empty(extmap__5385__auto__),null));
});


/**
* @constructor
 * @implements {cljs.core.IRecord}
 * @implements {cljs.core.IKVReduce}
 * @implements {cljs.core.IEquiv}
 * @implements {cljs.core.IHash}
 * @implements {cljs.core.ICollection}
 * @implements {cljs.core.ICounted}
 * @implements {cljs.core.ISeqable}
 * @implements {cljs.core.IMeta}
 * @implements {cljs.core.ICloneable}
 * @implements {cljs.core.IPrintWithWriter}
 * @implements {cljs.core.IIterable}
 * @implements {datascript.parser.ITraversable}
 * @implements {cljs.core.IWithMeta}
 * @implements {cljs.core.IAssociative}
 * @implements {cljs.core.IMap}
 * @implements {cljs.core.ILookup}
*/
datascript.parser.Predicate \x3d (function (fn,args,__meta,__extmap,__hash){
this.fn \x3d fn;
this.args \x3d args;
this.__meta \x3d __meta;
this.__extmap \x3d __extmap;
this.__hash \x3d __hash;
this.cljs$lang$protocol_mask$partition0$ \x3d 2230716170;
this.cljs$lang$protocol_mask$partition1$ \x3d 139264;
});
(datascript.parser.Predicate.prototype.cljs$core$ILookup$_lookup$arity$2 \x3d (function (this__5343__auto__,k__5344__auto__){
var self__ \x3d this;
var this__5343__auto____$1 \x3d this;
return this__5343__auto____$1.cljs$core$ILookup$_lookup$arity$3(null,k__5344__auto__,null);
}));

(datascript.parser.Predicate.prototype.cljs$core$ILookup$_lookup$arity$3 \x3d (function (this__5345__auto__,k54525,else__5346__auto__){
var self__ \x3d this;
var this__5345__auto____$1 \x3d this;
var G__54529 \x3d k54525;
var G__54529__$1 \x3d (((G__54529 instanceof cljs.core.Keyword))?G__54529.fqn:null);
switch (G__54529__$1) {
case \x22fn\x22:
return self__.fn;

break;
case \x22args\x22:
return self__.args;

break;
default:
return cljs.core.get.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k54525,else__5346__auto__);

}
}));

(datascript.parser.Predicate.prototype.cljs$core$IKVReduce$_kv_reduce$arity$3 \x3d (function (this__5363__auto__,f__5364__auto__,init__5365__auto__){
var self__ \x3d this;
var this__5363__auto____$1 \x3d this;
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (ret__5366__auto__,p__54530){
var vec__54531 \x3d p__54530;
var k__5367__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54531,(0),null);
var v__5368__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54531,(1),null);
return (f__5364__auto__.cljs$core$IFn$_invoke$arity$3 ? f__5364__auto__.cljs$core$IFn$_invoke$arity$3(ret__5366__auto__,k__5367__auto__,v__5368__auto__) : f__5364__auto__.call(null,ret__5366__auto__,k__5367__auto__,v__5368__auto__));
}),init__5365__auto__,this__5363__auto____$1);
}));

(datascript.parser.Predicate.prototype.cljs$core$IPrintWithWriter$_pr_writer$arity$3 \x3d (function (this__5358__auto__,writer__5359__auto__,opts__5360__auto__){
var self__ \x3d this;
var this__5358__auto____$1 \x3d this;
var pr_pair__5361__auto__ \x3d (function (keyval__5362__auto__){
return cljs.core.pr_sequential_writer(writer__5359__auto__,cljs.core.pr_writer,\x22\x22,\x22 \x22,\x22\x22,opts__5360__auto__,keyval__5362__auto__);
});
return cljs.core.pr_sequential_writer(writer__5359__auto__,pr_pair__5361__auto__,\x22#datascript.parser.Predicate{\x22,\x22, \x22,\x22}\x22,opts__5360__auto__,cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22fn\x22,\x22fn\x22,-1175266204),self__.fn],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22args\x22,\x22args\x22,1315556576),self__.args],null))], null),self__.__extmap));
}));

(datascript.parser.Predicate.prototype.cljs$core$IIterable$_iterator$arity$1 \x3d (function (G__54524){
var self__ \x3d this;
var G__54524__$1 \x3d this;
return (new cljs.core.RecordIter((0),G__54524__$1,2,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22fn\x22,\x22fn\x22,-1175266204),new cljs.core.Keyword(null,\x22args\x22,\x22args\x22,1315556576)], null),(cljs.core.truth_(self__.__extmap)?cljs.core._iterator(self__.__extmap):cljs.core.nil_iter())));
}));

(datascript.parser.Predicate.prototype.cljs$core$IMeta$_meta$arity$1 \x3d (function (this__5341__auto__){
var self__ \x3d this;
var this__5341__auto____$1 \x3d this;
return self__.__meta;
}));

(datascript.parser.Predicate.prototype.cljs$core$ICloneable$_clone$arity$1 \x3d (function (this__5338__auto__){
var self__ \x3d this;
var this__5338__auto____$1 \x3d this;
return (new datascript.parser.Predicate(self__.fn,self__.args,self__.__meta,self__.__extmap,self__.__hash));
}));

(datascript.parser.Predicate.prototype.cljs$core$ICounted$_count$arity$1 \x3d (function (this__5347__auto__){
var self__ \x3d this;
var this__5347__auto____$1 \x3d this;
return (2 + cljs.core.count(self__.__extmap));
}));

(datascript.parser.Predicate.prototype.cljs$core$IHash$_hash$arity$1 \x3d (function (this__5339__auto__){
var self__ \x3d this;
var this__5339__auto____$1 \x3d this;
var h__5154__auto__ \x3d self__.__hash;
if((!((h__5154__auto__ \x3d\x3d null)))){
return h__5154__auto__;
} else {
var h__5154__auto____$1 \x3d (function (coll__5340__auto__){
return (-1523376880 ^ cljs.core.hash_unordered_coll(coll__5340__auto__));
})(this__5339__auto____$1);
(self__.__hash \x3d h__5154__auto____$1);

return h__5154__auto____$1;
}
}));

(datascript.parser.Predicate.prototype.cljs$core$IEquiv$_equiv$arity$2 \x3d (function (this54526,other54527){
var self__ \x3d this;
var this54526__$1 \x3d this;
return (((!((other54527 \x3d\x3d null)))) \x26\x26 ((((this54526__$1.constructor \x3d\x3d\x3d other54527.constructor)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54526__$1.fn,other54527.fn)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54526__$1.args,other54527.args)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54526__$1.__extmap,other54527.__extmap)))))))));
}));

(datascript.parser.Predicate.prototype.cljs$core$IMap$_dissoc$arity$2 \x3d (function (this__5353__auto__,k__5354__auto__){
var self__ \x3d this;
var this__5353__auto____$1 \x3d this;
if(cljs.core.contains_QMARK_(new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22args\x22,\x22args\x22,1315556576),null,new cljs.core.Keyword(null,\x22fn\x22,\x22fn\x22,-1175266204),null], null), null),k__5354__auto__)){
return cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(cljs.core._with_meta(cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,this__5353__auto____$1),self__.__meta),k__5354__auto__);
} else {
return (new datascript.parser.Predicate(self__.fn,self__.args,self__.__meta,cljs.core.not_empty(cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(self__.__extmap,k__5354__auto__)),null));
}
}));

(datascript.parser.Predicate.prototype.cljs$core$IAssociative$_contains_key_QMARK_$arity$2 \x3d (function (this__5350__auto__,k54525){
var self__ \x3d this;
var this__5350__auto____$1 \x3d this;
var G__54534 \x3d k54525;
var G__54534__$1 \x3d (((G__54534 instanceof cljs.core.Keyword))?G__54534.fqn:null);
switch (G__54534__$1) {
case \x22fn\x22:
case \x22args\x22:
return true;

break;
default:
return cljs.core.contains_QMARK_(self__.__extmap,k54525);

}
}));

(datascript.parser.Predicate.prototype.cljs$core$IAssociative$_assoc$arity$3 \x3d (function (this__5351__auto__,k__5352__auto__,G__54524){
var self__ \x3d this;
var this__5351__auto____$1 \x3d this;
var pred__54535 \x3d cljs.core.keyword_identical_QMARK_;
var expr__54536 \x3d k__5352__auto__;
if(cljs.core.truth_((pred__54535.cljs$core$IFn$_invoke$arity$2 ? pred__54535.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22fn\x22,\x22fn\x22,-1175266204),expr__54536) : pred__54535.call(null,new cljs.core.Keyword(null,\x22fn\x22,\x22fn\x22,-1175266204),expr__54536)))){
return (new datascript.parser.Predicate(G__54524,self__.args,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__54535.cljs$core$IFn$_invoke$arity$2 ? pred__54535.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22args\x22,\x22args\x22,1315556576),expr__54536) : pred__54535.call(null,new cljs.core.Keyword(null,\x22args\x22,\x22args\x22,1315556576),expr__54536)))){
return (new datascript.parser.Predicate(self__.fn,G__54524,self__.__meta,self__.__extmap,null));
} else {
return (new datascript.parser.Predicate(self__.fn,self__.args,self__.__meta,cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k__5352__auto__,G__54524),null));
}
}
}));

(datascript.parser.Predicate.prototype.cljs$core$ISeqable$_seq$arity$1 \x3d (function (this__5356__auto__){
var self__ \x3d this;
var this__5356__auto____$1 \x3d this;
return cljs.core.seq(cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22fn\x22,\x22fn\x22,-1175266204),self__.fn,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22args\x22,\x22args\x22,1315556576),self__.args,null))], null),self__.__extmap));
}));

(datascript.parser.Predicate.prototype.cljs$core$IWithMeta$_with_meta$arity$2 \x3d (function (this__5342__auto__,G__54524){
var self__ \x3d this;
var this__5342__auto____$1 \x3d this;
return (new datascript.parser.Predicate(self__.fn,self__.args,G__54524,self__.__extmap,self__.__hash));
}));

(datascript.parser.Predicate.prototype.cljs$core$ICollection$_conj$arity$2 \x3d (function (this__5348__auto__,entry__5349__auto__){
var self__ \x3d this;
var this__5348__auto____$1 \x3d this;
if(cljs.core.vector_QMARK_(entry__5349__auto__)){
return this__5348__auto____$1.cljs$core$IAssociative$_assoc$arity$3(null,cljs.core._nth(entry__5349__auto__,(0)),cljs.core._nth(entry__5349__auto__,(1)));
} else {
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(cljs.core._conj,this__5348__auto____$1,entry__5349__auto__);
}
}));

(datascript.parser.Predicate.prototype.datascript$parser$ITraversable$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.parser.Predicate.prototype.datascript$parser$ITraversable$_postwalk$arity$2 \x3d (function (this__52373__auto__,f54521){
var self__ \x3d this;
var this__52373__auto____$1 \x3d this;
var new__52374__auto__ \x3d (new datascript.parser.Predicate(datascript.parser.postwalk(self__.fn,f54521),datascript.parser.postwalk(self__.args,f54521),null,null,null));
var temp__5802__auto__ \x3d cljs.core.meta(this__52373__auto____$1);
if(cljs.core.truth_(temp__5802__auto__)){
var meta__52375__auto__ \x3d temp__5802__auto__;
return cljs.core.with_meta(new__52374__auto__,meta__52375__auto__);
} else {
return new__52374__auto__;
}
}));

(datascript.parser.Predicate.prototype.datascript$parser$ITraversable$_collect$arity$3 \x3d (function (___52376__auto__,pred54522,acc54523){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
return datascript.parser.collect.cljs$core$IFn$_invoke$arity$3(pred54522,self__.args,datascript.parser.collect.cljs$core$IFn$_invoke$arity$3(pred54522,self__.fn,acc54523));
}));

(datascript.parser.Predicate.prototype.datascript$parser$ITraversable$_collect_vars$arity$2 \x3d (function (___52376__auto__,acc54523){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
var G__54538 \x3d (datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2 ? datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2(acc54523,self__.fn) : datascript.parser.collect_vars_acc.call(null,acc54523,self__.fn));
var G__54539 \x3d self__.args;
return (datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2 ? datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2(G__54538,G__54539) : datascript.parser.collect_vars_acc.call(null,G__54538,G__54539));
}));

(datascript.parser.Predicate.getBasis \x3d (function (){
return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22fn\x22,\x22fn\x22,465265323,null),new cljs.core.Symbol(null,\x22args\x22,\x22args\x22,-1338879193,null)], null);
}));

(datascript.parser.Predicate.cljs$lang$type \x3d true);

(datascript.parser.Predicate.cljs$lang$ctorPrSeq \x3d (function (this__5389__auto__){
return (new cljs.core.List(null,\x22datascript.parser/Predicate\x22,null,(1),null));
}));

(datascript.parser.Predicate.cljs$lang$ctorPrWriter \x3d (function (this__5389__auto__,writer__5390__auto__){
return cljs.core._write(writer__5390__auto__,\x22datascript.parser/Predicate\x22);
}));

/**
 * Positional factory function for datascript.parser/Predicate.
 */
datascript.parser.__GT_Predicate \x3d (function datascript$parser$__GT_Predicate(fn,args){
return (new datascript.parser.Predicate(fn,args,null,null,null));
});

/**
 * Factory function for datascript.parser/Predicate, taking a map of keywords to field values.
 */
datascript.parser.map__GT_Predicate \x3d (function datascript$parser$map__GT_Predicate(G__54528){
var extmap__5385__auto__ \x3d (function (){var G__54540 \x3d cljs.core.dissoc.cljs$core$IFn$_invoke$arity$variadic(G__54528,new cljs.core.Keyword(null,\x22fn\x22,\x22fn\x22,-1175266204),cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,\x22args\x22,\x22args\x22,1315556576)], 0));
if(cljs.core.record_QMARK_(G__54528)){
return cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,G__54540);
} else {
return G__54540;
}
})();
return (new datascript.parser.Predicate(new cljs.core.Keyword(null,\x22fn\x22,\x22fn\x22,-1175266204).cljs$core$IFn$_invoke$arity$1(G__54528),new cljs.core.Keyword(null,\x22args\x22,\x22args\x22,1315556576).cljs$core$IFn$_invoke$arity$1(G__54528),null,cljs.core.not_empty(extmap__5385__auto__),null));
});


/**
* @constructor
 * @implements {cljs.core.IRecord}
 * @implements {cljs.core.IKVReduce}
 * @implements {cljs.core.IEquiv}
 * @implements {cljs.core.IHash}
 * @implements {cljs.core.ICollection}
 * @implements {cljs.core.ICounted}
 * @implements {cljs.core.ISeqable}
 * @implements {cljs.core.IMeta}
 * @implements {cljs.core.ICloneable}
 * @implements {cljs.core.IPrintWithWriter}
 * @implements {cljs.core.IIterable}
 * @implements {datascript.parser.ITraversable}
 * @implements {cljs.core.IWithMeta}
 * @implements {cljs.core.IAssociative}
 * @implements {cljs.core.IMap}
 * @implements {cljs.core.ILookup}
*/
datascript.parser.Function \x3d (function (fn,args,binding,__meta,__extmap,__hash){
this.fn \x3d fn;
this.args \x3d args;
this.binding \x3d binding;
this.__meta \x3d __meta;
this.__extmap \x3d __extmap;
this.__hash \x3d __hash;
this.cljs$lang$protocol_mask$partition0$ \x3d 2230716170;
this.cljs$lang$protocol_mask$partition1$ \x3d 139264;
});
(datascript.parser.Function.prototype.cljs$core$ILookup$_lookup$arity$2 \x3d (function (this__5343__auto__,k__5344__auto__){
var self__ \x3d this;
var this__5343__auto____$1 \x3d this;
return this__5343__auto____$1.cljs$core$ILookup$_lookup$arity$3(null,k__5344__auto__,null);
}));

(datascript.parser.Function.prototype.cljs$core$ILookup$_lookup$arity$3 \x3d (function (this__5345__auto__,k54545,else__5346__auto__){
var self__ \x3d this;
var this__5345__auto____$1 \x3d this;
var G__54549 \x3d k54545;
var G__54549__$1 \x3d (((G__54549 instanceof cljs.core.Keyword))?G__54549.fqn:null);
switch (G__54549__$1) {
case \x22fn\x22:
return self__.fn;

break;
case \x22args\x22:
return self__.args;

break;
case \x22binding\x22:
return self__.binding;

break;
default:
return cljs.core.get.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k54545,else__5346__auto__);

}
}));

(datascript.parser.Function.prototype.cljs$core$IKVReduce$_kv_reduce$arity$3 \x3d (function (this__5363__auto__,f__5364__auto__,init__5365__auto__){
var self__ \x3d this;
var this__5363__auto____$1 \x3d this;
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (ret__5366__auto__,p__54550){
var vec__54551 \x3d p__54550;
var k__5367__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54551,(0),null);
var v__5368__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54551,(1),null);
return (f__5364__auto__.cljs$core$IFn$_invoke$arity$3 ? f__5364__auto__.cljs$core$IFn$_invoke$arity$3(ret__5366__auto__,k__5367__auto__,v__5368__auto__) : f__5364__auto__.call(null,ret__5366__auto__,k__5367__auto__,v__5368__auto__));
}),init__5365__auto__,this__5363__auto____$1);
}));

(datascript.parser.Function.prototype.cljs$core$IPrintWithWriter$_pr_writer$arity$3 \x3d (function (this__5358__auto__,writer__5359__auto__,opts__5360__auto__){
var self__ \x3d this;
var this__5358__auto____$1 \x3d this;
var pr_pair__5361__auto__ \x3d (function (keyval__5362__auto__){
return cljs.core.pr_sequential_writer(writer__5359__auto__,cljs.core.pr_writer,\x22\x22,\x22 \x22,\x22\x22,opts__5360__auto__,keyval__5362__auto__);
});
return cljs.core.pr_sequential_writer(writer__5359__auto__,pr_pair__5361__auto__,\x22#datascript.parser.Function{\x22,\x22, \x22,\x22}\x22,opts__5360__auto__,cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22fn\x22,\x22fn\x22,-1175266204),self__.fn],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22args\x22,\x22args\x22,1315556576),self__.args],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22binding\x22,\x22binding\x22,539932593),self__.binding],null))], null),self__.__extmap));
}));

(datascript.parser.Function.prototype.cljs$core$IIterable$_iterator$arity$1 \x3d (function (G__54544){
var self__ \x3d this;
var G__54544__$1 \x3d this;
return (new cljs.core.RecordIter((0),G__54544__$1,3,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22fn\x22,\x22fn\x22,-1175266204),new cljs.core.Keyword(null,\x22args\x22,\x22args\x22,1315556576),new cljs.core.Keyword(null,\x22binding\x22,\x22binding\x22,539932593)], null),(cljs.core.truth_(self__.__extmap)?cljs.core._iterator(self__.__extmap):cljs.core.nil_iter())));
}));

(datascript.parser.Function.prototype.cljs$core$IMeta$_meta$arity$1 \x3d (function (this__5341__auto__){
var self__ \x3d this;
var this__5341__auto____$1 \x3d this;
return self__.__meta;
}));

(datascript.parser.Function.prototype.cljs$core$ICloneable$_clone$arity$1 \x3d (function (this__5338__auto__){
var self__ \x3d this;
var this__5338__auto____$1 \x3d this;
return (new datascript.parser.Function(self__.fn,self__.args,self__.binding,self__.__meta,self__.__extmap,self__.__hash));
}));

(datascript.parser.Function.prototype.cljs$core$ICounted$_count$arity$1 \x3d (function (this__5347__auto__){
var self__ \x3d this;
var this__5347__auto____$1 \x3d this;
return (3 + cljs.core.count(self__.__extmap));
}));

(datascript.parser.Function.prototype.cljs$core$IHash$_hash$arity$1 \x3d (function (this__5339__auto__){
var self__ \x3d this;
var this__5339__auto____$1 \x3d this;
var h__5154__auto__ \x3d self__.__hash;
if((!((h__5154__auto__ \x3d\x3d null)))){
return h__5154__auto__;
} else {
var h__5154__auto____$1 \x3d (function (coll__5340__auto__){
return (589494199 ^ cljs.core.hash_unordered_coll(coll__5340__auto__));
})(this__5339__auto____$1);
(self__.__hash \x3d h__5154__auto____$1);

return h__5154__auto____$1;
}
}));

(datascript.parser.Function.prototype.cljs$core$IEquiv$_equiv$arity$2 \x3d (function (this54546,other54547){
var self__ \x3d this;
var this54546__$1 \x3d this;
return (((!((other54547 \x3d\x3d null)))) \x26\x26 ((((this54546__$1.constructor \x3d\x3d\x3d other54547.constructor)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54546__$1.fn,other54547.fn)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54546__$1.args,other54547.args)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54546__$1.binding,other54547.binding)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54546__$1.__extmap,other54547.__extmap)))))))))));
}));

(datascript.parser.Function.prototype.cljs$core$IMap$_dissoc$arity$2 \x3d (function (this__5353__auto__,k__5354__auto__){
var self__ \x3d this;
var this__5353__auto____$1 \x3d this;
if(cljs.core.contains_QMARK_(new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,\x22args\x22,\x22args\x22,1315556576),null,new cljs.core.Keyword(null,\x22fn\x22,\x22fn\x22,-1175266204),null,new cljs.core.Keyword(null,\x22binding\x22,\x22binding\x22,539932593),null], null), null),k__5354__auto__)){
return cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(cljs.core._with_meta(cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,this__5353__auto____$1),self__.__meta),k__5354__auto__);
} else {
return (new datascript.parser.Function(self__.fn,self__.args,self__.binding,self__.__meta,cljs.core.not_empty(cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(self__.__extmap,k__5354__auto__)),null));
}
}));

(datascript.parser.Function.prototype.cljs$core$IAssociative$_contains_key_QMARK_$arity$2 \x3d (function (this__5350__auto__,k54545){
var self__ \x3d this;
var this__5350__auto____$1 \x3d this;
var G__54554 \x3d k54545;
var G__54554__$1 \x3d (((G__54554 instanceof cljs.core.Keyword))?G__54554.fqn:null);
switch (G__54554__$1) {
case \x22fn\x22:
case \x22args\x22:
case \x22binding\x22:
return true;

break;
default:
return cljs.core.contains_QMARK_(self__.__extmap,k54545);

}
}));

(datascript.parser.Function.prototype.cljs$core$IAssociative$_assoc$arity$3 \x3d (function (this__5351__auto__,k__5352__auto__,G__54544){
var self__ \x3d this;
var this__5351__auto____$1 \x3d this;
var pred__54555 \x3d cljs.core.keyword_identical_QMARK_;
var expr__54556 \x3d k__5352__auto__;
if(cljs.core.truth_((pred__54555.cljs$core$IFn$_invoke$arity$2 ? pred__54555.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22fn\x22,\x22fn\x22,-1175266204),expr__54556) : pred__54555.call(null,new cljs.core.Keyword(null,\x22fn\x22,\x22fn\x22,-1175266204),expr__54556)))){
return (new datascript.parser.Function(G__54544,self__.args,self__.binding,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__54555.cljs$core$IFn$_invoke$arity$2 ? pred__54555.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22args\x22,\x22args\x22,1315556576),expr__54556) : pred__54555.call(null,new cljs.core.Keyword(null,\x22args\x22,\x22args\x22,1315556576),expr__54556)))){
return (new datascript.parser.Function(self__.fn,G__54544,self__.binding,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__54555.cljs$core$IFn$_invoke$arity$2 ? pred__54555.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22binding\x22,\x22binding\x22,539932593),expr__54556) : pred__54555.call(null,new cljs.core.Keyword(null,\x22binding\x22,\x22binding\x22,539932593),expr__54556)))){
return (new datascript.parser.Function(self__.fn,self__.args,G__54544,self__.__meta,self__.__extmap,null));
} else {
return (new datascript.parser.Function(self__.fn,self__.args,self__.binding,self__.__meta,cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k__5352__auto__,G__54544),null));
}
}
}
}));

(datascript.parser.Function.prototype.cljs$core$ISeqable$_seq$arity$1 \x3d (function (this__5356__auto__){
var self__ \x3d this;
var this__5356__auto____$1 \x3d this;
return cljs.core.seq(cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22fn\x22,\x22fn\x22,-1175266204),self__.fn,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22args\x22,\x22args\x22,1315556576),self__.args,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22binding\x22,\x22binding\x22,539932593),self__.binding,null))], null),self__.__extmap));
}));

(datascript.parser.Function.prototype.cljs$core$IWithMeta$_with_meta$arity$2 \x3d (function (this__5342__auto__,G__54544){
var self__ \x3d this;
var this__5342__auto____$1 \x3d this;
return (new datascript.parser.Function(self__.fn,self__.args,self__.binding,G__54544,self__.__extmap,self__.__hash));
}));

(datascript.parser.Function.prototype.cljs$core$ICollection$_conj$arity$2 \x3d (function (this__5348__auto__,entry__5349__auto__){
var self__ \x3d this;
var this__5348__auto____$1 \x3d this;
if(cljs.core.vector_QMARK_(entry__5349__auto__)){
return this__5348__auto____$1.cljs$core$IAssociative$_assoc$arity$3(null,cljs.core._nth(entry__5349__auto__,(0)),cljs.core._nth(entry__5349__auto__,(1)));
} else {
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(cljs.core._conj,this__5348__auto____$1,entry__5349__auto__);
}
}));

(datascript.parser.Function.prototype.datascript$parser$ITraversable$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.parser.Function.prototype.datascript$parser$ITraversable$_postwalk$arity$2 \x3d (function (this__52373__auto__,f54541){
var self__ \x3d this;
var this__52373__auto____$1 \x3d this;
var new__52374__auto__ \x3d (new datascript.parser.Function(datascript.parser.postwalk(self__.fn,f54541),datascript.parser.postwalk(self__.args,f54541),datascript.parser.postwalk(self__.binding,f54541),null,null,null));
var temp__5802__auto__ \x3d cljs.core.meta(this__52373__auto____$1);
if(cljs.core.truth_(temp__5802__auto__)){
var meta__52375__auto__ \x3d temp__5802__auto__;
return cljs.core.with_meta(new__52374__auto__,meta__52375__auto__);
} else {
return new__52374__auto__;
}
}));

(datascript.parser.Function.prototype.datascript$parser$ITraversable$_collect$arity$3 \x3d (function (___52376__auto__,pred54542,acc54543){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
return datascript.parser.collect.cljs$core$IFn$_invoke$arity$3(pred54542,self__.binding,datascript.parser.collect.cljs$core$IFn$_invoke$arity$3(pred54542,self__.args,datascript.parser.collect.cljs$core$IFn$_invoke$arity$3(pred54542,self__.fn,acc54543)));
}));

(datascript.parser.Function.prototype.datascript$parser$ITraversable$_collect_vars$arity$2 \x3d (function (___52376__auto__,acc54543){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
var G__54558 \x3d (function (){var G__54560 \x3d (datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2 ? datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2(acc54543,self__.fn) : datascript.parser.collect_vars_acc.call(null,acc54543,self__.fn));
var G__54561 \x3d self__.args;
return (datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2 ? datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2(G__54560,G__54561) : datascript.parser.collect_vars_acc.call(null,G__54560,G__54561));
})();
var G__54559 \x3d self__.binding;
return (datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2 ? datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2(G__54558,G__54559) : datascript.parser.collect_vars_acc.call(null,G__54558,G__54559));
}));

(datascript.parser.Function.getBasis \x3d (function (){
return new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22fn\x22,\x22fn\x22,465265323,null),new cljs.core.Symbol(null,\x22args\x22,\x22args\x22,-1338879193,null),new cljs.core.Symbol(null,\x22binding\x22,\x22binding\x22,-2114503176,null)], null);
}));

(datascript.parser.Function.cljs$lang$type \x3d true);

(datascript.parser.Function.cljs$lang$ctorPrSeq \x3d (function (this__5389__auto__){
return (new cljs.core.List(null,\x22datascript.parser/Function\x22,null,(1),null));
}));

(datascript.parser.Function.cljs$lang$ctorPrWriter \x3d (function (this__5389__auto__,writer__5390__auto__){
return cljs.core._write(writer__5390__auto__,\x22datascript.parser/Function\x22);
}));

/**
 * Positional factory function for datascript.parser/Function.
 */
datascript.parser.__GT_Function \x3d (function datascript$parser$__GT_Function(fn,args,binding){
return (new datascript.parser.Function(fn,args,binding,null,null,null));
});

/**
 * Factory function for datascript.parser/Function, taking a map of keywords to field values.
 */
datascript.parser.map__GT_Function \x3d (function datascript$parser$map__GT_Function(G__54548){
var extmap__5385__auto__ \x3d (function (){var G__54562 \x3d cljs.core.dissoc.cljs$core$IFn$_invoke$arity$variadic(G__54548,new cljs.core.Keyword(null,\x22fn\x22,\x22fn\x22,-1175266204),cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,\x22args\x22,\x22args\x22,1315556576),new cljs.core.Keyword(null,\x22binding\x22,\x22binding\x22,539932593)], 0));
if(cljs.core.record_QMARK_(G__54548)){
return cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,G__54562);
} else {
return G__54562;
}
})();
return (new datascript.parser.Function(new cljs.core.Keyword(null,\x22fn\x22,\x22fn\x22,-1175266204).cljs$core$IFn$_invoke$arity$1(G__54548),new cljs.core.Keyword(null,\x22args\x22,\x22args\x22,1315556576).cljs$core$IFn$_invoke$arity$1(G__54548),new cljs.core.Keyword(null,\x22binding\x22,\x22binding\x22,539932593).cljs$core$IFn$_invoke$arity$1(G__54548),null,cljs.core.not_empty(extmap__5385__auto__),null));
});


/**
* @constructor
 * @implements {cljs.core.IRecord}
 * @implements {cljs.core.IKVReduce}
 * @implements {cljs.core.IEquiv}
 * @implements {cljs.core.IHash}
 * @implements {cljs.core.ICollection}
 * @implements {cljs.core.ICounted}
 * @implements {cljs.core.ISeqable}
 * @implements {cljs.core.IMeta}
 * @implements {cljs.core.ICloneable}
 * @implements {cljs.core.IPrintWithWriter}
 * @implements {cljs.core.IIterable}
 * @implements {datascript.parser.ITraversable}
 * @implements {cljs.core.IWithMeta}
 * @implements {cljs.core.IAssociative}
 * @implements {cljs.core.IMap}
 * @implements {cljs.core.ILookup}
*/
datascript.parser.RuleExpr \x3d (function (source,name,args,__meta,__extmap,__hash){
this.source \x3d source;
this.name \x3d name;
this.args \x3d args;
this.__meta \x3d __meta;
this.__extmap \x3d __extmap;
this.__hash \x3d __hash;
this.cljs$lang$protocol_mask$partition0$ \x3d 2230716170;
this.cljs$lang$protocol_mask$partition1$ \x3d 139264;
});
(datascript.parser.RuleExpr.prototype.cljs$core$ILookup$_lookup$arity$2 \x3d (function (this__5343__auto__,k__5344__auto__){
var self__ \x3d this;
var this__5343__auto____$1 \x3d this;
return this__5343__auto____$1.cljs$core$ILookup$_lookup$arity$3(null,k__5344__auto__,null);
}));

(datascript.parser.RuleExpr.prototype.cljs$core$ILookup$_lookup$arity$3 \x3d (function (this__5345__auto__,k54567,else__5346__auto__){
var self__ \x3d this;
var this__5345__auto____$1 \x3d this;
var G__54571 \x3d k54567;
var G__54571__$1 \x3d (((G__54571 instanceof cljs.core.Keyword))?G__54571.fqn:null);
switch (G__54571__$1) {
case \x22source\x22:
return self__.source;

break;
case \x22name\x22:
return self__.name;

break;
case \x22args\x22:
return self__.args;

break;
default:
return cljs.core.get.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k54567,else__5346__auto__);

}
}));

(datascript.parser.RuleExpr.prototype.cljs$core$IKVReduce$_kv_reduce$arity$3 \x3d (function (this__5363__auto__,f__5364__auto__,init__5365__auto__){
var self__ \x3d this;
var this__5363__auto____$1 \x3d this;
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (ret__5366__auto__,p__54572){
var vec__54573 \x3d p__54572;
var k__5367__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54573,(0),null);
var v__5368__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54573,(1),null);
return (f__5364__auto__.cljs$core$IFn$_invoke$arity$3 ? f__5364__auto__.cljs$core$IFn$_invoke$arity$3(ret__5366__auto__,k__5367__auto__,v__5368__auto__) : f__5364__auto__.call(null,ret__5366__auto__,k__5367__auto__,v__5368__auto__));
}),init__5365__auto__,this__5363__auto____$1);
}));

(datascript.parser.RuleExpr.prototype.cljs$core$IPrintWithWriter$_pr_writer$arity$3 \x3d (function (this__5358__auto__,writer__5359__auto__,opts__5360__auto__){
var self__ \x3d this;
var this__5358__auto____$1 \x3d this;
var pr_pair__5361__auto__ \x3d (function (keyval__5362__auto__){
return cljs.core.pr_sequential_writer(writer__5359__auto__,cljs.core.pr_writer,\x22\x22,\x22 \x22,\x22\x22,opts__5360__auto__,keyval__5362__auto__);
});
return cljs.core.pr_sequential_writer(writer__5359__auto__,pr_pair__5361__auto__,\x22#datascript.parser.RuleExpr{\x22,\x22, \x22,\x22}\x22,opts__5360__auto__,cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22source\x22,\x22source\x22,-433931539),self__.source],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),self__.name],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22args\x22,\x22args\x22,1315556576),self__.args],null))], null),self__.__extmap));
}));

(datascript.parser.RuleExpr.prototype.cljs$core$IIterable$_iterator$arity$1 \x3d (function (G__54566){
var self__ \x3d this;
var G__54566__$1 \x3d this;
return (new cljs.core.RecordIter((0),G__54566__$1,3,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22source\x22,\x22source\x22,-433931539),new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),new cljs.core.Keyword(null,\x22args\x22,\x22args\x22,1315556576)], null),(cljs.core.truth_(self__.__extmap)?cljs.core._iterator(self__.__extmap):cljs.core.nil_iter())));
}));

(datascript.parser.RuleExpr.prototype.cljs$core$IMeta$_meta$arity$1 \x3d (function (this__5341__auto__){
var self__ \x3d this;
var this__5341__auto____$1 \x3d this;
return self__.__meta;
}));

(datascript.parser.RuleExpr.prototype.cljs$core$ICloneable$_clone$arity$1 \x3d (function (this__5338__auto__){
var self__ \x3d this;
var this__5338__auto____$1 \x3d this;
return (new datascript.parser.RuleExpr(self__.source,self__.name,self__.args,self__.__meta,self__.__extmap,self__.__hash));
}));

(datascript.parser.RuleExpr.prototype.cljs$core$ICounted$_count$arity$1 \x3d (function (this__5347__auto__){
var self__ \x3d this;
var this__5347__auto____$1 \x3d this;
return (3 + cljs.core.count(self__.__extmap));
}));

(datascript.parser.RuleExpr.prototype.cljs$core$IHash$_hash$arity$1 \x3d (function (this__5339__auto__){
var self__ \x3d this;
var this__5339__auto____$1 \x3d this;
var h__5154__auto__ \x3d self__.__hash;
if((!((h__5154__auto__ \x3d\x3d null)))){
return h__5154__auto__;
} else {
var h__5154__auto____$1 \x3d (function (coll__5340__auto__){
return (-444662011 ^ cljs.core.hash_unordered_coll(coll__5340__auto__));
})(this__5339__auto____$1);
(self__.__hash \x3d h__5154__auto____$1);

return h__5154__auto____$1;
}
}));

(datascript.parser.RuleExpr.prototype.cljs$core$IEquiv$_equiv$arity$2 \x3d (function (this54568,other54569){
var self__ \x3d this;
var this54568__$1 \x3d this;
return (((!((other54569 \x3d\x3d null)))) \x26\x26 ((((this54568__$1.constructor \x3d\x3d\x3d other54569.constructor)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54568__$1.source,other54569.source)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54568__$1.name,other54569.name)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54568__$1.args,other54569.args)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54568__$1.__extmap,other54569.__extmap)))))))))));
}));

(datascript.parser.RuleExpr.prototype.cljs$core$IMap$_dissoc$arity$2 \x3d (function (this__5353__auto__,k__5354__auto__){
var self__ \x3d this;
var this__5353__auto____$1 \x3d this;
if(cljs.core.contains_QMARK_(new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,\x22args\x22,\x22args\x22,1315556576),null,new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),null,new cljs.core.Keyword(null,\x22source\x22,\x22source\x22,-433931539),null], null), null),k__5354__auto__)){
return cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(cljs.core._with_meta(cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,this__5353__auto____$1),self__.__meta),k__5354__auto__);
} else {
return (new datascript.parser.RuleExpr(self__.source,self__.name,self__.args,self__.__meta,cljs.core.not_empty(cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(self__.__extmap,k__5354__auto__)),null));
}
}));

(datascript.parser.RuleExpr.prototype.cljs$core$IAssociative$_contains_key_QMARK_$arity$2 \x3d (function (this__5350__auto__,k54567){
var self__ \x3d this;
var this__5350__auto____$1 \x3d this;
var G__54576 \x3d k54567;
var G__54576__$1 \x3d (((G__54576 instanceof cljs.core.Keyword))?G__54576.fqn:null);
switch (G__54576__$1) {
case \x22source\x22:
case \x22name\x22:
case \x22args\x22:
return true;

break;
default:
return cljs.core.contains_QMARK_(self__.__extmap,k54567);

}
}));

(datascript.parser.RuleExpr.prototype.cljs$core$IAssociative$_assoc$arity$3 \x3d (function (this__5351__auto__,k__5352__auto__,G__54566){
var self__ \x3d this;
var this__5351__auto____$1 \x3d this;
var pred__54577 \x3d cljs.core.keyword_identical_QMARK_;
var expr__54578 \x3d k__5352__auto__;
if(cljs.core.truth_((pred__54577.cljs$core$IFn$_invoke$arity$2 ? pred__54577.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22source\x22,\x22source\x22,-433931539),expr__54578) : pred__54577.call(null,new cljs.core.Keyword(null,\x22source\x22,\x22source\x22,-433931539),expr__54578)))){
return (new datascript.parser.RuleExpr(G__54566,self__.name,self__.args,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__54577.cljs$core$IFn$_invoke$arity$2 ? pred__54577.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),expr__54578) : pred__54577.call(null,new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),expr__54578)))){
return (new datascript.parser.RuleExpr(self__.source,G__54566,self__.args,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__54577.cljs$core$IFn$_invoke$arity$2 ? pred__54577.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22args\x22,\x22args\x22,1315556576),expr__54578) : pred__54577.call(null,new cljs.core.Keyword(null,\x22args\x22,\x22args\x22,1315556576),expr__54578)))){
return (new datascript.parser.RuleExpr(self__.source,self__.name,G__54566,self__.__meta,self__.__extmap,null));
} else {
return (new datascript.parser.RuleExpr(self__.source,self__.name,self__.args,self__.__meta,cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k__5352__auto__,G__54566),null));
}
}
}
}));

(datascript.parser.RuleExpr.prototype.cljs$core$ISeqable$_seq$arity$1 \x3d (function (this__5356__auto__){
var self__ \x3d this;
var this__5356__auto____$1 \x3d this;
return cljs.core.seq(cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22source\x22,\x22source\x22,-433931539),self__.source,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),self__.name,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22args\x22,\x22args\x22,1315556576),self__.args,null))], null),self__.__extmap));
}));

(datascript.parser.RuleExpr.prototype.cljs$core$IWithMeta$_with_meta$arity$2 \x3d (function (this__5342__auto__,G__54566){
var self__ \x3d this;
var this__5342__auto____$1 \x3d this;
return (new datascript.parser.RuleExpr(self__.source,self__.name,self__.args,G__54566,self__.__extmap,self__.__hash));
}));

(datascript.parser.RuleExpr.prototype.cljs$core$ICollection$_conj$arity$2 \x3d (function (this__5348__auto__,entry__5349__auto__){
var self__ \x3d this;
var this__5348__auto____$1 \x3d this;
if(cljs.core.vector_QMARK_(entry__5349__auto__)){
return this__5348__auto____$1.cljs$core$IAssociative$_assoc$arity$3(null,cljs.core._nth(entry__5349__auto__,(0)),cljs.core._nth(entry__5349__auto__,(1)));
} else {
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(cljs.core._conj,this__5348__auto____$1,entry__5349__auto__);
}
}));

(datascript.parser.RuleExpr.prototype.datascript$parser$ITraversable$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.parser.RuleExpr.prototype.datascript$parser$ITraversable$_postwalk$arity$2 \x3d (function (this__52373__auto__,f54563){
var self__ \x3d this;
var this__52373__auto____$1 \x3d this;
var new__52374__auto__ \x3d (new datascript.parser.RuleExpr(datascript.parser.postwalk(self__.source,f54563),datascript.parser.postwalk(self__.name,f54563),datascript.parser.postwalk(self__.args,f54563),null,null,null));
var temp__5802__auto__ \x3d cljs.core.meta(this__52373__auto____$1);
if(cljs.core.truth_(temp__5802__auto__)){
var meta__52375__auto__ \x3d temp__5802__auto__;
return cljs.core.with_meta(new__52374__auto__,meta__52375__auto__);
} else {
return new__52374__auto__;
}
}));

(datascript.parser.RuleExpr.prototype.datascript$parser$ITraversable$_collect$arity$3 \x3d (function (___52376__auto__,pred54564,acc54565){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
return datascript.parser.collect.cljs$core$IFn$_invoke$arity$3(pred54564,self__.args,datascript.parser.collect.cljs$core$IFn$_invoke$arity$3(pred54564,self__.name,datascript.parser.collect.cljs$core$IFn$_invoke$arity$3(pred54564,self__.source,acc54565)));
}));

(datascript.parser.RuleExpr.prototype.datascript$parser$ITraversable$_collect_vars$arity$2 \x3d (function (___52376__auto__,acc54565){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
var G__54580 \x3d (function (){var G__54582 \x3d (datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2 ? datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2(acc54565,self__.source) : datascript.parser.collect_vars_acc.call(null,acc54565,self__.source));
var G__54583 \x3d self__.name;
return (datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2 ? datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2(G__54582,G__54583) : datascript.parser.collect_vars_acc.call(null,G__54582,G__54583));
})();
var G__54581 \x3d self__.args;
return (datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2 ? datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2(G__54580,G__54581) : datascript.parser.collect_vars_acc.call(null,G__54580,G__54581));
}));

(datascript.parser.RuleExpr.getBasis \x3d (function (){
return new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22source\x22,\x22source\x22,1206599988,null),new cljs.core.Symbol(null,\x22name\x22,\x22name\x22,-810760592,null),new cljs.core.Symbol(null,\x22args\x22,\x22args\x22,-1338879193,null)], null);
}));

(datascript.parser.RuleExpr.cljs$lang$type \x3d true);

(datascript.parser.RuleExpr.cljs$lang$ctorPrSeq \x3d (function (this__5389__auto__){
return (new cljs.core.List(null,\x22datascript.parser/RuleExpr\x22,null,(1),null));
}));

(datascript.parser.RuleExpr.cljs$lang$ctorPrWriter \x3d (function (this__5389__auto__,writer__5390__auto__){
return cljs.core._write(writer__5390__auto__,\x22datascript.parser/RuleExpr\x22);
}));

/**
 * Positional factory function for datascript.parser/RuleExpr.
 */
datascript.parser.__GT_RuleExpr \x3d (function datascript$parser$__GT_RuleExpr(source,name,args){
return (new datascript.parser.RuleExpr(source,name,args,null,null,null));
});

/**
 * Factory function for datascript.parser/RuleExpr, taking a map of keywords to field values.
 */
datascript.parser.map__GT_RuleExpr \x3d (function datascript$parser$map__GT_RuleExpr(G__54570){
var extmap__5385__auto__ \x3d (function (){var G__54584 \x3d cljs.core.dissoc.cljs$core$IFn$_invoke$arity$variadic(G__54570,new cljs.core.Keyword(null,\x22source\x22,\x22source\x22,-433931539),cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),new cljs.core.Keyword(null,\x22args\x22,\x22args\x22,1315556576)], 0));
if(cljs.core.record_QMARK_(G__54570)){
return cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,G__54584);
} else {
return G__54584;
}
})();
return (new datascript.parser.RuleExpr(new cljs.core.Keyword(null,\x22source\x22,\x22source\x22,-433931539).cljs$core$IFn$_invoke$arity$1(G__54570),new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177).cljs$core$IFn$_invoke$arity$1(G__54570),new cljs.core.Keyword(null,\x22args\x22,\x22args\x22,1315556576).cljs$core$IFn$_invoke$arity$1(G__54570),null,cljs.core.not_empty(extmap__5385__auto__),null));
});


/**
* @constructor
 * @implements {cljs.core.IRecord}
 * @implements {cljs.core.IKVReduce}
 * @implements {cljs.core.IEquiv}
 * @implements {cljs.core.IHash}
 * @implements {cljs.core.ICollection}
 * @implements {cljs.core.ICounted}
 * @implements {cljs.core.ISeqable}
 * @implements {cljs.core.IMeta}
 * @implements {cljs.core.ICloneable}
 * @implements {cljs.core.IPrintWithWriter}
 * @implements {cljs.core.IIterable}
 * @implements {datascript.parser.ITraversable}
 * @implements {cljs.core.IWithMeta}
 * @implements {cljs.core.IAssociative}
 * @implements {cljs.core.IMap}
 * @implements {cljs.core.ILookup}
*/
datascript.parser.Not \x3d (function (source,vars,clauses,__meta,__extmap,__hash){
this.source \x3d source;
this.vars \x3d vars;
this.clauses \x3d clauses;
this.__meta \x3d __meta;
this.__extmap \x3d __extmap;
this.__hash \x3d __hash;
this.cljs$lang$protocol_mask$partition0$ \x3d 2230716170;
this.cljs$lang$protocol_mask$partition1$ \x3d 139264;
});
(datascript.parser.Not.prototype.cljs$core$ILookup$_lookup$arity$2 \x3d (function (this__5343__auto__,k__5344__auto__){
var self__ \x3d this;
var this__5343__auto____$1 \x3d this;
return this__5343__auto____$1.cljs$core$ILookup$_lookup$arity$3(null,k__5344__auto__,null);
}));

(datascript.parser.Not.prototype.cljs$core$ILookup$_lookup$arity$3 \x3d (function (this__5345__auto__,k54589,else__5346__auto__){
var self__ \x3d this;
var this__5345__auto____$1 \x3d this;
var G__54593 \x3d k54589;
var G__54593__$1 \x3d (((G__54593 instanceof cljs.core.Keyword))?G__54593.fqn:null);
switch (G__54593__$1) {
case \x22source\x22:
return self__.source;

break;
case \x22vars\x22:
return self__.vars;

break;
case \x22clauses\x22:
return self__.clauses;

break;
default:
return cljs.core.get.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k54589,else__5346__auto__);

}
}));

(datascript.parser.Not.prototype.cljs$core$IKVReduce$_kv_reduce$arity$3 \x3d (function (this__5363__auto__,f__5364__auto__,init__5365__auto__){
var self__ \x3d this;
var this__5363__auto____$1 \x3d this;
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (ret__5366__auto__,p__54594){
var vec__54595 \x3d p__54594;
var k__5367__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54595,(0),null);
var v__5368__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54595,(1),null);
return (f__5364__auto__.cljs$core$IFn$_invoke$arity$3 ? f__5364__auto__.cljs$core$IFn$_invoke$arity$3(ret__5366__auto__,k__5367__auto__,v__5368__auto__) : f__5364__auto__.call(null,ret__5366__auto__,k__5367__auto__,v__5368__auto__));
}),init__5365__auto__,this__5363__auto____$1);
}));

(datascript.parser.Not.prototype.cljs$core$IPrintWithWriter$_pr_writer$arity$3 \x3d (function (this__5358__auto__,writer__5359__auto__,opts__5360__auto__){
var self__ \x3d this;
var this__5358__auto____$1 \x3d this;
var pr_pair__5361__auto__ \x3d (function (keyval__5362__auto__){
return cljs.core.pr_sequential_writer(writer__5359__auto__,cljs.core.pr_writer,\x22\x22,\x22 \x22,\x22\x22,opts__5360__auto__,keyval__5362__auto__);
});
return cljs.core.pr_sequential_writer(writer__5359__auto__,pr_pair__5361__auto__,\x22#datascript.parser.Not{\x22,\x22, \x22,\x22}\x22,opts__5360__auto__,cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22source\x22,\x22source\x22,-433931539),self__.source],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22vars\x22,\x22vars\x22,-2046957217),self__.vars],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22clauses\x22,\x22clauses\x22,1454841241),self__.clauses],null))], null),self__.__extmap));
}));

(datascript.parser.Not.prototype.cljs$core$IIterable$_iterator$arity$1 \x3d (function (G__54588){
var self__ \x3d this;
var G__54588__$1 \x3d this;
return (new cljs.core.RecordIter((0),G__54588__$1,3,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22source\x22,\x22source\x22,-433931539),new cljs.core.Keyword(null,\x22vars\x22,\x22vars\x22,-2046957217),new cljs.core.Keyword(null,\x22clauses\x22,\x22clauses\x22,1454841241)], null),(cljs.core.truth_(self__.__extmap)?cljs.core._iterator(self__.__extmap):cljs.core.nil_iter())));
}));

(datascript.parser.Not.prototype.cljs$core$IMeta$_meta$arity$1 \x3d (function (this__5341__auto__){
var self__ \x3d this;
var this__5341__auto____$1 \x3d this;
return self__.__meta;
}));

(datascript.parser.Not.prototype.cljs$core$ICloneable$_clone$arity$1 \x3d (function (this__5338__auto__){
var self__ \x3d this;
var this__5338__auto____$1 \x3d this;
return (new datascript.parser.Not(self__.source,self__.vars,self__.clauses,self__.__meta,self__.__extmap,self__.__hash));
}));

(datascript.parser.Not.prototype.cljs$core$ICounted$_count$arity$1 \x3d (function (this__5347__auto__){
var self__ \x3d this;
var this__5347__auto____$1 \x3d this;
return (3 + cljs.core.count(self__.__extmap));
}));

(datascript.parser.Not.prototype.cljs$core$IHash$_hash$arity$1 \x3d (function (this__5339__auto__){
var self__ \x3d this;
var this__5339__auto____$1 \x3d this;
var h__5154__auto__ \x3d self__.__hash;
if((!((h__5154__auto__ \x3d\x3d null)))){
return h__5154__auto__;
} else {
var h__5154__auto____$1 \x3d (function (coll__5340__auto__){
return (1394671061 ^ cljs.core.hash_unordered_coll(coll__5340__auto__));
})(this__5339__auto____$1);
(self__.__hash \x3d h__5154__auto____$1);

return h__5154__auto____$1;
}
}));

(datascript.parser.Not.prototype.cljs$core$IEquiv$_equiv$arity$2 \x3d (function (this54590,other54591){
var self__ \x3d this;
var this54590__$1 \x3d this;
return (((!((other54591 \x3d\x3d null)))) \x26\x26 ((((this54590__$1.constructor \x3d\x3d\x3d other54591.constructor)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54590__$1.source,other54591.source)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54590__$1.vars,other54591.vars)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54590__$1.clauses,other54591.clauses)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54590__$1.__extmap,other54591.__extmap)))))))))));
}));

(datascript.parser.Not.prototype.cljs$core$IMap$_dissoc$arity$2 \x3d (function (this__5353__auto__,k__5354__auto__){
var self__ \x3d this;
var this__5353__auto____$1 \x3d this;
if(cljs.core.contains_QMARK_(new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,\x22source\x22,\x22source\x22,-433931539),null,new cljs.core.Keyword(null,\x22clauses\x22,\x22clauses\x22,1454841241),null,new cljs.core.Keyword(null,\x22vars\x22,\x22vars\x22,-2046957217),null], null), null),k__5354__auto__)){
return cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(cljs.core._with_meta(cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,this__5353__auto____$1),self__.__meta),k__5354__auto__);
} else {
return (new datascript.parser.Not(self__.source,self__.vars,self__.clauses,self__.__meta,cljs.core.not_empty(cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(self__.__extmap,k__5354__auto__)),null));
}
}));

(datascript.parser.Not.prototype.cljs$core$IAssociative$_contains_key_QMARK_$arity$2 \x3d (function (this__5350__auto__,k54589){
var self__ \x3d this;
var this__5350__auto____$1 \x3d this;
var G__54598 \x3d k54589;
var G__54598__$1 \x3d (((G__54598 instanceof cljs.core.Keyword))?G__54598.fqn:null);
switch (G__54598__$1) {
case \x22source\x22:
case \x22vars\x22:
case \x22clauses\x22:
return true;

break;
default:
return cljs.core.contains_QMARK_(self__.__extmap,k54589);

}
}));

(datascript.parser.Not.prototype.cljs$core$IAssociative$_assoc$arity$3 \x3d (function (this__5351__auto__,k__5352__auto__,G__54588){
var self__ \x3d this;
var this__5351__auto____$1 \x3d this;
var pred__54599 \x3d cljs.core.keyword_identical_QMARK_;
var expr__54600 \x3d k__5352__auto__;
if(cljs.core.truth_((pred__54599.cljs$core$IFn$_invoke$arity$2 ? pred__54599.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22source\x22,\x22source\x22,-433931539),expr__54600) : pred__54599.call(null,new cljs.core.Keyword(null,\x22source\x22,\x22source\x22,-433931539),expr__54600)))){
return (new datascript.parser.Not(G__54588,self__.vars,self__.clauses,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__54599.cljs$core$IFn$_invoke$arity$2 ? pred__54599.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22vars\x22,\x22vars\x22,-2046957217),expr__54600) : pred__54599.call(null,new cljs.core.Keyword(null,\x22vars\x22,\x22vars\x22,-2046957217),expr__54600)))){
return (new datascript.parser.Not(self__.source,G__54588,self__.clauses,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__54599.cljs$core$IFn$_invoke$arity$2 ? pred__54599.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22clauses\x22,\x22clauses\x22,1454841241),expr__54600) : pred__54599.call(null,new cljs.core.Keyword(null,\x22clauses\x22,\x22clauses\x22,1454841241),expr__54600)))){
return (new datascript.parser.Not(self__.source,self__.vars,G__54588,self__.__meta,self__.__extmap,null));
} else {
return (new datascript.parser.Not(self__.source,self__.vars,self__.clauses,self__.__meta,cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k__5352__auto__,G__54588),null));
}
}
}
}));

(datascript.parser.Not.prototype.cljs$core$ISeqable$_seq$arity$1 \x3d (function (this__5356__auto__){
var self__ \x3d this;
var this__5356__auto____$1 \x3d this;
return cljs.core.seq(cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22source\x22,\x22source\x22,-433931539),self__.source,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22vars\x22,\x22vars\x22,-2046957217),self__.vars,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22clauses\x22,\x22clauses\x22,1454841241),self__.clauses,null))], null),self__.__extmap));
}));

(datascript.parser.Not.prototype.cljs$core$IWithMeta$_with_meta$arity$2 \x3d (function (this__5342__auto__,G__54588){
var self__ \x3d this;
var this__5342__auto____$1 \x3d this;
return (new datascript.parser.Not(self__.source,self__.vars,self__.clauses,G__54588,self__.__extmap,self__.__hash));
}));

(datascript.parser.Not.prototype.cljs$core$ICollection$_conj$arity$2 \x3d (function (this__5348__auto__,entry__5349__auto__){
var self__ \x3d this;
var this__5348__auto____$1 \x3d this;
if(cljs.core.vector_QMARK_(entry__5349__auto__)){
return this__5348__auto____$1.cljs$core$IAssociative$_assoc$arity$3(null,cljs.core._nth(entry__5349__auto__,(0)),cljs.core._nth(entry__5349__auto__,(1)));
} else {
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(cljs.core._conj,this__5348__auto____$1,entry__5349__auto__);
}
}));

(datascript.parser.Not.prototype.datascript$parser$ITraversable$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.parser.Not.prototype.datascript$parser$ITraversable$_postwalk$arity$2 \x3d (function (this__52373__auto__,f54585){
var self__ \x3d this;
var this__52373__auto____$1 \x3d this;
var new__52374__auto__ \x3d (new datascript.parser.Not(datascript.parser.postwalk(self__.source,f54585),datascript.parser.postwalk(self__.vars,f54585),datascript.parser.postwalk(self__.clauses,f54585),null,null,null));
var temp__5802__auto__ \x3d cljs.core.meta(this__52373__auto____$1);
if(cljs.core.truth_(temp__5802__auto__)){
var meta__52375__auto__ \x3d temp__5802__auto__;
return cljs.core.with_meta(new__52374__auto__,meta__52375__auto__);
} else {
return new__52374__auto__;
}
}));

(datascript.parser.Not.prototype.datascript$parser$ITraversable$_collect$arity$3 \x3d (function (___52376__auto__,pred54586,acc54587){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
return datascript.parser.collect.cljs$core$IFn$_invoke$arity$3(pred54586,self__.clauses,datascript.parser.collect.cljs$core$IFn$_invoke$arity$3(pred54586,self__.vars,datascript.parser.collect.cljs$core$IFn$_invoke$arity$3(pred54586,self__.source,acc54587)));
}));

(datascript.parser.Not.prototype.datascript$parser$ITraversable$_collect_vars$arity$2 \x3d (function (___52376__auto__,acc54587){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
var G__54602 \x3d (function (){var G__54604 \x3d (datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2 ? datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2(acc54587,self__.source) : datascript.parser.collect_vars_acc.call(null,acc54587,self__.source));
var G__54605 \x3d self__.vars;
return (datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2 ? datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2(G__54604,G__54605) : datascript.parser.collect_vars_acc.call(null,G__54604,G__54605));
})();
var G__54603 \x3d self__.clauses;
return (datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2 ? datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2(G__54602,G__54603) : datascript.parser.collect_vars_acc.call(null,G__54602,G__54603));
}));

(datascript.parser.Not.getBasis \x3d (function (){
return new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22source\x22,\x22source\x22,1206599988,null),new cljs.core.Symbol(null,\x22vars\x22,\x22vars\x22,-406425690,null),new cljs.core.Symbol(null,\x22clauses\x22,\x22clauses\x22,-1199594528,null)], null);
}));

(datascript.parser.Not.cljs$lang$type \x3d true);

(datascript.parser.Not.cljs$lang$ctorPrSeq \x3d (function (this__5389__auto__){
return (new cljs.core.List(null,\x22datascript.parser/Not\x22,null,(1),null));
}));

(datascript.parser.Not.cljs$lang$ctorPrWriter \x3d (function (this__5389__auto__,writer__5390__auto__){
return cljs.core._write(writer__5390__auto__,\x22datascript.parser/Not\x22);
}));

/**
 * Positional factory function for datascript.parser/Not.
 */
datascript.parser.__GT_Not \x3d (function datascript$parser$__GT_Not(source,vars,clauses){
return (new datascript.parser.Not(source,vars,clauses,null,null,null));
});

/**
 * Factory function for datascript.parser/Not, taking a map of keywords to field values.
 */
datascript.parser.map__GT_Not \x3d (function datascript$parser$map__GT_Not(G__54592){
var extmap__5385__auto__ \x3d (function (){var G__54606 \x3d cljs.core.dissoc.cljs$core$IFn$_invoke$arity$variadic(G__54592,new cljs.core.Keyword(null,\x22source\x22,\x22source\x22,-433931539),cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,\x22vars\x22,\x22vars\x22,-2046957217),new cljs.core.Keyword(null,\x22clauses\x22,\x22clauses\x22,1454841241)], 0));
if(cljs.core.record_QMARK_(G__54592)){
return cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,G__54606);
} else {
return G__54606;
}
})();
return (new datascript.parser.Not(new cljs.core.Keyword(null,\x22source\x22,\x22source\x22,-433931539).cljs$core$IFn$_invoke$arity$1(G__54592),new cljs.core.Keyword(null,\x22vars\x22,\x22vars\x22,-2046957217).cljs$core$IFn$_invoke$arity$1(G__54592),new cljs.core.Keyword(null,\x22clauses\x22,\x22clauses\x22,1454841241).cljs$core$IFn$_invoke$arity$1(G__54592),null,cljs.core.not_empty(extmap__5385__auto__),null));
});


/**
* @constructor
 * @implements {cljs.core.IRecord}
 * @implements {cljs.core.IKVReduce}
 * @implements {cljs.core.IEquiv}
 * @implements {cljs.core.IHash}
 * @implements {cljs.core.ICollection}
 * @implements {cljs.core.ICounted}
 * @implements {cljs.core.ISeqable}
 * @implements {cljs.core.IMeta}
 * @implements {cljs.core.ICloneable}
 * @implements {cljs.core.IPrintWithWriter}
 * @implements {cljs.core.IIterable}
 * @implements {datascript.parser.ITraversable}
 * @implements {cljs.core.IWithMeta}
 * @implements {cljs.core.IAssociative}
 * @implements {cljs.core.IMap}
 * @implements {cljs.core.ILookup}
*/
datascript.parser.Or \x3d (function (source,rule_vars,clauses,__meta,__extmap,__hash){
this.source \x3d source;
this.rule_vars \x3d rule_vars;
this.clauses \x3d clauses;
this.__meta \x3d __meta;
this.__extmap \x3d __extmap;
this.__hash \x3d __hash;
this.cljs$lang$protocol_mask$partition0$ \x3d 2230716170;
this.cljs$lang$protocol_mask$partition1$ \x3d 139264;
});
(datascript.parser.Or.prototype.cljs$core$ILookup$_lookup$arity$2 \x3d (function (this__5343__auto__,k__5344__auto__){
var self__ \x3d this;
var this__5343__auto____$1 \x3d this;
return this__5343__auto____$1.cljs$core$ILookup$_lookup$arity$3(null,k__5344__auto__,null);
}));

(datascript.parser.Or.prototype.cljs$core$ILookup$_lookup$arity$3 \x3d (function (this__5345__auto__,k54611,else__5346__auto__){
var self__ \x3d this;
var this__5345__auto____$1 \x3d this;
var G__54615 \x3d k54611;
var G__54615__$1 \x3d (((G__54615 instanceof cljs.core.Keyword))?G__54615.fqn:null);
switch (G__54615__$1) {
case \x22source\x22:
return self__.source;

break;
case \x22rule-vars\x22:
return self__.rule_vars;

break;
case \x22clauses\x22:
return self__.clauses;

break;
default:
return cljs.core.get.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k54611,else__5346__auto__);

}
}));

(datascript.parser.Or.prototype.cljs$core$IKVReduce$_kv_reduce$arity$3 \x3d (function (this__5363__auto__,f__5364__auto__,init__5365__auto__){
var self__ \x3d this;
var this__5363__auto____$1 \x3d this;
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (ret__5366__auto__,p__54616){
var vec__54617 \x3d p__54616;
var k__5367__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54617,(0),null);
var v__5368__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54617,(1),null);
return (f__5364__auto__.cljs$core$IFn$_invoke$arity$3 ? f__5364__auto__.cljs$core$IFn$_invoke$arity$3(ret__5366__auto__,k__5367__auto__,v__5368__auto__) : f__5364__auto__.call(null,ret__5366__auto__,k__5367__auto__,v__5368__auto__));
}),init__5365__auto__,this__5363__auto____$1);
}));

(datascript.parser.Or.prototype.cljs$core$IPrintWithWriter$_pr_writer$arity$3 \x3d (function (this__5358__auto__,writer__5359__auto__,opts__5360__auto__){
var self__ \x3d this;
var this__5358__auto____$1 \x3d this;
var pr_pair__5361__auto__ \x3d (function (keyval__5362__auto__){
return cljs.core.pr_sequential_writer(writer__5359__auto__,cljs.core.pr_writer,\x22\x22,\x22 \x22,\x22\x22,opts__5360__auto__,keyval__5362__auto__);
});
return cljs.core.pr_sequential_writer(writer__5359__auto__,pr_pair__5361__auto__,\x22#datascript.parser.Or{\x22,\x22, \x22,\x22}\x22,opts__5360__auto__,cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22source\x22,\x22source\x22,-433931539),self__.source],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22rule-vars\x22,\x22rule-vars\x22,1665972520),self__.rule_vars],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22clauses\x22,\x22clauses\x22,1454841241),self__.clauses],null))], null),self__.__extmap));
}));

(datascript.parser.Or.prototype.cljs$core$IIterable$_iterator$arity$1 \x3d (function (G__54610){
var self__ \x3d this;
var G__54610__$1 \x3d this;
return (new cljs.core.RecordIter((0),G__54610__$1,3,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22source\x22,\x22source\x22,-433931539),new cljs.core.Keyword(null,\x22rule-vars\x22,\x22rule-vars\x22,1665972520),new cljs.core.Keyword(null,\x22clauses\x22,\x22clauses\x22,1454841241)], null),(cljs.core.truth_(self__.__extmap)?cljs.core._iterator(self__.__extmap):cljs.core.nil_iter())));
}));

(datascript.parser.Or.prototype.cljs$core$IMeta$_meta$arity$1 \x3d (function (this__5341__auto__){
var self__ \x3d this;
var this__5341__auto____$1 \x3d this;
return self__.__meta;
}));

(datascript.parser.Or.prototype.cljs$core$ICloneable$_clone$arity$1 \x3d (function (this__5338__auto__){
var self__ \x3d this;
var this__5338__auto____$1 \x3d this;
return (new datascript.parser.Or(self__.source,self__.rule_vars,self__.clauses,self__.__meta,self__.__extmap,self__.__hash));
}));

(datascript.parser.Or.prototype.cljs$core$ICounted$_count$arity$1 \x3d (function (this__5347__auto__){
var self__ \x3d this;
var this__5347__auto____$1 \x3d this;
return (3 + cljs.core.count(self__.__extmap));
}));

(datascript.parser.Or.prototype.cljs$core$IHash$_hash$arity$1 \x3d (function (this__5339__auto__){
var self__ \x3d this;
var this__5339__auto____$1 \x3d this;
var h__5154__auto__ \x3d self__.__hash;
if((!((h__5154__auto__ \x3d\x3d null)))){
return h__5154__auto__;
} else {
var h__5154__auto____$1 \x3d (function (coll__5340__auto__){
return (1461934571 ^ cljs.core.hash_unordered_coll(coll__5340__auto__));
})(this__5339__auto____$1);
(self__.__hash \x3d h__5154__auto____$1);

return h__5154__auto____$1;
}
}));

(datascript.parser.Or.prototype.cljs$core$IEquiv$_equiv$arity$2 \x3d (function (this54612,other54613){
var self__ \x3d this;
var this54612__$1 \x3d this;
return (((!((other54613 \x3d\x3d null)))) \x26\x26 ((((this54612__$1.constructor \x3d\x3d\x3d other54613.constructor)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54612__$1.source,other54613.source)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54612__$1.rule_vars,other54613.rule_vars)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54612__$1.clauses,other54613.clauses)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54612__$1.__extmap,other54613.__extmap)))))))))));
}));

(datascript.parser.Or.prototype.cljs$core$IMap$_dissoc$arity$2 \x3d (function (this__5353__auto__,k__5354__auto__){
var self__ \x3d this;
var this__5353__auto____$1 \x3d this;
if(cljs.core.contains_QMARK_(new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,\x22rule-vars\x22,\x22rule-vars\x22,1665972520),null,new cljs.core.Keyword(null,\x22source\x22,\x22source\x22,-433931539),null,new cljs.core.Keyword(null,\x22clauses\x22,\x22clauses\x22,1454841241),null], null), null),k__5354__auto__)){
return cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(cljs.core._with_meta(cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,this__5353__auto____$1),self__.__meta),k__5354__auto__);
} else {
return (new datascript.parser.Or(self__.source,self__.rule_vars,self__.clauses,self__.__meta,cljs.core.not_empty(cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(self__.__extmap,k__5354__auto__)),null));
}
}));

(datascript.parser.Or.prototype.cljs$core$IAssociative$_contains_key_QMARK_$arity$2 \x3d (function (this__5350__auto__,k54611){
var self__ \x3d this;
var this__5350__auto____$1 \x3d this;
var G__54620 \x3d k54611;
var G__54620__$1 \x3d (((G__54620 instanceof cljs.core.Keyword))?G__54620.fqn:null);
switch (G__54620__$1) {
case \x22source\x22:
case \x22rule-vars\x22:
case \x22clauses\x22:
return true;

break;
default:
return cljs.core.contains_QMARK_(self__.__extmap,k54611);

}
}));

(datascript.parser.Or.prototype.cljs$core$IAssociative$_assoc$arity$3 \x3d (function (this__5351__auto__,k__5352__auto__,G__54610){
var self__ \x3d this;
var this__5351__auto____$1 \x3d this;
var pred__54621 \x3d cljs.core.keyword_identical_QMARK_;
var expr__54622 \x3d k__5352__auto__;
if(cljs.core.truth_((pred__54621.cljs$core$IFn$_invoke$arity$2 ? pred__54621.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22source\x22,\x22source\x22,-433931539),expr__54622) : pred__54621.call(null,new cljs.core.Keyword(null,\x22source\x22,\x22source\x22,-433931539),expr__54622)))){
return (new datascript.parser.Or(G__54610,self__.rule_vars,self__.clauses,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__54621.cljs$core$IFn$_invoke$arity$2 ? pred__54621.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22rule-vars\x22,\x22rule-vars\x22,1665972520),expr__54622) : pred__54621.call(null,new cljs.core.Keyword(null,\x22rule-vars\x22,\x22rule-vars\x22,1665972520),expr__54622)))){
return (new datascript.parser.Or(self__.source,G__54610,self__.clauses,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__54621.cljs$core$IFn$_invoke$arity$2 ? pred__54621.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22clauses\x22,\x22clauses\x22,1454841241),expr__54622) : pred__54621.call(null,new cljs.core.Keyword(null,\x22clauses\x22,\x22clauses\x22,1454841241),expr__54622)))){
return (new datascript.parser.Or(self__.source,self__.rule_vars,G__54610,self__.__meta,self__.__extmap,null));
} else {
return (new datascript.parser.Or(self__.source,self__.rule_vars,self__.clauses,self__.__meta,cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k__5352__auto__,G__54610),null));
}
}
}
}));

(datascript.parser.Or.prototype.cljs$core$ISeqable$_seq$arity$1 \x3d (function (this__5356__auto__){
var self__ \x3d this;
var this__5356__auto____$1 \x3d this;
return cljs.core.seq(cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22source\x22,\x22source\x22,-433931539),self__.source,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22rule-vars\x22,\x22rule-vars\x22,1665972520),self__.rule_vars,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22clauses\x22,\x22clauses\x22,1454841241),self__.clauses,null))], null),self__.__extmap));
}));

(datascript.parser.Or.prototype.cljs$core$IWithMeta$_with_meta$arity$2 \x3d (function (this__5342__auto__,G__54610){
var self__ \x3d this;
var this__5342__auto____$1 \x3d this;
return (new datascript.parser.Or(self__.source,self__.rule_vars,self__.clauses,G__54610,self__.__extmap,self__.__hash));
}));

(datascript.parser.Or.prototype.cljs$core$ICollection$_conj$arity$2 \x3d (function (this__5348__auto__,entry__5349__auto__){
var self__ \x3d this;
var this__5348__auto____$1 \x3d this;
if(cljs.core.vector_QMARK_(entry__5349__auto__)){
return this__5348__auto____$1.cljs$core$IAssociative$_assoc$arity$3(null,cljs.core._nth(entry__5349__auto__,(0)),cljs.core._nth(entry__5349__auto__,(1)));
} else {
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(cljs.core._conj,this__5348__auto____$1,entry__5349__auto__);
}
}));

(datascript.parser.Or.prototype.datascript$parser$ITraversable$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.parser.Or.prototype.datascript$parser$ITraversable$_postwalk$arity$2 \x3d (function (this__52373__auto__,f54607){
var self__ \x3d this;
var this__52373__auto____$1 \x3d this;
var new__52374__auto__ \x3d (new datascript.parser.Or(datascript.parser.postwalk(self__.source,f54607),datascript.parser.postwalk(self__.rule_vars,f54607),datascript.parser.postwalk(self__.clauses,f54607),null,null,null));
var temp__5802__auto__ \x3d cljs.core.meta(this__52373__auto____$1);
if(cljs.core.truth_(temp__5802__auto__)){
var meta__52375__auto__ \x3d temp__5802__auto__;
return cljs.core.with_meta(new__52374__auto__,meta__52375__auto__);
} else {
return new__52374__auto__;
}
}));

(datascript.parser.Or.prototype.datascript$parser$ITraversable$_collect$arity$3 \x3d (function (___52376__auto__,pred54608,acc54609){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
return datascript.parser.collect.cljs$core$IFn$_invoke$arity$3(pred54608,self__.clauses,datascript.parser.collect.cljs$core$IFn$_invoke$arity$3(pred54608,self__.rule_vars,datascript.parser.collect.cljs$core$IFn$_invoke$arity$3(pred54608,self__.source,acc54609)));
}));

(datascript.parser.Or.prototype.datascript$parser$ITraversable$_collect_vars$arity$2 \x3d (function (___52376__auto__,acc54609){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
var G__54624 \x3d (function (){var G__54626 \x3d (datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2 ? datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2(acc54609,self__.source) : datascript.parser.collect_vars_acc.call(null,acc54609,self__.source));
var G__54627 \x3d self__.rule_vars;
return (datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2 ? datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2(G__54626,G__54627) : datascript.parser.collect_vars_acc.call(null,G__54626,G__54627));
})();
var G__54625 \x3d self__.clauses;
return (datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2 ? datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2(G__54624,G__54625) : datascript.parser.collect_vars_acc.call(null,G__54624,G__54625));
}));

(datascript.parser.Or.getBasis \x3d (function (){
return new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22source\x22,\x22source\x22,1206599988,null),new cljs.core.Symbol(null,\x22rule-vars\x22,\x22rule-vars\x22,-988463249,null),new cljs.core.Symbol(null,\x22clauses\x22,\x22clauses\x22,-1199594528,null)], null);
}));

(datascript.parser.Or.cljs$lang$type \x3d true);

(datascript.parser.Or.cljs$lang$ctorPrSeq \x3d (function (this__5389__auto__){
return (new cljs.core.List(null,\x22datascript.parser/Or\x22,null,(1),null));
}));

(datascript.parser.Or.cljs$lang$ctorPrWriter \x3d (function (this__5389__auto__,writer__5390__auto__){
return cljs.core._write(writer__5390__auto__,\x22datascript.parser/Or\x22);
}));

/**
 * Positional factory function for datascript.parser/Or.
 */
datascript.parser.__GT_Or \x3d (function datascript$parser$__GT_Or(source,rule_vars,clauses){
return (new datascript.parser.Or(source,rule_vars,clauses,null,null,null));
});

/**
 * Factory function for datascript.parser/Or, taking a map of keywords to field values.
 */
datascript.parser.map__GT_Or \x3d (function datascript$parser$map__GT_Or(G__54614){
var extmap__5385__auto__ \x3d (function (){var G__54628 \x3d cljs.core.dissoc.cljs$core$IFn$_invoke$arity$variadic(G__54614,new cljs.core.Keyword(null,\x22source\x22,\x22source\x22,-433931539),cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,\x22rule-vars\x22,\x22rule-vars\x22,1665972520),new cljs.core.Keyword(null,\x22clauses\x22,\x22clauses\x22,1454841241)], 0));
if(cljs.core.record_QMARK_(G__54614)){
return cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,G__54628);
} else {
return G__54628;
}
})();
return (new datascript.parser.Or(new cljs.core.Keyword(null,\x22source\x22,\x22source\x22,-433931539).cljs$core$IFn$_invoke$arity$1(G__54614),new cljs.core.Keyword(null,\x22rule-vars\x22,\x22rule-vars\x22,1665972520).cljs$core$IFn$_invoke$arity$1(G__54614),new cljs.core.Keyword(null,\x22clauses\x22,\x22clauses\x22,1454841241).cljs$core$IFn$_invoke$arity$1(G__54614),null,cljs.core.not_empty(extmap__5385__auto__),null));
});


/**
* @constructor
 * @implements {cljs.core.IRecord}
 * @implements {cljs.core.IKVReduce}
 * @implements {cljs.core.IEquiv}
 * @implements {cljs.core.IHash}
 * @implements {cljs.core.ICollection}
 * @implements {cljs.core.ICounted}
 * @implements {cljs.core.ISeqable}
 * @implements {cljs.core.IMeta}
 * @implements {cljs.core.ICloneable}
 * @implements {cljs.core.IPrintWithWriter}
 * @implements {cljs.core.IIterable}
 * @implements {datascript.parser.ITraversable}
 * @implements {cljs.core.IWithMeta}
 * @implements {cljs.core.IAssociative}
 * @implements {cljs.core.IMap}
 * @implements {cljs.core.ILookup}
*/
datascript.parser.And \x3d (function (clauses,__meta,__extmap,__hash){
this.clauses \x3d clauses;
this.__meta \x3d __meta;
this.__extmap \x3d __extmap;
this.__hash \x3d __hash;
this.cljs$lang$protocol_mask$partition0$ \x3d 2230716170;
this.cljs$lang$protocol_mask$partition1$ \x3d 139264;
});
(datascript.parser.And.prototype.cljs$core$ILookup$_lookup$arity$2 \x3d (function (this__5343__auto__,k__5344__auto__){
var self__ \x3d this;
var this__5343__auto____$1 \x3d this;
return this__5343__auto____$1.cljs$core$ILookup$_lookup$arity$3(null,k__5344__auto__,null);
}));

(datascript.parser.And.prototype.cljs$core$ILookup$_lookup$arity$3 \x3d (function (this__5345__auto__,k54633,else__5346__auto__){
var self__ \x3d this;
var this__5345__auto____$1 \x3d this;
var G__54637 \x3d k54633;
var G__54637__$1 \x3d (((G__54637 instanceof cljs.core.Keyword))?G__54637.fqn:null);
switch (G__54637__$1) {
case \x22clauses\x22:
return self__.clauses;

break;
default:
return cljs.core.get.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k54633,else__5346__auto__);

}
}));

(datascript.parser.And.prototype.cljs$core$IKVReduce$_kv_reduce$arity$3 \x3d (function (this__5363__auto__,f__5364__auto__,init__5365__auto__){
var self__ \x3d this;
var this__5363__auto____$1 \x3d this;
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (ret__5366__auto__,p__54638){
var vec__54639 \x3d p__54638;
var k__5367__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54639,(0),null);
var v__5368__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54639,(1),null);
return (f__5364__auto__.cljs$core$IFn$_invoke$arity$3 ? f__5364__auto__.cljs$core$IFn$_invoke$arity$3(ret__5366__auto__,k__5367__auto__,v__5368__auto__) : f__5364__auto__.call(null,ret__5366__auto__,k__5367__auto__,v__5368__auto__));
}),init__5365__auto__,this__5363__auto____$1);
}));

(datascript.parser.And.prototype.cljs$core$IPrintWithWriter$_pr_writer$arity$3 \x3d (function (this__5358__auto__,writer__5359__auto__,opts__5360__auto__){
var self__ \x3d this;
var this__5358__auto____$1 \x3d this;
var pr_pair__5361__auto__ \x3d (function (keyval__5362__auto__){
return cljs.core.pr_sequential_writer(writer__5359__auto__,cljs.core.pr_writer,\x22\x22,\x22 \x22,\x22\x22,opts__5360__auto__,keyval__5362__auto__);
});
return cljs.core.pr_sequential_writer(writer__5359__auto__,pr_pair__5361__auto__,\x22#datascript.parser.And{\x22,\x22, \x22,\x22}\x22,opts__5360__auto__,cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22clauses\x22,\x22clauses\x22,1454841241),self__.clauses],null))], null),self__.__extmap));
}));

(datascript.parser.And.prototype.cljs$core$IIterable$_iterator$arity$1 \x3d (function (G__54632){
var self__ \x3d this;
var G__54632__$1 \x3d this;
return (new cljs.core.RecordIter((0),G__54632__$1,1,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22clauses\x22,\x22clauses\x22,1454841241)], null),(cljs.core.truth_(self__.__extmap)?cljs.core._iterator(self__.__extmap):cljs.core.nil_iter())));
}));

(datascript.parser.And.prototype.cljs$core$IMeta$_meta$arity$1 \x3d (function (this__5341__auto__){
var self__ \x3d this;
var this__5341__auto____$1 \x3d this;
return self__.__meta;
}));

(datascript.parser.And.prototype.cljs$core$ICloneable$_clone$arity$1 \x3d (function (this__5338__auto__){
var self__ \x3d this;
var this__5338__auto____$1 \x3d this;
return (new datascript.parser.And(self__.clauses,self__.__meta,self__.__extmap,self__.__hash));
}));

(datascript.parser.And.prototype.cljs$core$ICounted$_count$arity$1 \x3d (function (this__5347__auto__){
var self__ \x3d this;
var this__5347__auto____$1 \x3d this;
return (1 + cljs.core.count(self__.__extmap));
}));

(datascript.parser.And.prototype.cljs$core$IHash$_hash$arity$1 \x3d (function (this__5339__auto__){
var self__ \x3d this;
var this__5339__auto____$1 \x3d this;
var h__5154__auto__ \x3d self__.__hash;
if((!((h__5154__auto__ \x3d\x3d null)))){
return h__5154__auto__;
} else {
var h__5154__auto____$1 \x3d (function (coll__5340__auto__){
return (-131856804 ^ cljs.core.hash_unordered_coll(coll__5340__auto__));
})(this__5339__auto____$1);
(self__.__hash \x3d h__5154__auto____$1);

return h__5154__auto____$1;
}
}));

(datascript.parser.And.prototype.cljs$core$IEquiv$_equiv$arity$2 \x3d (function (this54634,other54635){
var self__ \x3d this;
var this54634__$1 \x3d this;
return (((!((other54635 \x3d\x3d null)))) \x26\x26 ((((this54634__$1.constructor \x3d\x3d\x3d other54635.constructor)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54634__$1.clauses,other54635.clauses)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54634__$1.__extmap,other54635.__extmap)))))));
}));

(datascript.parser.And.prototype.cljs$core$IMap$_dissoc$arity$2 \x3d (function (this__5353__auto__,k__5354__auto__){
var self__ \x3d this;
var this__5353__auto____$1 \x3d this;
if(cljs.core.contains_QMARK_(new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,\x22clauses\x22,\x22clauses\x22,1454841241),null], null), null),k__5354__auto__)){
return cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(cljs.core._with_meta(cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,this__5353__auto____$1),self__.__meta),k__5354__auto__);
} else {
return (new datascript.parser.And(self__.clauses,self__.__meta,cljs.core.not_empty(cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(self__.__extmap,k__5354__auto__)),null));
}
}));

(datascript.parser.And.prototype.cljs$core$IAssociative$_contains_key_QMARK_$arity$2 \x3d (function (this__5350__auto__,k54633){
var self__ \x3d this;
var this__5350__auto____$1 \x3d this;
var G__54642 \x3d k54633;
var G__54642__$1 \x3d (((G__54642 instanceof cljs.core.Keyword))?G__54642.fqn:null);
switch (G__54642__$1) {
case \x22clauses\x22:
return true;

break;
default:
return cljs.core.contains_QMARK_(self__.__extmap,k54633);

}
}));

(datascript.parser.And.prototype.cljs$core$IAssociative$_assoc$arity$3 \x3d (function (this__5351__auto__,k__5352__auto__,G__54632){
var self__ \x3d this;
var this__5351__auto____$1 \x3d this;
var pred__54643 \x3d cljs.core.keyword_identical_QMARK_;
var expr__54644 \x3d k__5352__auto__;
if(cljs.core.truth_((pred__54643.cljs$core$IFn$_invoke$arity$2 ? pred__54643.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22clauses\x22,\x22clauses\x22,1454841241),expr__54644) : pred__54643.call(null,new cljs.core.Keyword(null,\x22clauses\x22,\x22clauses\x22,1454841241),expr__54644)))){
return (new datascript.parser.And(G__54632,self__.__meta,self__.__extmap,null));
} else {
return (new datascript.parser.And(self__.clauses,self__.__meta,cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k__5352__auto__,G__54632),null));
}
}));

(datascript.parser.And.prototype.cljs$core$ISeqable$_seq$arity$1 \x3d (function (this__5356__auto__){
var self__ \x3d this;
var this__5356__auto____$1 \x3d this;
return cljs.core.seq(cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22clauses\x22,\x22clauses\x22,1454841241),self__.clauses,null))], null),self__.__extmap));
}));

(datascript.parser.And.prototype.cljs$core$IWithMeta$_with_meta$arity$2 \x3d (function (this__5342__auto__,G__54632){
var self__ \x3d this;
var this__5342__auto____$1 \x3d this;
return (new datascript.parser.And(self__.clauses,G__54632,self__.__extmap,self__.__hash));
}));

(datascript.parser.And.prototype.cljs$core$ICollection$_conj$arity$2 \x3d (function (this__5348__auto__,entry__5349__auto__){
var self__ \x3d this;
var this__5348__auto____$1 \x3d this;
if(cljs.core.vector_QMARK_(entry__5349__auto__)){
return this__5348__auto____$1.cljs$core$IAssociative$_assoc$arity$3(null,cljs.core._nth(entry__5349__auto__,(0)),cljs.core._nth(entry__5349__auto__,(1)));
} else {
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(cljs.core._conj,this__5348__auto____$1,entry__5349__auto__);
}
}));

(datascript.parser.And.prototype.datascript$parser$ITraversable$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.parser.And.prototype.datascript$parser$ITraversable$_postwalk$arity$2 \x3d (function (this__52373__auto__,f54629){
var self__ \x3d this;
var this__52373__auto____$1 \x3d this;
var new__52374__auto__ \x3d (new datascript.parser.And(datascript.parser.postwalk(self__.clauses,f54629),null,null,null));
var temp__5802__auto__ \x3d cljs.core.meta(this__52373__auto____$1);
if(cljs.core.truth_(temp__5802__auto__)){
var meta__52375__auto__ \x3d temp__5802__auto__;
return cljs.core.with_meta(new__52374__auto__,meta__52375__auto__);
} else {
return new__52374__auto__;
}
}));

(datascript.parser.And.prototype.datascript$parser$ITraversable$_collect$arity$3 \x3d (function (___52376__auto__,pred54630,acc54631){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
return datascript.parser.collect.cljs$core$IFn$_invoke$arity$3(pred54630,self__.clauses,acc54631);
}));

(datascript.parser.And.prototype.datascript$parser$ITraversable$_collect_vars$arity$2 \x3d (function (___52376__auto__,acc54631){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
return (datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2 ? datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2(acc54631,self__.clauses) : datascript.parser.collect_vars_acc.call(null,acc54631,self__.clauses));
}));

(datascript.parser.And.getBasis \x3d (function (){
return new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22clauses\x22,\x22clauses\x22,-1199594528,null)], null);
}));

(datascript.parser.And.cljs$lang$type \x3d true);

(datascript.parser.And.cljs$lang$ctorPrSeq \x3d (function (this__5389__auto__){
return (new cljs.core.List(null,\x22datascript.parser/And\x22,null,(1),null));
}));

(datascript.parser.And.cljs$lang$ctorPrWriter \x3d (function (this__5389__auto__,writer__5390__auto__){
return cljs.core._write(writer__5390__auto__,\x22datascript.parser/And\x22);
}));

/**
 * Positional factory function for datascript.parser/And.
 */
datascript.parser.__GT_And \x3d (function datascript$parser$__GT_And(clauses){
return (new datascript.parser.And(clauses,null,null,null));
});

/**
 * Factory function for datascript.parser/And, taking a map of keywords to field values.
 */
datascript.parser.map__GT_And \x3d (function datascript$parser$map__GT_And(G__54636){
var extmap__5385__auto__ \x3d (function (){var G__54646 \x3d cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(G__54636,new cljs.core.Keyword(null,\x22clauses\x22,\x22clauses\x22,1454841241));
if(cljs.core.record_QMARK_(G__54636)){
return cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,G__54646);
} else {
return G__54646;
}
})();
return (new datascript.parser.And(new cljs.core.Keyword(null,\x22clauses\x22,\x22clauses\x22,1454841241).cljs$core$IFn$_invoke$arity$1(G__54636),null,cljs.core.not_empty(extmap__5385__auto__),null));
});

datascript.parser.parse_pattern_el \x3d (function datascript$parser$parse_pattern_el(form){
var or__5045__auto__ \x3d datascript.parser.parse_placeholder(form);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
var or__5045__auto____$1 \x3d datascript.parser.parse_variable(form);
if(cljs.core.truth_(or__5045__auto____$1)){
return or__5045__auto____$1;
} else {
return datascript.parser.parse_constant(form);
}
}
});
datascript.parser.take_source \x3d (function datascript$parser$take_source(form){
if(cljs.core.sequential_QMARK_(form)){
var temp__5802__auto__ \x3d datascript.parser.parse_src_var(cljs.core.first(form));
if(cljs.core.truth_(temp__5802__auto__)){
var source_STAR_ \x3d temp__5802__auto__;
return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [source_STAR_,cljs.core.next(form)], null);
} else {
return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new datascript.parser.DefaultSrc(null,null,null)),form], null);
}
} else {
return null;
}
});
datascript.parser.parse_pattern \x3d (function datascript$parser$parse_pattern(form){
var temp__5804__auto__ \x3d datascript.parser.take_source(form);
if(cljs.core.truth_(temp__5804__auto__)){
var vec__54647 \x3d temp__5804__auto__;
var source_STAR_ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54647,(0),null);
var next_form \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54647,(1),null);
var temp__5804__auto____$1 \x3d datascript.parser.parse_seq(datascript.parser.parse_pattern_el,next_form);
if(cljs.core.truth_(temp__5804__auto____$1)){
var pattern_STAR_ \x3d temp__5804__auto____$1;
if((!(cljs.core.empty_QMARK_(pattern_STAR_)))){
return datascript.parser.with_source((new datascript.parser.Pattern(source_STAR_,pattern_STAR_,null,null,null)),form);
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2(\x22Pattern could not be empty\x22,new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22parser\x22,\x22where\x22,\x22parser/where\x22,-966053850),new cljs.core.Keyword(null,\x22form\x22,\x22form\x22,-1624062471),form], null));
}
} else {
return null;
}
} else {
return null;
}
});
datascript.parser.parse_call \x3d (function datascript$parser$parse_call(form){
if(cljs.core.sequential_QMARK_(form)){
var vec__54650 \x3d form;
var seq__54651 \x3d cljs.core.seq(vec__54650);
var first__54652 \x3d cljs.core.first(seq__54651);
var seq__54651__$1 \x3d cljs.core.next(seq__54651);
var fn \x3d first__54652;
var args \x3d seq__54651__$1;
var args__$1 \x3d (((args \x3d\x3d null))?cljs.core.PersistentVector.EMPTY:args);
var fn_STAR_ \x3d (function (){var or__5045__auto__ \x3d datascript.parser.parse_plain_symbol(fn);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return datascript.parser.parse_variable(fn);
}
})();
var args_STAR_ \x3d datascript.parser.parse_seq(datascript.parser.parse_fn_arg,args__$1);
if(cljs.core.truth_((function (){var and__5043__auto__ \x3d fn_STAR_;
if(cljs.core.truth_(and__5043__auto__)){
return args_STAR_;
} else {
return and__5043__auto__;
}
})())){
return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [fn_STAR_,args_STAR_], null);
} else {
return null;
}
} else {
return null;
}
});
datascript.parser.parse_pred \x3d (function datascript$parser$parse_pred(form){
if(datascript.parser.of_size_QMARK_(form,(1))){
var temp__5804__auto__ \x3d datascript.parser.parse_call(cljs.core.first(form));
if(cljs.core.truth_(temp__5804__auto__)){
var vec__54653 \x3d temp__5804__auto__;
var fn_STAR_ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54653,(0),null);
var args_STAR_ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54653,(1),null);
return datascript.parser.with_source((new datascript.parser.Predicate(fn_STAR_,args_STAR_,null,null,null)),form);
} else {
return null;
}
} else {
return null;
}
});
datascript.parser.parse_fn \x3d (function datascript$parser$parse_fn(form){
if(datascript.parser.of_size_QMARK_(form,(2))){
var vec__54656 \x3d form;
var call \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54656,(0),null);
var binding \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54656,(1),null);
var temp__5804__auto__ \x3d datascript.parser.parse_call(call);
if(cljs.core.truth_(temp__5804__auto__)){
var vec__54659 \x3d temp__5804__auto__;
var fn_STAR_ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54659,(0),null);
var args_STAR_ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54659,(1),null);
var temp__5804__auto____$1 \x3d datascript.parser.parse_binding(binding);
if(cljs.core.truth_(temp__5804__auto____$1)){
var binding_STAR_ \x3d temp__5804__auto____$1;
return datascript.parser.with_source((new datascript.parser.Function(fn_STAR_,args_STAR_,binding_STAR_,null,null,null)),form);
} else {
return null;
}
} else {
return null;
}
} else {
return null;
}
});
datascript.parser.parse_rule_expr \x3d (function datascript$parser$parse_rule_expr(form){
var temp__5804__auto__ \x3d datascript.parser.take_source(form);
if(cljs.core.truth_(temp__5804__auto__)){
var vec__54662 \x3d temp__5804__auto__;
var source_STAR_ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54662,(0),null);
var next_form \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54662,(1),null);
var vec__54665 \x3d next_form;
var seq__54666 \x3d cljs.core.seq(vec__54665);
var first__54667 \x3d cljs.core.first(seq__54666);
var seq__54666__$1 \x3d cljs.core.next(seq__54666);
var name \x3d first__54667;
var args \x3d seq__54666__$1;
var name_STAR_ \x3d datascript.parser.parse_plain_symbol(name);
var args_STAR_ \x3d datascript.parser.parse_seq(datascript.parser.parse_pattern_el,args);
if(cljs.core.truth_(name_STAR_)){
if(cljs.core.empty_QMARK_(args)){
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2(\x22rule-expr requires at least one argument\x22,new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22parser\x22,\x22where\x22,\x22parser/where\x22,-966053850),new cljs.core.Keyword(null,\x22form\x22,\x22form\x22,-1624062471),form], null));
} else {
if((args_STAR_ \x3d\x3d null)){
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2(\x22Cannot parse rule-expr arguments, expected [ (variable | constant | \x27_\x27)+ ]\x22,new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22parser\x22,\x22where\x22,\x22parser/where\x22,-966053850),new cljs.core.Keyword(null,\x22form\x22,\x22form\x22,-1624062471),form], null));
} else {
return (new datascript.parser.RuleExpr(source_STAR_,name_STAR_,args_STAR_,null,null,null));

}
}
} else {
return null;
}
} else {
return null;
}
});
datascript.parser.collect_vars_acc \x3d (function datascript$parser$collect_vars_acc(acc,form){
if((form instanceof datascript.parser.Variable)){
return cljs.core.conj.cljs$core$IFn$_invoke$arity$2(acc,form);
} else {
if((form instanceof datascript.parser.Not)){
return cljs.core.into.cljs$core$IFn$_invoke$arity$2(acc,form.vars);
} else {
if((form instanceof datascript.parser.Or)){
var G__54668 \x3d acc;
var G__54669 \x3d form.rule_vars;
return (datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2 ? datascript.parser.collect_vars_acc.cljs$core$IFn$_invoke$arity$2(G__54668,G__54669) : datascript.parser.collect_vars_acc.call(null,G__54668,G__54669));
} else {
if((((!((form \x3d\x3d null))))?((((false) || ((cljs.core.PROTOCOL_SENTINEL \x3d\x3d\x3d form.datascript$parser$ITraversable$))))?true:(((!form.cljs$lang$protocol_mask$partition$))?cljs.core.native_satisfies_QMARK_(datascript.parser.ITraversable,form):false)):cljs.core.native_satisfies_QMARK_(datascript.parser.ITraversable,form))){
return datascript.parser._collect_vars(form,acc);
} else {
if(cljs.core.sequential_QMARK_(form)){
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(datascript.parser.collect_vars_acc,acc,form);
} else {
return acc;

}
}
}
}
}
});
datascript.parser.collect_vars \x3d (function datascript$parser$collect_vars(form){
return datascript.parser.collect_vars_acc(cljs.core.PersistentVector.EMPTY,form);
});
datascript.parser.collect_vars_distinct \x3d (function datascript$parser$collect_vars_distinct(form){
return cljs.core.vec(cljs.core.distinct.cljs$core$IFn$_invoke$arity$1(datascript.parser.collect_vars(form)));
});
datascript.parser.validate_join_vars \x3d (function datascript$parser$validate_join_vars(required,free,form){
if(((cljs.core.empty_QMARK_(required)) \x26\x26 (cljs.core.empty_QMARK_(free)))){
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2(\x22Join variables should not be empty\x22,new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22parser\x22,\x22where\x22,\x22parser/where\x22,-966053850),new cljs.core.Keyword(null,\x22form\x22,\x22form\x22,-1624062471),form], null));
} else {
return null;
}
});
datascript.parser.validate_not \x3d (function datascript$parser$validate_not(clause,form){
datascript.parser.validate_join_vars(null,new cljs.core.Keyword(null,\x22vars\x22,\x22vars\x22,-2046957217).cljs$core$IFn$_invoke$arity$1(clause),form);

return clause;
});
datascript.parser.parse_not \x3d (function datascript$parser$parse_not(form){
var temp__5804__auto__ \x3d datascript.parser.take_source(form);
if(cljs.core.truth_(temp__5804__auto__)){
var vec__54671 \x3d temp__5804__auto__;
var source_STAR_ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54671,(0),null);
var next_form \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54671,(1),null);
var vec__54674 \x3d next_form;
var seq__54675 \x3d cljs.core.seq(vec__54674);
var first__54676 \x3d cljs.core.first(seq__54675);
var seq__54675__$1 \x3d cljs.core.next(seq__54675);
var sym \x3d first__54676;
var clauses \x3d seq__54675__$1;
if(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Symbol(null,\x22not\x22,\x22not\x22,1044554643,null),sym)){
var temp__5802__auto__ \x3d (datascript.parser.parse_clauses.cljs$core$IFn$_invoke$arity$1 ? datascript.parser.parse_clauses.cljs$core$IFn$_invoke$arity$1(clauses) : datascript.parser.parse_clauses.call(null,clauses));
if(cljs.core.truth_(temp__5802__auto__)){
var clauses_STAR_ \x3d temp__5802__auto__;
return datascript.parser.validate_not(datascript.parser.with_source((new datascript.parser.Not(source_STAR_,datascript.parser.collect_vars_distinct(clauses_STAR_),clauses_STAR_,null,null,null)),form),form);
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2(\x22Cannot parse \x27not\x27 clause, expected [ src-var? \x27not\x27 clause+ ]\x22,new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22parser\x22,\x22where\x22,\x22parser/where\x22,-966053850),new cljs.core.Keyword(null,\x22form\x22,\x22form\x22,-1624062471),form], null));
}
} else {
return null;
}
} else {
return null;
}
});
datascript.parser.parse_not_join \x3d (function datascript$parser$parse_not_join(form){
var temp__5804__auto__ \x3d datascript.parser.take_source(form);
if(cljs.core.truth_(temp__5804__auto__)){
var vec__54677 \x3d temp__5804__auto__;
var source_STAR_ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54677,(0),null);
var next_form \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54677,(1),null);
var vec__54680 \x3d next_form;
var seq__54681 \x3d cljs.core.seq(vec__54680);
var first__54682 \x3d cljs.core.first(seq__54681);
var seq__54681__$1 \x3d cljs.core.next(seq__54681);
var sym \x3d first__54682;
var first__54682__$1 \x3d cljs.core.first(seq__54681__$1);
var seq__54681__$2 \x3d cljs.core.next(seq__54681__$1);
var vars \x3d first__54682__$1;
var clauses \x3d seq__54681__$2;
if(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Symbol(null,\x22not-join\x22,\x22not-join\x22,-645515756,null),sym)){
var vars_STAR_ \x3d datascript.parser.parse_seq(datascript.parser.parse_variable,vars);
var clauses_STAR_ \x3d (datascript.parser.parse_clauses.cljs$core$IFn$_invoke$arity$1 ? datascript.parser.parse_clauses.cljs$core$IFn$_invoke$arity$1(clauses) : datascript.parser.parse_clauses.call(null,clauses));
if(cljs.core.truth_((function (){var and__5043__auto__ \x3d vars_STAR_;
if(cljs.core.truth_(and__5043__auto__)){
return clauses_STAR_;
} else {
return and__5043__auto__;
}
})())){
return datascript.parser.validate_not(datascript.parser.with_source((new datascript.parser.Not(source_STAR_,vars_STAR_,clauses_STAR_,null,null,null)),form),form);
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2(\x22Cannot parse \x27not-join\x27 clause, expected [ src-var? \x27not-join\x27 [variable+] clause+ ]\x22,new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22parser\x22,\x22where\x22,\x22parser/where\x22,-966053850),new cljs.core.Keyword(null,\x22form\x22,\x22form\x22,-1624062471),form], null));
}
} else {
return null;
}
} else {
return null;
}
});
datascript.parser.validate_or \x3d (function datascript$parser$validate_or(clause,form){
var map__54683 \x3d clause;
var map__54683__$1 \x3d cljs.core.__destructure_map(map__54683);
var map__54684 \x3d cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__54683__$1,new cljs.core.Keyword(null,\x22rule-vars\x22,\x22rule-vars\x22,1665972520));
var map__54684__$1 \x3d cljs.core.__destructure_map(map__54684);
var required \x3d cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__54684__$1,new cljs.core.Keyword(null,\x22required\x22,\x22required\x22,1807647006));
var free \x3d cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__54684__$1,new cljs.core.Keyword(null,\x22free\x22,\x22free\x22,801364328));
datascript.parser.validate_join_vars(required,free,form);

return clause;
});
datascript.parser.parse_and \x3d (function datascript$parser$parse_and(form){
if(((cljs.core.sequential_QMARK_(form)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Symbol(null,\x22and\x22,\x22and\x22,668631710,null),cljs.core.first(form))))){
var clauses_STAR_ \x3d (function (){var G__54685 \x3d cljs.core.next(form);
return (datascript.parser.parse_clauses.cljs$core$IFn$_invoke$arity$1 ? datascript.parser.parse_clauses.cljs$core$IFn$_invoke$arity$1(G__54685) : datascript.parser.parse_clauses.call(null,G__54685));
})();
if(cljs.core.truth_(cljs.core.not_empty(clauses_STAR_))){
return (new datascript.parser.And(clauses_STAR_,null,null,null));
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2(\x22Cannot parse \x27and\x27 clause, expected [ \x27and\x27 clause+ ]\x22,new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22parser\x22,\x22where\x22,\x22parser/where\x22,-966053850),new cljs.core.Keyword(null,\x22form\x22,\x22form\x22,-1624062471),form], null));
}
} else {
return null;
}
});
datascript.parser.parse_or \x3d (function datascript$parser$parse_or(form){
var temp__5804__auto__ \x3d datascript.parser.take_source(form);
if(cljs.core.truth_(temp__5804__auto__)){
var vec__54686 \x3d temp__5804__auto__;
var source_STAR_ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54686,(0),null);
var next_form \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54686,(1),null);
var vec__54689 \x3d next_form;
var seq__54690 \x3d cljs.core.seq(vec__54689);
var first__54691 \x3d cljs.core.first(seq__54690);
var seq__54690__$1 \x3d cljs.core.next(seq__54690);
var sym \x3d first__54691;
var clauses \x3d seq__54690__$1;
if(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Symbol(null,\x22or\x22,\x22or\x22,1876275696,null),sym)){
var temp__5802__auto__ \x3d datascript.parser.parse_seq(cljs.core.some_fn.cljs$core$IFn$_invoke$arity$2(datascript.parser.parse_and,datascript.parser.parse_clause),clauses);
if(cljs.core.truth_(temp__5802__auto__)){
var clauses_STAR_ \x3d temp__5802__auto__;
return datascript.parser.validate_or(datascript.parser.with_source((new datascript.parser.Or(source_STAR_,(new datascript.parser.RuleVars(null,datascript.parser.collect_vars_distinct(clauses_STAR_),null,null,null)),clauses_STAR_,null,null,null)),form),form);
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2(\x22Cannot parse \x27or\x27 clause, expected [ src-var? \x27or\x27 clause+ ]\x22,new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22parser\x22,\x22where\x22,\x22parser/where\x22,-966053850),new cljs.core.Keyword(null,\x22form\x22,\x22form\x22,-1624062471),form], null));
}
} else {
return null;
}
} else {
return null;
}
});
datascript.parser.parse_or_join \x3d (function datascript$parser$parse_or_join(form){
var temp__5804__auto__ \x3d datascript.parser.take_source(form);
if(cljs.core.truth_(temp__5804__auto__)){
var vec__54692 \x3d temp__5804__auto__;
var source_STAR_ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54692,(0),null);
var next_form \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54692,(1),null);
var vec__54695 \x3d next_form;
var seq__54696 \x3d cljs.core.seq(vec__54695);
var first__54697 \x3d cljs.core.first(seq__54696);
var seq__54696__$1 \x3d cljs.core.next(seq__54696);
var sym \x3d first__54697;
var first__54697__$1 \x3d cljs.core.first(seq__54696__$1);
var seq__54696__$2 \x3d cljs.core.next(seq__54696__$1);
var vars \x3d first__54697__$1;
var clauses \x3d seq__54696__$2;
if(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Symbol(null,\x22or-join\x22,\x22or-join\x22,591375469,null),sym)){
var vars_STAR_ \x3d datascript.parser.parse_rule_vars(vars);
var clauses_STAR_ \x3d datascript.parser.parse_seq(cljs.core.some_fn.cljs$core$IFn$_invoke$arity$2(datascript.parser.parse_and,datascript.parser.parse_clause),clauses);
if(cljs.core.truth_((function (){var and__5043__auto__ \x3d vars_STAR_;
if(cljs.core.truth_(and__5043__auto__)){
return clauses_STAR_;
} else {
return and__5043__auto__;
}
})())){
return datascript.parser.validate_or(datascript.parser.with_source((new datascript.parser.Or(source_STAR_,vars_STAR_,clauses_STAR_,null,null,null)),form),form);
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2(\x22Cannot parse \x27or-join\x27 clause, expected [ src-var? \x27or-join\x27 [variable+] clause+ ]\x22,new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22parser\x22,\x22where\x22,\x22parser/where\x22,-966053850),new cljs.core.Keyword(null,\x22form\x22,\x22form\x22,-1624062471),form], null));
}
} else {
return null;
}
} else {
return null;
}
});
datascript.parser.parse_clause \x3d (function datascript$parser$parse_clause(form){
var or__5045__auto__ \x3d datascript.parser.parse_not(form);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
var or__5045__auto____$1 \x3d datascript.parser.parse_not_join(form);
if(cljs.core.truth_(or__5045__auto____$1)){
return or__5045__auto____$1;
} else {
var or__5045__auto____$2 \x3d datascript.parser.parse_or(form);
if(cljs.core.truth_(or__5045__auto____$2)){
return or__5045__auto____$2;
} else {
var or__5045__auto____$3 \x3d datascript.parser.parse_or_join(form);
if(cljs.core.truth_(or__5045__auto____$3)){
return or__5045__auto____$3;
} else {
var or__5045__auto____$4 \x3d datascript.parser.parse_pred(form);
if(cljs.core.truth_(or__5045__auto____$4)){
return or__5045__auto____$4;
} else {
var or__5045__auto____$5 \x3d datascript.parser.parse_fn(form);
if(cljs.core.truth_(or__5045__auto____$5)){
return or__5045__auto____$5;
} else {
var or__5045__auto____$6 \x3d datascript.parser.parse_rule_expr(form);
if(cljs.core.truth_(or__5045__auto____$6)){
return or__5045__auto____$6;
} else {
var or__5045__auto____$7 \x3d datascript.parser.parse_pattern(form);
if(cljs.core.truth_(or__5045__auto____$7)){
return or__5045__auto____$7;
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2(\x22Cannot parse clause, expected (data-pattern | pred-expr | fn-expr | rule-expr | not-clause | not-join-clause | or-clause | or-join-clause)\x22,new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22parser\x22,\x22where\x22,\x22parser/where\x22,-966053850),new cljs.core.Keyword(null,\x22form\x22,\x22form\x22,-1624062471),form], null));
}
}
}
}
}
}
}
}
});
datascript.parser.parse_clauses \x3d (function datascript$parser$parse_clauses(clauses){
return datascript.parser.parse_seq(datascript.parser.parse_clause,clauses);
});
datascript.parser.parse_where \x3d (function datascript$parser$parse_where(form){
var or__5045__auto__ \x3d datascript.parser.parse_clauses(form);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2(\x22Cannot parse :where clause, expected [clause+]\x22,new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22parser\x22,\x22where\x22,\x22parser/where\x22,-966053850),new cljs.core.Keyword(null,\x22form\x22,\x22form\x22,-1624062471),form], null));
}
});

/**
* @constructor
 * @implements {cljs.core.IRecord}
 * @implements {cljs.core.IKVReduce}
 * @implements {cljs.core.IEquiv}
 * @implements {cljs.core.IHash}
 * @implements {cljs.core.ICollection}
 * @implements {cljs.core.ICounted}
 * @implements {cljs.core.ISeqable}
 * @implements {cljs.core.IMeta}
 * @implements {cljs.core.ICloneable}
 * @implements {cljs.core.IPrintWithWriter}
 * @implements {cljs.core.IIterable}
 * @implements {datascript.parser.ITraversable}
 * @implements {cljs.core.IWithMeta}
 * @implements {cljs.core.IAssociative}
 * @implements {cljs.core.IMap}
 * @implements {cljs.core.ILookup}
*/
datascript.parser.RuleBranch \x3d (function (vars,clauses,__meta,__extmap,__hash){
this.vars \x3d vars;
this.clauses \x3d clauses;
this.__meta \x3d __meta;
this.__extmap \x3d __extmap;
this.__hash \x3d __hash;
this.cljs$lang$protocol_mask$partition0$ \x3d 2230716170;
this.cljs$lang$protocol_mask$partition1$ \x3d 139264;
});
(datascript.parser.RuleBranch.prototype.cljs$core$ILookup$_lookup$arity$2 \x3d (function (this__5343__auto__,k__5344__auto__){
var self__ \x3d this;
var this__5343__auto____$1 \x3d this;
return this__5343__auto____$1.cljs$core$ILookup$_lookup$arity$3(null,k__5344__auto__,null);
}));

(datascript.parser.RuleBranch.prototype.cljs$core$ILookup$_lookup$arity$3 \x3d (function (this__5345__auto__,k54703,else__5346__auto__){
var self__ \x3d this;
var this__5345__auto____$1 \x3d this;
var G__54707 \x3d k54703;
var G__54707__$1 \x3d (((G__54707 instanceof cljs.core.Keyword))?G__54707.fqn:null);
switch (G__54707__$1) {
case \x22vars\x22:
return self__.vars;

break;
case \x22clauses\x22:
return self__.clauses;

break;
default:
return cljs.core.get.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k54703,else__5346__auto__);

}
}));

(datascript.parser.RuleBranch.prototype.cljs$core$IKVReduce$_kv_reduce$arity$3 \x3d (function (this__5363__auto__,f__5364__auto__,init__5365__auto__){
var self__ \x3d this;
var this__5363__auto____$1 \x3d this;
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (ret__5366__auto__,p__54708){
var vec__54709 \x3d p__54708;
var k__5367__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54709,(0),null);
var v__5368__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54709,(1),null);
return (f__5364__auto__.cljs$core$IFn$_invoke$arity$3 ? f__5364__auto__.cljs$core$IFn$_invoke$arity$3(ret__5366__auto__,k__5367__auto__,v__5368__auto__) : f__5364__auto__.call(null,ret__5366__auto__,k__5367__auto__,v__5368__auto__));
}),init__5365__auto__,this__5363__auto____$1);
}));

(datascript.parser.RuleBranch.prototype.cljs$core$IPrintWithWriter$_pr_writer$arity$3 \x3d (function (this__5358__auto__,writer__5359__auto__,opts__5360__auto__){
var self__ \x3d this;
var this__5358__auto____$1 \x3d this;
var pr_pair__5361__auto__ \x3d (function (keyval__5362__auto__){
return cljs.core.pr_sequential_writer(writer__5359__auto__,cljs.core.pr_writer,\x22\x22,\x22 \x22,\x22\x22,opts__5360__auto__,keyval__5362__auto__);
});
return cljs.core.pr_sequential_writer(writer__5359__auto__,pr_pair__5361__auto__,\x22#datascript.parser.RuleBranch{\x22,\x22, \x22,\x22}\x22,opts__5360__auto__,cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22vars\x22,\x22vars\x22,-2046957217),self__.vars],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22clauses\x22,\x22clauses\x22,1454841241),self__.clauses],null))], null),self__.__extmap));
}));

(datascript.parser.RuleBranch.prototype.cljs$core$IIterable$_iterator$arity$1 \x3d (function (G__54702){
var self__ \x3d this;
var G__54702__$1 \x3d this;
return (new cljs.core.RecordIter((0),G__54702__$1,2,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22vars\x22,\x22vars\x22,-2046957217),new cljs.core.Keyword(null,\x22clauses\x22,\x22clauses\x22,1454841241)], null),(cljs.core.truth_(self__.__extmap)?cljs.core._iterator(self__.__extmap):cljs.core.nil_iter())));
}));

(datascript.parser.RuleBranch.prototype.cljs$core$IMeta$_meta$arity$1 \x3d (function (this__5341__auto__){
var self__ \x3d this;
var this__5341__auto____$1 \x3d this;
return self__.__meta;
}));

(datascript.parser.RuleBranch.prototype.cljs$core$ICloneable$_clone$arity$1 \x3d (function (this__5338__auto__){
var self__ \x3d this;
var this__5338__auto____$1 \x3d this;
return (new datascript.parser.RuleBranch(self__.vars,self__.clauses,self__.__meta,self__.__extmap,self__.__hash));
}));

(datascript.parser.RuleBranch.prototype.cljs$core$ICounted$_count$arity$1 \x3d (function (this__5347__auto__){
var self__ \x3d this;
var this__5347__auto____$1 \x3d this;
return (2 + cljs.core.count(self__.__extmap));
}));

(datascript.parser.RuleBranch.prototype.cljs$core$IHash$_hash$arity$1 \x3d (function (this__5339__auto__){
var self__ \x3d this;
var this__5339__auto____$1 \x3d this;
var h__5154__auto__ \x3d self__.__hash;
if((!((h__5154__auto__ \x3d\x3d null)))){
return h__5154__auto__;
} else {
var h__5154__auto____$1 \x3d (function (coll__5340__auto__){
return (1024755006 ^ cljs.core.hash_unordered_coll(coll__5340__auto__));
})(this__5339__auto____$1);
(self__.__hash \x3d h__5154__auto____$1);

return h__5154__auto____$1;
}
}));

(datascript.parser.RuleBranch.prototype.cljs$core$IEquiv$_equiv$arity$2 \x3d (function (this54704,other54705){
var self__ \x3d this;
var this54704__$1 \x3d this;
return (((!((other54705 \x3d\x3d null)))) \x26\x26 ((((this54704__$1.constructor \x3d\x3d\x3d other54705.constructor)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54704__$1.vars,other54705.vars)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54704__$1.clauses,other54705.clauses)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54704__$1.__extmap,other54705.__extmap)))))))));
}));

(datascript.parser.RuleBranch.prototype.cljs$core$IMap$_dissoc$arity$2 \x3d (function (this__5353__auto__,k__5354__auto__){
var self__ \x3d this;
var this__5353__auto____$1 \x3d this;
if(cljs.core.contains_QMARK_(new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22clauses\x22,\x22clauses\x22,1454841241),null,new cljs.core.Keyword(null,\x22vars\x22,\x22vars\x22,-2046957217),null], null), null),k__5354__auto__)){
return cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(cljs.core._with_meta(cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,this__5353__auto____$1),self__.__meta),k__5354__auto__);
} else {
return (new datascript.parser.RuleBranch(self__.vars,self__.clauses,self__.__meta,cljs.core.not_empty(cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(self__.__extmap,k__5354__auto__)),null));
}
}));

(datascript.parser.RuleBranch.prototype.cljs$core$IAssociative$_contains_key_QMARK_$arity$2 \x3d (function (this__5350__auto__,k54703){
var self__ \x3d this;
var this__5350__auto____$1 \x3d this;
var G__54712 \x3d k54703;
var G__54712__$1 \x3d (((G__54712 instanceof cljs.core.Keyword))?G__54712.fqn:null);
switch (G__54712__$1) {
case \x22vars\x22:
case \x22clauses\x22:
return true;

break;
default:
return cljs.core.contains_QMARK_(self__.__extmap,k54703);

}
}));

(datascript.parser.RuleBranch.prototype.cljs$core$IAssociative$_assoc$arity$3 \x3d (function (this__5351__auto__,k__5352__auto__,G__54702){
var self__ \x3d this;
var this__5351__auto____$1 \x3d this;
var pred__54713 \x3d cljs.core.keyword_identical_QMARK_;
var expr__54714 \x3d k__5352__auto__;
if(cljs.core.truth_((pred__54713.cljs$core$IFn$_invoke$arity$2 ? pred__54713.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22vars\x22,\x22vars\x22,-2046957217),expr__54714) : pred__54713.call(null,new cljs.core.Keyword(null,\x22vars\x22,\x22vars\x22,-2046957217),expr__54714)))){
return (new datascript.parser.RuleBranch(G__54702,self__.clauses,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__54713.cljs$core$IFn$_invoke$arity$2 ? pred__54713.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22clauses\x22,\x22clauses\x22,1454841241),expr__54714) : pred__54713.call(null,new cljs.core.Keyword(null,\x22clauses\x22,\x22clauses\x22,1454841241),expr__54714)))){
return (new datascript.parser.RuleBranch(self__.vars,G__54702,self__.__meta,self__.__extmap,null));
} else {
return (new datascript.parser.RuleBranch(self__.vars,self__.clauses,self__.__meta,cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k__5352__auto__,G__54702),null));
}
}
}));

(datascript.parser.RuleBranch.prototype.cljs$core$ISeqable$_seq$arity$1 \x3d (function (this__5356__auto__){
var self__ \x3d this;
var this__5356__auto____$1 \x3d this;
return cljs.core.seq(cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22vars\x22,\x22vars\x22,-2046957217),self__.vars,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22clauses\x22,\x22clauses\x22,1454841241),self__.clauses,null))], null),self__.__extmap));
}));

(datascript.parser.RuleBranch.prototype.cljs$core$IWithMeta$_with_meta$arity$2 \x3d (function (this__5342__auto__,G__54702){
var self__ \x3d this;
var this__5342__auto____$1 \x3d this;
return (new datascript.parser.RuleBranch(self__.vars,self__.clauses,G__54702,self__.__extmap,self__.__hash));
}));

(datascript.parser.RuleBranch.prototype.cljs$core$ICollection$_conj$arity$2 \x3d (function (this__5348__auto__,entry__5349__auto__){
var self__ \x3d this;
var this__5348__auto____$1 \x3d this;
if(cljs.core.vector_QMARK_(entry__5349__auto__)){
return this__5348__auto____$1.cljs$core$IAssociative$_assoc$arity$3(null,cljs.core._nth(entry__5349__auto__,(0)),cljs.core._nth(entry__5349__auto__,(1)));
} else {
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(cljs.core._conj,this__5348__auto____$1,entry__5349__auto__);
}
}));

(datascript.parser.RuleBranch.prototype.datascript$parser$ITraversable$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.parser.RuleBranch.prototype.datascript$parser$ITraversable$_postwalk$arity$2 \x3d (function (this__52373__auto__,f54699){
var self__ \x3d this;
var this__52373__auto____$1 \x3d this;
var new__52374__auto__ \x3d (new datascript.parser.RuleBranch(datascript.parser.postwalk(self__.vars,f54699),datascript.parser.postwalk(self__.clauses,f54699),null,null,null));
var temp__5802__auto__ \x3d cljs.core.meta(this__52373__auto____$1);
if(cljs.core.truth_(temp__5802__auto__)){
var meta__52375__auto__ \x3d temp__5802__auto__;
return cljs.core.with_meta(new__52374__auto__,meta__52375__auto__);
} else {
return new__52374__auto__;
}
}));

(datascript.parser.RuleBranch.prototype.datascript$parser$ITraversable$_collect$arity$3 \x3d (function (___52376__auto__,pred54700,acc54701){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
return datascript.parser.collect.cljs$core$IFn$_invoke$arity$3(pred54700,self__.clauses,datascript.parser.collect.cljs$core$IFn$_invoke$arity$3(pred54700,self__.vars,acc54701));
}));

(datascript.parser.RuleBranch.prototype.datascript$parser$ITraversable$_collect_vars$arity$2 \x3d (function (___52376__auto__,acc54701){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
return datascript.parser.collect_vars_acc(datascript.parser.collect_vars_acc(acc54701,self__.vars),self__.clauses);
}));

(datascript.parser.RuleBranch.getBasis \x3d (function (){
return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22vars\x22,\x22vars\x22,-406425690,null),new cljs.core.Symbol(null,\x22clauses\x22,\x22clauses\x22,-1199594528,null)], null);
}));

(datascript.parser.RuleBranch.cljs$lang$type \x3d true);

(datascript.parser.RuleBranch.cljs$lang$ctorPrSeq \x3d (function (this__5389__auto__){
return (new cljs.core.List(null,\x22datascript.parser/RuleBranch\x22,null,(1),null));
}));

(datascript.parser.RuleBranch.cljs$lang$ctorPrWriter \x3d (function (this__5389__auto__,writer__5390__auto__){
return cljs.core._write(writer__5390__auto__,\x22datascript.parser/RuleBranch\x22);
}));

/**
 * Positional factory function for datascript.parser/RuleBranch.
 */
datascript.parser.__GT_RuleBranch \x3d (function datascript$parser$__GT_RuleBranch(vars,clauses){
return (new datascript.parser.RuleBranch(vars,clauses,null,null,null));
});

/**
 * Factory function for datascript.parser/RuleBranch, taking a map of keywords to field values.
 */
datascript.parser.map__GT_RuleBranch \x3d (function datascript$parser$map__GT_RuleBranch(G__54706){
var extmap__5385__auto__ \x3d (function (){var G__54716 \x3d cljs.core.dissoc.cljs$core$IFn$_invoke$arity$variadic(G__54706,new cljs.core.Keyword(null,\x22vars\x22,\x22vars\x22,-2046957217),cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,\x22clauses\x22,\x22clauses\x22,1454841241)], 0));
if(cljs.core.record_QMARK_(G__54706)){
return cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,G__54716);
} else {
return G__54716;
}
})();
return (new datascript.parser.RuleBranch(new cljs.core.Keyword(null,\x22vars\x22,\x22vars\x22,-2046957217).cljs$core$IFn$_invoke$arity$1(G__54706),new cljs.core.Keyword(null,\x22clauses\x22,\x22clauses\x22,1454841241).cljs$core$IFn$_invoke$arity$1(G__54706),null,cljs.core.not_empty(extmap__5385__auto__),null));
});


/**
* @constructor
 * @implements {cljs.core.IRecord}
 * @implements {cljs.core.IKVReduce}
 * @implements {cljs.core.IEquiv}
 * @implements {cljs.core.IHash}
 * @implements {cljs.core.ICollection}
 * @implements {cljs.core.ICounted}
 * @implements {cljs.core.ISeqable}
 * @implements {cljs.core.IMeta}
 * @implements {cljs.core.ICloneable}
 * @implements {cljs.core.IPrintWithWriter}
 * @implements {cljs.core.IIterable}
 * @implements {datascript.parser.ITraversable}
 * @implements {cljs.core.IWithMeta}
 * @implements {cljs.core.IAssociative}
 * @implements {cljs.core.IMap}
 * @implements {cljs.core.ILookup}
*/
datascript.parser.Rule \x3d (function (name,branches,__meta,__extmap,__hash){
this.name \x3d name;
this.branches \x3d branches;
this.__meta \x3d __meta;
this.__extmap \x3d __extmap;
this.__hash \x3d __hash;
this.cljs$lang$protocol_mask$partition0$ \x3d 2230716170;
this.cljs$lang$protocol_mask$partition1$ \x3d 139264;
});
(datascript.parser.Rule.prototype.cljs$core$ILookup$_lookup$arity$2 \x3d (function (this__5343__auto__,k__5344__auto__){
var self__ \x3d this;
var this__5343__auto____$1 \x3d this;
return this__5343__auto____$1.cljs$core$ILookup$_lookup$arity$3(null,k__5344__auto__,null);
}));

(datascript.parser.Rule.prototype.cljs$core$ILookup$_lookup$arity$3 \x3d (function (this__5345__auto__,k54721,else__5346__auto__){
var self__ \x3d this;
var this__5345__auto____$1 \x3d this;
var G__54725 \x3d k54721;
var G__54725__$1 \x3d (((G__54725 instanceof cljs.core.Keyword))?G__54725.fqn:null);
switch (G__54725__$1) {
case \x22name\x22:
return self__.name;

break;
case \x22branches\x22:
return self__.branches;

break;
default:
return cljs.core.get.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k54721,else__5346__auto__);

}
}));

(datascript.parser.Rule.prototype.cljs$core$IKVReduce$_kv_reduce$arity$3 \x3d (function (this__5363__auto__,f__5364__auto__,init__5365__auto__){
var self__ \x3d this;
var this__5363__auto____$1 \x3d this;
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (ret__5366__auto__,p__54726){
var vec__54727 \x3d p__54726;
var k__5367__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54727,(0),null);
var v__5368__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54727,(1),null);
return (f__5364__auto__.cljs$core$IFn$_invoke$arity$3 ? f__5364__auto__.cljs$core$IFn$_invoke$arity$3(ret__5366__auto__,k__5367__auto__,v__5368__auto__) : f__5364__auto__.call(null,ret__5366__auto__,k__5367__auto__,v__5368__auto__));
}),init__5365__auto__,this__5363__auto____$1);
}));

(datascript.parser.Rule.prototype.cljs$core$IPrintWithWriter$_pr_writer$arity$3 \x3d (function (this__5358__auto__,writer__5359__auto__,opts__5360__auto__){
var self__ \x3d this;
var this__5358__auto____$1 \x3d this;
var pr_pair__5361__auto__ \x3d (function (keyval__5362__auto__){
return cljs.core.pr_sequential_writer(writer__5359__auto__,cljs.core.pr_writer,\x22\x22,\x22 \x22,\x22\x22,opts__5360__auto__,keyval__5362__auto__);
});
return cljs.core.pr_sequential_writer(writer__5359__auto__,pr_pair__5361__auto__,\x22#datascript.parser.Rule{\x22,\x22, \x22,\x22}\x22,opts__5360__auto__,cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),self__.name],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22branches\x22,\x22branches\x22,-1240337268),self__.branches],null))], null),self__.__extmap));
}));

(datascript.parser.Rule.prototype.cljs$core$IIterable$_iterator$arity$1 \x3d (function (G__54720){
var self__ \x3d this;
var G__54720__$1 \x3d this;
return (new cljs.core.RecordIter((0),G__54720__$1,2,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),new cljs.core.Keyword(null,\x22branches\x22,\x22branches\x22,-1240337268)], null),(cljs.core.truth_(self__.__extmap)?cljs.core._iterator(self__.__extmap):cljs.core.nil_iter())));
}));

(datascript.parser.Rule.prototype.cljs$core$IMeta$_meta$arity$1 \x3d (function (this__5341__auto__){
var self__ \x3d this;
var this__5341__auto____$1 \x3d this;
return self__.__meta;
}));

(datascript.parser.Rule.prototype.cljs$core$ICloneable$_clone$arity$1 \x3d (function (this__5338__auto__){
var self__ \x3d this;
var this__5338__auto____$1 \x3d this;
return (new datascript.parser.Rule(self__.name,self__.branches,self__.__meta,self__.__extmap,self__.__hash));
}));

(datascript.parser.Rule.prototype.cljs$core$ICounted$_count$arity$1 \x3d (function (this__5347__auto__){
var self__ \x3d this;
var this__5347__auto____$1 \x3d this;
return (2 + cljs.core.count(self__.__extmap));
}));

(datascript.parser.Rule.prototype.cljs$core$IHash$_hash$arity$1 \x3d (function (this__5339__auto__){
var self__ \x3d this;
var this__5339__auto____$1 \x3d this;
var h__5154__auto__ \x3d self__.__hash;
if((!((h__5154__auto__ \x3d\x3d null)))){
return h__5154__auto__;
} else {
var h__5154__auto____$1 \x3d (function (coll__5340__auto__){
return (-900273052 ^ cljs.core.hash_unordered_coll(coll__5340__auto__));
})(this__5339__auto____$1);
(self__.__hash \x3d h__5154__auto____$1);

return h__5154__auto____$1;
}
}));

(datascript.parser.Rule.prototype.cljs$core$IEquiv$_equiv$arity$2 \x3d (function (this54722,other54723){
var self__ \x3d this;
var this54722__$1 \x3d this;
return (((!((other54723 \x3d\x3d null)))) \x26\x26 ((((this54722__$1.constructor \x3d\x3d\x3d other54723.constructor)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54722__$1.name,other54723.name)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54722__$1.branches,other54723.branches)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54722__$1.__extmap,other54723.__extmap)))))))));
}));

(datascript.parser.Rule.prototype.cljs$core$IMap$_dissoc$arity$2 \x3d (function (this__5353__auto__,k__5354__auto__){
var self__ \x3d this;
var this__5353__auto____$1 \x3d this;
if(cljs.core.contains_QMARK_(new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),null,new cljs.core.Keyword(null,\x22branches\x22,\x22branches\x22,-1240337268),null], null), null),k__5354__auto__)){
return cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(cljs.core._with_meta(cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,this__5353__auto____$1),self__.__meta),k__5354__auto__);
} else {
return (new datascript.parser.Rule(self__.name,self__.branches,self__.__meta,cljs.core.not_empty(cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(self__.__extmap,k__5354__auto__)),null));
}
}));

(datascript.parser.Rule.prototype.cljs$core$IAssociative$_contains_key_QMARK_$arity$2 \x3d (function (this__5350__auto__,k54721){
var self__ \x3d this;
var this__5350__auto____$1 \x3d this;
var G__54730 \x3d k54721;
var G__54730__$1 \x3d (((G__54730 instanceof cljs.core.Keyword))?G__54730.fqn:null);
switch (G__54730__$1) {
case \x22name\x22:
case \x22branches\x22:
return true;

break;
default:
return cljs.core.contains_QMARK_(self__.__extmap,k54721);

}
}));

(datascript.parser.Rule.prototype.cljs$core$IAssociative$_assoc$arity$3 \x3d (function (this__5351__auto__,k__5352__auto__,G__54720){
var self__ \x3d this;
var this__5351__auto____$1 \x3d this;
var pred__54731 \x3d cljs.core.keyword_identical_QMARK_;
var expr__54732 \x3d k__5352__auto__;
if(cljs.core.truth_((pred__54731.cljs$core$IFn$_invoke$arity$2 ? pred__54731.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),expr__54732) : pred__54731.call(null,new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),expr__54732)))){
return (new datascript.parser.Rule(G__54720,self__.branches,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__54731.cljs$core$IFn$_invoke$arity$2 ? pred__54731.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22branches\x22,\x22branches\x22,-1240337268),expr__54732) : pred__54731.call(null,new cljs.core.Keyword(null,\x22branches\x22,\x22branches\x22,-1240337268),expr__54732)))){
return (new datascript.parser.Rule(self__.name,G__54720,self__.__meta,self__.__extmap,null));
} else {
return (new datascript.parser.Rule(self__.name,self__.branches,self__.__meta,cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k__5352__auto__,G__54720),null));
}
}
}));

(datascript.parser.Rule.prototype.cljs$core$ISeqable$_seq$arity$1 \x3d (function (this__5356__auto__){
var self__ \x3d this;
var this__5356__auto____$1 \x3d this;
return cljs.core.seq(cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),self__.name,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22branches\x22,\x22branches\x22,-1240337268),self__.branches,null))], null),self__.__extmap));
}));

(datascript.parser.Rule.prototype.cljs$core$IWithMeta$_with_meta$arity$2 \x3d (function (this__5342__auto__,G__54720){
var self__ \x3d this;
var this__5342__auto____$1 \x3d this;
return (new datascript.parser.Rule(self__.name,self__.branches,G__54720,self__.__extmap,self__.__hash));
}));

(datascript.parser.Rule.prototype.cljs$core$ICollection$_conj$arity$2 \x3d (function (this__5348__auto__,entry__5349__auto__){
var self__ \x3d this;
var this__5348__auto____$1 \x3d this;
if(cljs.core.vector_QMARK_(entry__5349__auto__)){
return this__5348__auto____$1.cljs$core$IAssociative$_assoc$arity$3(null,cljs.core._nth(entry__5349__auto__,(0)),cljs.core._nth(entry__5349__auto__,(1)));
} else {
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(cljs.core._conj,this__5348__auto____$1,entry__5349__auto__);
}
}));

(datascript.parser.Rule.prototype.datascript$parser$ITraversable$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.parser.Rule.prototype.datascript$parser$ITraversable$_postwalk$arity$2 \x3d (function (this__52373__auto__,f54717){
var self__ \x3d this;
var this__52373__auto____$1 \x3d this;
var new__52374__auto__ \x3d (new datascript.parser.Rule(datascript.parser.postwalk(self__.name,f54717),datascript.parser.postwalk(self__.branches,f54717),null,null,null));
var temp__5802__auto__ \x3d cljs.core.meta(this__52373__auto____$1);
if(cljs.core.truth_(temp__5802__auto__)){
var meta__52375__auto__ \x3d temp__5802__auto__;
return cljs.core.with_meta(new__52374__auto__,meta__52375__auto__);
} else {
return new__52374__auto__;
}
}));

(datascript.parser.Rule.prototype.datascript$parser$ITraversable$_collect$arity$3 \x3d (function (___52376__auto__,pred54718,acc54719){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
return datascript.parser.collect.cljs$core$IFn$_invoke$arity$3(pred54718,self__.branches,datascript.parser.collect.cljs$core$IFn$_invoke$arity$3(pred54718,self__.name,acc54719));
}));

(datascript.parser.Rule.prototype.datascript$parser$ITraversable$_collect_vars$arity$2 \x3d (function (___52376__auto__,acc54719){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
return datascript.parser.collect_vars_acc(datascript.parser.collect_vars_acc(acc54719,self__.name),self__.branches);
}));

(datascript.parser.Rule.getBasis \x3d (function (){
return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22name\x22,\x22name\x22,-810760592,null),new cljs.core.Symbol(null,\x22branches\x22,\x22branches\x22,400194259,null)], null);
}));

(datascript.parser.Rule.cljs$lang$type \x3d true);

(datascript.parser.Rule.cljs$lang$ctorPrSeq \x3d (function (this__5389__auto__){
return (new cljs.core.List(null,\x22datascript.parser/Rule\x22,null,(1),null));
}));

(datascript.parser.Rule.cljs$lang$ctorPrWriter \x3d (function (this__5389__auto__,writer__5390__auto__){
return cljs.core._write(writer__5390__auto__,\x22datascript.parser/Rule\x22);
}));

/**
 * Positional factory function for datascript.parser/Rule.
 */
datascript.parser.__GT_Rule \x3d (function datascript$parser$__GT_Rule(name,branches){
return (new datascript.parser.Rule(name,branches,null,null,null));
});

/**
 * Factory function for datascript.parser/Rule, taking a map of keywords to field values.
 */
datascript.parser.map__GT_Rule \x3d (function datascript$parser$map__GT_Rule(G__54724){
var extmap__5385__auto__ \x3d (function (){var G__54734 \x3d cljs.core.dissoc.cljs$core$IFn$_invoke$arity$variadic(G__54724,new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,\x22branches\x22,\x22branches\x22,-1240337268)], 0));
if(cljs.core.record_QMARK_(G__54724)){
return cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,G__54734);
} else {
return G__54734;
}
})();
return (new datascript.parser.Rule(new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177).cljs$core$IFn$_invoke$arity$1(G__54724),new cljs.core.Keyword(null,\x22branches\x22,\x22branches\x22,-1240337268).cljs$core$IFn$_invoke$arity$1(G__54724),null,cljs.core.not_empty(extmap__5385__auto__),null));
});

datascript.parser.parse_rule \x3d (function datascript$parser$parse_rule(form){
if(cljs.core.sequential_QMARK_(form)){
var vec__54735 \x3d form;
var seq__54736 \x3d cljs.core.seq(vec__54735);
var first__54737 \x3d cljs.core.first(seq__54736);
var seq__54736__$1 \x3d cljs.core.next(seq__54736);
var head \x3d first__54737;
var clauses \x3d seq__54736__$1;
if(cljs.core.sequential_QMARK_(head)){
var vec__54738 \x3d head;
var seq__54739 \x3d cljs.core.seq(vec__54738);
var first__54740 \x3d cljs.core.first(seq__54739);
var seq__54739__$1 \x3d cljs.core.next(seq__54739);
var name \x3d first__54740;
var vars \x3d seq__54739__$1;
var name_STAR_ \x3d (function (){var or__5045__auto__ \x3d datascript.parser.parse_plain_symbol(name);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2(\x22Cannot parse rule name, expected plain-symbol\x22,new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22parser\x22,\x22rule\x22,\x22parser/rule\x22,-464044566),new cljs.core.Keyword(null,\x22form\x22,\x22form\x22,-1624062471),form], null));
}
})();
var vars_STAR_ \x3d datascript.parser.parse_rule_vars(vars);
var clauses_STAR_ \x3d (function (){var or__5045__auto__ \x3d cljs.core.not_empty(datascript.parser.parse_clauses(clauses));
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2(\x22Rule branch should have clauses\x22,new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22parser\x22,\x22rule\x22,\x22parser/rule\x22,-464044566),new cljs.core.Keyword(null,\x22form\x22,\x22form\x22,-1624062471),form], null));
}
})();
return new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),name_STAR_,new cljs.core.Keyword(null,\x22vars\x22,\x22vars\x22,-2046957217),vars_STAR_,new cljs.core.Keyword(null,\x22clauses\x22,\x22clauses\x22,1454841241),clauses_STAR_], null);
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22Cannot parse rule head, expected [rule-name rule-vars], got: \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([head], 0))].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22parser\x22,\x22rule\x22,\x22parser/rule\x22,-464044566),new cljs.core.Keyword(null,\x22form\x22,\x22form\x22,-1624062471),form], null));
}
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2(\x22Cannot parse rule, expected [rule-head clause+]\x22,new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22parser\x22,\x22rule\x22,\x22parser/rule\x22,-464044566),new cljs.core.Keyword(null,\x22form\x22,\x22form\x22,-1624062471),form], null));
}
});
datascript.parser.validate_arity \x3d (function datascript$parser$validate_arity(name,branches){
var vars0 \x3d new cljs.core.Keyword(null,\x22vars\x22,\x22vars\x22,-2046957217).cljs$core$IFn$_invoke$arity$1(cljs.core.first(branches));
var arity0 \x3d datascript.parser.rule_vars_arity(vars0);
var seq__54741 \x3d cljs.core.seq(cljs.core.next(branches));
var chunk__54743 \x3d null;
var count__54744 \x3d (0);
var i__54745 \x3d (0);
while(true){
if((i__54745 \x3c count__54744)){
var b \x3d chunk__54743.cljs$core$IIndexed$_nth$arity$2(null,i__54745);
var vars_55178 \x3d new cljs.core.Keyword(null,\x22vars\x22,\x22vars\x22,-2046957217).cljs$core$IFn$_invoke$arity$1(b);
if(cljs.core.not_EQ_.cljs$core$IFn$_invoke$arity$2(arity0,datascript.parser.rule_vars_arity(vars_55178))){
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22Arity mismatch for rule \x27\x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,\x22symbol\x22,\x22symbol\x22,-1038572696).cljs$core$IFn$_invoke$arity$1(name)], 0)),\x22\x27: \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([datascript.parser.flatten_rule_vars(vars0)], 0)),\x22 vs. \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([datascript.parser.flatten_rule_vars(vars_55178)], 0))].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22parser\x22,\x22rule\x22,\x22parser/rule\x22,-464044566),new cljs.core.Keyword(null,\x22rule\x22,\x22rule\x22,729973257),name], null));
} else {
}


var G__55179 \x3d seq__54741;
var G__55180 \x3d chunk__54743;
var G__55181 \x3d count__54744;
var G__55182 \x3d (i__54745 + (1));
seq__54741 \x3d G__55179;
chunk__54743 \x3d G__55180;
count__54744 \x3d G__55181;
i__54745 \x3d G__55182;
continue;
} else {
var temp__5804__auto__ \x3d cljs.core.seq(seq__54741);
if(temp__5804__auto__){
var seq__54741__$1 \x3d temp__5804__auto__;
if(cljs.core.chunked_seq_QMARK_(seq__54741__$1)){
var c__5568__auto__ \x3d cljs.core.chunk_first(seq__54741__$1);
var G__55183 \x3d cljs.core.chunk_rest(seq__54741__$1);
var G__55184 \x3d c__5568__auto__;
var G__55185 \x3d cljs.core.count(c__5568__auto__);
var G__55186 \x3d (0);
seq__54741 \x3d G__55183;
chunk__54743 \x3d G__55184;
count__54744 \x3d G__55185;
i__54745 \x3d G__55186;
continue;
} else {
var b \x3d cljs.core.first(seq__54741__$1);
var vars_55187 \x3d new cljs.core.Keyword(null,\x22vars\x22,\x22vars\x22,-2046957217).cljs$core$IFn$_invoke$arity$1(b);
if(cljs.core.not_EQ_.cljs$core$IFn$_invoke$arity$2(arity0,datascript.parser.rule_vars_arity(vars_55187))){
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22Arity mismatch for rule \x27\x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,\x22symbol\x22,\x22symbol\x22,-1038572696).cljs$core$IFn$_invoke$arity$1(name)], 0)),\x22\x27: \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([datascript.parser.flatten_rule_vars(vars0)], 0)),\x22 vs. \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([datascript.parser.flatten_rule_vars(vars_55187)], 0))].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22parser\x22,\x22rule\x22,\x22parser/rule\x22,-464044566),new cljs.core.Keyword(null,\x22rule\x22,\x22rule\x22,729973257),name], null));
} else {
}


var G__55188 \x3d cljs.core.next(seq__54741__$1);
var G__55189 \x3d null;
var G__55190 \x3d (0);
var G__55191 \x3d (0);
seq__54741 \x3d G__55188;
chunk__54743 \x3d G__55189;
count__54744 \x3d G__55190;
i__54745 \x3d G__55191;
continue;
}
} else {
return null;
}
}
break;
}
});
datascript.parser.parse_rules \x3d (function datascript$parser$parse_rules(form){
return cljs.core.vec((function (){var iter__5523__auto__ \x3d (function datascript$parser$parse_rules_$_iter__54748(s__54749){
return (new cljs.core.LazySeq(null,(function (){
var s__54749__$1 \x3d s__54749;
while(true){
var temp__5804__auto__ \x3d cljs.core.seq(s__54749__$1);
if(temp__5804__auto__){
var s__54749__$2 \x3d temp__5804__auto__;
if(cljs.core.chunked_seq_QMARK_(s__54749__$2)){
var c__5521__auto__ \x3d cljs.core.chunk_first(s__54749__$2);
var size__5522__auto__ \x3d cljs.core.count(c__5521__auto__);
var b__54751 \x3d cljs.core.chunk_buffer(size__5522__auto__);
if((function (){var i__54750 \x3d (0);
while(true){
if((i__54750 \x3c size__5522__auto__)){
var vec__54752 \x3d cljs.core._nth(c__5521__auto__,i__54750);
var name \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54752,(0),null);
var branches \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54752,(1),null);
var branches__$1 \x3d cljs.core.mapv.cljs$core$IFn$_invoke$arity$2(((function (i__54750,vec__54752,name,branches,c__5521__auto__,size__5522__auto__,b__54751,s__54749__$2,temp__5804__auto__){
return (function (p1__54747_SHARP_){
return (new datascript.parser.RuleBranch(new cljs.core.Keyword(null,\x22vars\x22,\x22vars\x22,-2046957217).cljs$core$IFn$_invoke$arity$1(p1__54747_SHARP_),new cljs.core.Keyword(null,\x22clauses\x22,\x22clauses\x22,1454841241).cljs$core$IFn$_invoke$arity$1(p1__54747_SHARP_),null,null,null));
});})(i__54750,vec__54752,name,branches,c__5521__auto__,size__5522__auto__,b__54751,s__54749__$2,temp__5804__auto__))
,branches);
cljs.core.chunk_append(b__54751,(function (){
datascript.parser.validate_arity(name,branches__$1);

return (new datascript.parser.Rule(name,branches__$1,null,null,null));
})()
);

var G__55193 \x3d (i__54750 + (1));
i__54750 \x3d G__55193;
continue;
} else {
return true;
}
break;
}
})()){
return cljs.core.chunk_cons(cljs.core.chunk(b__54751),datascript$parser$parse_rules_$_iter__54748(cljs.core.chunk_rest(s__54749__$2)));
} else {
return cljs.core.chunk_cons(cljs.core.chunk(b__54751),null);
}
} else {
var vec__54755 \x3d cljs.core.first(s__54749__$2);
var name \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54755,(0),null);
var branches \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54755,(1),null);
var branches__$1 \x3d cljs.core.mapv.cljs$core$IFn$_invoke$arity$2(((function (vec__54755,name,branches,s__54749__$2,temp__5804__auto__){
return (function (p1__54747_SHARP_){
return (new datascript.parser.RuleBranch(new cljs.core.Keyword(null,\x22vars\x22,\x22vars\x22,-2046957217).cljs$core$IFn$_invoke$arity$1(p1__54747_SHARP_),new cljs.core.Keyword(null,\x22clauses\x22,\x22clauses\x22,1454841241).cljs$core$IFn$_invoke$arity$1(p1__54747_SHARP_),null,null,null));
});})(vec__54755,name,branches,s__54749__$2,temp__5804__auto__))
,branches);
return cljs.core.cons((function (){
datascript.parser.validate_arity(name,branches__$1);

return (new datascript.parser.Rule(name,branches__$1,null,null,null));
})()
,datascript$parser$parse_rules_$_iter__54748(cljs.core.rest(s__54749__$2)));
}
} else {
return null;
}
break;
}
}),null,null));
});
return iter__5523__auto__(cljs.core.group_by(new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),datascript.parser.parse_seq(datascript.parser.parse_rule,form)));
})());
});

/**
* @constructor
 * @implements {cljs.core.IRecord}
 * @implements {cljs.core.IKVReduce}
 * @implements {cljs.core.IEquiv}
 * @implements {cljs.core.IHash}
 * @implements {cljs.core.ICollection}
 * @implements {cljs.core.ICounted}
 * @implements {cljs.core.ISeqable}
 * @implements {cljs.core.IMeta}
 * @implements {cljs.core.ICloneable}
 * @implements {cljs.core.IPrintWithWriter}
 * @implements {cljs.core.IIterable}
 * @implements {datascript.parser.ITraversable}
 * @implements {cljs.core.IWithMeta}
 * @implements {cljs.core.IAssociative}
 * @implements {cljs.core.IMap}
 * @implements {cljs.core.ILookup}
*/
datascript.parser.Query \x3d (function (qfind,qwith,qreturn_map,qin,qwhere,__meta,__extmap,__hash){
this.qfind \x3d qfind;
this.qwith \x3d qwith;
this.qreturn_map \x3d qreturn_map;
this.qin \x3d qin;
this.qwhere \x3d qwhere;
this.__meta \x3d __meta;
this.__extmap \x3d __extmap;
this.__hash \x3d __hash;
this.cljs$lang$protocol_mask$partition0$ \x3d 2230716170;
this.cljs$lang$protocol_mask$partition1$ \x3d 139264;
});
(datascript.parser.Query.prototype.cljs$core$ILookup$_lookup$arity$2 \x3d (function (this__5343__auto__,k__5344__auto__){
var self__ \x3d this;
var this__5343__auto____$1 \x3d this;
return this__5343__auto____$1.cljs$core$ILookup$_lookup$arity$3(null,k__5344__auto__,null);
}));

(datascript.parser.Query.prototype.cljs$core$ILookup$_lookup$arity$3 \x3d (function (this__5345__auto__,k54762,else__5346__auto__){
var self__ \x3d this;
var this__5345__auto____$1 \x3d this;
var G__54766 \x3d k54762;
var G__54766__$1 \x3d (((G__54766 instanceof cljs.core.Keyword))?G__54766.fqn:null);
switch (G__54766__$1) {
case \x22qfind\x22:
return self__.qfind;

break;
case \x22qwith\x22:
return self__.qwith;

break;
case \x22qreturn-map\x22:
return self__.qreturn_map;

break;
case \x22qin\x22:
return self__.qin;

break;
case \x22qwhere\x22:
return self__.qwhere;

break;
default:
return cljs.core.get.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k54762,else__5346__auto__);

}
}));

(datascript.parser.Query.prototype.cljs$core$IKVReduce$_kv_reduce$arity$3 \x3d (function (this__5363__auto__,f__5364__auto__,init__5365__auto__){
var self__ \x3d this;
var this__5363__auto____$1 \x3d this;
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (ret__5366__auto__,p__54767){
var vec__54768 \x3d p__54767;
var k__5367__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54768,(0),null);
var v__5368__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54768,(1),null);
return (f__5364__auto__.cljs$core$IFn$_invoke$arity$3 ? f__5364__auto__.cljs$core$IFn$_invoke$arity$3(ret__5366__auto__,k__5367__auto__,v__5368__auto__) : f__5364__auto__.call(null,ret__5366__auto__,k__5367__auto__,v__5368__auto__));
}),init__5365__auto__,this__5363__auto____$1);
}));

(datascript.parser.Query.prototype.cljs$core$IPrintWithWriter$_pr_writer$arity$3 \x3d (function (this__5358__auto__,writer__5359__auto__,opts__5360__auto__){
var self__ \x3d this;
var this__5358__auto____$1 \x3d this;
var pr_pair__5361__auto__ \x3d (function (keyval__5362__auto__){
return cljs.core.pr_sequential_writer(writer__5359__auto__,cljs.core.pr_writer,\x22\x22,\x22 \x22,\x22\x22,opts__5360__auto__,keyval__5362__auto__);
});
return cljs.core.pr_sequential_writer(writer__5359__auto__,pr_pair__5361__auto__,\x22#datascript.parser.Query{\x22,\x22, \x22,\x22}\x22,opts__5360__auto__,cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 5, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22qfind\x22,\x22qfind\x22,1529332972),self__.qfind],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22qwith\x22,\x22qwith\x22,-45809392),self__.qwith],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22qreturn-map\x22,\x22qreturn-map\x22,1841215994),self__.qreturn_map],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22qin\x22,\x22qin\x22,1372651151),self__.qin],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22qwhere\x22,\x22qwhere\x22,-1645067378),self__.qwhere],null))], null),self__.__extmap));
}));

(datascript.parser.Query.prototype.cljs$core$IIterable$_iterator$arity$1 \x3d (function (G__54761){
var self__ \x3d this;
var G__54761__$1 \x3d this;
return (new cljs.core.RecordIter((0),G__54761__$1,5,new cljs.core.PersistentVector(null, 5, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22qfind\x22,\x22qfind\x22,1529332972),new cljs.core.Keyword(null,\x22qwith\x22,\x22qwith\x22,-45809392),new cljs.core.Keyword(null,\x22qreturn-map\x22,\x22qreturn-map\x22,1841215994),new cljs.core.Keyword(null,\x22qin\x22,\x22qin\x22,1372651151),new cljs.core.Keyword(null,\x22qwhere\x22,\x22qwhere\x22,-1645067378)], null),(cljs.core.truth_(self__.__extmap)?cljs.core._iterator(self__.__extmap):cljs.core.nil_iter())));
}));

(datascript.parser.Query.prototype.cljs$core$IMeta$_meta$arity$1 \x3d (function (this__5341__auto__){
var self__ \x3d this;
var this__5341__auto____$1 \x3d this;
return self__.__meta;
}));

(datascript.parser.Query.prototype.cljs$core$ICloneable$_clone$arity$1 \x3d (function (this__5338__auto__){
var self__ \x3d this;
var this__5338__auto____$1 \x3d this;
return (new datascript.parser.Query(self__.qfind,self__.qwith,self__.qreturn_map,self__.qin,self__.qwhere,self__.__meta,self__.__extmap,self__.__hash));
}));

(datascript.parser.Query.prototype.cljs$core$ICounted$_count$arity$1 \x3d (function (this__5347__auto__){
var self__ \x3d this;
var this__5347__auto____$1 \x3d this;
return (5 + cljs.core.count(self__.__extmap));
}));

(datascript.parser.Query.prototype.cljs$core$IHash$_hash$arity$1 \x3d (function (this__5339__auto__){
var self__ \x3d this;
var this__5339__auto____$1 \x3d this;
var h__5154__auto__ \x3d self__.__hash;
if((!((h__5154__auto__ \x3d\x3d null)))){
return h__5154__auto__;
} else {
var h__5154__auto____$1 \x3d (function (coll__5340__auto__){
return (181307977 ^ cljs.core.hash_unordered_coll(coll__5340__auto__));
})(this__5339__auto____$1);
(self__.__hash \x3d h__5154__auto____$1);

return h__5154__auto____$1;
}
}));

(datascript.parser.Query.prototype.cljs$core$IEquiv$_equiv$arity$2 \x3d (function (this54763,other54764){
var self__ \x3d this;
var this54763__$1 \x3d this;
return (((!((other54764 \x3d\x3d null)))) \x26\x26 ((((this54763__$1.constructor \x3d\x3d\x3d other54764.constructor)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54763__$1.qfind,other54764.qfind)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54763__$1.qwith,other54764.qwith)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54763__$1.qreturn_map,other54764.qreturn_map)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54763__$1.qin,other54764.qin)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54763__$1.qwhere,other54764.qwhere)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54763__$1.__extmap,other54764.__extmap)))))))))))))));
}));

(datascript.parser.Query.prototype.cljs$core$IMap$_dissoc$arity$2 \x3d (function (this__5353__auto__,k__5354__auto__){
var self__ \x3d this;
var this__5353__auto____$1 \x3d this;
if(cljs.core.contains_QMARK_(new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 5, [new cljs.core.Keyword(null,\x22qfind\x22,\x22qfind\x22,1529332972),null,new cljs.core.Keyword(null,\x22qwhere\x22,\x22qwhere\x22,-1645067378),null,new cljs.core.Keyword(null,\x22qin\x22,\x22qin\x22,1372651151),null,new cljs.core.Keyword(null,\x22qwith\x22,\x22qwith\x22,-45809392),null,new cljs.core.Keyword(null,\x22qreturn-map\x22,\x22qreturn-map\x22,1841215994),null], null), null),k__5354__auto__)){
return cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(cljs.core._with_meta(cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,this__5353__auto____$1),self__.__meta),k__5354__auto__);
} else {
return (new datascript.parser.Query(self__.qfind,self__.qwith,self__.qreturn_map,self__.qin,self__.qwhere,self__.__meta,cljs.core.not_empty(cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(self__.__extmap,k__5354__auto__)),null));
}
}));

(datascript.parser.Query.prototype.cljs$core$IAssociative$_contains_key_QMARK_$arity$2 \x3d (function (this__5350__auto__,k54762){
var self__ \x3d this;
var this__5350__auto____$1 \x3d this;
var G__54771 \x3d k54762;
var G__54771__$1 \x3d (((G__54771 instanceof cljs.core.Keyword))?G__54771.fqn:null);
switch (G__54771__$1) {
case \x22qfind\x22:
case \x22qwith\x22:
case \x22qreturn-map\x22:
case \x22qin\x22:
case \x22qwhere\x22:
return true;

break;
default:
return cljs.core.contains_QMARK_(self__.__extmap,k54762);

}
}));

(datascript.parser.Query.prototype.cljs$core$IAssociative$_assoc$arity$3 \x3d (function (this__5351__auto__,k__5352__auto__,G__54761){
var self__ \x3d this;
var this__5351__auto____$1 \x3d this;
var pred__54772 \x3d cljs.core.keyword_identical_QMARK_;
var expr__54773 \x3d k__5352__auto__;
if(cljs.core.truth_((pred__54772.cljs$core$IFn$_invoke$arity$2 ? pred__54772.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22qfind\x22,\x22qfind\x22,1529332972),expr__54773) : pred__54772.call(null,new cljs.core.Keyword(null,\x22qfind\x22,\x22qfind\x22,1529332972),expr__54773)))){
return (new datascript.parser.Query(G__54761,self__.qwith,self__.qreturn_map,self__.qin,self__.qwhere,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__54772.cljs$core$IFn$_invoke$arity$2 ? pred__54772.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22qwith\x22,\x22qwith\x22,-45809392),expr__54773) : pred__54772.call(null,new cljs.core.Keyword(null,\x22qwith\x22,\x22qwith\x22,-45809392),expr__54773)))){
return (new datascript.parser.Query(self__.qfind,G__54761,self__.qreturn_map,self__.qin,self__.qwhere,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__54772.cljs$core$IFn$_invoke$arity$2 ? pred__54772.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22qreturn-map\x22,\x22qreturn-map\x22,1841215994),expr__54773) : pred__54772.call(null,new cljs.core.Keyword(null,\x22qreturn-map\x22,\x22qreturn-map\x22,1841215994),expr__54773)))){
return (new datascript.parser.Query(self__.qfind,self__.qwith,G__54761,self__.qin,self__.qwhere,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__54772.cljs$core$IFn$_invoke$arity$2 ? pred__54772.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22qin\x22,\x22qin\x22,1372651151),expr__54773) : pred__54772.call(null,new cljs.core.Keyword(null,\x22qin\x22,\x22qin\x22,1372651151),expr__54773)))){
return (new datascript.parser.Query(self__.qfind,self__.qwith,self__.qreturn_map,G__54761,self__.qwhere,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__54772.cljs$core$IFn$_invoke$arity$2 ? pred__54772.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22qwhere\x22,\x22qwhere\x22,-1645067378),expr__54773) : pred__54772.call(null,new cljs.core.Keyword(null,\x22qwhere\x22,\x22qwhere\x22,-1645067378),expr__54773)))){
return (new datascript.parser.Query(self__.qfind,self__.qwith,self__.qreturn_map,self__.qin,G__54761,self__.__meta,self__.__extmap,null));
} else {
return (new datascript.parser.Query(self__.qfind,self__.qwith,self__.qreturn_map,self__.qin,self__.qwhere,self__.__meta,cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k__5352__auto__,G__54761),null));
}
}
}
}
}
}));

(datascript.parser.Query.prototype.cljs$core$ISeqable$_seq$arity$1 \x3d (function (this__5356__auto__){
var self__ \x3d this;
var this__5356__auto____$1 \x3d this;
return cljs.core.seq(cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 5, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22qfind\x22,\x22qfind\x22,1529332972),self__.qfind,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22qwith\x22,\x22qwith\x22,-45809392),self__.qwith,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22qreturn-map\x22,\x22qreturn-map\x22,1841215994),self__.qreturn_map,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22qin\x22,\x22qin\x22,1372651151),self__.qin,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22qwhere\x22,\x22qwhere\x22,-1645067378),self__.qwhere,null))], null),self__.__extmap));
}));

(datascript.parser.Query.prototype.cljs$core$IWithMeta$_with_meta$arity$2 \x3d (function (this__5342__auto__,G__54761){
var self__ \x3d this;
var this__5342__auto____$1 \x3d this;
return (new datascript.parser.Query(self__.qfind,self__.qwith,self__.qreturn_map,self__.qin,self__.qwhere,G__54761,self__.__extmap,self__.__hash));
}));

(datascript.parser.Query.prototype.cljs$core$ICollection$_conj$arity$2 \x3d (function (this__5348__auto__,entry__5349__auto__){
var self__ \x3d this;
var this__5348__auto____$1 \x3d this;
if(cljs.core.vector_QMARK_(entry__5349__auto__)){
return this__5348__auto____$1.cljs$core$IAssociative$_assoc$arity$3(null,cljs.core._nth(entry__5349__auto__,(0)),cljs.core._nth(entry__5349__auto__,(1)));
} else {
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(cljs.core._conj,this__5348__auto____$1,entry__5349__auto__);
}
}));

(datascript.parser.Query.prototype.datascript$parser$ITraversable$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.parser.Query.prototype.datascript$parser$ITraversable$_postwalk$arity$2 \x3d (function (this__52373__auto__,f54758){
var self__ \x3d this;
var this__52373__auto____$1 \x3d this;
var new__52374__auto__ \x3d (new datascript.parser.Query(datascript.parser.postwalk(self__.qfind,f54758),datascript.parser.postwalk(self__.qwith,f54758),datascript.parser.postwalk(self__.qreturn_map,f54758),datascript.parser.postwalk(self__.qin,f54758),datascript.parser.postwalk(self__.qwhere,f54758),null,null,null));
var temp__5802__auto__ \x3d cljs.core.meta(this__52373__auto____$1);
if(cljs.core.truth_(temp__5802__auto__)){
var meta__52375__auto__ \x3d temp__5802__auto__;
return cljs.core.with_meta(new__52374__auto__,meta__52375__auto__);
} else {
return new__52374__auto__;
}
}));

(datascript.parser.Query.prototype.datascript$parser$ITraversable$_collect$arity$3 \x3d (function (___52376__auto__,pred54759,acc54760){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
return datascript.parser.collect.cljs$core$IFn$_invoke$arity$3(pred54759,self__.qwhere,datascript.parser.collect.cljs$core$IFn$_invoke$arity$3(pred54759,self__.qin,datascript.parser.collect.cljs$core$IFn$_invoke$arity$3(pred54759,self__.qreturn_map,datascript.parser.collect.cljs$core$IFn$_invoke$arity$3(pred54759,self__.qwith,datascript.parser.collect.cljs$core$IFn$_invoke$arity$3(pred54759,self__.qfind,acc54760)))));
}));

(datascript.parser.Query.prototype.datascript$parser$ITraversable$_collect_vars$arity$2 \x3d (function (___52376__auto__,acc54760){
var self__ \x3d this;
var ___52376__auto____$1 \x3d this;
return datascript.parser.collect_vars_acc(datascript.parser.collect_vars_acc(datascript.parser.collect_vars_acc(datascript.parser.collect_vars_acc(datascript.parser.collect_vars_acc(acc54760,self__.qfind),self__.qwith),self__.qreturn_map),self__.qin),self__.qwhere);
}));

(datascript.parser.Query.getBasis \x3d (function (){
return new cljs.core.PersistentVector(null, 5, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22qfind\x22,\x22qfind\x22,-1125102797,null),new cljs.core.Symbol(null,\x22qwith\x22,\x22qwith\x22,1594722135,null),new cljs.core.Symbol(null,\x22qreturn-map\x22,\x22qreturn-map\x22,-813219775,null),new cljs.core.Symbol(null,\x22qin\x22,\x22qin\x22,-1281784618,null),new cljs.core.Symbol(null,\x22qwhere\x22,\x22qwhere\x22,-4535851,null)], null);
}));

(datascript.parser.Query.cljs$lang$type \x3d true);

(datascript.parser.Query.cljs$lang$ctorPrSeq \x3d (function (this__5389__auto__){
return (new cljs.core.List(null,\x22datascript.parser/Query\x22,null,(1),null));
}));

(datascript.parser.Query.cljs$lang$ctorPrWriter \x3d (function (this__5389__auto__,writer__5390__auto__){
return cljs.core._write(writer__5390__auto__,\x22datascript.parser/Query\x22);
}));

/**
 * Positional factory function for datascript.parser/Query.
 */
datascript.parser.__GT_Query \x3d (function datascript$parser$__GT_Query(qfind,qwith,qreturn_map,qin,qwhere){
return (new datascript.parser.Query(qfind,qwith,qreturn_map,qin,qwhere,null,null,null));
});

/**
 * Factory function for datascript.parser/Query, taking a map of keywords to field values.
 */
datascript.parser.map__GT_Query \x3d (function datascript$parser$map__GT_Query(G__54765){
var extmap__5385__auto__ \x3d (function (){var G__54775 \x3d cljs.core.dissoc.cljs$core$IFn$_invoke$arity$variadic(G__54765,new cljs.core.Keyword(null,\x22qfind\x22,\x22qfind\x22,1529332972),cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,\x22qwith\x22,\x22qwith\x22,-45809392),new cljs.core.Keyword(null,\x22qreturn-map\x22,\x22qreturn-map\x22,1841215994),new cljs.core.Keyword(null,\x22qin\x22,\x22qin\x22,1372651151),new cljs.core.Keyword(null,\x22qwhere\x22,\x22qwhere\x22,-1645067378)], 0));
if(cljs.core.record_QMARK_(G__54765)){
return cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,G__54775);
} else {
return G__54775;
}
})();
return (new datascript.parser.Query(new cljs.core.Keyword(null,\x22qfind\x22,\x22qfind\x22,1529332972).cljs$core$IFn$_invoke$arity$1(G__54765),new cljs.core.Keyword(null,\x22qwith\x22,\x22qwith\x22,-45809392).cljs$core$IFn$_invoke$arity$1(G__54765),new cljs.core.Keyword(null,\x22qreturn-map\x22,\x22qreturn-map\x22,1841215994).cljs$core$IFn$_invoke$arity$1(G__54765),new cljs.core.Keyword(null,\x22qin\x22,\x22qin\x22,1372651151).cljs$core$IFn$_invoke$arity$1(G__54765),new cljs.core.Keyword(null,\x22qwhere\x22,\x22qwhere\x22,-1645067378).cljs$core$IFn$_invoke$arity$1(G__54765),null,cljs.core.not_empty(extmap__5385__auto__),null));
});

datascript.parser.query__GT_map \x3d (function datascript$parser$query__GT_map(query){
var parsed \x3d cljs.core.PersistentArrayMap.EMPTY;
var key \x3d null;
var qs \x3d query;
while(true){
var temp__5802__auto__ \x3d cljs.core.first(qs);
if(cljs.core.truth_(temp__5802__auto__)){
var q \x3d temp__5802__auto__;
if((q instanceof cljs.core.Keyword)){
var G__55203 \x3d parsed;
var G__55204 \x3d q;
var G__55205 \x3d cljs.core.next(qs);
parsed \x3d G__55203;
key \x3d G__55204;
qs \x3d G__55205;
continue;
} else {
var G__55207 \x3d cljs.core.update_in.cljs$core$IFn$_invoke$arity$4(parsed,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [key], null),cljs.core.fnil.cljs$core$IFn$_invoke$arity$2(cljs.core.conj,cljs.core.PersistentVector.EMPTY),q);
var G__55208 \x3d key;
var G__55209 \x3d cljs.core.next(qs);
parsed \x3d G__55207;
key \x3d G__55208;
qs \x3d G__55209;
continue;
}
} else {
return parsed;
}
break;
}
});
datascript.parser.explicit_input \x3d (function datascript$parser$explicit_input(parsed){
var source \x3d new cljs.core.Keyword(null,\x22source\x22,\x22source\x22,-433931539).cljs$core$IFn$_invoke$arity$1(parsed);
if((parsed instanceof datascript.parser.Pattern)){
return source;
} else {
if((!((source \x3d\x3d null)))){
if((!((source instanceof datascript.parser.DefaultSrc)))){
return source;
} else {
return null;
}
} else {
return null;
}
}
});
datascript.parser.default_in \x3d (function datascript$parser$default_in(qwhere){
if((!(cljs.core.empty_QMARK_(datascript.parser.collect.cljs$core$IFn$_invoke$arity$2(datascript.parser.explicit_input,qwhere))))){
return new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22$\x22,\x22$\x22,-1580747756,null)], null);
} else {
return cljs.core.PersistentVector.EMPTY;
}
});
datascript.parser.validate_query \x3d (function datascript$parser$validate_query(q,form,form_map){
var find_vars_55213 \x3d cljs.core.set(datascript.parser.collect_vars(new cljs.core.Keyword(null,\x22qfind\x22,\x22qfind\x22,1529332972).cljs$core$IFn$_invoke$arity$1(q)));
var with_vars_55214 \x3d cljs.core.set(new cljs.core.Keyword(null,\x22qwith\x22,\x22qwith\x22,-45809392).cljs$core$IFn$_invoke$arity$1(q));
var in_vars_55215 \x3d cljs.core.set(datascript.parser.collect_vars(new cljs.core.Keyword(null,\x22qin\x22,\x22qin\x22,1372651151).cljs$core$IFn$_invoke$arity$1(q)));
var where_vars_55216 \x3d cljs.core.set(datascript.parser.collect_vars(new cljs.core.Keyword(null,\x22qwhere\x22,\x22qwhere\x22,-1645067378).cljs$core$IFn$_invoke$arity$1(q)));
var unknown_55217 \x3d clojure.set.difference.cljs$core$IFn$_invoke$arity$2(clojure.set.union.cljs$core$IFn$_invoke$arity$2(find_vars_55213,with_vars_55214),clojure.set.union.cljs$core$IFn$_invoke$arity$2(where_vars_55216,in_vars_55215));
var shared_55218 \x3d clojure.set.intersection.cljs$core$IFn$_invoke$arity$2(find_vars_55213,with_vars_55214);
if(cljs.core.empty_QMARK_(unknown_55217)){
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22Query for unknown vars: \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([cljs.core.mapv.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22symbol\x22,\x22symbol\x22,-1038572696),unknown_55217)], 0))].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22parser\x22,\x22query\x22,\x22parser/query\x22,1877320671),new cljs.core.Keyword(null,\x22vars\x22,\x22vars\x22,-2046957217),unknown_55217,new cljs.core.Keyword(null,\x22form\x22,\x22form\x22,-1624062471),form], null));
}

if(cljs.core.empty_QMARK_(shared_55218)){
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22:find and :with should not use same variables: \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([cljs.core.mapv.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22symbol\x22,\x22symbol\x22,-1038572696),shared_55218)], 0))].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22parser\x22,\x22query\x22,\x22parser/query\x22,1877320671),new cljs.core.Keyword(null,\x22vars\x22,\x22vars\x22,-2046957217),shared_55218,new cljs.core.Keyword(null,\x22form\x22,\x22form\x22,-1624062471),form], null));
}

var temp__5808__auto___55223 \x3d new cljs.core.Keyword(null,\x22qreturn-map\x22,\x22qreturn-map\x22,1841215994).cljs$core$IFn$_invoke$arity$1(q);
if((temp__5808__auto___55223 \x3d\x3d null)){
} else {
var return_map_55224 \x3d temp__5808__auto___55223;
if((new cljs.core.Keyword(null,\x22qfind\x22,\x22qfind\x22,1529332972).cljs$core$IFn$_invoke$arity$1(q) instanceof datascript.parser.FindScalar)){
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,\x22type\x22,\x22type\x22,1174270348).cljs$core$IFn$_invoke$arity$1(return_map_55224)], 0)),\x22 does not work with single-scalar :find\x22].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22parser\x22,\x22query\x22,\x22parser/query\x22,1877320671),new cljs.core.Keyword(null,\x22form\x22,\x22form\x22,-1624062471),form], null));
} else {
}

if((new cljs.core.Keyword(null,\x22qfind\x22,\x22qfind\x22,1529332972).cljs$core$IFn$_invoke$arity$1(q) instanceof datascript.parser.FindColl)){
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,\x22type\x22,\x22type\x22,1174270348).cljs$core$IFn$_invoke$arity$1(return_map_55224)], 0)),\x22 does not work with collection :find\x22].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22parser\x22,\x22query\x22,\x22parser/query\x22,1877320671),new cljs.core.Keyword(null,\x22form\x22,\x22form\x22,-1624062471),form], null));
} else {
}
}

var temp__5808__auto___55225 \x3d new cljs.core.Keyword(null,\x22symbols\x22,\x22symbols\x22,1211743).cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword(null,\x22qreturn-map\x22,\x22qreturn-map\x22,1841215994).cljs$core$IFn$_invoke$arity$1(q));
if((temp__5808__auto___55225 \x3d\x3d null)){
} else {
var return_symbols_55226 \x3d temp__5808__auto___55225;
var find_elements_55227 \x3d datascript.parser.find_elements(new cljs.core.Keyword(null,\x22qfind\x22,\x22qfind\x22,1529332972).cljs$core$IFn$_invoke$arity$1(q));
if(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(cljs.core.count(return_symbols_55226),cljs.core.count(find_elements_55227))){
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22Count of \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,\x22type\x22,\x22type\x22,1174270348).cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword(null,\x22qreturn-map\x22,\x22qreturn-map\x22,1841215994).cljs$core$IFn$_invoke$arity$1(q))], 0)),\x22 must match count of :find\x22].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22parser\x22,\x22query\x22,\x22parser/query\x22,1877320671),new cljs.core.Keyword(null,\x22return-map\x22,\x22return-map\x22,1620104901),cljs.core.cons(new cljs.core.Keyword(null,\x22type\x22,\x22type\x22,1174270348).cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword(null,\x22qreturn-map\x22,\x22qreturn-map\x22,1841215994).cljs$core$IFn$_invoke$arity$1(q)),return_symbols_55226),new cljs.core.Keyword(null,\x22find\x22,\x22find\x22,496279456),find_elements_55227,new cljs.core.Keyword(null,\x22form\x22,\x22form\x22,-1624062471),form], null));
}
}

if(((1) \x3c cljs.core.count(cljs.core.filter.cljs$core$IFn$_invoke$arity$2(cljs.core.some_QMARK_,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22keys\x22,\x22keys\x22,1068423698).cljs$core$IFn$_invoke$arity$1(form_map),new cljs.core.Keyword(null,\x22syms\x22,\x22syms\x22,-1575891762).cljs$core$IFn$_invoke$arity$1(form_map),new cljs.core.Keyword(null,\x22strs\x22,\x22strs\x22,1175537277).cljs$core$IFn$_invoke$arity$1(form_map)], null))))){
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2(\x22Only one of :keys/:syms/:strs must be present\x22,new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22parser\x22,\x22query\x22,\x22parser/query\x22,1877320671),new cljs.core.Keyword(null,\x22form\x22,\x22form\x22,-1624062471),form], null));
} else {
}

var in_vars_55228 \x3d datascript.parser.collect_vars(new cljs.core.Keyword(null,\x22qin\x22,\x22qin\x22,1372651151).cljs$core$IFn$_invoke$arity$1(q));
var in_sources_55229 \x3d datascript.parser.collect.cljs$core$IFn$_invoke$arity$2((function (p1__54776_SHARP_){
return (p1__54776_SHARP_ instanceof datascript.parser.SrcVar);
}),new cljs.core.Keyword(null,\x22qin\x22,\x22qin\x22,1372651151).cljs$core$IFn$_invoke$arity$1(q));
var in_rules_55230 \x3d datascript.parser.collect.cljs$core$IFn$_invoke$arity$2((function (p1__54777_SHARP_){
return (p1__54777_SHARP_ instanceof datascript.parser.RulesVar);
}),new cljs.core.Keyword(null,\x22qin\x22,\x22qin\x22,1372651151).cljs$core$IFn$_invoke$arity$1(q));
if(cljs.core.truth_((function (){var and__5043__auto__ \x3d datascript.parser.distinct_QMARK_(in_vars_55228);
if(cljs.core.truth_(and__5043__auto__)){
var and__5043__auto____$1 \x3d datascript.parser.distinct_QMARK_(in_sources_55229);
if(cljs.core.truth_(and__5043__auto____$1)){
return datascript.parser.distinct_QMARK_(in_rules_55230);
} else {
return and__5043__auto____$1;
}
} else {
return and__5043__auto__;
}
})())){
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2(\x22Vars used in :in should be distinct\x22,new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22parser\x22,\x22query\x22,\x22parser/query\x22,1877320671),new cljs.core.Keyword(null,\x22form\x22,\x22form\x22,-1624062471),form], null));
}

var with_vars_55231 \x3d datascript.parser.collect_vars(new cljs.core.Keyword(null,\x22qwith\x22,\x22qwith\x22,-45809392).cljs$core$IFn$_invoke$arity$1(q));
if(cljs.core.truth_(datascript.parser.distinct_QMARK_(with_vars_55231))){
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2(\x22Vars used in :with should be distinct\x22,new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22parser\x22,\x22query\x22,\x22parser/query\x22,1877320671),new cljs.core.Keyword(null,\x22form\x22,\x22form\x22,-1624062471),form], null));
}

var in_sources_55232 \x3d datascript.parser.collect.cljs$core$IFn$_invoke$arity$3((function (p1__54778_SHARP_){
return (p1__54778_SHARP_ instanceof datascript.parser.SrcVar);
}),new cljs.core.Keyword(null,\x22qin\x22,\x22qin\x22,1372651151).cljs$core$IFn$_invoke$arity$1(q),cljs.core.PersistentHashSet.EMPTY);
var where_sources_55233 \x3d datascript.parser.collect.cljs$core$IFn$_invoke$arity$3((function (p1__54779_SHARP_){
return (p1__54779_SHARP_ instanceof datascript.parser.SrcVar);
}),new cljs.core.Keyword(null,\x22qwhere\x22,\x22qwhere\x22,-1645067378).cljs$core$IFn$_invoke$arity$1(q),cljs.core.PersistentHashSet.EMPTY);
var unknown_55234 \x3d clojure.set.difference.cljs$core$IFn$_invoke$arity$2(where_sources_55233,in_sources_55232);
if(cljs.core.empty_QMARK_(unknown_55234)){
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22Where uses unknown source vars: \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([cljs.core.mapv.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22symbol\x22,\x22symbol\x22,-1038572696),unknown_55234)], 0))].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22parser\x22,\x22query\x22,\x22parser/query\x22,1877320671),new cljs.core.Keyword(null,\x22vars\x22,\x22vars\x22,-2046957217),unknown_55234,new cljs.core.Keyword(null,\x22form\x22,\x22form\x22,-1624062471),form], null));
}

var rule_exprs \x3d datascript.parser.collect.cljs$core$IFn$_invoke$arity$2((function (p1__54780_SHARP_){
return (p1__54780_SHARP_ instanceof datascript.parser.RuleExpr);
}),new cljs.core.Keyword(null,\x22qwhere\x22,\x22qwhere\x22,-1645067378).cljs$core$IFn$_invoke$arity$1(q));
var rules_vars \x3d datascript.parser.collect.cljs$core$IFn$_invoke$arity$2((function (p1__54781_SHARP_){
return (p1__54781_SHARP_ instanceof datascript.parser.RulesVar);
}),new cljs.core.Keyword(null,\x22qin\x22,\x22qin\x22,1372651151).cljs$core$IFn$_invoke$arity$1(q));
if((((!(cljs.core.empty_QMARK_(rule_exprs)))) \x26\x26 (cljs.core.empty_QMARK_(rules_vars)))){
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2(\x22Missing rules var \x27%\x27 in :in\x22,new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22parser\x22,\x22query\x22,\x22parser/query\x22,1877320671),new cljs.core.Keyword(null,\x22form\x22,\x22form\x22,-1624062471),form], null));
} else {
return null;
}
});
datascript.parser.parse_query \x3d (function datascript$parser$parse_query(q){
var qm \x3d ((cljs.core.map_QMARK_(q))?q:((cljs.core.sequential_QMARK_(q))?datascript.parser.query__GT_map(q):(function(){throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2(\x22Query should be a vector or a map\x22,new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22parser\x22,\x22query\x22,\x22parser/query\x22,1877320671),new cljs.core.Keyword(null,\x22form\x22,\x22form\x22,-1624062471),q], null))})()
));
var qwhere \x3d datascript.parser.parse_where(new cljs.core.Keyword(null,\x22where\x22,\x22where\x22,-2044795965).cljs$core$IFn$_invoke$arity$2(qm,cljs.core.PersistentVector.EMPTY));
var res \x3d datascript.parser.map__GT_Query(new cljs.core.PersistentArrayMap(null, 5, [new cljs.core.Keyword(null,\x22qfind\x22,\x22qfind\x22,1529332972),datascript.parser.parse_find(new cljs.core.Keyword(null,\x22find\x22,\x22find\x22,496279456).cljs$core$IFn$_invoke$arity$1(qm)),new cljs.core.Keyword(null,\x22qwith\x22,\x22qwith\x22,-45809392),(function (){var temp__5804__auto__ \x3d new cljs.core.Keyword(null,\x22with\x22,\x22with\x22,-1536296876).cljs$core$IFn$_invoke$arity$1(qm);
if(cljs.core.truth_(temp__5804__auto__)){
var with$ \x3d temp__5804__auto__;
return datascript.parser.parse_with(with$);
} else {
return null;
}
})(),new cljs.core.Keyword(null,\x22qreturn-map\x22,\x22qreturn-map\x22,1841215994),(function (){var or__5045__auto__ \x3d datascript.parser.parse_return_map(new cljs.core.Keyword(null,\x22keys\x22,\x22keys\x22,1068423698),new cljs.core.Keyword(null,\x22keys\x22,\x22keys\x22,1068423698).cljs$core$IFn$_invoke$arity$1(qm));
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
var or__5045__auto____$1 \x3d datascript.parser.parse_return_map(new cljs.core.Keyword(null,\x22syms\x22,\x22syms\x22,-1575891762),new cljs.core.Keyword(null,\x22syms\x22,\x22syms\x22,-1575891762).cljs$core$IFn$_invoke$arity$1(qm));
if(cljs.core.truth_(or__5045__auto____$1)){
return or__5045__auto____$1;
} else {
return datascript.parser.parse_return_map(new cljs.core.Keyword(null,\x22strs\x22,\x22strs\x22,1175537277),new cljs.core.Keyword(null,\x22strs\x22,\x22strs\x22,1175537277).cljs$core$IFn$_invoke$arity$1(qm));
}
}
})(),new cljs.core.Keyword(null,\x22qin\x22,\x22qin\x22,1372651151),datascript.parser.parse_in((function (){var or__5045__auto__ \x3d new cljs.core.Keyword(null,\x22in\x22,\x22in\x22,-1531184865).cljs$core$IFn$_invoke$arity$1(qm);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return datascript.parser.default_in(qwhere);
}
})()),new cljs.core.Keyword(null,\x22qwhere\x22,\x22qwhere\x22,-1645067378),qwhere], null));
datascript.parser.validate_query(res,q,qm);

return res;
});
");
SHADOW_ENV.evalLoad("datascript.query.js", true , "goog.provide(\x27datascript.query\x27);
datascript.query._STAR_query_cache_STAR_ \x3d datascript.lru.cache((100));



/**
* @constructor
 * @implements {cljs.core.IRecord}
 * @implements {cljs.core.IKVReduce}
 * @implements {cljs.core.IEquiv}
 * @implements {cljs.core.IHash}
 * @implements {cljs.core.ICollection}
 * @implements {cljs.core.ICounted}
 * @implements {cljs.core.ISeqable}
 * @implements {cljs.core.IMeta}
 * @implements {cljs.core.ICloneable}
 * @implements {cljs.core.IPrintWithWriter}
 * @implements {cljs.core.IIterable}
 * @implements {cljs.core.IWithMeta}
 * @implements {cljs.core.IAssociative}
 * @implements {cljs.core.IMap}
 * @implements {cljs.core.ILookup}
*/
datascript.query.Context \x3d (function (rels,sources,rules,__meta,__extmap,__hash){
this.rels \x3d rels;
this.sources \x3d sources;
this.rules \x3d rules;
this.__meta \x3d __meta;
this.__extmap \x3d __extmap;
this.__hash \x3d __hash;
this.cljs$lang$protocol_mask$partition0$ \x3d 2230716170;
this.cljs$lang$protocol_mask$partition1$ \x3d 139264;
});
(datascript.query.Context.prototype.cljs$core$ILookup$_lookup$arity$2 \x3d (function (this__5343__auto__,k__5344__auto__){
var self__ \x3d this;
var this__5343__auto____$1 \x3d this;
return this__5343__auto____$1.cljs$core$ILookup$_lookup$arity$3(null,k__5344__auto__,null);
}));

(datascript.query.Context.prototype.cljs$core$ILookup$_lookup$arity$3 \x3d (function (this__5345__auto__,k54784,else__5346__auto__){
var self__ \x3d this;
var this__5345__auto____$1 \x3d this;
var G__54790 \x3d k54784;
var G__54790__$1 \x3d (((G__54790 instanceof cljs.core.Keyword))?G__54790.fqn:null);
switch (G__54790__$1) {
case \x22rels\x22:
return self__.rels;

break;
case \x22sources\x22:
return self__.sources;

break;
case \x22rules\x22:
return self__.rules;

break;
default:
return cljs.core.get.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k54784,else__5346__auto__);

}
}));

(datascript.query.Context.prototype.cljs$core$IKVReduce$_kv_reduce$arity$3 \x3d (function (this__5363__auto__,f__5364__auto__,init__5365__auto__){
var self__ \x3d this;
var this__5363__auto____$1 \x3d this;
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (ret__5366__auto__,p__54792){
var vec__54793 \x3d p__54792;
var k__5367__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54793,(0),null);
var v__5368__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54793,(1),null);
return (f__5364__auto__.cljs$core$IFn$_invoke$arity$3 ? f__5364__auto__.cljs$core$IFn$_invoke$arity$3(ret__5366__auto__,k__5367__auto__,v__5368__auto__) : f__5364__auto__.call(null,ret__5366__auto__,k__5367__auto__,v__5368__auto__));
}),init__5365__auto__,this__5363__auto____$1);
}));

(datascript.query.Context.prototype.cljs$core$IPrintWithWriter$_pr_writer$arity$3 \x3d (function (this__5358__auto__,writer__5359__auto__,opts__5360__auto__){
var self__ \x3d this;
var this__5358__auto____$1 \x3d this;
var pr_pair__5361__auto__ \x3d (function (keyval__5362__auto__){
return cljs.core.pr_sequential_writer(writer__5359__auto__,cljs.core.pr_writer,\x22\x22,\x22 \x22,\x22\x22,opts__5360__auto__,keyval__5362__auto__);
});
return cljs.core.pr_sequential_writer(writer__5359__auto__,pr_pair__5361__auto__,\x22#datascript.query.Context{\x22,\x22, \x22,\x22}\x22,opts__5360__auto__,cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22rels\x22,\x22rels\x22,1770187185),self__.rels],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22sources\x22,\x22sources\x22,-321166424),self__.sources],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22rules\x22,\x22rules\x22,1198912366),self__.rules],null))], null),self__.__extmap));
}));

(datascript.query.Context.prototype.cljs$core$IIterable$_iterator$arity$1 \x3d (function (G__54783){
var self__ \x3d this;
var G__54783__$1 \x3d this;
return (new cljs.core.RecordIter((0),G__54783__$1,3,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22rels\x22,\x22rels\x22,1770187185),new cljs.core.Keyword(null,\x22sources\x22,\x22sources\x22,-321166424),new cljs.core.Keyword(null,\x22rules\x22,\x22rules\x22,1198912366)], null),(cljs.core.truth_(self__.__extmap)?cljs.core._iterator(self__.__extmap):cljs.core.nil_iter())));
}));

(datascript.query.Context.prototype.cljs$core$IMeta$_meta$arity$1 \x3d (function (this__5341__auto__){
var self__ \x3d this;
var this__5341__auto____$1 \x3d this;
return self__.__meta;
}));

(datascript.query.Context.prototype.cljs$core$ICloneable$_clone$arity$1 \x3d (function (this__5338__auto__){
var self__ \x3d this;
var this__5338__auto____$1 \x3d this;
return (new datascript.query.Context(self__.rels,self__.sources,self__.rules,self__.__meta,self__.__extmap,self__.__hash));
}));

(datascript.query.Context.prototype.cljs$core$ICounted$_count$arity$1 \x3d (function (this__5347__auto__){
var self__ \x3d this;
var this__5347__auto____$1 \x3d this;
return (3 + cljs.core.count(self__.__extmap));
}));

(datascript.query.Context.prototype.cljs$core$IHash$_hash$arity$1 \x3d (function (this__5339__auto__){
var self__ \x3d this;
var this__5339__auto____$1 \x3d this;
var h__5154__auto__ \x3d self__.__hash;
if((!((h__5154__auto__ \x3d\x3d null)))){
return h__5154__auto__;
} else {
var h__5154__auto____$1 \x3d (function (coll__5340__auto__){
return (1014232958 ^ cljs.core.hash_unordered_coll(coll__5340__auto__));
})(this__5339__auto____$1);
(self__.__hash \x3d h__5154__auto____$1);

return h__5154__auto____$1;
}
}));

(datascript.query.Context.prototype.cljs$core$IEquiv$_equiv$arity$2 \x3d (function (this54785,other54786){
var self__ \x3d this;
var this54785__$1 \x3d this;
return (((!((other54786 \x3d\x3d null)))) \x26\x26 ((((this54785__$1.constructor \x3d\x3d\x3d other54786.constructor)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54785__$1.rels,other54786.rels)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54785__$1.sources,other54786.sources)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54785__$1.rules,other54786.rules)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54785__$1.__extmap,other54786.__extmap)))))))))));
}));

(datascript.query.Context.prototype.cljs$core$IMap$_dissoc$arity$2 \x3d (function (this__5353__auto__,k__5354__auto__){
var self__ \x3d this;
var this__5353__auto____$1 \x3d this;
if(cljs.core.contains_QMARK_(new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,\x22sources\x22,\x22sources\x22,-321166424),null,new cljs.core.Keyword(null,\x22rules\x22,\x22rules\x22,1198912366),null,new cljs.core.Keyword(null,\x22rels\x22,\x22rels\x22,1770187185),null], null), null),k__5354__auto__)){
return cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(cljs.core._with_meta(cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,this__5353__auto____$1),self__.__meta),k__5354__auto__);
} else {
return (new datascript.query.Context(self__.rels,self__.sources,self__.rules,self__.__meta,cljs.core.not_empty(cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(self__.__extmap,k__5354__auto__)),null));
}
}));

(datascript.query.Context.prototype.cljs$core$IAssociative$_contains_key_QMARK_$arity$2 \x3d (function (this__5350__auto__,k54784){
var self__ \x3d this;
var this__5350__auto____$1 \x3d this;
var G__54797 \x3d k54784;
var G__54797__$1 \x3d (((G__54797 instanceof cljs.core.Keyword))?G__54797.fqn:null);
switch (G__54797__$1) {
case \x22rels\x22:
case \x22sources\x22:
case \x22rules\x22:
return true;

break;
default:
return cljs.core.contains_QMARK_(self__.__extmap,k54784);

}
}));

(datascript.query.Context.prototype.cljs$core$IAssociative$_assoc$arity$3 \x3d (function (this__5351__auto__,k__5352__auto__,G__54783){
var self__ \x3d this;
var this__5351__auto____$1 \x3d this;
var pred__54798 \x3d cljs.core.keyword_identical_QMARK_;
var expr__54799 \x3d k__5352__auto__;
if(cljs.core.truth_((pred__54798.cljs$core$IFn$_invoke$arity$2 ? pred__54798.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22rels\x22,\x22rels\x22,1770187185),expr__54799) : pred__54798.call(null,new cljs.core.Keyword(null,\x22rels\x22,\x22rels\x22,1770187185),expr__54799)))){
return (new datascript.query.Context(G__54783,self__.sources,self__.rules,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__54798.cljs$core$IFn$_invoke$arity$2 ? pred__54798.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22sources\x22,\x22sources\x22,-321166424),expr__54799) : pred__54798.call(null,new cljs.core.Keyword(null,\x22sources\x22,\x22sources\x22,-321166424),expr__54799)))){
return (new datascript.query.Context(self__.rels,G__54783,self__.rules,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__54798.cljs$core$IFn$_invoke$arity$2 ? pred__54798.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22rules\x22,\x22rules\x22,1198912366),expr__54799) : pred__54798.call(null,new cljs.core.Keyword(null,\x22rules\x22,\x22rules\x22,1198912366),expr__54799)))){
return (new datascript.query.Context(self__.rels,self__.sources,G__54783,self__.__meta,self__.__extmap,null));
} else {
return (new datascript.query.Context(self__.rels,self__.sources,self__.rules,self__.__meta,cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k__5352__auto__,G__54783),null));
}
}
}
}));

(datascript.query.Context.prototype.cljs$core$ISeqable$_seq$arity$1 \x3d (function (this__5356__auto__){
var self__ \x3d this;
var this__5356__auto____$1 \x3d this;
return cljs.core.seq(cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22rels\x22,\x22rels\x22,1770187185),self__.rels,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22sources\x22,\x22sources\x22,-321166424),self__.sources,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22rules\x22,\x22rules\x22,1198912366),self__.rules,null))], null),self__.__extmap));
}));

(datascript.query.Context.prototype.cljs$core$IWithMeta$_with_meta$arity$2 \x3d (function (this__5342__auto__,G__54783){
var self__ \x3d this;
var this__5342__auto____$1 \x3d this;
return (new datascript.query.Context(self__.rels,self__.sources,self__.rules,G__54783,self__.__extmap,self__.__hash));
}));

(datascript.query.Context.prototype.cljs$core$ICollection$_conj$arity$2 \x3d (function (this__5348__auto__,entry__5349__auto__){
var self__ \x3d this;
var this__5348__auto____$1 \x3d this;
if(cljs.core.vector_QMARK_(entry__5349__auto__)){
return this__5348__auto____$1.cljs$core$IAssociative$_assoc$arity$3(null,cljs.core._nth(entry__5349__auto__,(0)),cljs.core._nth(entry__5349__auto__,(1)));
} else {
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(cljs.core._conj,this__5348__auto____$1,entry__5349__auto__);
}
}));

(datascript.query.Context.getBasis \x3d (function (){
return new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22rels\x22,\x22rels\x22,-884248584,null),new cljs.core.Symbol(null,\x22sources\x22,\x22sources\x22,1319365103,null),new cljs.core.Symbol(null,\x22rules\x22,\x22rules\x22,-1455523403,null)], null);
}));

(datascript.query.Context.cljs$lang$type \x3d true);

(datascript.query.Context.cljs$lang$ctorPrSeq \x3d (function (this__5389__auto__){
return (new cljs.core.List(null,\x22datascript.query/Context\x22,null,(1),null));
}));

(datascript.query.Context.cljs$lang$ctorPrWriter \x3d (function (this__5389__auto__,writer__5390__auto__){
return cljs.core._write(writer__5390__auto__,\x22datascript.query/Context\x22);
}));

/**
 * Positional factory function for datascript.query/Context.
 */
datascript.query.__GT_Context \x3d (function datascript$query$__GT_Context(rels,sources,rules){
return (new datascript.query.Context(rels,sources,rules,null,null,null));
});

/**
 * Factory function for datascript.query/Context, taking a map of keywords to field values.
 */
datascript.query.map__GT_Context \x3d (function datascript$query$map__GT_Context(G__54787){
var extmap__5385__auto__ \x3d (function (){var G__54802 \x3d cljs.core.dissoc.cljs$core$IFn$_invoke$arity$variadic(G__54787,new cljs.core.Keyword(null,\x22rels\x22,\x22rels\x22,1770187185),cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,\x22sources\x22,\x22sources\x22,-321166424),new cljs.core.Keyword(null,\x22rules\x22,\x22rules\x22,1198912366)], 0));
if(cljs.core.record_QMARK_(G__54787)){
return cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,G__54802);
} else {
return G__54802;
}
})();
return (new datascript.query.Context(new cljs.core.Keyword(null,\x22rels\x22,\x22rels\x22,1770187185).cljs$core$IFn$_invoke$arity$1(G__54787),new cljs.core.Keyword(null,\x22sources\x22,\x22sources\x22,-321166424).cljs$core$IFn$_invoke$arity$1(G__54787),new cljs.core.Keyword(null,\x22rules\x22,\x22rules\x22,1198912366).cljs$core$IFn$_invoke$arity$1(G__54787),null,cljs.core.not_empty(extmap__5385__auto__),null));
});


/**
* @constructor
 * @implements {cljs.core.IRecord}
 * @implements {cljs.core.IKVReduce}
 * @implements {cljs.core.IEquiv}
 * @implements {cljs.core.IHash}
 * @implements {cljs.core.ICollection}
 * @implements {cljs.core.ICounted}
 * @implements {cljs.core.ISeqable}
 * @implements {cljs.core.IMeta}
 * @implements {cljs.core.ICloneable}
 * @implements {cljs.core.IPrintWithWriter}
 * @implements {cljs.core.IIterable}
 * @implements {cljs.core.IWithMeta}
 * @implements {cljs.core.IAssociative}
 * @implements {cljs.core.IMap}
 * @implements {cljs.core.ILookup}
*/
datascript.query.Relation \x3d (function (attrs,tuples,__meta,__extmap,__hash){
this.attrs \x3d attrs;
this.tuples \x3d tuples;
this.__meta \x3d __meta;
this.__extmap \x3d __extmap;
this.__hash \x3d __hash;
this.cljs$lang$protocol_mask$partition0$ \x3d 2230716170;
this.cljs$lang$protocol_mask$partition1$ \x3d 139264;
});
(datascript.query.Relation.prototype.cljs$core$ILookup$_lookup$arity$2 \x3d (function (this__5343__auto__,k__5344__auto__){
var self__ \x3d this;
var this__5343__auto____$1 \x3d this;
return this__5343__auto____$1.cljs$core$ILookup$_lookup$arity$3(null,k__5344__auto__,null);
}));

(datascript.query.Relation.prototype.cljs$core$ILookup$_lookup$arity$3 \x3d (function (this__5345__auto__,k54804,else__5346__auto__){
var self__ \x3d this;
var this__5345__auto____$1 \x3d this;
var G__54809 \x3d k54804;
var G__54809__$1 \x3d (((G__54809 instanceof cljs.core.Keyword))?G__54809.fqn:null);
switch (G__54809__$1) {
case \x22attrs\x22:
return self__.attrs;

break;
case \x22tuples\x22:
return self__.tuples;

break;
default:
return cljs.core.get.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k54804,else__5346__auto__);

}
}));

(datascript.query.Relation.prototype.cljs$core$IKVReduce$_kv_reduce$arity$3 \x3d (function (this__5363__auto__,f__5364__auto__,init__5365__auto__){
var self__ \x3d this;
var this__5363__auto____$1 \x3d this;
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (ret__5366__auto__,p__54810){
var vec__54811 \x3d p__54810;
var k__5367__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54811,(0),null);
var v__5368__auto__ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54811,(1),null);
return (f__5364__auto__.cljs$core$IFn$_invoke$arity$3 ? f__5364__auto__.cljs$core$IFn$_invoke$arity$3(ret__5366__auto__,k__5367__auto__,v__5368__auto__) : f__5364__auto__.call(null,ret__5366__auto__,k__5367__auto__,v__5368__auto__));
}),init__5365__auto__,this__5363__auto____$1);
}));

(datascript.query.Relation.prototype.cljs$core$IPrintWithWriter$_pr_writer$arity$3 \x3d (function (this__5358__auto__,writer__5359__auto__,opts__5360__auto__){
var self__ \x3d this;
var this__5358__auto____$1 \x3d this;
var pr_pair__5361__auto__ \x3d (function (keyval__5362__auto__){
return cljs.core.pr_sequential_writer(writer__5359__auto__,cljs.core.pr_writer,\x22\x22,\x22 \x22,\x22\x22,opts__5360__auto__,keyval__5362__auto__);
});
return cljs.core.pr_sequential_writer(writer__5359__auto__,pr_pair__5361__auto__,\x22#datascript.query.Relation{\x22,\x22, \x22,\x22}\x22,opts__5360__auto__,cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713),self__.attrs],null)),(new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,\x22tuples\x22,\x22tuples\x22,-676032639),self__.tuples],null))], null),self__.__extmap));
}));

(datascript.query.Relation.prototype.cljs$core$IIterable$_iterator$arity$1 \x3d (function (G__54803){
var self__ \x3d this;
var G__54803__$1 \x3d this;
return (new cljs.core.RecordIter((0),G__54803__$1,2,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713),new cljs.core.Keyword(null,\x22tuples\x22,\x22tuples\x22,-676032639)], null),(cljs.core.truth_(self__.__extmap)?cljs.core._iterator(self__.__extmap):cljs.core.nil_iter())));
}));

(datascript.query.Relation.prototype.cljs$core$IMeta$_meta$arity$1 \x3d (function (this__5341__auto__){
var self__ \x3d this;
var this__5341__auto____$1 \x3d this;
return self__.__meta;
}));

(datascript.query.Relation.prototype.cljs$core$ICloneable$_clone$arity$1 \x3d (function (this__5338__auto__){
var self__ \x3d this;
var this__5338__auto____$1 \x3d this;
return (new datascript.query.Relation(self__.attrs,self__.tuples,self__.__meta,self__.__extmap,self__.__hash));
}));

(datascript.query.Relation.prototype.cljs$core$ICounted$_count$arity$1 \x3d (function (this__5347__auto__){
var self__ \x3d this;
var this__5347__auto____$1 \x3d this;
return (2 + cljs.core.count(self__.__extmap));
}));

(datascript.query.Relation.prototype.cljs$core$IHash$_hash$arity$1 \x3d (function (this__5339__auto__){
var self__ \x3d this;
var this__5339__auto____$1 \x3d this;
var h__5154__auto__ \x3d self__.__hash;
if((!((h__5154__auto__ \x3d\x3d null)))){
return h__5154__auto__;
} else {
var h__5154__auto____$1 \x3d (function (coll__5340__auto__){
return (1107093117 ^ cljs.core.hash_unordered_coll(coll__5340__auto__));
})(this__5339__auto____$1);
(self__.__hash \x3d h__5154__auto____$1);

return h__5154__auto____$1;
}
}));

(datascript.query.Relation.prototype.cljs$core$IEquiv$_equiv$arity$2 \x3d (function (this54805,other54806){
var self__ \x3d this;
var this54805__$1 \x3d this;
return (((!((other54806 \x3d\x3d null)))) \x26\x26 ((((this54805__$1.constructor \x3d\x3d\x3d other54806.constructor)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54805__$1.attrs,other54806.attrs)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54805__$1.tuples,other54806.tuples)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(this54805__$1.__extmap,other54806.__extmap)))))))));
}));

(datascript.query.Relation.prototype.cljs$core$IMap$_dissoc$arity$2 \x3d (function (this__5353__auto__,k__5354__auto__){
var self__ \x3d this;
var this__5353__auto____$1 \x3d this;
if(cljs.core.contains_QMARK_(new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22tuples\x22,\x22tuples\x22,-676032639),null,new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713),null], null), null),k__5354__auto__)){
return cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(cljs.core._with_meta(cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,this__5353__auto____$1),self__.__meta),k__5354__auto__);
} else {
return (new datascript.query.Relation(self__.attrs,self__.tuples,self__.__meta,cljs.core.not_empty(cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(self__.__extmap,k__5354__auto__)),null));
}
}));

(datascript.query.Relation.prototype.cljs$core$IAssociative$_contains_key_QMARK_$arity$2 \x3d (function (this__5350__auto__,k54804){
var self__ \x3d this;
var this__5350__auto____$1 \x3d this;
var G__54816 \x3d k54804;
var G__54816__$1 \x3d (((G__54816 instanceof cljs.core.Keyword))?G__54816.fqn:null);
switch (G__54816__$1) {
case \x22attrs\x22:
case \x22tuples\x22:
return true;

break;
default:
return cljs.core.contains_QMARK_(self__.__extmap,k54804);

}
}));

(datascript.query.Relation.prototype.cljs$core$IAssociative$_assoc$arity$3 \x3d (function (this__5351__auto__,k__5352__auto__,G__54803){
var self__ \x3d this;
var this__5351__auto____$1 \x3d this;
var pred__54817 \x3d cljs.core.keyword_identical_QMARK_;
var expr__54818 \x3d k__5352__auto__;
if(cljs.core.truth_((pred__54817.cljs$core$IFn$_invoke$arity$2 ? pred__54817.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713),expr__54818) : pred__54817.call(null,new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713),expr__54818)))){
return (new datascript.query.Relation(G__54803,self__.tuples,self__.__meta,self__.__extmap,null));
} else {
if(cljs.core.truth_((pred__54817.cljs$core$IFn$_invoke$arity$2 ? pred__54817.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22tuples\x22,\x22tuples\x22,-676032639),expr__54818) : pred__54817.call(null,new cljs.core.Keyword(null,\x22tuples\x22,\x22tuples\x22,-676032639),expr__54818)))){
return (new datascript.query.Relation(self__.attrs,G__54803,self__.__meta,self__.__extmap,null));
} else {
return (new datascript.query.Relation(self__.attrs,self__.tuples,self__.__meta,cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(self__.__extmap,k__5352__auto__,G__54803),null));
}
}
}));

(datascript.query.Relation.prototype.cljs$core$ISeqable$_seq$arity$1 \x3d (function (this__5356__auto__){
var self__ \x3d this;
var this__5356__auto____$1 \x3d this;
return cljs.core.seq(cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713),self__.attrs,null)),(new cljs.core.MapEntry(new cljs.core.Keyword(null,\x22tuples\x22,\x22tuples\x22,-676032639),self__.tuples,null))], null),self__.__extmap));
}));

(datascript.query.Relation.prototype.cljs$core$IWithMeta$_with_meta$arity$2 \x3d (function (this__5342__auto__,G__54803){
var self__ \x3d this;
var this__5342__auto____$1 \x3d this;
return (new datascript.query.Relation(self__.attrs,self__.tuples,G__54803,self__.__extmap,self__.__hash));
}));

(datascript.query.Relation.prototype.cljs$core$ICollection$_conj$arity$2 \x3d (function (this__5348__auto__,entry__5349__auto__){
var self__ \x3d this;
var this__5348__auto____$1 \x3d this;
if(cljs.core.vector_QMARK_(entry__5349__auto__)){
return this__5348__auto____$1.cljs$core$IAssociative$_assoc$arity$3(null,cljs.core._nth(entry__5349__auto__,(0)),cljs.core._nth(entry__5349__auto__,(1)));
} else {
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(cljs.core._conj,this__5348__auto____$1,entry__5349__auto__);
}
}));

(datascript.query.Relation.getBasis \x3d (function (){
return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22attrs\x22,\x22attrs\x22,-450137186,null),new cljs.core.Symbol(null,\x22tuples\x22,\x22tuples\x22,964498888,null)], null);
}));

(datascript.query.Relation.cljs$lang$type \x3d true);

(datascript.query.Relation.cljs$lang$ctorPrSeq \x3d (function (this__5389__auto__){
return (new cljs.core.List(null,\x22datascript.query/Relation\x22,null,(1),null));
}));

(datascript.query.Relation.cljs$lang$ctorPrWriter \x3d (function (this__5389__auto__,writer__5390__auto__){
return cljs.core._write(writer__5390__auto__,\x22datascript.query/Relation\x22);
}));

/**
 * Positional factory function for datascript.query/Relation.
 */
datascript.query.__GT_Relation \x3d (function datascript$query$__GT_Relation(attrs,tuples){
return (new datascript.query.Relation(attrs,tuples,null,null,null));
});

/**
 * Factory function for datascript.query/Relation, taking a map of keywords to field values.
 */
datascript.query.map__GT_Relation \x3d (function datascript$query$map__GT_Relation(G__54807){
var extmap__5385__auto__ \x3d (function (){var G__54821 \x3d cljs.core.dissoc.cljs$core$IFn$_invoke$arity$variadic(G__54807,new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713),cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,\x22tuples\x22,\x22tuples\x22,-676032639)], 0));
if(cljs.core.record_QMARK_(G__54807)){
return cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,G__54821);
} else {
return G__54821;
}
})();
return (new datascript.query.Relation(new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713).cljs$core$IFn$_invoke$arity$1(G__54807),new cljs.core.Keyword(null,\x22tuples\x22,\x22tuples\x22,-676032639).cljs$core$IFn$_invoke$arity$1(G__54807),null,cljs.core.not_empty(extmap__5385__auto__),null));
});

datascript.query.single \x3d (function datascript$query$single(coll){
if((cljs.core.next(coll) \x3d\x3d null)){
} else {
throw (new Error([\x22Assert failed: \x22,\x22Expected single element\x22,\x22\
\x22,\x22(nil? (next coll))\x22].join(\x27\x27)));
}

return cljs.core.first(coll);
});
datascript.query.intersect_keys \x3d (function datascript$query$intersect_keys(attrs1,attrs2){
return clojure.set.intersection.cljs$core$IFn$_invoke$arity$2(cljs.core.set(cljs.core.keys(attrs1)),cljs.core.set(cljs.core.keys(attrs2)));
});
datascript.query.concatv \x3d (function datascript$query$concatv(var_args){
var args__5775__auto__ \x3d [];
var len__5769__auto___55202 \x3d arguments.length;
var i__5770__auto___55206 \x3d (0);
while(true){
if((i__5770__auto___55206 \x3c len__5769__auto___55202)){
args__5775__auto__.push((arguments[i__5770__auto___55206]));

var G__55210 \x3d (i__5770__auto___55206 + (1));
i__5770__auto___55206 \x3d G__55210;
continue;
} else {
}
break;
}

var argseq__5776__auto__ \x3d ((((0) \x3c args__5775__auto__.length))?(new cljs.core.IndexedSeq(args__5775__auto__.slice((0)),(0),null)):null);
return datascript.query.concatv.cljs$core$IFn$_invoke$arity$variadic(argseq__5776__auto__);
});

(datascript.query.concatv.cljs$core$IFn$_invoke$arity$variadic \x3d (function (xs){
return cljs.core.into.cljs$core$IFn$_invoke$arity$3(cljs.core.PersistentVector.EMPTY,cljs.core.cat,xs);
}));

(datascript.query.concatv.cljs$lang$maxFixedArity \x3d (0));

/** @this {Function} */
(datascript.query.concatv.cljs$lang$applyTo \x3d (function (seq54823){
var self__5755__auto__ \x3d this;
return self__5755__auto__.cljs$core$IFn$_invoke$arity$variadic(cljs.core.seq(seq54823));
}));

datascript.query.zip \x3d (function datascript$query$zip(var_args){
var G__54828 \x3d arguments.length;
switch (G__54828) {
case 2:
return datascript.query.zip.cljs$core$IFn$_invoke$arity$2((arguments[(0)]),(arguments[(1)]));

break;
default:
var args_arr__5794__auto__ \x3d [];
var len__5769__auto___55220 \x3d arguments.length;
var i__5770__auto___55221 \x3d (0);
while(true){
if((i__5770__auto___55221 \x3c len__5769__auto___55220)){
args_arr__5794__auto__.push((arguments[i__5770__auto___55221]));

var G__55222 \x3d (i__5770__auto___55221 + (1));
i__5770__auto___55221 \x3d G__55222;
continue;
} else {
}
break;
}

var argseq__5795__auto__ \x3d (new cljs.core.IndexedSeq(args_arr__5794__auto__.slice((2)),(0),null));
return datascript.query.zip.cljs$core$IFn$_invoke$arity$variadic((arguments[(0)]),(arguments[(1)]),argseq__5795__auto__);

}
});

(datascript.query.zip.cljs$core$IFn$_invoke$arity$2 \x3d (function (a,b){
return cljs.core.mapv.cljs$core$IFn$_invoke$arity$3(cljs.core.vector,a,b);
}));

(datascript.query.zip.cljs$core$IFn$_invoke$arity$variadic \x3d (function (a,b,rest){
return cljs.core.apply.cljs$core$IFn$_invoke$arity$5(cljs.core.mapv,cljs.core.vector,a,b,rest);
}));

/** @this {Function} */
(datascript.query.zip.cljs$lang$applyTo \x3d (function (seq54825){
var G__54826 \x3d cljs.core.first(seq54825);
var seq54825__$1 \x3d cljs.core.next(seq54825);
var G__54827 \x3d cljs.core.first(seq54825__$1);
var seq54825__$2 \x3d cljs.core.next(seq54825__$1);
var self__5754__auto__ \x3d this;
return self__5754__auto__.cljs$core$IFn$_invoke$arity$variadic(G__54826,G__54827,seq54825__$2);
}));

(datascript.query.zip.cljs$lang$maxFixedArity \x3d (2));

datascript.query.same_keys_QMARK_ \x3d (function datascript$query$same_keys_QMARK_(a,b){
return ((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(cljs.core.count(a),cljs.core.count(b))) \x26\x26 (((cljs.core.every_QMARK_((function (p1__54830_SHARP_){
return cljs.core.contains_QMARK_(b,p1__54830_SHARP_);
}),cljs.core.keys(a))) \x26\x26 (cljs.core.every_QMARK_((function (p1__54831_SHARP_){
return cljs.core.contains_QMARK_(b,p1__54831_SHARP_);
}),cljs.core.keys(a))))));
});
datascript.query.looks_like_QMARK_ \x3d (function datascript$query$looks_like_QMARK_(pattern,form){
if(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Symbol(null,\x22_\x22,\x22_\x22,-1201019570,null),pattern)){
return true;
} else {
if(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22*\x22,\x22*\x22,345799209,null)], null),pattern)){
return cljs.core.sequential_QMARK_(form);
} else {
if((pattern instanceof cljs.core.Symbol)){
return cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(form,pattern);
} else {
if(cljs.core.sequential_QMARK_(pattern)){
if(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(cljs.core.last(pattern),new cljs.core.Symbol(null,\x22*\x22,\x22*\x22,345799209,null))){
return ((cljs.core.sequential_QMARK_(form)) \x26\x26 (cljs.core.every_QMARK_((function (p__54833){
var vec__54834 \x3d p__54833;
var pattern_el \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54834,(0),null);
var form_el \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54834,(1),null);
return (datascript.query.looks_like_QMARK_.cljs$core$IFn$_invoke$arity$2 ? datascript.query.looks_like_QMARK_.cljs$core$IFn$_invoke$arity$2(pattern_el,form_el) : datascript.query.looks_like_QMARK_.call(null,pattern_el,form_el));
}),cljs.core.map.cljs$core$IFn$_invoke$arity$3(cljs.core.vector,cljs.core.butlast(pattern),form))));
} else {
return ((cljs.core.sequential_QMARK_(form)) \x26\x26 (((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(cljs.core.count(form),cljs.core.count(pattern))) \x26\x26 (cljs.core.every_QMARK_((function (p__54837){
var vec__54838 \x3d p__54837;
var pattern_el \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54838,(0),null);
var form_el \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54838,(1),null);
return (datascript.query.looks_like_QMARK_.cljs$core$IFn$_invoke$arity$2 ? datascript.query.looks_like_QMARK_.cljs$core$IFn$_invoke$arity$2(pattern_el,form_el) : datascript.query.looks_like_QMARK_.call(null,pattern_el,form_el));
}),cljs.core.map.cljs$core$IFn$_invoke$arity$3(cljs.core.vector,pattern,form))))));
}
} else {
return (pattern.cljs$core$IFn$_invoke$arity$1 ? pattern.cljs$core$IFn$_invoke$arity$1(form) : pattern.call(null,form));

}
}
}
}
});
datascript.query.source_QMARK_ \x3d (function datascript$query$source_QMARK_(sym){
return (((sym instanceof cljs.core.Symbol)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(\x22$\x22,cljs.core.first(cljs.core.name(sym)))));
});
datascript.query.free_var_QMARK_ \x3d (function datascript$query$free_var_QMARK_(sym){
return (((sym instanceof cljs.core.Symbol)) \x26\x26 (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(\x22?\x22,cljs.core.first(cljs.core.name(sym)))));
});
datascript.query.attr_QMARK_ \x3d (function datascript$query$attr_QMARK_(form){
return (((form instanceof cljs.core.Keyword)) || (typeof form \x3d\x3d\x3d \x27string\x27));
});
datascript.query.lookup_ref_QMARK_ \x3d (function datascript$query$lookup_ref_QMARK_(form){
return datascript.query.looks_like_QMARK_(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [datascript.query.attr_QMARK_,new cljs.core.Symbol(null,\x22_\x22,\x22_\x22,-1201019570,null)], null),form);
});
datascript.query.join_tuples \x3d (function datascript$query$join_tuples(t1,idxs1,t2,idxs2){
var l1 \x3d idxs1.length;
var l2 \x3d idxs2.length;
var res \x3d me.tonsky.persistent_sorted_set.arrays.make_array((l1 + l2));
var n__5636__auto___55235 \x3d l1;
var i_55236 \x3d (0);
while(true){
if((i_55236 \x3c n__5636__auto___55235)){
(res[i_55236] \x3d (t1[(idxs1[i_55236])]));

var G__55237 \x3d (i_55236 + (1));
i_55236 \x3d G__55237;
continue;
} else {
}
break;
}

var n__5636__auto___55238 \x3d l2;
var i_55239 \x3d (0);
while(true){
if((i_55239 \x3c n__5636__auto___55238)){
(res[(l1 + i_55239)] \x3d (t2[(idxs2[i_55239])]));

var G__55240 \x3d (i_55239 + (1));
i_55239 \x3d G__55240;
continue;
} else {
}
break;
}

return res;
});
datascript.query.sum_rel \x3d (function datascript$query$sum_rel(a,b){
var map__54843 \x3d a;
var map__54843__$1 \x3d cljs.core.__destructure_map(map__54843);
var attrs_a \x3d cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__54843__$1,new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713));
var tuples_a \x3d cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__54843__$1,new cljs.core.Keyword(null,\x22tuples\x22,\x22tuples\x22,-676032639));
var map__54844 \x3d b;
var map__54844__$1 \x3d cljs.core.__destructure_map(map__54844);
var attrs_b \x3d cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__54844__$1,new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713));
var tuples_b \x3d cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__54844__$1,new cljs.core.Keyword(null,\x22tuples\x22,\x22tuples\x22,-676032639));
if(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(attrs_a,attrs_b)){
return (new datascript.query.Relation(attrs_a,cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.vec(tuples_a),tuples_b),null,null,null));
} else {
if((!(datascript.query.same_keys_QMARK_(attrs_a,attrs_b)))){
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22Can\\u2019t sum relations with different attrs: \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([attrs_a], 0)),\x22 and \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([attrs_b], 0))].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22query\x22,\x22where\x22,\x22query/where\x22,-1935159429)], null));
} else {
if(cljs.core.every_QMARK_(cljs.core.number_QMARK_,cljs.core.vals(attrs_a))){
var idxb__GT_idxa \x3d cljs.core.vec((function (){var iter__5523__auto__ \x3d (function datascript$query$sum_rel_$_iter__54845(s__54846){
return (new cljs.core.LazySeq(null,(function (){
var s__54846__$1 \x3d s__54846;
while(true){
var temp__5804__auto__ \x3d cljs.core.seq(s__54846__$1);
if(temp__5804__auto__){
var s__54846__$2 \x3d temp__5804__auto__;
if(cljs.core.chunked_seq_QMARK_(s__54846__$2)){
var c__5521__auto__ \x3d cljs.core.chunk_first(s__54846__$2);
var size__5522__auto__ \x3d cljs.core.count(c__5521__auto__);
var b__54848 \x3d cljs.core.chunk_buffer(size__5522__auto__);
if((function (){var i__54847 \x3d (0);
while(true){
if((i__54847 \x3c size__5522__auto__)){
var vec__54849 \x3d cljs.core._nth(c__5521__auto__,i__54847);
var sym \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54849,(0),null);
var idx_b \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54849,(1),null);
cljs.core.chunk_append(b__54848,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [idx_b,(attrs_a.cljs$core$IFn$_invoke$arity$1 ? attrs_a.cljs$core$IFn$_invoke$arity$1(sym) : attrs_a.call(null,sym))], null));

var G__55243 \x3d (i__54847 + (1));
i__54847 \x3d G__55243;
continue;
} else {
return true;
}
break;
}
})()){
return cljs.core.chunk_cons(cljs.core.chunk(b__54848),datascript$query$sum_rel_$_iter__54845(cljs.core.chunk_rest(s__54846__$2)));
} else {
return cljs.core.chunk_cons(cljs.core.chunk(b__54848),null);
}
} else {
var vec__54852 \x3d cljs.core.first(s__54846__$2);
var sym \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54852,(0),null);
var idx_b \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54852,(1),null);
return cljs.core.cons(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [idx_b,(attrs_a.cljs$core$IFn$_invoke$arity$1 ? attrs_a.cljs$core$IFn$_invoke$arity$1(sym) : attrs_a.call(null,sym))], null),datascript$query$sum_rel_$_iter__54845(cljs.core.rest(s__54846__$2)));
}
} else {
return null;
}
break;
}
}),null,null));
});
return iter__5523__auto__(attrs_b);
})());
var tlen \x3d (cljs.core.reduce.cljs$core$IFn$_invoke$arity$2(cljs.core.max,cljs.core.vals(attrs_a)) + (1));
var tuples_SINGLEQUOTE_ \x3d cljs.core.persistent_BANG_(cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (acc,tuple_b){
var tuple_SINGLEQUOTE_ \x3d me.tonsky.persistent_sorted_set.arrays.make_array(tlen);
var seq__54856_55244 \x3d cljs.core.seq(idxb__GT_idxa);
var chunk__54857_55245 \x3d null;
var count__54858_55246 \x3d (0);
var i__54859_55247 \x3d (0);
while(true){
if((i__54859_55247 \x3c count__54858_55246)){
var vec__54866_55248 \x3d chunk__54857_55245.cljs$core$IIndexed$_nth$arity$2(null,i__54859_55247);
var idx_b_55249 \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54866_55248,(0),null);
var idx_a_55250 \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54866_55248,(1),null);
(tuple_SINGLEQUOTE_[idx_a_55250] \x3d (tuple_b[idx_b_55249]));


var G__55251 \x3d seq__54856_55244;
var G__55252 \x3d chunk__54857_55245;
var G__55253 \x3d count__54858_55246;
var G__55254 \x3d (i__54859_55247 + (1));
seq__54856_55244 \x3d G__55251;
chunk__54857_55245 \x3d G__55252;
count__54858_55246 \x3d G__55253;
i__54859_55247 \x3d G__55254;
continue;
} else {
var temp__5804__auto___55255 \x3d cljs.core.seq(seq__54856_55244);
if(temp__5804__auto___55255){
var seq__54856_55256__$1 \x3d temp__5804__auto___55255;
if(cljs.core.chunked_seq_QMARK_(seq__54856_55256__$1)){
var c__5568__auto___55257 \x3d cljs.core.chunk_first(seq__54856_55256__$1);
var G__55258 \x3d cljs.core.chunk_rest(seq__54856_55256__$1);
var G__55259 \x3d c__5568__auto___55257;
var G__55260 \x3d cljs.core.count(c__5568__auto___55257);
var G__55261 \x3d (0);
seq__54856_55244 \x3d G__55258;
chunk__54857_55245 \x3d G__55259;
count__54858_55246 \x3d G__55260;
i__54859_55247 \x3d G__55261;
continue;
} else {
var vec__54870_55262 \x3d cljs.core.first(seq__54856_55256__$1);
var idx_b_55263 \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54870_55262,(0),null);
var idx_a_55264 \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54870_55262,(1),null);
(tuple_SINGLEQUOTE_[idx_a_55264] \x3d (tuple_b[idx_b_55263]));


var G__55265 \x3d cljs.core.next(seq__54856_55256__$1);
var G__55266 \x3d null;
var G__55267 \x3d (0);
var G__55268 \x3d (0);
seq__54856_55244 \x3d G__55265;
chunk__54857_55245 \x3d G__55266;
count__54858_55246 \x3d G__55267;
i__54859_55247 \x3d G__55268;
continue;
}
} else {
}
}
break;
}

return cljs.core.conj_BANG_.cljs$core$IFn$_invoke$arity$2(acc,tuple_SINGLEQUOTE_);
}),cljs.core.transient$(cljs.core.vec(tuples_a)),tuples_b));
return (new datascript.query.Relation(attrs_a,tuples_SINGLEQUOTE_,null,null,null));
} else {
var all_attrs \x3d cljs.core.zipmap(cljs.core.keys(cljs.core.merge.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([attrs_a,attrs_b], 0))),cljs.core.range.cljs$core$IFn$_invoke$arity$0());
var G__54873 \x3d (function (){var G__54875 \x3d (new datascript.query.Relation(all_attrs,cljs.core.PersistentVector.EMPTY,null,null,null));
var G__54876 \x3d a;
return (datascript.query.sum_rel.cljs$core$IFn$_invoke$arity$2 ? datascript.query.sum_rel.cljs$core$IFn$_invoke$arity$2(G__54875,G__54876) : datascript.query.sum_rel.call(null,G__54875,G__54876));
})();
var G__54874 \x3d b;
return (datascript.query.sum_rel.cljs$core$IFn$_invoke$arity$2 ? datascript.query.sum_rel.cljs$core$IFn$_invoke$arity$2(G__54873,G__54874) : datascript.query.sum_rel.call(null,G__54873,G__54874));

}
}
}
});
datascript.query.prod_rel \x3d (function datascript$query$prod_rel(var_args){
var G__54878 \x3d arguments.length;
switch (G__54878) {
case 0:
return datascript.query.prod_rel.cljs$core$IFn$_invoke$arity$0();

break;
case 2:
return datascript.query.prod_rel.cljs$core$IFn$_invoke$arity$2((arguments[(0)]),(arguments[(1)]));

break;
default:
throw (new Error([\x22Invalid arity: \x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1(arguments.length)].join(\x27\x27)));

}
});

(datascript.query.prod_rel.cljs$core$IFn$_invoke$arity$0 \x3d (function (){
return (new datascript.query.Relation(cljs.core.PersistentArrayMap.EMPTY,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [me.tonsky.persistent_sorted_set.arrays.make_array((0))], null),null,null,null));
}));

(datascript.query.prod_rel.cljs$core$IFn$_invoke$arity$2 \x3d (function (rel1,rel2){
var attrs1 \x3d cljs.core.keys(new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713).cljs$core$IFn$_invoke$arity$1(rel1));
var attrs2 \x3d cljs.core.keys(new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713).cljs$core$IFn$_invoke$arity$1(rel2));
var idxs1 \x3d cljs.core.to_array(cljs.core.map.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713).cljs$core$IFn$_invoke$arity$1(rel1),attrs1));
var idxs2 \x3d cljs.core.to_array(cljs.core.map.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713).cljs$core$IFn$_invoke$arity$1(rel2),attrs2));
return (new datascript.query.Relation(cljs.core.zipmap(cljs.core.concat.cljs$core$IFn$_invoke$arity$2(attrs1,attrs2),cljs.core.range.cljs$core$IFn$_invoke$arity$0()),cljs.core.persistent_BANG_(cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (acc,t1){
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (acc__$1,t2){
return cljs.core.conj_BANG_.cljs$core$IFn$_invoke$arity$2(acc__$1,datascript.query.join_tuples(t1,idxs1,t2,idxs2));
}),acc,new cljs.core.Keyword(null,\x22tuples\x22,\x22tuples\x22,-676032639).cljs$core$IFn$_invoke$arity$1(rel2));
}),cljs.core.transient$(cljs.core.PersistentVector.EMPTY),new cljs.core.Keyword(null,\x22tuples\x22,\x22tuples\x22,-676032639).cljs$core$IFn$_invoke$arity$1(rel1))),null,null,null));
}));

(datascript.query.prod_rel.cljs$lang$maxFixedArity \x3d 2);

datascript.query.parse_rules \x3d (function datascript$query$parse_rules(rules){
var rules__$1 \x3d ((typeof rules \x3d\x3d\x3d \x27string\x27)?cljs.reader.read_string.cljs$core$IFn$_invoke$arity$1(rules):rules);
datascript.parser.parse_rules(rules__$1);

return cljs.core.group_by(cljs.core.ffirst,rules__$1);
});
datascript.query.empty_rel \x3d (function datascript$query$empty_rel(binding){
var vars \x3d cljs.core.map.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22symbol\x22,\x22symbol\x22,-1038572696),datascript.parser.collect_vars_distinct(binding));
return (new datascript.query.Relation(cljs.core.zipmap(vars,cljs.core.range.cljs$core$IFn$_invoke$arity$0()),cljs.core.PersistentVector.EMPTY,null,null,null));
});

/**
 * @interface
 */
datascript.query.IBinding \x3d function(){};

var datascript$query$IBinding$in__GT_rel$dyn_55272 \x3d (function (binding,value){
var x__5393__auto__ \x3d (((binding \x3d\x3d null))?null:binding);
var m__5394__auto__ \x3d (datascript.query.in__GT_rel[goog.typeOf(x__5393__auto__)]);
if((!((m__5394__auto__ \x3d\x3d null)))){
return (m__5394__auto__.cljs$core$IFn$_invoke$arity$2 ? m__5394__auto__.cljs$core$IFn$_invoke$arity$2(binding,value) : m__5394__auto__.call(null,binding,value));
} else {
var m__5392__auto__ \x3d (datascript.query.in__GT_rel[\x22_\x22]);
if((!((m__5392__auto__ \x3d\x3d null)))){
return (m__5392__auto__.cljs$core$IFn$_invoke$arity$2 ? m__5392__auto__.cljs$core$IFn$_invoke$arity$2(binding,value) : m__5392__auto__.call(null,binding,value));
} else {
throw cljs.core.missing_protocol(\x22IBinding.in-\x3erel\x22,binding);
}
}
});
datascript.query.in__GT_rel \x3d (function datascript$query$in__GT_rel(binding,value){
if((((!((binding \x3d\x3d null)))) \x26\x26 ((!((binding.datascript$query$IBinding$in__GT_rel$arity$2 \x3d\x3d null)))))){
return binding.datascript$query$IBinding$in__GT_rel$arity$2(binding,value);
} else {
return datascript$query$IBinding$in__GT_rel$dyn_55272(binding,value);
}
});

(datascript.parser.BindIgnore.prototype.datascript$query$IBinding$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.parser.BindIgnore.prototype.datascript$query$IBinding$in__GT_rel$arity$2 \x3d (function (_,___$1){
var ___$2 \x3d this;
return datascript.query.prod_rel.cljs$core$IFn$_invoke$arity$0();
}));

(datascript.parser.BindScalar.prototype.datascript$query$IBinding$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.parser.BindScalar.prototype.datascript$query$IBinding$in__GT_rel$arity$2 \x3d (function (binding,value){
var binding__$1 \x3d this;
return (new datascript.query.Relation(cljs.core.PersistentArrayMap.createAsIfByAssoc([cljs.core.get_in.cljs$core$IFn$_invoke$arity$2(binding__$1,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22variable\x22,\x22variable\x22,-281346492),new cljs.core.Keyword(null,\x22symbol\x22,\x22symbol\x22,-1038572696)], null)),(0)]),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.into_array.cljs$core$IFn$_invoke$arity$1(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [value], null))], null),null,null,null));
}));

(datascript.parser.BindColl.prototype.datascript$query$IBinding$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.parser.BindColl.prototype.datascript$query$IBinding$in__GT_rel$arity$2 \x3d (function (binding,coll){
var binding__$1 \x3d this;
if((!(datascript.db.seqable_QMARK_(coll)))){
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22Cannot bind value \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([coll], 0)),\x22 to collection \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([datascript.parser.source(binding__$1)], 0))].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22query\x22,\x22binding\x22,\x22query/binding\x22,698240489),new cljs.core.Keyword(null,\x22value\x22,\x22value\x22,305978217),coll,new cljs.core.Keyword(null,\x22binding\x22,\x22binding\x22,539932593),datascript.parser.source(binding__$1)], null));
} else {
if(cljs.core.empty_QMARK_(coll)){
return datascript.query.empty_rel(binding__$1);
} else {
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$2(datascript.query.sum_rel,cljs.core.map.cljs$core$IFn$_invoke$arity$2((function (p1__54880_SHARP_){
return datascript.query.in__GT_rel(binding__$1.binding,p1__54880_SHARP_);
}),coll));

}
}
}));

(datascript.parser.BindTuple.prototype.datascript$query$IBinding$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.parser.BindTuple.prototype.datascript$query$IBinding$in__GT_rel$arity$2 \x3d (function (binding,coll){
var binding__$1 \x3d this;
if((!(datascript.db.seqable_QMARK_(coll)))){
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22Cannot bind value \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([coll], 0)),\x22 to tuple \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([datascript.parser.source(binding__$1)], 0))].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22query\x22,\x22binding\x22,\x22query/binding\x22,698240489),new cljs.core.Keyword(null,\x22value\x22,\x22value\x22,305978217),coll,new cljs.core.Keyword(null,\x22binding\x22,\x22binding\x22,539932593),datascript.parser.source(binding__$1)], null));
} else {
if((cljs.core.count(coll) \x3c cljs.core.count(binding__$1.bindings))){
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22Not enough elements in a collection \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([coll], 0)),\x22 to bind tuple \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([datascript.parser.source(binding__$1)], 0))].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22query\x22,\x22binding\x22,\x22query/binding\x22,698240489),new cljs.core.Keyword(null,\x22value\x22,\x22value\x22,305978217),coll,new cljs.core.Keyword(null,\x22binding\x22,\x22binding\x22,539932593),datascript.parser.source(binding__$1)], null));
} else {
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$2(datascript.query.prod_rel,cljs.core.map.cljs$core$IFn$_invoke$arity$3((function (p1__54881_SHARP_,p2__54882_SHARP_){
return datascript.query.in__GT_rel(p1__54881_SHARP_,p2__54882_SHARP_);
}),binding__$1.bindings,coll));

}
}
}));
datascript.query.resolve_in \x3d (function datascript$query$resolve_in(context,p__54885){
var vec__54886 \x3d p__54885;
var binding \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54886,(0),null);
var value \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54886,(1),null);
if((((binding instanceof datascript.parser.BindScalar)) \x26\x26 ((new cljs.core.Keyword(null,\x22variable\x22,\x22variable\x22,-281346492).cljs$core$IFn$_invoke$arity$1(binding) instanceof datascript.parser.SrcVar)))){
return cljs.core.update.cljs$core$IFn$_invoke$arity$5(context,new cljs.core.Keyword(null,\x22sources\x22,\x22sources\x22,-321166424),cljs.core.assoc,cljs.core.get_in.cljs$core$IFn$_invoke$arity$2(binding,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22variable\x22,\x22variable\x22,-281346492),new cljs.core.Keyword(null,\x22symbol\x22,\x22symbol\x22,-1038572696)], null)),value);
} else {
if((((binding instanceof datascript.parser.BindScalar)) \x26\x26 ((new cljs.core.Keyword(null,\x22variable\x22,\x22variable\x22,-281346492).cljs$core$IFn$_invoke$arity$1(binding) instanceof datascript.parser.RulesVar)))){
return cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(context,new cljs.core.Keyword(null,\x22rules\x22,\x22rules\x22,1198912366),datascript.query.parse_rules(value));
} else {
return cljs.core.update.cljs$core$IFn$_invoke$arity$4(context,new cljs.core.Keyword(null,\x22rels\x22,\x22rels\x22,1770187185),cljs.core.conj,datascript.query.in__GT_rel(binding,value));

}
}
});
datascript.query.resolve_ins \x3d (function datascript$query$resolve_ins(context,bindings,values){
var cb \x3d cljs.core.count(bindings);
var cv \x3d cljs.core.count(values);
if((cb \x3c cv)){
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22Extra inputs passed, expected: \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([cljs.core.mapv.cljs$core$IFn$_invoke$arity$2((function (p1__54890_SHARP_){
return new cljs.core.Keyword(null,\x22source\x22,\x22source\x22,-433931539).cljs$core$IFn$_invoke$arity$1(cljs.core.meta(p1__54890_SHARP_));
}),bindings)], 0)),\x22, got: \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([cv], 0))].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22query\x22,\x22inputs\x22,\x22query/inputs\x22,1042810394),new cljs.core.Keyword(null,\x22expected\x22,\x22expected\x22,1583670997),bindings,new cljs.core.Keyword(null,\x22got\x22,\x22got\x22,-1674745710),values], null));
} else {
if((cb \x3e cv)){
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22Too few inputs passed, expected: \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([cljs.core.mapv.cljs$core$IFn$_invoke$arity$2((function (p1__54891_SHARP_){
return new cljs.core.Keyword(null,\x22source\x22,\x22source\x22,-433931539).cljs$core$IFn$_invoke$arity$1(cljs.core.meta(p1__54891_SHARP_));
}),bindings)], 0)),\x22, got: \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([cv], 0))].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22query\x22,\x22inputs\x22,\x22query/inputs\x22,1042810394),new cljs.core.Keyword(null,\x22expected\x22,\x22expected\x22,1583670997),bindings,new cljs.core.Keyword(null,\x22got\x22,\x22got\x22,-1674745710),values], null));
} else {
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(datascript.query.resolve_in,context,cljs.core.zipmap(bindings,values));

}
}
});
/**
 * List of symbols in current pattern that might potentiall be resolved to refs
 */
datascript.query._STAR_lookup_attrs_STAR_ \x3d null;
/**
 * Default pattern source. Lookup refs, patterns, rules will be resolved with it
 */
datascript.query._STAR_implicit_source_STAR_ \x3d null;
datascript.query.getter_fn \x3d (function datascript$query$getter_fn(attrs,attr){
var idx \x3d (attrs.cljs$core$IFn$_invoke$arity$1 ? attrs.cljs$core$IFn$_invoke$arity$1(attr) : attrs.call(null,attr));
if(cljs.core.contains_QMARK_(datascript.query._STAR_lookup_attrs_STAR_,attr)){
return (function (tuple){
var eid \x3d (tuple[idx]);
if(typeof eid \x3d\x3d\x3d \x27number\x27){
return eid;
} else {
if(cljs.core.sequential_QMARK_(eid)){
return datascript.db.entid(datascript.query._STAR_implicit_source_STAR_,eid);
} else {
if(me.tonsky.persistent_sorted_set.arrays.array_QMARK_(eid)){
return datascript.db.entid(datascript.query._STAR_implicit_source_STAR_,eid);
} else {
return eid;

}
}
}
});
} else {
return (function (tuple){
return (tuple[idx]);
});
}
});
datascript.query.tuple_key_fn \x3d (function datascript$query$tuple_key_fn(getters){
if((cljs.core.count(getters) \x3d\x3d\x3d (1))){
return cljs.core.first(getters);
} else {
var getters__$1 \x3d cljs.core.to_array(getters);
return (function (tuple){
return cljs.core.list_STAR_.cljs$core$IFn$_invoke$arity$1(getters__$1.map((function (p1__54893_SHARP_){
return (p1__54893_SHARP_.cljs$core$IFn$_invoke$arity$1 ? p1__54893_SHARP_.cljs$core$IFn$_invoke$arity$1(tuple) : p1__54893_SHARP_.call(null,tuple));
})));
});
}
});
datascript.query.hash_attrs \x3d (function datascript$query$hash_attrs(key_fn,tuples){
var tuples__$1 \x3d tuples;
var hash_table \x3d cljs.core.transient$(cljs.core.PersistentArrayMap.EMPTY);
while(true){
var temp__5806__auto__ \x3d cljs.core.first(tuples__$1);
if((temp__5806__auto__ \x3d\x3d null)){
return cljs.core.persistent_BANG_(hash_table);
} else {
var tuple \x3d temp__5806__auto__;
var key \x3d (key_fn.cljs$core$IFn$_invoke$arity$1 ? key_fn.cljs$core$IFn$_invoke$arity$1(tuple) : key_fn.call(null,tuple));
var G__55276 \x3d cljs.core.next(tuples__$1);
var G__55277 \x3d cljs.core.assoc_BANG_.cljs$core$IFn$_invoke$arity$3(hash_table,key,cljs.core.conj.cljs$core$IFn$_invoke$arity$2(cljs.core.get.cljs$core$IFn$_invoke$arity$3(hash_table,key,cljs.core.List.EMPTY),tuple));
tuples__$1 \x3d G__55276;
hash_table \x3d G__55277;
continue;
}
break;
}
});
datascript.query.hash_join \x3d (function datascript$query$hash_join(rel1,rel2){
var tuples1 \x3d new cljs.core.Keyword(null,\x22tuples\x22,\x22tuples\x22,-676032639).cljs$core$IFn$_invoke$arity$1(rel1);
var tuples2 \x3d new cljs.core.Keyword(null,\x22tuples\x22,\x22tuples\x22,-676032639).cljs$core$IFn$_invoke$arity$1(rel2);
var attrs1 \x3d new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713).cljs$core$IFn$_invoke$arity$1(rel1);
var attrs2 \x3d new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713).cljs$core$IFn$_invoke$arity$1(rel2);
var common_attrs \x3d cljs.core.vec(datascript.query.intersect_keys(new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713).cljs$core$IFn$_invoke$arity$1(rel1),new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713).cljs$core$IFn$_invoke$arity$1(rel2)));
var common_gtrs1 \x3d cljs.core.map.cljs$core$IFn$_invoke$arity$2((function (p1__54896_SHARP_){
return datascript.query.getter_fn(attrs1,p1__54896_SHARP_);
}),common_attrs);
var common_gtrs2 \x3d cljs.core.map.cljs$core$IFn$_invoke$arity$2((function (p1__54897_SHARP_){
return datascript.query.getter_fn(attrs2,p1__54897_SHARP_);
}),common_attrs);
var keep_attrs1 \x3d cljs.core.keys(attrs1);
var keep_attrs2 \x3d cljs.core.vec(clojure.set.difference.cljs$core$IFn$_invoke$arity$2(cljs.core.set(cljs.core.keys(attrs2)),cljs.core.set(cljs.core.keys(attrs1))));
var keep_idxs1 \x3d cljs.core.to_array(cljs.core.map.cljs$core$IFn$_invoke$arity$2(attrs1,keep_attrs1));
var keep_idxs2 \x3d cljs.core.to_array(cljs.core.map.cljs$core$IFn$_invoke$arity$2(attrs2,keep_attrs2));
var key_fn1 \x3d datascript.query.tuple_key_fn(common_gtrs1);
var hash \x3d datascript.query.hash_attrs(key_fn1,tuples1);
var key_fn2 \x3d datascript.query.tuple_key_fn(common_gtrs2);
var new_tuples \x3d cljs.core.persistent_BANG_(cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (acc,tuple2){
var key \x3d (key_fn2.cljs$core$IFn$_invoke$arity$1 ? key_fn2.cljs$core$IFn$_invoke$arity$1(tuple2) : key_fn2.call(null,tuple2));
var temp__5806__auto__ \x3d cljs.core.get.cljs$core$IFn$_invoke$arity$2(hash,key);
if((temp__5806__auto__ \x3d\x3d null)){
return acc;
} else {
var tuples1__$1 \x3d temp__5806__auto__;
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (acc__$1,tuple1){
return cljs.core.conj_BANG_.cljs$core$IFn$_invoke$arity$2(acc__$1,datascript.query.join_tuples(tuple1,keep_idxs1,tuple2,keep_idxs2));
}),acc,tuples1__$1);
}
}),cljs.core.transient$(cljs.core.PersistentVector.EMPTY),tuples2));
return (new datascript.query.Relation(cljs.core.zipmap(cljs.core.concat.cljs$core$IFn$_invoke$arity$2(keep_attrs1,keep_attrs2),cljs.core.range.cljs$core$IFn$_invoke$arity$0()),new_tuples,null,null,null));
});
datascript.query.subtract_rel \x3d (function datascript$query$subtract_rel(a,b){
var map__54902 \x3d a;
var map__54902__$1 \x3d cljs.core.__destructure_map(map__54902);
var attrs_a \x3d cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__54902__$1,new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713));
var tuples_a \x3d cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__54902__$1,new cljs.core.Keyword(null,\x22tuples\x22,\x22tuples\x22,-676032639));
var map__54903 \x3d b;
var map__54903__$1 \x3d cljs.core.__destructure_map(map__54903);
var attrs_b \x3d cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__54903__$1,new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713));
var tuples_b \x3d cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__54903__$1,new cljs.core.Keyword(null,\x22tuples\x22,\x22tuples\x22,-676032639));
var attrs \x3d datascript.query.intersect_keys(attrs_a,attrs_b);
var getters_b \x3d cljs.core.map.cljs$core$IFn$_invoke$arity$2((function (p1__54899_SHARP_){
return datascript.query.getter_fn(attrs_b,p1__54899_SHARP_);
}),attrs);
var key_fn_b \x3d datascript.query.tuple_key_fn(getters_b);
var hash \x3d datascript.query.hash_attrs(key_fn_b,tuples_b);
var getters_a \x3d cljs.core.map.cljs$core$IFn$_invoke$arity$2((function (p1__54900_SHARP_){
return datascript.query.getter_fn(attrs_a,p1__54900_SHARP_);
}),attrs);
var key_fn_a \x3d datascript.query.tuple_key_fn(getters_a);
return cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(a,new cljs.core.Keyword(null,\x22tuples\x22,\x22tuples\x22,-676032639),cljs.core.filterv((function (p1__54901_SHARP_){
return ((function (){var G__54904 \x3d (key_fn_a.cljs$core$IFn$_invoke$arity$1 ? key_fn_a.cljs$core$IFn$_invoke$arity$1(p1__54901_SHARP_) : key_fn_a.call(null,p1__54901_SHARP_));
return (hash.cljs$core$IFn$_invoke$arity$1 ? hash.cljs$core$IFn$_invoke$arity$1(G__54904) : hash.call(null,G__54904));
})() \x3d\x3d null);
}),tuples_a));
});
datascript.query.lookup_pattern_db \x3d (function datascript$query$lookup_pattern_db(db,pattern){
var search_pattern \x3d cljs.core.mapv.cljs$core$IFn$_invoke$arity$2((function (p1__54905_SHARP_){
if(((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(p1__54905_SHARP_,new cljs.core.Symbol(null,\x22_\x22,\x22_\x22,-1201019570,null))) || (datascript.query.free_var_QMARK_(p1__54905_SHARP_)))){
return null;
} else {
return p1__54905_SHARP_;
}
}),pattern);
var datoms \x3d datascript.db._search(db,search_pattern);
var attr__GT_prop \x3d cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,cljs.core.filter.cljs$core$IFn$_invoke$arity$2((function (p__54906){
var vec__54907 \x3d p__54906;
var s \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54907,(0),null);
var _ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54907,(1),null);
return datascript.query.free_var_QMARK_(s);
}),cljs.core.map.cljs$core$IFn$_invoke$arity$3(cljs.core.vector,pattern,new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [\x22e\x22,\x22a\x22,\x22v\x22,\x22tx\x22], null))));
return (new datascript.query.Relation(attr__GT_prop,datoms,null,null,null));
});
datascript.query.matches_pattern_QMARK_ \x3d (function datascript$query$matches_pattern_QMARK_(pattern,tuple){
var tuple__$1 \x3d tuple;
var pattern__$1 \x3d pattern;
while(true){
if(cljs.core.truth_((function (){var and__5043__auto__ \x3d tuple__$1;
if(cljs.core.truth_(and__5043__auto__)){
return pattern__$1;
} else {
return and__5043__auto__;
}
})())){
var t \x3d cljs.core.first(tuple__$1);
var p \x3d cljs.core.first(pattern__$1);
if(((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(p,new cljs.core.Symbol(null,\x22_\x22,\x22_\x22,-1201019570,null))) || (((datascript.query.free_var_QMARK_(p)) || (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(t,p)))))){
var G__55280 \x3d cljs.core.next(tuple__$1);
var G__55281 \x3d cljs.core.next(pattern__$1);
tuple__$1 \x3d G__55280;
pattern__$1 \x3d G__55281;
continue;
} else {
return false;
}
} else {
return true;
}
break;
}
});
datascript.query.lookup_pattern_coll \x3d (function datascript$query$lookup_pattern_coll(coll,pattern){
var data \x3d cljs.core.filter.cljs$core$IFn$_invoke$arity$2((function (p1__54911_SHARP_){
return datascript.query.matches_pattern_QMARK_(pattern,p1__54911_SHARP_);
}),coll);
var attr__GT_idx \x3d cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,cljs.core.filter.cljs$core$IFn$_invoke$arity$2((function (p__54913){
var vec__54914 \x3d p__54913;
var s \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54914,(0),null);
var _ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54914,(1),null);
return datascript.query.free_var_QMARK_(s);
}),cljs.core.map.cljs$core$IFn$_invoke$arity$3(cljs.core.vector,pattern,cljs.core.range.cljs$core$IFn$_invoke$arity$0())));
return (new datascript.query.Relation(attr__GT_idx,cljs.core.mapv.cljs$core$IFn$_invoke$arity$2(cljs.core.to_array,data),null,null,null));
});
datascript.query.normalize_pattern_clause \x3d (function datascript$query$normalize_pattern_clause(clause){
if(datascript.query.source_QMARK_(cljs.core.first(clause))){
return clause;
} else {
return cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22$\x22,\x22$\x22,-1580747756,null)], null),clause);
}
});
datascript.query.lookup_pattern \x3d (function datascript$query$lookup_pattern(source,pattern){
if((((!((source \x3d\x3d null))))?((((false) || ((cljs.core.PROTOCOL_SENTINEL \x3d\x3d\x3d source.datascript$db$ISearch$))))?true:(((!source.cljs$lang$protocol_mask$partition$))?cljs.core.native_satisfies_QMARK_(datascript.db.ISearch,source):false)):cljs.core.native_satisfies_QMARK_(datascript.db.ISearch,source))){
return datascript.query.lookup_pattern_db(source,pattern);
} else {
return datascript.query.lookup_pattern_coll(source,pattern);

}
});
datascript.query.collapse_rels \x3d (function datascript$query$collapse_rels(rels,new_rel){
var rels__$1 \x3d rels;
var new_rel__$1 \x3d new_rel;
var acc \x3d cljs.core.PersistentVector.EMPTY;
while(true){
var temp__5806__auto__ \x3d cljs.core.first(rels__$1);
if((temp__5806__auto__ \x3d\x3d null)){
return cljs.core.conj.cljs$core$IFn$_invoke$arity$2(acc,new_rel__$1);
} else {
var rel \x3d temp__5806__auto__;
if(cljs.core.truth_(cljs.core.not_empty(datascript.query.intersect_keys(new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713).cljs$core$IFn$_invoke$arity$1(new_rel__$1),new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713).cljs$core$IFn$_invoke$arity$1(rel))))){
var G__55289 \x3d cljs.core.next(rels__$1);
var G__55290 \x3d datascript.query.hash_join(rel,new_rel__$1);
var G__55291 \x3d acc;
rels__$1 \x3d G__55289;
new_rel__$1 \x3d G__55290;
acc \x3d G__55291;
continue;
} else {
var G__55292 \x3d cljs.core.next(rels__$1);
var G__55293 \x3d new_rel__$1;
var G__55294 \x3d cljs.core.conj.cljs$core$IFn$_invoke$arity$2(acc,rel);
rels__$1 \x3d G__55292;
new_rel__$1 \x3d G__55293;
acc \x3d G__55294;
continue;
}
}
break;
}
});
datascript.query.rel_with_attr \x3d (function datascript$query$rel_with_attr(context,sym){
return cljs.core.some((function (p1__54919_SHARP_){
if(cljs.core.contains_QMARK_(new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713).cljs$core$IFn$_invoke$arity$1(p1__54919_SHARP_),sym)){
return p1__54919_SHARP_;
} else {
return null;
}
}),new cljs.core.Keyword(null,\x22rels\x22,\x22rels\x22,1770187185).cljs$core$IFn$_invoke$arity$1(context));
});
datascript.query.context_resolve_val \x3d (function datascript$query$context_resolve_val(context,sym){
var temp__5808__auto__ \x3d datascript.query.rel_with_attr(context,sym);
if((temp__5808__auto__ \x3d\x3d null)){
return null;
} else {
var rel \x3d temp__5808__auto__;
var temp__5808__auto____$1 \x3d cljs.core.first(new cljs.core.Keyword(null,\x22tuples\x22,\x22tuples\x22,-676032639).cljs$core$IFn$_invoke$arity$1(rel));
if((temp__5808__auto____$1 \x3d\x3d null)){
return null;
} else {
var tuple \x3d temp__5808__auto____$1;
return (tuple[(function (){var fexpr__54921 \x3d new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713).cljs$core$IFn$_invoke$arity$1(rel);
return (fexpr__54921.cljs$core$IFn$_invoke$arity$1 ? fexpr__54921.cljs$core$IFn$_invoke$arity$1(sym) : fexpr__54921.call(null,sym));
})()]);
}
}
});
datascript.query.rel_contains_attrs_QMARK_ \x3d (function datascript$query$rel_contains_attrs_QMARK_(rel,attrs){
return cljs.core.some((function (p1__54922_SHARP_){
return cljs.core.contains_QMARK_(new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713).cljs$core$IFn$_invoke$arity$1(rel),p1__54922_SHARP_);
}),attrs);
});
datascript.query.rel_prod_by_attrs \x3d (function datascript$query$rel_prod_by_attrs(context,attrs){
var rels \x3d cljs.core.filter.cljs$core$IFn$_invoke$arity$2((function (p1__54923_SHARP_){
return datascript.query.rel_contains_attrs_QMARK_(p1__54923_SHARP_,attrs);
}),new cljs.core.Keyword(null,\x22rels\x22,\x22rels\x22,1770187185).cljs$core$IFn$_invoke$arity$1(context));
var production \x3d cljs.core.reduce.cljs$core$IFn$_invoke$arity$2(datascript.query.prod_rel,rels);
return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.update.cljs$core$IFn$_invoke$arity$3(context,new cljs.core.Keyword(null,\x22rels\x22,\x22rels\x22,1770187185),(function (p1__54924_SHARP_){
return cljs.core.remove.cljs$core$IFn$_invoke$arity$2(cljs.core.set(rels),p1__54924_SHARP_);
})),production], null);
});
datascript.query._call_fn \x3d (function datascript$query$_call_fn(context,rel,f,args){
var sources \x3d new cljs.core.Keyword(null,\x22sources\x22,\x22sources\x22,-321166424).cljs$core$IFn$_invoke$arity$1(context);
var attrs \x3d new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713).cljs$core$IFn$_invoke$arity$1(rel);
var len \x3d cljs.core.count(args);
var static_args \x3d me.tonsky.persistent_sorted_set.arrays.make_array(len);
var tuples_args \x3d me.tonsky.persistent_sorted_set.arrays.make_array(len);
var n__5636__auto___55302 \x3d len;
var i_55303 \x3d (0);
while(true){
if((i_55303 \x3c n__5636__auto___55302)){
var arg_55304 \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$2(args,i_55303);
if((arg_55304 instanceof cljs.core.Symbol)){
var temp__5806__auto___55308 \x3d cljs.core.get.cljs$core$IFn$_invoke$arity$2(sources,arg_55304);
if((temp__5806__auto___55308 \x3d\x3d null)){
(tuples_args[i_55303] \x3d cljs.core.get.cljs$core$IFn$_invoke$arity$2(attrs,arg_55304));
} else {
var source_55309 \x3d temp__5806__auto___55308;
(static_args[i_55303] \x3d source_55309);
}
} else {
(static_args[i_55303] \x3d arg_55304);
}

var G__55310 \x3d (i_55303 + (1));
i_55303 \x3d G__55310;
continue;
} else {
}
break;
}

if((f \x3d\x3d\x3d cljs.core.vector)){
return (function (tuple){
var args__$1 \x3d me.tonsky.persistent_sorted_set.arrays.aclone(static_args);
var n__5636__auto___55311 \x3d len;
var i_55312 \x3d (0);
while(true){
if((i_55312 \x3c n__5636__auto___55311)){
var temp__5808__auto___55313 \x3d (tuples_args[i_55312]);
if((temp__5808__auto___55313 \x3d\x3d null)){
} else {
var tuple_idx_55314 \x3d temp__5808__auto___55313;
var v_55315 \x3d (tuple[tuple_idx_55314]);
(args__$1[i_55312] \x3d v_55315);
}

var G__55319 \x3d (i_55312 + (1));
i_55312 \x3d G__55319;
continue;
} else {
}
break;
}

return cljs.core.apply.cljs$core$IFn$_invoke$arity$2(f,args__$1);
});
} else {
return (function (tuple){
var n__5636__auto___55320 \x3d len;
var i_55321 \x3d (0);
while(true){
if((i_55321 \x3c n__5636__auto___55320)){
var temp__5808__auto___55322 \x3d (tuples_args[i_55321]);
if((temp__5808__auto___55322 \x3d\x3d null)){
} else {
var tuple_idx_55323 \x3d temp__5808__auto___55322;
var v_55324 \x3d (tuple[tuple_idx_55323]);
(static_args[i_55321] \x3d v_55324);
}

var G__55325 \x3d (i_55321 + (1));
i_55321 \x3d G__55325;
continue;
} else {
}
break;
}

return cljs.core.apply.cljs$core$IFn$_invoke$arity$2(f,static_args);
});
}
});
datascript.query.resolve_sym \x3d (function datascript$query$resolve_sym(sym){
return null;
});
datascript.query.filter_by_pred \x3d (function datascript$query$filter_by_pred(context,clause){
var vec__54928 \x3d clause;
var vec__54931 \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54928,(0),null);
var seq__54932 \x3d cljs.core.seq(vec__54931);
var first__54933 \x3d cljs.core.first(seq__54932);
var seq__54932__$1 \x3d cljs.core.next(seq__54932);
var f \x3d first__54933;
var args \x3d seq__54932__$1;
var pred \x3d (function (){var or__5045__auto__ \x3d cljs.core.get.cljs$core$IFn$_invoke$arity$2(datascript.built_ins.query_fns,f);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
var or__5045__auto____$1 \x3d datascript.query.context_resolve_val(context,f);
if(cljs.core.truth_(or__5045__auto____$1)){
return or__5045__auto____$1;
} else {
var or__5045__auto____$2 \x3d datascript.query.resolve_sym(f);
if(cljs.core.truth_(or__5045__auto____$2)){
return or__5045__auto____$2;
} else {
if((datascript.query.rel_with_attr(context,f) \x3d\x3d null)){
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22Unknown predicate \x27\x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([f], 0)),\x22 in \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([clause], 0))].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22query\x22,\x22where\x22,\x22query/where\x22,-1935159429),new cljs.core.Keyword(null,\x22form\x22,\x22form\x22,-1624062471),clause,new cljs.core.Keyword(null,\x22var\x22,\x22var\x22,-769682797),f], null));
} else {
return null;
}
}
}
}
})();
var vec__54934 \x3d datascript.query.rel_prod_by_attrs(context,cljs.core.filter.cljs$core$IFn$_invoke$arity$2(cljs.core.symbol_QMARK_,args));
var context__$1 \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54934,(0),null);
var production \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54934,(1),null);
var new_rel \x3d (cljs.core.truth_(pred)?(function (){var tuple_pred \x3d datascript.query._call_fn(context__$1,production,pred,args);
return cljs.core.update.cljs$core$IFn$_invoke$arity$3(production,new cljs.core.Keyword(null,\x22tuples\x22,\x22tuples\x22,-676032639),(function (p1__54927_SHARP_){
return cljs.core.filter.cljs$core$IFn$_invoke$arity$2(tuple_pred,p1__54927_SHARP_);
}));
})():cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(production,new cljs.core.Keyword(null,\x22tuples\x22,\x22tuples\x22,-676032639),cljs.core.PersistentVector.EMPTY));
return cljs.core.update.cljs$core$IFn$_invoke$arity$4(context__$1,new cljs.core.Keyword(null,\x22rels\x22,\x22rels\x22,1770187185),cljs.core.conj,new_rel);
});
datascript.query.bind_by_fn \x3d (function datascript$query$bind_by_fn(context,clause){
var vec__54938 \x3d clause;
var vec__54941 \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54938,(0),null);
var seq__54942 \x3d cljs.core.seq(vec__54941);
var first__54943 \x3d cljs.core.first(seq__54942);
var seq__54942__$1 \x3d cljs.core.next(seq__54942);
var f \x3d first__54943;
var args \x3d seq__54942__$1;
var out \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54938,(1),null);
var binding \x3d datascript.parser.parse_binding(out);
var fun \x3d (function (){var or__5045__auto__ \x3d cljs.core.get.cljs$core$IFn$_invoke$arity$2(datascript.built_ins.query_fns,f);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
var or__5045__auto____$1 \x3d datascript.query.context_resolve_val(context,f);
if(cljs.core.truth_(or__5045__auto____$1)){
return or__5045__auto____$1;
} else {
var or__5045__auto____$2 \x3d datascript.query.resolve_sym(f);
if(cljs.core.truth_(or__5045__auto____$2)){
return or__5045__auto____$2;
} else {
if((datascript.query.rel_with_attr(context,f) \x3d\x3d null)){
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22Unknown function \x27\x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([f], 0)),\x22 in \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([clause], 0))].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22query\x22,\x22where\x22,\x22query/where\x22,-1935159429),new cljs.core.Keyword(null,\x22form\x22,\x22form\x22,-1624062471),clause,new cljs.core.Keyword(null,\x22var\x22,\x22var\x22,-769682797),f], null));
} else {
return null;
}
}
}
}
})();
var vec__54944 \x3d datascript.query.rel_prod_by_attrs(context,cljs.core.filter.cljs$core$IFn$_invoke$arity$2(cljs.core.symbol_QMARK_,args));
var context__$1 \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54944,(0),null);
var production \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54944,(1),null);
var new_rel \x3d (cljs.core.truth_(fun)?(function (){var tuple_fn \x3d datascript.query._call_fn(context__$1,production,fun,args);
var rels \x3d (function (){var iter__5523__auto__ \x3d (function datascript$query$bind_by_fn_$_iter__54948(s__54949){
return (new cljs.core.LazySeq(null,(function (){
var s__54949__$1 \x3d s__54949;
while(true){
var temp__5804__auto__ \x3d cljs.core.seq(s__54949__$1);
if(temp__5804__auto__){
var s__54949__$2 \x3d temp__5804__auto__;
if(cljs.core.chunked_seq_QMARK_(s__54949__$2)){
var c__5521__auto__ \x3d cljs.core.chunk_first(s__54949__$2);
var size__5522__auto__ \x3d cljs.core.count(c__5521__auto__);
var b__54951 \x3d cljs.core.chunk_buffer(size__5522__auto__);
if((function (){var i__54950 \x3d (0);
while(true){
if((i__54950 \x3c size__5522__auto__)){
var tuple \x3d cljs.core._nth(c__5521__auto__,i__54950);
var val \x3d tuple_fn(tuple);
if((!((val \x3d\x3d null)))){
cljs.core.chunk_append(b__54951,datascript.query.prod_rel.cljs$core$IFn$_invoke$arity$2((new datascript.query.Relation(new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713).cljs$core$IFn$_invoke$arity$1(production),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [tuple], null),null,null,null)),datascript.query.in__GT_rel(binding,val)));

var G__55340 \x3d (i__54950 + (1));
i__54950 \x3d G__55340;
continue;
} else {
var G__55341 \x3d (i__54950 + (1));
i__54950 \x3d G__55341;
continue;
}
} else {
return true;
}
break;
}
})()){
return cljs.core.chunk_cons(cljs.core.chunk(b__54951),datascript$query$bind_by_fn_$_iter__54948(cljs.core.chunk_rest(s__54949__$2)));
} else {
return cljs.core.chunk_cons(cljs.core.chunk(b__54951),null);
}
} else {
var tuple \x3d cljs.core.first(s__54949__$2);
var val \x3d tuple_fn(tuple);
if((!((val \x3d\x3d null)))){
return cljs.core.cons(datascript.query.prod_rel.cljs$core$IFn$_invoke$arity$2((new datascript.query.Relation(new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713).cljs$core$IFn$_invoke$arity$1(production),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [tuple], null),null,null,null)),datascript.query.in__GT_rel(binding,val)),datascript$query$bind_by_fn_$_iter__54948(cljs.core.rest(s__54949__$2)));
} else {
var G__55346 \x3d cljs.core.rest(s__54949__$2);
s__54949__$1 \x3d G__55346;
continue;
}
}
} else {
return null;
}
break;
}
}),null,null));
});
return iter__5523__auto__(new cljs.core.Keyword(null,\x22tuples\x22,\x22tuples\x22,-676032639).cljs$core$IFn$_invoke$arity$1(production));
})();
if(cljs.core.empty_QMARK_(rels)){
return datascript.query.prod_rel.cljs$core$IFn$_invoke$arity$2(production,datascript.query.empty_rel(binding));
} else {
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$2(datascript.query.sum_rel,rels);
}
})():datascript.query.prod_rel.cljs$core$IFn$_invoke$arity$2(cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(production,new cljs.core.Keyword(null,\x22tuples\x22,\x22tuples\x22,-676032639),cljs.core.PersistentVector.EMPTY),datascript.query.empty_rel(binding)));
return cljs.core.update.cljs$core$IFn$_invoke$arity$4(context__$1,new cljs.core.Keyword(null,\x22rels\x22,\x22rels\x22,1770187185),datascript.query.collapse_rels,new_rel);
});
datascript.query.rule_QMARK_ \x3d (function datascript$query$rule_QMARK_(context,clause){
if((!(cljs.core.sequential_QMARK_(clause)))){
return false;
} else {
var head \x3d ((datascript.query.source_QMARK_(cljs.core.first(clause)))?cljs.core.second(clause):cljs.core.first(clause));
if((!((head instanceof cljs.core.Symbol)))){
return false;
} else {
if(datascript.query.free_var_QMARK_(head)){
return false;
} else {
if(cljs.core.contains_QMARK_(new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 6, [new cljs.core.Symbol(null,\x22and\x22,\x22and\x22,668631710,null),null,new cljs.core.Symbol(null,\x22not\x22,\x22not\x22,1044554643,null),null,new cljs.core.Symbol(null,\x22not-join\x22,\x22not-join\x22,-645515756,null),null,new cljs.core.Symbol(null,\x22or-join\x22,\x22or-join\x22,591375469,null),null,new cljs.core.Symbol(null,\x22or\x22,\x22or\x22,1876275696,null),null,new cljs.core.Symbol(null,\x22_\x22,\x22_\x22,-1201019570,null),null], null), null),head)){
return false;
} else {
if((!(cljs.core.contains_QMARK_(new cljs.core.Keyword(null,\x22rules\x22,\x22rules\x22,1198912366).cljs$core$IFn$_invoke$arity$1(context),head)))){
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22Unknown rule \x27\x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([head], 0)),\x22 in \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([clause], 0))].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22query\x22,\x22where\x22,\x22query/where\x22,-1935159429),new cljs.core.Keyword(null,\x22form\x22,\x22form\x22,-1624062471),clause], null));
} else {
return true;

}
}
}
}
}
});
datascript.query.rule_seqid \x3d cljs.core.atom.cljs$core$IFn$_invoke$arity$1((0));
datascript.query.expand_rule \x3d (function datascript$query$expand_rule(clause,context,used_args){
var vec__54955 \x3d clause;
var seq__54956 \x3d cljs.core.seq(vec__54955);
var first__54957 \x3d cljs.core.first(seq__54956);
var seq__54956__$1 \x3d cljs.core.next(seq__54956);
var rule \x3d first__54957;
var call_args \x3d seq__54956__$1;
var seqid \x3d cljs.core.swap_BANG_.cljs$core$IFn$_invoke$arity$2(datascript.query.rule_seqid,cljs.core.inc);
var branches \x3d cljs.core.get.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22rules\x22,\x22rules\x22,1198912366).cljs$core$IFn$_invoke$arity$1(context),rule);
var iter__5523__auto__ \x3d (function datascript$query$expand_rule_$_iter__54958(s__54959){
return (new cljs.core.LazySeq(null,(function (){
var s__54959__$1 \x3d s__54959;
while(true){
var temp__5804__auto__ \x3d cljs.core.seq(s__54959__$1);
if(temp__5804__auto__){
var s__54959__$2 \x3d temp__5804__auto__;
if(cljs.core.chunked_seq_QMARK_(s__54959__$2)){
var c__5521__auto__ \x3d cljs.core.chunk_first(s__54959__$2);
var size__5522__auto__ \x3d cljs.core.count(c__5521__auto__);
var b__54961 \x3d cljs.core.chunk_buffer(size__5522__auto__);
if((function (){var i__54960 \x3d (0);
while(true){
if((i__54960 \x3c size__5522__auto__)){
var branch \x3d cljs.core._nth(c__5521__auto__,i__54960);
var vec__54962 \x3d branch;
var seq__54963 \x3d cljs.core.seq(vec__54962);
var first__54964 \x3d cljs.core.first(seq__54963);
var seq__54963__$1 \x3d cljs.core.next(seq__54963);
var vec__54965 \x3d first__54964;
var seq__54966 \x3d cljs.core.seq(vec__54965);
var first__54967 \x3d cljs.core.first(seq__54966);
var seq__54966__$1 \x3d cljs.core.next(seq__54966);
var _ \x3d first__54967;
var rule_args \x3d seq__54966__$1;
var clauses \x3d seq__54963__$1;
var replacements \x3d cljs.core.zipmap(rule_args,call_args);
cljs.core.chunk_append(b__54961,clojure.walk.postwalk(((function (i__54960,vec__54962,seq__54963,first__54964,seq__54963__$1,vec__54965,seq__54966,first__54967,seq__54966__$1,_,rule_args,clauses,replacements,branch,c__5521__auto__,size__5522__auto__,b__54961,s__54959__$2,temp__5804__auto__,vec__54955,seq__54956,first__54957,seq__54956__$1,rule,call_args,seqid,branches){
return (function (p1__54954_SHARP_){
if(datascript.query.free_var_QMARK_(p1__54954_SHARP_)){
var x__51072__auto__ \x3d (replacements.cljs$core$IFn$_invoke$arity$1 ? replacements.cljs$core$IFn$_invoke$arity$1(p1__54954_SHARP_) : replacements.call(null,p1__54954_SHARP_));
if((x__51072__auto__ \x3d\x3d null)){
return cljs.core.symbol.cljs$core$IFn$_invoke$arity$1([cljs.core.name(p1__54954_SHARP_),\x22__auto__\x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1(seqid)].join(\x27\x27));
} else {
return x__51072__auto__;
}
} else {
return p1__54954_SHARP_;
}
});})(i__54960,vec__54962,seq__54963,first__54964,seq__54963__$1,vec__54965,seq__54966,first__54967,seq__54966__$1,_,rule_args,clauses,replacements,branch,c__5521__auto__,size__5522__auto__,b__54961,s__54959__$2,temp__5804__auto__,vec__54955,seq__54956,first__54957,seq__54956__$1,rule,call_args,seqid,branches))
,clauses));

var G__55352 \x3d (i__54960 + (1));
i__54960 \x3d G__55352;
continue;
} else {
return true;
}
break;
}
})()){
return cljs.core.chunk_cons(cljs.core.chunk(b__54961),datascript$query$expand_rule_$_iter__54958(cljs.core.chunk_rest(s__54959__$2)));
} else {
return cljs.core.chunk_cons(cljs.core.chunk(b__54961),null);
}
} else {
var branch \x3d cljs.core.first(s__54959__$2);
var vec__54969 \x3d branch;
var seq__54970 \x3d cljs.core.seq(vec__54969);
var first__54971 \x3d cljs.core.first(seq__54970);
var seq__54970__$1 \x3d cljs.core.next(seq__54970);
var vec__54972 \x3d first__54971;
var seq__54973 \x3d cljs.core.seq(vec__54972);
var first__54974 \x3d cljs.core.first(seq__54973);
var seq__54973__$1 \x3d cljs.core.next(seq__54973);
var _ \x3d first__54974;
var rule_args \x3d seq__54973__$1;
var clauses \x3d seq__54970__$1;
var replacements \x3d cljs.core.zipmap(rule_args,call_args);
return cljs.core.cons(clojure.walk.postwalk(((function (vec__54969,seq__54970,first__54971,seq__54970__$1,vec__54972,seq__54973,first__54974,seq__54973__$1,_,rule_args,clauses,replacements,branch,s__54959__$2,temp__5804__auto__,vec__54955,seq__54956,first__54957,seq__54956__$1,rule,call_args,seqid,branches){
return (function (p1__54954_SHARP_){
if(datascript.query.free_var_QMARK_(p1__54954_SHARP_)){
var x__51072__auto__ \x3d (replacements.cljs$core$IFn$_invoke$arity$1 ? replacements.cljs$core$IFn$_invoke$arity$1(p1__54954_SHARP_) : replacements.call(null,p1__54954_SHARP_));
if((x__51072__auto__ \x3d\x3d null)){
return cljs.core.symbol.cljs$core$IFn$_invoke$arity$1([cljs.core.name(p1__54954_SHARP_),\x22__auto__\x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1(seqid)].join(\x27\x27));
} else {
return x__51072__auto__;
}
} else {
return p1__54954_SHARP_;
}
});})(vec__54969,seq__54970,first__54971,seq__54970__$1,vec__54972,seq__54973,first__54974,seq__54973__$1,_,rule_args,clauses,replacements,branch,s__54959__$2,temp__5804__auto__,vec__54955,seq__54956,first__54957,seq__54956__$1,rule,call_args,seqid,branches))
,clauses),datascript$query$expand_rule_$_iter__54958(cljs.core.rest(s__54959__$2)));
}
} else {
return null;
}
break;
}
}),null,null));
});
return iter__5523__auto__(branches);
});
datascript.query.remove_pairs \x3d (function datascript$query$remove_pairs(xs,ys){
var pairs \x3d cljs.core.remove.cljs$core$IFn$_invoke$arity$2((function (p__54976){
var vec__54977 \x3d p__54976;
var x \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54977,(0),null);
var y \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54977,(1),null);
return cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(x,y);
}),cljs.core.map.cljs$core$IFn$_invoke$arity$3(cljs.core.vector,xs,ys));
return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.map.cljs$core$IFn$_invoke$arity$2(cljs.core.first,pairs),cljs.core.map.cljs$core$IFn$_invoke$arity$2(cljs.core.second,pairs)], null);
});
datascript.query.rule_gen_guards \x3d (function datascript$query$rule_gen_guards(rule_clause,used_args){
var vec__54980 \x3d rule_clause;
var seq__54981 \x3d cljs.core.seq(vec__54980);
var first__54982 \x3d cljs.core.first(seq__54981);
var seq__54981__$1 \x3d cljs.core.next(seq__54981);
var rule \x3d first__54982;
var call_args \x3d seq__54981__$1;
var prev_call_args \x3d cljs.core.get.cljs$core$IFn$_invoke$arity$2(used_args,rule);
var iter__5523__auto__ \x3d (function datascript$query$rule_gen_guards_$_iter__54983(s__54984){
return (new cljs.core.LazySeq(null,(function (){
var s__54984__$1 \x3d s__54984;
while(true){
var temp__5804__auto__ \x3d cljs.core.seq(s__54984__$1);
if(temp__5804__auto__){
var s__54984__$2 \x3d temp__5804__auto__;
if(cljs.core.chunked_seq_QMARK_(s__54984__$2)){
var c__5521__auto__ \x3d cljs.core.chunk_first(s__54984__$2);
var size__5522__auto__ \x3d cljs.core.count(c__5521__auto__);
var b__54986 \x3d cljs.core.chunk_buffer(size__5522__auto__);
if((function (){var i__54985 \x3d (0);
while(true){
if((i__54985 \x3c size__5522__auto__)){
var prev_args \x3d cljs.core._nth(c__5521__auto__,i__54985);
var vec__54988 \x3d datascript.query.remove_pairs(call_args,prev_args);
var call_args__$1 \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54988,(0),null);
var prev_args__$1 \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54988,(1),null);
cljs.core.chunk_append(b__54986,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.concat.cljs$core$IFn$_invoke$arity$variadic(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22-differ?\x22,\x22-differ?\x22,1465687357,null)], null),call_args__$1,cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([prev_args__$1], 0))], null));

var G__55360 \x3d (i__54985 + (1));
i__54985 \x3d G__55360;
continue;
} else {
return true;
}
break;
}
})()){
return cljs.core.chunk_cons(cljs.core.chunk(b__54986),datascript$query$rule_gen_guards_$_iter__54983(cljs.core.chunk_rest(s__54984__$2)));
} else {
return cljs.core.chunk_cons(cljs.core.chunk(b__54986),null);
}
} else {
var prev_args \x3d cljs.core.first(s__54984__$2);
var vec__54991 \x3d datascript.query.remove_pairs(call_args,prev_args);
var call_args__$1 \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54991,(0),null);
var prev_args__$1 \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54991,(1),null);
return cljs.core.cons(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.concat.cljs$core$IFn$_invoke$arity$variadic(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22-differ?\x22,\x22-differ?\x22,1465687357,null)], null),call_args__$1,cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([prev_args__$1], 0))], null),datascript$query$rule_gen_guards_$_iter__54983(cljs.core.rest(s__54984__$2)));
}
} else {
return null;
}
break;
}
}),null,null));
});
return iter__5523__auto__(prev_call_args);
});
datascript.query.walk_collect \x3d (function datascript$query$walk_collect(form,pred){
var res \x3d cljs.core.atom.cljs$core$IFn$_invoke$arity$1(cljs.core.PersistentVector.EMPTY);
clojure.walk.postwalk((function (p1__54994_SHARP_){
if(cljs.core.truth_((pred.cljs$core$IFn$_invoke$arity$1 ? pred.cljs$core$IFn$_invoke$arity$1(p1__54994_SHARP_) : pred.call(null,p1__54994_SHARP_)))){
cljs.core.swap_BANG_.cljs$core$IFn$_invoke$arity$3(res,cljs.core.conj,p1__54994_SHARP_);
} else {
}

return p1__54994_SHARP_;
}),form);

return cljs.core.deref(res);
});
datascript.query.collect_vars \x3d (function datascript$query$collect_vars(clause){
return cljs.core.set(datascript.query.walk_collect(clause,datascript.query.free_var_QMARK_));
});
datascript.query.split_guards \x3d (function datascript$query$split_guards(clauses,guards){
var bound_vars \x3d datascript.query.collect_vars(clauses);
var pred \x3d (function (p__54996){
var vec__54997 \x3d p__54996;
var vec__55000 \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__54997,(0),null);
var seq__55001 \x3d cljs.core.seq(vec__55000);
var first__55002 \x3d cljs.core.first(seq__55001);
var seq__55001__$1 \x3d cljs.core.next(seq__55001);
var _ \x3d first__55002;
var vars \x3d seq__55001__$1;
return cljs.core.every_QMARK_(bound_vars,vars);
});
return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.filter.cljs$core$IFn$_invoke$arity$2(pred,guards),cljs.core.remove.cljs$core$IFn$_invoke$arity$2(pred,guards)], null);
});
datascript.query.solve_rule \x3d (function datascript$query$solve_rule(context,clause){
var final_attrs \x3d cljs.core.filter.cljs$core$IFn$_invoke$arity$2(datascript.query.free_var_QMARK_,clause);
var final_attrs_map \x3d cljs.core.zipmap(final_attrs,cljs.core.range.cljs$core$IFn$_invoke$arity$0());
var solve \x3d (function (prefix_context,clauses){
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(datascript.query._resolve_clause,prefix_context,clauses);
});
var empty_rels_QMARK_ \x3d (function (context__$1){
return cljs.core.some((function (p1__55003_SHARP_){
return cljs.core.empty_QMARK_(new cljs.core.Keyword(null,\x22tuples\x22,\x22tuples\x22,-676032639).cljs$core$IFn$_invoke$arity$1(p1__55003_SHARP_));
}),new cljs.core.Keyword(null,\x22rels\x22,\x22rels\x22,1770187185).cljs$core$IFn$_invoke$arity$1(context__$1));
});
var stack \x3d (new cljs.core.List(null,new cljs.core.PersistentArrayMap(null, 5, [new cljs.core.Keyword(null,\x22prefix-clauses\x22,\x22prefix-clauses\x22,1294180028),cljs.core.PersistentVector.EMPTY,new cljs.core.Keyword(null,\x22prefix-context\x22,\x22prefix-context\x22,-1269613591),context,new cljs.core.Keyword(null,\x22clauses\x22,\x22clauses\x22,1454841241),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [clause], null),new cljs.core.Keyword(null,\x22used-args\x22,\x22used-args\x22,23596256),cljs.core.PersistentArrayMap.EMPTY,new cljs.core.Keyword(null,\x22pending-guards\x22,\x22pending-guards\x22,-1255527308),cljs.core.PersistentArrayMap.EMPTY], null),null,(1),null));
var rel \x3d (new datascript.query.Relation(final_attrs_map,cljs.core.PersistentVector.EMPTY,null,null,null));
while(true){
var temp__5806__auto__ \x3d cljs.core.first(stack);
if((temp__5806__auto__ \x3d\x3d null)){
return rel;
} else {
var frame \x3d temp__5806__auto__;
var vec__55023 \x3d cljs.core.split_with(((function (stack,rel,frame,temp__5806__auto__,final_attrs,final_attrs_map,solve,empty_rels_QMARK_){
return (function (p1__55004_SHARP_){
return (!(datascript.query.rule_QMARK_(context,p1__55004_SHARP_)));
});})(stack,rel,frame,temp__5806__auto__,final_attrs,final_attrs_map,solve,empty_rels_QMARK_))
,new cljs.core.Keyword(null,\x22clauses\x22,\x22clauses\x22,1454841241).cljs$core$IFn$_invoke$arity$1(frame));
var clauses \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__55023,(0),null);
var vec__55026 \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__55023,(1),null);
var seq__55027 \x3d cljs.core.seq(vec__55026);
var first__55028 \x3d cljs.core.first(seq__55027);
var seq__55027__$1 \x3d cljs.core.next(seq__55027);
var rule_clause \x3d first__55028;
var next_clauses \x3d seq__55027__$1;
if((rule_clause \x3d\x3d null)){
var context__$1 \x3d solve(new cljs.core.Keyword(null,\x22prefix-context\x22,\x22prefix-context\x22,-1269613591).cljs$core$IFn$_invoke$arity$1(frame),clauses);
var tuples \x3d (datascript.query._collect.cljs$core$IFn$_invoke$arity$2 ? datascript.query._collect.cljs$core$IFn$_invoke$arity$2(context__$1,final_attrs) : datascript.query._collect.call(null,context__$1,final_attrs));
var new_rel \x3d (new datascript.query.Relation(final_attrs_map,tuples,null,null,null));
var G__55372 \x3d cljs.core.next(stack);
var G__55373 \x3d datascript.query.sum_rel(rel,new_rel);
stack \x3d G__55372;
rel \x3d G__55373;
continue;
} else {
var vec__55029 \x3d rule_clause;
var seq__55030 \x3d cljs.core.seq(vec__55029);
var first__55031 \x3d cljs.core.first(seq__55030);
var seq__55030__$1 \x3d cljs.core.next(seq__55030);
var rule \x3d first__55031;
var call_args \x3d seq__55030__$1;
var guards \x3d datascript.query.rule_gen_guards(rule_clause,new cljs.core.Keyword(null,\x22used-args\x22,\x22used-args\x22,23596256).cljs$core$IFn$_invoke$arity$1(frame));
var vec__55032 \x3d datascript.query.split_guards(cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22prefix-clauses\x22,\x22prefix-clauses\x22,1294180028).cljs$core$IFn$_invoke$arity$1(frame),clauses),cljs.core.concat.cljs$core$IFn$_invoke$arity$2(guards,new cljs.core.Keyword(null,\x22pending-guards\x22,\x22pending-guards\x22,-1255527308).cljs$core$IFn$_invoke$arity$1(frame)));
var active_gs \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__55032,(0),null);
var pending_gs \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__55032,(1),null);
if(cljs.core.truth_(cljs.core.some(((function (stack,rel,vec__55029,seq__55030,first__55031,seq__55030__$1,rule,call_args,guards,vec__55032,active_gs,pending_gs,vec__55023,clauses,vec__55026,seq__55027,first__55028,seq__55027__$1,rule_clause,next_clauses,frame,temp__5806__auto__,final_attrs,final_attrs_map,solve,empty_rels_QMARK_){
return (function (p1__55005_SHARP_){
return cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(p1__55005_SHARP_,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.list(new cljs.core.Symbol(null,\x22-differ?\x22,\x22-differ?\x22,1465687357,null))], null));
});})(stack,rel,vec__55029,seq__55030,first__55031,seq__55030__$1,rule,call_args,guards,vec__55032,active_gs,pending_gs,vec__55023,clauses,vec__55026,seq__55027,first__55028,seq__55027__$1,rule_clause,next_clauses,frame,temp__5806__auto__,final_attrs,final_attrs_map,solve,empty_rels_QMARK_))
,active_gs))){
var G__55374 \x3d cljs.core.next(stack);
var G__55375 \x3d rel;
stack \x3d G__55374;
rel \x3d G__55375;
continue;
} else {
var prefix_clauses \x3d cljs.core.concat.cljs$core$IFn$_invoke$arity$2(clauses,active_gs);
var prefix_context \x3d solve(new cljs.core.Keyword(null,\x22prefix-context\x22,\x22prefix-context\x22,-1269613591).cljs$core$IFn$_invoke$arity$1(frame),prefix_clauses);
if(cljs.core.truth_(empty_rels_QMARK_(prefix_context))){
var G__55376 \x3d cljs.core.next(stack);
var G__55377 \x3d rel;
stack \x3d G__55376;
rel \x3d G__55377;
continue;
} else {
var used_args \x3d cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(new cljs.core.Keyword(null,\x22used-args\x22,\x22used-args\x22,23596256).cljs$core$IFn$_invoke$arity$1(frame),rule,cljs.core.conj.cljs$core$IFn$_invoke$arity$2(cljs.core.get.cljs$core$IFn$_invoke$arity$3(new cljs.core.Keyword(null,\x22used-args\x22,\x22used-args\x22,23596256).cljs$core$IFn$_invoke$arity$1(frame),rule,cljs.core.PersistentVector.EMPTY),call_args));
var branches \x3d datascript.query.expand_rule(rule_clause,context,used_args);
var G__55378 \x3d cljs.core.concat.cljs$core$IFn$_invoke$arity$2((function (){var iter__5523__auto__ \x3d ((function (stack,rel,used_args,branches,prefix_clauses,prefix_context,vec__55029,seq__55030,first__55031,seq__55030__$1,rule,call_args,guards,vec__55032,active_gs,pending_gs,vec__55023,clauses,vec__55026,seq__55027,first__55028,seq__55027__$1,rule_clause,next_clauses,frame,temp__5806__auto__,final_attrs,final_attrs_map,solve,empty_rels_QMARK_){
return (function datascript$query$solve_rule_$_iter__55036(s__55037){
return (new cljs.core.LazySeq(null,((function (stack,rel,used_args,branches,prefix_clauses,prefix_context,vec__55029,seq__55030,first__55031,seq__55030__$1,rule,call_args,guards,vec__55032,active_gs,pending_gs,vec__55023,clauses,vec__55026,seq__55027,first__55028,seq__55027__$1,rule_clause,next_clauses,frame,temp__5806__auto__,final_attrs,final_attrs_map,solve,empty_rels_QMARK_){
return (function (){
var s__55037__$1 \x3d s__55037;
while(true){
var temp__5804__auto__ \x3d cljs.core.seq(s__55037__$1);
if(temp__5804__auto__){
var s__55037__$2 \x3d temp__5804__auto__;
if(cljs.core.chunked_seq_QMARK_(s__55037__$2)){
var c__5521__auto__ \x3d cljs.core.chunk_first(s__55037__$2);
var size__5522__auto__ \x3d cljs.core.count(c__5521__auto__);
var b__55039 \x3d cljs.core.chunk_buffer(size__5522__auto__);
if((function (){var i__55038 \x3d (0);
while(true){
if((i__55038 \x3c size__5522__auto__)){
var branch \x3d cljs.core._nth(c__5521__auto__,i__55038);
cljs.core.chunk_append(b__55039,new cljs.core.PersistentArrayMap(null, 5, [new cljs.core.Keyword(null,\x22prefix-clauses\x22,\x22prefix-clauses\x22,1294180028),prefix_clauses,new cljs.core.Keyword(null,\x22prefix-context\x22,\x22prefix-context\x22,-1269613591),prefix_context,new cljs.core.Keyword(null,\x22clauses\x22,\x22clauses\x22,1454841241),datascript.query.concatv.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([branch,next_clauses], 0)),new cljs.core.Keyword(null,\x22used-args\x22,\x22used-args\x22,23596256),used_args,new cljs.core.Keyword(null,\x22pending-guards\x22,\x22pending-guards\x22,-1255527308),pending_gs], null));

var G__55382 \x3d (i__55038 + (1));
i__55038 \x3d G__55382;
continue;
} else {
return true;
}
break;
}
})()){
return cljs.core.chunk_cons(cljs.core.chunk(b__55039),datascript$query$solve_rule_$_iter__55036(cljs.core.chunk_rest(s__55037__$2)));
} else {
return cljs.core.chunk_cons(cljs.core.chunk(b__55039),null);
}
} else {
var branch \x3d cljs.core.first(s__55037__$2);
return cljs.core.cons(new cljs.core.PersistentArrayMap(null, 5, [new cljs.core.Keyword(null,\x22prefix-clauses\x22,\x22prefix-clauses\x22,1294180028),prefix_clauses,new cljs.core.Keyword(null,\x22prefix-context\x22,\x22prefix-context\x22,-1269613591),prefix_context,new cljs.core.Keyword(null,\x22clauses\x22,\x22clauses\x22,1454841241),datascript.query.concatv.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([branch,next_clauses], 0)),new cljs.core.Keyword(null,\x22used-args\x22,\x22used-args\x22,23596256),used_args,new cljs.core.Keyword(null,\x22pending-guards\x22,\x22pending-guards\x22,-1255527308),pending_gs], null),datascript$query$solve_rule_$_iter__55036(cljs.core.rest(s__55037__$2)));
}
} else {
return null;
}
break;
}
});})(stack,rel,used_args,branches,prefix_clauses,prefix_context,vec__55029,seq__55030,first__55031,seq__55030__$1,rule,call_args,guards,vec__55032,active_gs,pending_gs,vec__55023,clauses,vec__55026,seq__55027,first__55028,seq__55027__$1,rule_clause,next_clauses,frame,temp__5806__auto__,final_attrs,final_attrs_map,solve,empty_rels_QMARK_))
,null,null));
});})(stack,rel,used_args,branches,prefix_clauses,prefix_context,vec__55029,seq__55030,first__55031,seq__55030__$1,rule,call_args,guards,vec__55032,active_gs,pending_gs,vec__55023,clauses,vec__55026,seq__55027,first__55028,seq__55027__$1,rule_clause,next_clauses,frame,temp__5806__auto__,final_attrs,final_attrs_map,solve,empty_rels_QMARK_))
;
return iter__5523__auto__(branches);
})(),cljs.core.next(stack));
var G__55379 \x3d rel;
stack \x3d G__55378;
rel \x3d G__55379;
continue;
}
}
}
}
break;
}
});
datascript.query.resolve_pattern_lookup_refs \x3d (function datascript$query$resolve_pattern_lookup_refs(source,pattern){
if((((!((source \x3d\x3d null))))?((((false) || ((cljs.core.PROTOCOL_SENTINEL \x3d\x3d\x3d source.datascript$db$IDB$))))?true:(((!source.cljs$lang$protocol_mask$partition$))?cljs.core.native_satisfies_QMARK_(datascript.db.IDB,source):false)):cljs.core.native_satisfies_QMARK_(datascript.db.IDB,source))){
var vec__55042 \x3d pattern;
var e \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__55042,(0),null);
var a \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__55042,(1),null);
var v \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__55042,(2),null);
var tx \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__55042,(3),null);
return cljs.core.subvec.cljs$core$IFn$_invoke$arity$3(new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [(cljs.core.truth_((function (){var or__5045__auto__ \x3d datascript.query.lookup_ref_QMARK_(e);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return datascript.query.attr_QMARK_(e);
}
})())?datascript.db.entid_strict(source,e):e),a,(cljs.core.truth_((function (){var and__5043__auto__ \x3d v;
if(cljs.core.truth_(and__5043__auto__)){
var and__5043__auto____$1 \x3d datascript.query.attr_QMARK_(a);
if(and__5043__auto____$1){
var and__5043__auto____$2 \x3d datascript.db.ref_QMARK_(source,a);
if(and__5043__auto____$2){
var or__5045__auto__ \x3d datascript.query.lookup_ref_QMARK_(v);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return datascript.query.attr_QMARK_(v);
}
} else {
return and__5043__auto____$2;
}
} else {
return and__5043__auto____$1;
}
} else {
return and__5043__auto__;
}
})())?datascript.db.entid_strict(source,v):v),(cljs.core.truth_(datascript.query.lookup_ref_QMARK_(tx))?datascript.db.entid_strict(source,tx):tx)], null),(0),cljs.core.count(pattern));
} else {
return pattern;
}
});
datascript.query.dynamic_lookup_attrs \x3d (function datascript$query$dynamic_lookup_attrs(source,pattern){
var vec__55046 \x3d pattern;
var e \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__55046,(0),null);
var a \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__55046,(1),null);
var v \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__55046,(2),null);
var tx \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__55046,(3),null);
var G__55049 \x3d cljs.core.PersistentHashSet.EMPTY;
var G__55049__$1 \x3d ((datascript.query.free_var_QMARK_(e))?cljs.core.conj.cljs$core$IFn$_invoke$arity$2(G__55049,e):G__55049);
var G__55049__$2 \x3d ((datascript.query.free_var_QMARK_(tx))?cljs.core.conj.cljs$core$IFn$_invoke$arity$2(G__55049__$1,tx):G__55049__$1);
if(((datascript.query.free_var_QMARK_(v)) \x26\x26 ((((!(datascript.query.free_var_QMARK_(a)))) \x26\x26 (datascript.db.ref_QMARK_(source,a)))))){
return cljs.core.conj.cljs$core$IFn$_invoke$arity$2(G__55049__$2,v);
} else {
return G__55049__$2;
}
});
datascript.query.limit_rel \x3d (function datascript$query$limit_rel(rel,vars){
var temp__5808__auto__ \x3d cljs.core.not_empty(cljs.core.select_keys(new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713).cljs$core$IFn$_invoke$arity$1(rel),vars));
if((temp__5808__auto__ \x3d\x3d null)){
return null;
} else {
var attrs_SINGLEQUOTE_ \x3d temp__5808__auto__;
return cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(rel,new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713),attrs_SINGLEQUOTE_);
}
});
datascript.query.limit_context \x3d (function datascript$query$limit_context(context,vars){
return cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(context,new cljs.core.Keyword(null,\x22rels\x22,\x22rels\x22,1770187185),cljs.core.keep.cljs$core$IFn$_invoke$arity$2((function (p1__55050_SHARP_){
return datascript.query.limit_rel(p1__55050_SHARP_,vars);
}),new cljs.core.Keyword(null,\x22rels\x22,\x22rels\x22,1770187185).cljs$core$IFn$_invoke$arity$1(context)));
});
datascript.query.bound_vars \x3d (function datascript$query$bound_vars(context){
return cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentHashSet.EMPTY,cljs.core.mapcat.cljs$core$IFn$_invoke$arity$variadic((function (p1__55052_SHARP_){
return cljs.core.keys(new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713).cljs$core$IFn$_invoke$arity$1(p1__55052_SHARP_));
}),cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,\x22rels\x22,\x22rels\x22,1770187185).cljs$core$IFn$_invoke$arity$1(context)], 0)));
});
datascript.query.check_bound \x3d (function datascript$query$check_bound(bound,vars,form){
if(clojure.set.subset_QMARK_(vars,bound)){
return null;
} else {
var missing \x3d clojure.set.difference.cljs$core$IFn$_invoke$arity$2(cljs.core.set(vars),bound);
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22Insufficient bindings: \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([missing], 0)),\x22 not bound in \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([form], 0))].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22query\x22,\x22where\x22,\x22query/where\x22,-1935159429),new cljs.core.Keyword(null,\x22form\x22,\x22form\x22,-1624062471),form,new cljs.core.Keyword(null,\x22vars\x22,\x22vars\x22,-2046957217),missing], null));
}
});
datascript.query.check_free_same \x3d (function datascript$query$check_free_same(bound,branches,form){
var free \x3d cljs.core.mapv.cljs$core$IFn$_invoke$arity$2((function (p1__55053_SHARP_){
return clojure.set.difference.cljs$core$IFn$_invoke$arity$2(datascript.query.collect_vars(p1__55053_SHARP_),bound);
}),branches);
if(cljs.core.truth_(cljs.core.apply.cljs$core$IFn$_invoke$arity$2(cljs.core._EQ_,free))){
return null;
} else {
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22All clauses in \x27or\x27 must use same set of free vars, had \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([free], 0)),\x22 in \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([form], 0))].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22query\x22,\x22where\x22,\x22query/where\x22,-1935159429),new cljs.core.Keyword(null,\x22form\x22,\x22form\x22,-1624062471),form,new cljs.core.Keyword(null,\x22vars\x22,\x22vars\x22,-2046957217),free], null));
}
});
datascript.query.check_free_subset \x3d (function datascript$query$check_free_subset(bound,vars,branches){
var free \x3d cljs.core.set(cljs.core.remove.cljs$core$IFn$_invoke$arity$2(bound,vars));
var seq__55055 \x3d cljs.core.seq(branches);
var chunk__55056 \x3d null;
var count__55057 \x3d (0);
var i__55058 \x3d (0);
while(true){
if((i__55058 \x3c count__55057)){
var branch \x3d chunk__55056.cljs$core$IIndexed$_nth$arity$2(null,i__55058);
var temp__5808__auto___55386 \x3d cljs.core.not_empty(clojure.set.difference.cljs$core$IFn$_invoke$arity$2(free,datascript.query.collect_vars(branch)));
if((temp__5808__auto___55386 \x3d\x3d null)){
} else {
var missing_55387 \x3d temp__5808__auto___55386;
cljs.core.prn.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([branch,bound,vars,free], 0));

throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22All clauses in \x27or\x27 must use same set of free vars, had \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([missing_55387], 0)),\x22 not bound in \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([branch], 0))].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22query\x22,\x22where\x22,\x22query/where\x22,-1935159429),new cljs.core.Keyword(null,\x22form\x22,\x22form\x22,-1624062471),branch,new cljs.core.Keyword(null,\x22vars\x22,\x22vars\x22,-2046957217),missing_55387], null));
}


var G__55388 \x3d seq__55055;
var G__55389 \x3d chunk__55056;
var G__55390 \x3d count__55057;
var G__55391 \x3d (i__55058 + (1));
seq__55055 \x3d G__55388;
chunk__55056 \x3d G__55389;
count__55057 \x3d G__55390;
i__55058 \x3d G__55391;
continue;
} else {
var temp__5804__auto__ \x3d cljs.core.seq(seq__55055);
if(temp__5804__auto__){
var seq__55055__$1 \x3d temp__5804__auto__;
if(cljs.core.chunked_seq_QMARK_(seq__55055__$1)){
var c__5568__auto__ \x3d cljs.core.chunk_first(seq__55055__$1);
var G__55392 \x3d cljs.core.chunk_rest(seq__55055__$1);
var G__55393 \x3d c__5568__auto__;
var G__55394 \x3d cljs.core.count(c__5568__auto__);
var G__55395 \x3d (0);
seq__55055 \x3d G__55392;
chunk__55056 \x3d G__55393;
count__55057 \x3d G__55394;
i__55058 \x3d G__55395;
continue;
} else {
var branch \x3d cljs.core.first(seq__55055__$1);
var temp__5808__auto___55396 \x3d cljs.core.not_empty(clojure.set.difference.cljs$core$IFn$_invoke$arity$2(free,datascript.query.collect_vars(branch)));
if((temp__5808__auto___55396 \x3d\x3d null)){
} else {
var missing_55400 \x3d temp__5808__auto___55396;
cljs.core.prn.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([branch,bound,vars,free], 0));

throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22All clauses in \x27or\x27 must use same set of free vars, had \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([missing_55400], 0)),\x22 not bound in \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([branch], 0))].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22query\x22,\x22where\x22,\x22query/where\x22,-1935159429),new cljs.core.Keyword(null,\x22form\x22,\x22form\x22,-1624062471),branch,new cljs.core.Keyword(null,\x22vars\x22,\x22vars\x22,-2046957217),missing_55400], null));
}


var G__55401 \x3d cljs.core.next(seq__55055__$1);
var G__55402 \x3d null;
var G__55403 \x3d (0);
var G__55404 \x3d (0);
seq__55055 \x3d G__55401;
chunk__55056 \x3d G__55402;
count__55057 \x3d G__55403;
i__55058 \x3d G__55404;
continue;
}
} else {
return null;
}
}
break;
}
});
datascript.query._resolve_clause \x3d (function datascript$query$_resolve_clause(var_args){
var G__55066 \x3d arguments.length;
switch (G__55066) {
case 2:
return datascript.query._resolve_clause.cljs$core$IFn$_invoke$arity$2((arguments[(0)]),(arguments[(1)]));

break;
case 3:
return datascript.query._resolve_clause.cljs$core$IFn$_invoke$arity$3((arguments[(0)]),(arguments[(1)]),(arguments[(2)]));

break;
default:
throw (new Error([\x22Invalid arity: \x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1(arguments.length)].join(\x27\x27)));

}
});

(datascript.query._resolve_clause.cljs$core$IFn$_invoke$arity$2 \x3d (function (context,clause){
return datascript.query._resolve_clause.cljs$core$IFn$_invoke$arity$3(context,clause,clause);
}));

(datascript.query._resolve_clause.cljs$core$IFn$_invoke$arity$3 \x3d (function (context,clause,orig_clause){
while(true){
var pred__55067 \x3d datascript.query.looks_like_QMARK_;
var expr__55068 \x3d clause;
if(cljs.core.truth_((function (){var G__55070 \x3d new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.symbol_QMARK_,new cljs.core.Symbol(null,\x22*\x22,\x22*\x22,345799209,null)], null)], null);
var G__55071 \x3d expr__55068;
return (pred__55067.cljs$core$IFn$_invoke$arity$2 ? pred__55067.cljs$core$IFn$_invoke$arity$2(G__55070,G__55071) : pred__55067.call(null,G__55070,G__55071));
})())){
datascript.query.check_bound(datascript.query.bound_vars(context),cljs.core.filter.cljs$core$IFn$_invoke$arity$2(datascript.query.free_var_QMARK_,cljs.core.nfirst(clause)),clause);

return datascript.query.filter_by_pred(context,clause);
} else {
if(cljs.core.truth_((function (){var G__55072 \x3d new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.symbol_QMARK_,new cljs.core.Symbol(null,\x22*\x22,\x22*\x22,345799209,null)], null),new cljs.core.Symbol(null,\x22_\x22,\x22_\x22,-1201019570,null)], null);
var G__55073 \x3d expr__55068;
return (pred__55067.cljs$core$IFn$_invoke$arity$2 ? pred__55067.cljs$core$IFn$_invoke$arity$2(G__55072,G__55073) : pred__55067.call(null,G__55072,G__55073));
})())){
datascript.query.check_bound(datascript.query.bound_vars(context),cljs.core.filter.cljs$core$IFn$_invoke$arity$2(datascript.query.free_var_QMARK_,cljs.core.nfirst(clause)),clause);

return datascript.query.bind_by_fn(context,clause);
} else {
if(cljs.core.truth_((function (){var G__55075 \x3d new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [datascript.query.source_QMARK_,new cljs.core.Symbol(null,\x22*\x22,\x22*\x22,345799209,null)], null);
var G__55076 \x3d expr__55068;
return (pred__55067.cljs$core$IFn$_invoke$arity$2 ? pred__55067.cljs$core$IFn$_invoke$arity$2(G__55075,G__55076) : pred__55067.call(null,G__55075,G__55076));
})())){
var vec__55077 \x3d clause;
var seq__55078 \x3d cljs.core.seq(vec__55077);
var first__55079 \x3d cljs.core.first(seq__55078);
var seq__55078__$1 \x3d cljs.core.next(seq__55078);
var source_sym \x3d first__55079;
var rest \x3d seq__55078__$1;
var _STAR_implicit_source_STAR__orig_val__55080 \x3d datascript.query._STAR_implicit_source_STAR_;
var _STAR_implicit_source_STAR__temp_val__55081 \x3d cljs.core.get.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22sources\x22,\x22sources\x22,-321166424).cljs$core$IFn$_invoke$arity$1(context),source_sym);
(datascript.query._STAR_implicit_source_STAR_ \x3d _STAR_implicit_source_STAR__temp_val__55081);

try{return datascript.query._resolve_clause.cljs$core$IFn$_invoke$arity$3(context,rest,clause);
}finally {(datascript.query._STAR_implicit_source_STAR_ \x3d _STAR_implicit_source_STAR__orig_val__55080);
}} else {
if(cljs.core.truth_((function (){var G__55082 \x3d new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22or\x22,\x22or\x22,1876275696,null),new cljs.core.Symbol(null,\x22*\x22,\x22*\x22,345799209,null)], null);
var G__55083 \x3d expr__55068;
return (pred__55067.cljs$core$IFn$_invoke$arity$2 ? pred__55067.cljs$core$IFn$_invoke$arity$2(G__55082,G__55083) : pred__55067.call(null,G__55082,G__55083));
})())){
var vec__55084 \x3d clause;
var seq__55085 \x3d cljs.core.seq(vec__55084);
var first__55086 \x3d cljs.core.first(seq__55085);
var seq__55085__$1 \x3d cljs.core.next(seq__55085);
var _ \x3d first__55086;
var branches \x3d seq__55085__$1;
var ___$1 \x3d datascript.query.check_free_same(datascript.query.bound_vars(context),branches,clause);
var contexts \x3d cljs.core.map.cljs$core$IFn$_invoke$arity$2(((function (context,clause,orig_clause,vec__55084,seq__55085,first__55086,seq__55085__$1,_,branches,___$1,pred__55067,expr__55068){
return (function (p1__55060_SHARP_){
return (datascript.query.resolve_clause.cljs$core$IFn$_invoke$arity$2 ? datascript.query.resolve_clause.cljs$core$IFn$_invoke$arity$2(context,p1__55060_SHARP_) : datascript.query.resolve_clause.call(null,context,p1__55060_SHARP_));
});})(context,clause,orig_clause,vec__55084,seq__55085,first__55086,seq__55085__$1,_,branches,___$1,pred__55067,expr__55068))
,branches);
var rels \x3d cljs.core.map.cljs$core$IFn$_invoke$arity$2(((function (context,clause,orig_clause,vec__55084,seq__55085,first__55086,seq__55085__$1,_,branches,___$1,contexts,pred__55067,expr__55068){
return (function (p1__55061_SHARP_){
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$2(datascript.query.hash_join,new cljs.core.Keyword(null,\x22rels\x22,\x22rels\x22,1770187185).cljs$core$IFn$_invoke$arity$1(p1__55061_SHARP_));
});})(context,clause,orig_clause,vec__55084,seq__55085,first__55086,seq__55085__$1,_,branches,___$1,contexts,pred__55067,expr__55068))
,contexts);
return cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(cljs.core.first(contexts),new cljs.core.Keyword(null,\x22rels\x22,\x22rels\x22,1770187185),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.reduce.cljs$core$IFn$_invoke$arity$2(datascript.query.sum_rel,rels)], null));
} else {
if(cljs.core.truth_((function (){var G__55087 \x3d new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22or-join\x22,\x22or-join\x22,591375469,null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22*\x22,\x22*\x22,345799209,null)], null),new cljs.core.Symbol(null,\x22*\x22,\x22*\x22,345799209,null)], null),new cljs.core.Symbol(null,\x22*\x22,\x22*\x22,345799209,null)], null);
var G__55088 \x3d expr__55068;
return (pred__55067.cljs$core$IFn$_invoke$arity$2 ? pred__55067.cljs$core$IFn$_invoke$arity$2(G__55087,G__55088) : pred__55067.call(null,G__55087,G__55088));
})())){
var vec__55089 \x3d clause;
var seq__55090 \x3d cljs.core.seq(vec__55089);
var first__55091 \x3d cljs.core.first(seq__55090);
var seq__55090__$1 \x3d cljs.core.next(seq__55090);
var _ \x3d first__55091;
var first__55091__$1 \x3d cljs.core.first(seq__55090__$1);
var seq__55090__$2 \x3d cljs.core.next(seq__55090__$1);
var vec__55092 \x3d first__55091__$1;
var seq__55093 \x3d cljs.core.seq(vec__55092);
var first__55094 \x3d cljs.core.first(seq__55093);
var seq__55093__$1 \x3d cljs.core.next(seq__55093);
var req_vars \x3d first__55094;
var vars \x3d seq__55093__$1;
var branches \x3d seq__55090__$2;
var bound \x3d datascript.query.bound_vars(context);
datascript.query.check_bound(bound,req_vars,orig_clause);

datascript.query.check_free_subset(bound,vars,branches);

var G__55407 \x3d context;
var G__55408 \x3d cljs.core.list_STAR_.cljs$core$IFn$_invoke$arity$3(new cljs.core.Symbol(null,\x22or-join\x22,\x22or-join\x22,591375469,null),cljs.core.concat.cljs$core$IFn$_invoke$arity$2(req_vars,vars),branches);
var G__55409 \x3d clause;
context \x3d G__55407;
clause \x3d G__55408;
orig_clause \x3d G__55409;
continue;
} else {
if(cljs.core.truth_((function (){var G__55095 \x3d new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22or-join\x22,\x22or-join\x22,591375469,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22*\x22,\x22*\x22,345799209,null)], null),new cljs.core.Symbol(null,\x22*\x22,\x22*\x22,345799209,null)], null);
var G__55096 \x3d expr__55068;
return (pred__55067.cljs$core$IFn$_invoke$arity$2 ? pred__55067.cljs$core$IFn$_invoke$arity$2(G__55095,G__55096) : pred__55067.call(null,G__55095,G__55096));
})())){
var vec__55097 \x3d clause;
var seq__55098 \x3d cljs.core.seq(vec__55097);
var first__55099 \x3d cljs.core.first(seq__55098);
var seq__55098__$1 \x3d cljs.core.next(seq__55098);
var _ \x3d first__55099;
var first__55099__$1 \x3d cljs.core.first(seq__55098__$1);
var seq__55098__$2 \x3d cljs.core.next(seq__55098__$1);
var vars \x3d first__55099__$1;
var branches \x3d seq__55098__$2;
var vars__$1 \x3d cljs.core.set(vars);
var ___$1 \x3d datascript.query.check_free_subset(datascript.query.bound_vars(context),vars__$1,branches);
var join_context \x3d datascript.query.limit_context(context,vars__$1);
var contexts \x3d cljs.core.map.cljs$core$IFn$_invoke$arity$2(((function (context,clause,orig_clause,vec__55097,seq__55098,first__55099,seq__55098__$1,_,first__55099__$1,seq__55098__$2,vars,branches,vars__$1,___$1,join_context,pred__55067,expr__55068){
return (function (p1__55062_SHARP_){
return datascript.query.limit_context((datascript.query.resolve_clause.cljs$core$IFn$_invoke$arity$2 ? datascript.query.resolve_clause.cljs$core$IFn$_invoke$arity$2(join_context,p1__55062_SHARP_) : datascript.query.resolve_clause.call(null,join_context,p1__55062_SHARP_)),vars__$1);
});})(context,clause,orig_clause,vec__55097,seq__55098,first__55099,seq__55098__$1,_,first__55099__$1,seq__55098__$2,vars,branches,vars__$1,___$1,join_context,pred__55067,expr__55068))
,branches);
var rels \x3d cljs.core.map.cljs$core$IFn$_invoke$arity$2(((function (context,clause,orig_clause,vec__55097,seq__55098,first__55099,seq__55098__$1,_,first__55099__$1,seq__55098__$2,vars,branches,vars__$1,___$1,join_context,contexts,pred__55067,expr__55068){
return (function (p1__55063_SHARP_){
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$2(datascript.query.hash_join,new cljs.core.Keyword(null,\x22rels\x22,\x22rels\x22,1770187185).cljs$core$IFn$_invoke$arity$1(p1__55063_SHARP_));
});})(context,clause,orig_clause,vec__55097,seq__55098,first__55099,seq__55098__$1,_,first__55099__$1,seq__55098__$2,vars,branches,vars__$1,___$1,join_context,contexts,pred__55067,expr__55068))
,contexts);
var sum_rel \x3d cljs.core.reduce.cljs$core$IFn$_invoke$arity$2(datascript.query.sum_rel,rels);
return cljs.core.update.cljs$core$IFn$_invoke$arity$4(context,new cljs.core.Keyword(null,\x22rels\x22,\x22rels\x22,1770187185),datascript.query.collapse_rels,sum_rel);
} else {
if(cljs.core.truth_((function (){var G__55101 \x3d new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22and\x22,\x22and\x22,668631710,null),new cljs.core.Symbol(null,\x22*\x22,\x22*\x22,345799209,null)], null);
var G__55102 \x3d expr__55068;
return (pred__55067.cljs$core$IFn$_invoke$arity$2 ? pred__55067.cljs$core$IFn$_invoke$arity$2(G__55101,G__55102) : pred__55067.call(null,G__55101,G__55102));
})())){
var vec__55103 \x3d clause;
var seq__55104 \x3d cljs.core.seq(vec__55103);
var first__55105 \x3d cljs.core.first(seq__55104);
var seq__55104__$1 \x3d cljs.core.next(seq__55104);
var _ \x3d first__55105;
var clauses \x3d seq__55104__$1;
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(datascript.query.resolve_clause,context,clauses);
} else {
if(cljs.core.truth_((function (){var G__55106 \x3d new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22not\x22,\x22not\x22,1044554643,null),new cljs.core.Symbol(null,\x22*\x22,\x22*\x22,345799209,null)], null);
var G__55107 \x3d expr__55068;
return (pred__55067.cljs$core$IFn$_invoke$arity$2 ? pred__55067.cljs$core$IFn$_invoke$arity$2(G__55106,G__55107) : pred__55067.call(null,G__55106,G__55107));
})())){
var vec__55108 \x3d clause;
var seq__55109 \x3d cljs.core.seq(vec__55108);
var first__55110 \x3d cljs.core.first(seq__55109);
var seq__55109__$1 \x3d cljs.core.next(seq__55109);
var _ \x3d first__55110;
var clauses \x3d seq__55109__$1;
var bound \x3d datascript.query.bound_vars(context);
var negation_vars \x3d datascript.query.collect_vars(clauses);
var ___$1 \x3d ((cljs.core.empty_QMARK_(clojure.set.intersection.cljs$core$IFn$_invoke$arity$2(bound,negation_vars)))?(function(){throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\x22Insufficient bindings: none of \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([negation_vars], 0)),\x22 is bound in \x22,cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([orig_clause], 0))].join(\x27\x27),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22query\x22,\x22where\x22,\x22query/where\x22,-1935159429),new cljs.core.Keyword(null,\x22form\x22,\x22form\x22,-1624062471),orig_clause], null))})():null);
var context_SINGLEQUOTE_ \x3d cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(context,new cljs.core.Keyword(null,\x22rels\x22,\x22rels\x22,1770187185),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.reduce.cljs$core$IFn$_invoke$arity$2(datascript.query.hash_join,new cljs.core.Keyword(null,\x22rels\x22,\x22rels\x22,1770187185).cljs$core$IFn$_invoke$arity$1(context))], null));
var negation_context \x3d cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(datascript.query.resolve_clause,context_SINGLEQUOTE_,clauses);
var negation \x3d datascript.query.subtract_rel(datascript.query.single(new cljs.core.Keyword(null,\x22rels\x22,\x22rels\x22,1770187185).cljs$core$IFn$_invoke$arity$1(context_SINGLEQUOTE_)),cljs.core.reduce.cljs$core$IFn$_invoke$arity$2(datascript.query.hash_join,new cljs.core.Keyword(null,\x22rels\x22,\x22rels\x22,1770187185).cljs$core$IFn$_invoke$arity$1(negation_context)));
return cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(context_SINGLEQUOTE_,new cljs.core.Keyword(null,\x22rels\x22,\x22rels\x22,1770187185),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [negation], null));
} else {
if(cljs.core.truth_((function (){var G__55111 \x3d new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22not-join\x22,\x22not-join\x22,-645515756,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22*\x22,\x22*\x22,345799209,null)], null),new cljs.core.Symbol(null,\x22*\x22,\x22*\x22,345799209,null)], null);
var G__55112 \x3d expr__55068;
return (pred__55067.cljs$core$IFn$_invoke$arity$2 ? pred__55067.cljs$core$IFn$_invoke$arity$2(G__55111,G__55112) : pred__55067.call(null,G__55111,G__55112));
})())){
var vec__55113 \x3d clause;
var seq__55114 \x3d cljs.core.seq(vec__55113);
var first__55115 \x3d cljs.core.first(seq__55114);
var seq__55114__$1 \x3d cljs.core.next(seq__55114);
var _ \x3d first__55115;
var first__55115__$1 \x3d cljs.core.first(seq__55114__$1);
var seq__55114__$2 \x3d cljs.core.next(seq__55114__$1);
var vars \x3d first__55115__$1;
var clauses \x3d seq__55114__$2;
var bound \x3d datascript.query.bound_vars(context);
var ___$1 \x3d datascript.query.check_bound(bound,vars,orig_clause);
var context_SINGLEQUOTE_ \x3d cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(context,new cljs.core.Keyword(null,\x22rels\x22,\x22rels\x22,1770187185),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.reduce.cljs$core$IFn$_invoke$arity$2(datascript.query.hash_join,new cljs.core.Keyword(null,\x22rels\x22,\x22rels\x22,1770187185).cljs$core$IFn$_invoke$arity$1(context))], null));
var join_context \x3d datascript.query.limit_context(context_SINGLEQUOTE_,vars);
var negation_context \x3d datascript.query.limit_context(cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(datascript.query.resolve_clause,join_context,clauses),vars);
var negation \x3d datascript.query.subtract_rel(datascript.query.single(new cljs.core.Keyword(null,\x22rels\x22,\x22rels\x22,1770187185).cljs$core$IFn$_invoke$arity$1(context_SINGLEQUOTE_)),cljs.core.reduce.cljs$core$IFn$_invoke$arity$2(datascript.query.hash_join,new cljs.core.Keyword(null,\x22rels\x22,\x22rels\x22,1770187185).cljs$core$IFn$_invoke$arity$1(negation_context)));
return cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(context_SINGLEQUOTE_,new cljs.core.Keyword(null,\x22rels\x22,\x22rels\x22,1770187185),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [negation], null));
} else {
if(cljs.core.truth_((function (){var G__55117 \x3d new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22*\x22,\x22*\x22,345799209,null)], null);
var G__55118 \x3d expr__55068;
return (pred__55067.cljs$core$IFn$_invoke$arity$2 ? pred__55067.cljs$core$IFn$_invoke$arity$2(G__55117,G__55118) : pred__55067.call(null,G__55117,G__55118));
})())){
var source \x3d datascript.query._STAR_implicit_source_STAR_;
var pattern \x3d datascript.query.resolve_pattern_lookup_refs(source,clause);
var relation \x3d datascript.query.lookup_pattern(source,pattern);
var _STAR_lookup_attrs_STAR__orig_val__55119 \x3d datascript.query._STAR_lookup_attrs_STAR_;
var _STAR_lookup_attrs_STAR__temp_val__55120 \x3d (((((!((source \x3d\x3d null))))?((((false) || ((cljs.core.PROTOCOL_SENTINEL \x3d\x3d\x3d source.datascript$db$IDB$))))?true:(((!source.cljs$lang$protocol_mask$partition$))?cljs.core.native_satisfies_QMARK_(datascript.db.IDB,source):false)):cljs.core.native_satisfies_QMARK_(datascript.db.IDB,source)))?datascript.query.dynamic_lookup_attrs(source,pattern):datascript.query._STAR_lookup_attrs_STAR_);
(datascript.query._STAR_lookup_attrs_STAR_ \x3d _STAR_lookup_attrs_STAR__temp_val__55120);

try{return cljs.core.update.cljs$core$IFn$_invoke$arity$4(context,new cljs.core.Keyword(null,\x22rels\x22,\x22rels\x22,1770187185),datascript.query.collapse_rels,relation);
}finally {(datascript.query._STAR_lookup_attrs_STAR_ \x3d _STAR_lookup_attrs_STAR__orig_val__55119);
}} else {
throw (new Error([\x22No matching clause: \x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1(expr__55068)].join(\x27\x27)));
}
}
}
}
}
}
}
}
}
}
break;
}
}));

(datascript.query._resolve_clause.cljs$lang$maxFixedArity \x3d 3);

datascript.query.resolve_clause \x3d (function datascript$query$resolve_clause(context,clause){
if(datascript.query.rule_QMARK_(context,clause)){
if(datascript.query.source_QMARK_(cljs.core.first(clause))){
var _STAR_implicit_source_STAR__orig_val__55122 \x3d datascript.query._STAR_implicit_source_STAR_;
var _STAR_implicit_source_STAR__temp_val__55123 \x3d cljs.core.get.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22sources\x22,\x22sources\x22,-321166424).cljs$core$IFn$_invoke$arity$1(context),cljs.core.first(clause));
(datascript.query._STAR_implicit_source_STAR_ \x3d _STAR_implicit_source_STAR__temp_val__55123);

try{var G__55124 \x3d context;
var G__55125 \x3d cljs.core.next(clause);
return (datascript.query.resolve_clause.cljs$core$IFn$_invoke$arity$2 ? datascript.query.resolve_clause.cljs$core$IFn$_invoke$arity$2(G__55124,G__55125) : datascript.query.resolve_clause.call(null,G__55124,G__55125));
}finally {(datascript.query._STAR_implicit_source_STAR_ \x3d _STAR_implicit_source_STAR__orig_val__55122);
}} else {
return cljs.core.update.cljs$core$IFn$_invoke$arity$4(context,new cljs.core.Keyword(null,\x22rels\x22,\x22rels\x22,1770187185),datascript.query.collapse_rels,datascript.query.solve_rule(context,clause));
}
} else {
return datascript.query._resolve_clause.cljs$core$IFn$_invoke$arity$2(context,clause);
}
});
datascript.query._q \x3d (function datascript$query$_q(context,clauses){
var _STAR_implicit_source_STAR__orig_val__55127 \x3d datascript.query._STAR_implicit_source_STAR_;
var _STAR_implicit_source_STAR__temp_val__55128 \x3d cljs.core.get.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22sources\x22,\x22sources\x22,-321166424).cljs$core$IFn$_invoke$arity$1(context),new cljs.core.Symbol(null,\x22$\x22,\x22$\x22,-1580747756,null));
(datascript.query._STAR_implicit_source_STAR_ \x3d _STAR_implicit_source_STAR__temp_val__55128);

try{return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(datascript.query.resolve_clause,context,clauses);
}finally {(datascript.query._STAR_implicit_source_STAR_ \x3d _STAR_implicit_source_STAR__orig_val__55127);
}});
datascript.query._collect \x3d (function datascript$query$_collect(var_args){
var G__55131 \x3d arguments.length;
switch (G__55131) {
case 2:
return datascript.query._collect.cljs$core$IFn$_invoke$arity$2((arguments[(0)]),(arguments[(1)]));

break;
case 3:
return datascript.query._collect.cljs$core$IFn$_invoke$arity$3((arguments[(0)]),(arguments[(1)]),(arguments[(2)]));

break;
default:
throw (new Error([\x22Invalid arity: \x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1(arguments.length)].join(\x27\x27)));

}
});

(datascript.query._collect.cljs$core$IFn$_invoke$arity$2 \x3d (function (context,symbols){
var rels \x3d new cljs.core.Keyword(null,\x22rels\x22,\x22rels\x22,1770187185).cljs$core$IFn$_invoke$arity$1(context);
return datascript.query._collect.cljs$core$IFn$_invoke$arity$3(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [me.tonsky.persistent_sorted_set.arrays.make_array(cljs.core.count(symbols))], null),rels,symbols);
}));

(datascript.query._collect.cljs$core$IFn$_invoke$arity$3 \x3d (function (acc,rels,symbols){
while(true){
var rel \x3d cljs.core.first(rels);
if((rel \x3d\x3d null)){
return acc;
} else {
if(cljs.core.empty_QMARK_(new cljs.core.Keyword(null,\x22tuples\x22,\x22tuples\x22,-676032639).cljs$core$IFn$_invoke$arity$1(rel))){
return cljs.core.PersistentVector.EMPTY;
} else {
var keep_attrs \x3d cljs.core.select_keys(new cljs.core.Keyword(null,\x22attrs\x22,\x22attrs\x22,-2090668713).cljs$core$IFn$_invoke$arity$1(rel),symbols);
if(cljs.core.empty_QMARK_(keep_attrs)){
var G__55414 \x3d acc;
var G__55415 \x3d cljs.core.next(rels);
var G__55416 \x3d symbols;
acc \x3d G__55414;
rels \x3d G__55415;
symbols \x3d G__55416;
continue;
} else {
var copy_map \x3d cljs.core.to_array(cljs.core.map.cljs$core$IFn$_invoke$arity$2(((function (acc,rels,symbols,keep_attrs,rel){
return (function (p1__55129_SHARP_){
return cljs.core.get.cljs$core$IFn$_invoke$arity$2(keep_attrs,p1__55129_SHARP_);
});})(acc,rels,symbols,keep_attrs,rel))
,symbols));
var len \x3d cljs.core.count(symbols);
var G__55417 \x3d (function (){var iter__5523__auto__ \x3d ((function (acc,rels,symbols,copy_map,len,keep_attrs,rel){
return (function datascript$query$iter__55133(s__55134){
return (new cljs.core.LazySeq(null,((function (acc,rels,symbols,copy_map,len,keep_attrs,rel){
return (function (){
var s__55134__$1 \x3d s__55134;
while(true){
var temp__5804__auto__ \x3d cljs.core.seq(s__55134__$1);
if(temp__5804__auto__){
var xs__6360__auto__ \x3d temp__5804__auto__;
var t1 \x3d cljs.core.first(xs__6360__auto__);
var iterys__5519__auto__ \x3d ((function (s__55134__$1,acc,rels,symbols,t1,xs__6360__auto__,temp__5804__auto__,copy_map,len,keep_attrs,rel){
return (function datascript$query$iter__55133_$_iter__55135(s__55136){
return (new cljs.core.LazySeq(null,((function (s__55134__$1,acc,rels,symbols,t1,xs__6360__auto__,temp__5804__auto__,copy_map,len,keep_attrs,rel){
return (function (){
var s__55136__$1 \x3d s__55136;
while(true){
var temp__5804__auto____$1 \x3d cljs.core.seq(s__55136__$1);
if(temp__5804__auto____$1){
var s__55136__$2 \x3d temp__5804__auto____$1;
if(cljs.core.chunked_seq_QMARK_(s__55136__$2)){
var c__5521__auto__ \x3d cljs.core.chunk_first(s__55136__$2);
var size__5522__auto__ \x3d cljs.core.count(c__5521__auto__);
var b__55138 \x3d cljs.core.chunk_buffer(size__5522__auto__);
if((function (){var i__55137 \x3d (0);
while(true){
if((i__55137 \x3c size__5522__auto__)){
var t2 \x3d cljs.core._nth(c__5521__auto__,i__55137);
cljs.core.chunk_append(b__55138,(function (){var res \x3d cljs.core.aclone(t1);
var n__5636__auto___55420 \x3d len;
var i_55421 \x3d (0);
while(true){
if((i_55421 \x3c n__5636__auto___55420)){
var temp__5808__auto___55422 \x3d (copy_map[i_55421]);
if((temp__5808__auto___55422 \x3d\x3d null)){
} else {
var idx_55423 \x3d temp__5808__auto___55422;
(res[i_55421] \x3d (t2[idx_55423]));
}

var G__55424 \x3d (i_55421 + (1));
i_55421 \x3d G__55424;
continue;
} else {
}
break;
}

return res;
})());

var G__55425 \x3d (i__55137 + (1));
i__55137 \x3d G__55425;
continue;
} else {
return true;
}
break;
}
})()){
return cljs.core.chunk_cons(cljs.core.chunk(b__55138),datascript$query$iter__55133_$_iter__55135(cljs.core.chunk_rest(s__55136__$2)));
} else {
return cljs.core.chunk_cons(cljs.core.chunk(b__55138),null);
}
} else {
var t2 \x3d cljs.core.first(s__55136__$2);
return cljs.core.cons((function (){var res \x3d cljs.core.aclone(t1);
var n__5636__auto___55426 \x3d len;
var i_55427 \x3d (0);
while(true){
if((i_55427 \x3c n__5636__auto___55426)){
var temp__5808__auto___55428 \x3d (copy_map[i_55427]);
if((temp__5808__auto___55428 \x3d\x3d null)){
} else {
var idx_55429 \x3d temp__5808__auto___55428;
(res[i_55427] \x3d (t2[idx_55429]));
}

var G__55430 \x3d (i_55427 + (1));
i_55427 \x3d G__55430;
continue;
} else {
}
break;
}

return res;
})(),datascript$query$iter__55133_$_iter__55135(cljs.core.rest(s__55136__$2)));
}
} else {
return null;
}
break;
}
});})(s__55134__$1,acc,rels,symbols,t1,xs__6360__auto__,temp__5804__auto__,copy_map,len,keep_attrs,rel))
,null,null));
});})(s__55134__$1,acc,rels,symbols,t1,xs__6360__auto__,temp__5804__auto__,copy_map,len,keep_attrs,rel))
;
var fs__5520__auto__ \x3d cljs.core.seq(iterys__5519__auto__(new cljs.core.Keyword(null,\x22tuples\x22,\x22tuples\x22,-676032639).cljs$core$IFn$_invoke$arity$1(rel)));
if(fs__5520__auto__){
return cljs.core.concat.cljs$core$IFn$_invoke$arity$2(fs__5520__auto__,datascript$query$iter__55133(cljs.core.rest(s__55134__$1)));
} else {
var G__55431 \x3d cljs.core.rest(s__55134__$1);
s__55134__$1 \x3d G__55431;
continue;
}
} else {
return null;
}
break;
}
});})(acc,rels,symbols,copy_map,len,keep_attrs,rel))
,null,null));
});})(acc,rels,symbols,copy_map,len,keep_attrs,rel))
;
return iter__5523__auto__(acc);
})();
var G__55418 \x3d cljs.core.next(rels);
var G__55419 \x3d symbols;
acc \x3d G__55417;
rels \x3d G__55418;
symbols \x3d G__55419;
continue;

}
}
}
break;
}
}));

(datascript.query._collect.cljs$lang$maxFixedArity \x3d 3);

datascript.query.collect \x3d (function datascript$query$collect(context,symbols){
return cljs.core.set(cljs.core.map.cljs$core$IFn$_invoke$arity$2(cljs.core.vec,datascript.query._collect.cljs$core$IFn$_invoke$arity$2(context,symbols)));
});

/**
 * @interface
 */
datascript.query.IContextResolve \x3d function(){};

var datascript$query$IContextResolve$_context_resolve$dyn_55432 \x3d (function (var$,context){
var x__5393__auto__ \x3d (((var$ \x3d\x3d null))?null:var$);
var m__5394__auto__ \x3d (datascript.query._context_resolve[goog.typeOf(x__5393__auto__)]);
if((!((m__5394__auto__ \x3d\x3d null)))){
return (m__5394__auto__.cljs$core$IFn$_invoke$arity$2 ? m__5394__auto__.cljs$core$IFn$_invoke$arity$2(var$,context) : m__5394__auto__.call(null,var$,context));
} else {
var m__5392__auto__ \x3d (datascript.query._context_resolve[\x22_\x22]);
if((!((m__5392__auto__ \x3d\x3d null)))){
return (m__5392__auto__.cljs$core$IFn$_invoke$arity$2 ? m__5392__auto__.cljs$core$IFn$_invoke$arity$2(var$,context) : m__5392__auto__.call(null,var$,context));
} else {
throw cljs.core.missing_protocol(\x22IContextResolve.-context-resolve\x22,var$);
}
}
});
datascript.query._context_resolve \x3d (function datascript$query$_context_resolve(var$,context){
if((((!((var$ \x3d\x3d null)))) \x26\x26 ((!((var$.datascript$query$IContextResolve$_context_resolve$arity$2 \x3d\x3d null)))))){
return var$.datascript$query$IContextResolve$_context_resolve$arity$2(var$,context);
} else {
return datascript$query$IContextResolve$_context_resolve$dyn_55432(var$,context);
}
});

(datascript.parser.Variable.prototype.datascript$query$IContextResolve$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.parser.Variable.prototype.datascript$query$IContextResolve$_context_resolve$arity$2 \x3d (function (var$,context){
var var$__$1 \x3d this;
return datascript.query.context_resolve_val(context,var$__$1.symbol);
}));

(datascript.parser.SrcVar.prototype.datascript$query$IContextResolve$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.parser.SrcVar.prototype.datascript$query$IContextResolve$_context_resolve$arity$2 \x3d (function (var$,context){
var var$__$1 \x3d this;
return cljs.core.get_in.cljs$core$IFn$_invoke$arity$2(context,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22sources\x22,\x22sources\x22,-321166424),var$__$1.symbol], null));
}));

(datascript.parser.PlainSymbol.prototype.datascript$query$IContextResolve$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.parser.PlainSymbol.prototype.datascript$query$IContextResolve$_context_resolve$arity$2 \x3d (function (var$,_){
var var$__$1 \x3d this;
var or__5045__auto__ \x3d cljs.core.get.cljs$core$IFn$_invoke$arity$2(datascript.built_ins.aggregates,var$__$1.symbol);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return datascript.query.resolve_sym(var$__$1.symbol);
}
}));

(datascript.parser.Constant.prototype.datascript$query$IContextResolve$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.parser.Constant.prototype.datascript$query$IContextResolve$_context_resolve$arity$2 \x3d (function (var$,_){
var var$__$1 \x3d this;
return var$__$1.value;
}));
datascript.query._aggregate \x3d (function datascript$query$_aggregate(find_elements,context,tuples){
return cljs.core.mapv.cljs$core$IFn$_invoke$arity$4((function (element,fixed_value,i){
if(datascript.parser.aggregate_QMARK_(element)){
var f \x3d datascript.query._context_resolve(new cljs.core.Keyword(null,\x22fn\x22,\x22fn\x22,-1175266204).cljs$core$IFn$_invoke$arity$1(element),context);
var args \x3d cljs.core.map.cljs$core$IFn$_invoke$arity$2((function (p1__55142_SHARP_){
return datascript.query._context_resolve(p1__55142_SHARP_,context);
}),cljs.core.butlast(new cljs.core.Keyword(null,\x22args\x22,\x22args\x22,1315556576).cljs$core$IFn$_invoke$arity$1(element)));
var vals \x3d cljs.core.map.cljs$core$IFn$_invoke$arity$2((function (p1__55143_SHARP_){
return cljs.core.nth.cljs$core$IFn$_invoke$arity$2(p1__55143_SHARP_,i);
}),tuples);
return cljs.core.apply.cljs$core$IFn$_invoke$arity$2(f,cljs.core.concat.cljs$core$IFn$_invoke$arity$2(args,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [vals], null)));
} else {
return fixed_value;
}
}),find_elements,cljs.core.first(tuples),cljs.core.range.cljs$core$IFn$_invoke$arity$0());
});
datascript.query.idxs_of \x3d (function datascript$query$idxs_of(pred,coll){
return cljs.core.remove.cljs$core$IFn$_invoke$arity$2(cljs.core.nil_QMARK_,cljs.core.map.cljs$core$IFn$_invoke$arity$3((function (p1__55145_SHARP_,p2__55146_SHARP_){
if(cljs.core.truth_((pred.cljs$core$IFn$_invoke$arity$1 ? pred.cljs$core$IFn$_invoke$arity$1(p1__55145_SHARP_) : pred.call(null,p1__55145_SHARP_)))){
return p2__55146_SHARP_;
} else {
return null;
}
}),coll,cljs.core.range.cljs$core$IFn$_invoke$arity$0()));
});
datascript.query.aggregate \x3d (function datascript$query$aggregate(find_elements,context,resultset){
var group_idxs \x3d datascript.query.idxs_of(cljs.core.complement(datascript.parser.aggregate_QMARK_),find_elements);
var group_fn \x3d (function (tuple){
return cljs.core.map.cljs$core$IFn$_invoke$arity$2((function (p1__55147_SHARP_){
return cljs.core.nth.cljs$core$IFn$_invoke$arity$2(tuple,p1__55147_SHARP_);
}),group_idxs);
});
var grouped \x3d cljs.core.group_by(group_fn,resultset);
var iter__5523__auto__ \x3d (function datascript$query$aggregate_$_iter__55148(s__55149){
return (new cljs.core.LazySeq(null,(function (){
var s__55149__$1 \x3d s__55149;
while(true){
var temp__5804__auto__ \x3d cljs.core.seq(s__55149__$1);
if(temp__5804__auto__){
var s__55149__$2 \x3d temp__5804__auto__;
if(cljs.core.chunked_seq_QMARK_(s__55149__$2)){
var c__5521__auto__ \x3d cljs.core.chunk_first(s__55149__$2);
var size__5522__auto__ \x3d cljs.core.count(c__5521__auto__);
var b__55151 \x3d cljs.core.chunk_buffer(size__5522__auto__);
if((function (){var i__55150 \x3d (0);
while(true){
if((i__55150 \x3c size__5522__auto__)){
var vec__55152 \x3d cljs.core._nth(c__5521__auto__,i__55150);
var _ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__55152,(0),null);
var tuples \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__55152,(1),null);
cljs.core.chunk_append(b__55151,datascript.query._aggregate(find_elements,context,tuples));

var G__55434 \x3d (i__55150 + (1));
i__55150 \x3d G__55434;
continue;
} else {
return true;
}
break;
}
})()){
return cljs.core.chunk_cons(cljs.core.chunk(b__55151),datascript$query$aggregate_$_iter__55148(cljs.core.chunk_rest(s__55149__$2)));
} else {
return cljs.core.chunk_cons(cljs.core.chunk(b__55151),null);
}
} else {
var vec__55155 \x3d cljs.core.first(s__55149__$2);
var _ \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__55155,(0),null);
var tuples \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__55155,(1),null);
return cljs.core.cons(datascript.query._aggregate(find_elements,context,tuples),datascript$query$aggregate_$_iter__55148(cljs.core.rest(s__55149__$2)));
}
} else {
return null;
}
break;
}
}),null,null));
});
return iter__5523__auto__(grouped);
});
datascript.query.map_STAR_ \x3d (function datascript$query$map_STAR_(f,xs){
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (p1__55158_SHARP_,p2__55159_SHARP_){
return cljs.core.conj.cljs$core$IFn$_invoke$arity$2(p1__55158_SHARP_,(f.cljs$core$IFn$_invoke$arity$1 ? f.cljs$core$IFn$_invoke$arity$1(p2__55159_SHARP_) : f.call(null,p2__55159_SHARP_)));
}),cljs.core.empty(xs),xs);
});
datascript.query.tuples__GT_return_map \x3d (function datascript$query$tuples__GT_return_map(return_map,tuples){
var symbols \x3d new cljs.core.Keyword(null,\x22symbols\x22,\x22symbols\x22,1211743).cljs$core$IFn$_invoke$arity$1(return_map);
var idxs \x3d cljs.core.range.cljs$core$IFn$_invoke$arity$2((0),cljs.core.count(symbols));
return datascript.query.map_STAR_((function (tuple){
return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (m,i){
return cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(m,cljs.core.nth.cljs$core$IFn$_invoke$arity$2(symbols,i),cljs.core.nth.cljs$core$IFn$_invoke$arity$2(tuple,i));
}),cljs.core.PersistentArrayMap.EMPTY,idxs);
}),tuples);
});

/**
 * @interface
 */
datascript.query.IPostProcess \x3d function(){};

var datascript$query$IPostProcess$_post_process$dyn_55436 \x3d (function (find,return_map,tuples){
var x__5393__auto__ \x3d (((find \x3d\x3d null))?null:find);
var m__5394__auto__ \x3d (datascript.query._post_process[goog.typeOf(x__5393__auto__)]);
if((!((m__5394__auto__ \x3d\x3d null)))){
return (m__5394__auto__.cljs$core$IFn$_invoke$arity$3 ? m__5394__auto__.cljs$core$IFn$_invoke$arity$3(find,return_map,tuples) : m__5394__auto__.call(null,find,return_map,tuples));
} else {
var m__5392__auto__ \x3d (datascript.query._post_process[\x22_\x22]);
if((!((m__5392__auto__ \x3d\x3d null)))){
return (m__5392__auto__.cljs$core$IFn$_invoke$arity$3 ? m__5392__auto__.cljs$core$IFn$_invoke$arity$3(find,return_map,tuples) : m__5392__auto__.call(null,find,return_map,tuples));
} else {
throw cljs.core.missing_protocol(\x22IPostProcess.-post-process\x22,find);
}
}
});
datascript.query._post_process \x3d (function datascript$query$_post_process(find,return_map,tuples){
if((((!((find \x3d\x3d null)))) \x26\x26 ((!((find.datascript$query$IPostProcess$_post_process$arity$3 \x3d\x3d null)))))){
return find.datascript$query$IPostProcess$_post_process$arity$3(find,return_map,tuples);
} else {
return datascript$query$IPostProcess$_post_process$dyn_55436(find,return_map,tuples);
}
});

(datascript.parser.FindRel.prototype.datascript$query$IPostProcess$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.parser.FindRel.prototype.datascript$query$IPostProcess$_post_process$arity$3 \x3d (function (_,return_map,tuples){
var ___$1 \x3d this;
if((return_map \x3d\x3d null)){
return tuples;
} else {
return datascript.query.tuples__GT_return_map(return_map,tuples);
}
}));

(datascript.parser.FindColl.prototype.datascript$query$IPostProcess$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.parser.FindColl.prototype.datascript$query$IPostProcess$_post_process$arity$3 \x3d (function (_,return_map,tuples){
var ___$1 \x3d this;
return cljs.core.into.cljs$core$IFn$_invoke$arity$3(cljs.core.PersistentVector.EMPTY,cljs.core.map.cljs$core$IFn$_invoke$arity$1(cljs.core.first),tuples);
}));

(datascript.parser.FindScalar.prototype.datascript$query$IPostProcess$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.parser.FindScalar.prototype.datascript$query$IPostProcess$_post_process$arity$3 \x3d (function (_,return_map,tuples){
var ___$1 \x3d this;
return cljs.core.ffirst(tuples);
}));

(datascript.parser.FindTuple.prototype.datascript$query$IPostProcess$ \x3d cljs.core.PROTOCOL_SENTINEL);

(datascript.parser.FindTuple.prototype.datascript$query$IPostProcess$_post_process$arity$3 \x3d (function (_,return_map,tuples){
var ___$1 \x3d this;
if((!((return_map \x3d\x3d null)))){
return cljs.core.first(datascript.query.tuples__GT_return_map(return_map,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.first(tuples)], null)));
} else {
return cljs.core.first(tuples);
}
}));
datascript.query.pull \x3d (function datascript$query$pull(find_elements,context,resultset){
var resolved \x3d (function (){var iter__5523__auto__ \x3d (function datascript$query$pull_$_iter__55160(s__55161){
return (new cljs.core.LazySeq(null,(function (){
var s__55161__$1 \x3d s__55161;
while(true){
var temp__5804__auto__ \x3d cljs.core.seq(s__55161__$1);
if(temp__5804__auto__){
var s__55161__$2 \x3d temp__5804__auto__;
if(cljs.core.chunked_seq_QMARK_(s__55161__$2)){
var c__5521__auto__ \x3d cljs.core.chunk_first(s__55161__$2);
var size__5522__auto__ \x3d cljs.core.count(c__5521__auto__);
var b__55163 \x3d cljs.core.chunk_buffer(size__5522__auto__);
if((function (){var i__55162 \x3d (0);
while(true){
if((i__55162 \x3c size__5522__auto__)){
var find \x3d cljs.core._nth(c__5521__auto__,i__55162);
cljs.core.chunk_append(b__55163,((datascript.parser.pull_QMARK_(find))?(function (){var db \x3d datascript.query._context_resolve(new cljs.core.Keyword(null,\x22source\x22,\x22source\x22,-433931539).cljs$core$IFn$_invoke$arity$1(find),context);
var pattern \x3d datascript.query._context_resolve(new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423).cljs$core$IFn$_invoke$arity$1(find),context);
return datascript.pull_api.parse_opts.cljs$core$IFn$_invoke$arity$2(db,pattern);
})():null));

var G__55438 \x3d (i__55162 + (1));
i__55162 \x3d G__55438;
continue;
} else {
return true;
}
break;
}
})()){
return cljs.core.chunk_cons(cljs.core.chunk(b__55163),datascript$query$pull_$_iter__55160(cljs.core.chunk_rest(s__55161__$2)));
} else {
return cljs.core.chunk_cons(cljs.core.chunk(b__55163),null);
}
} else {
var find \x3d cljs.core.first(s__55161__$2);
return cljs.core.cons(((datascript.parser.pull_QMARK_(find))?(function (){var db \x3d datascript.query._context_resolve(new cljs.core.Keyword(null,\x22source\x22,\x22source\x22,-433931539).cljs$core$IFn$_invoke$arity$1(find),context);
var pattern \x3d datascript.query._context_resolve(new cljs.core.Keyword(null,\x22pattern\x22,\x22pattern\x22,242135423).cljs$core$IFn$_invoke$arity$1(find),context);
return datascript.pull_api.parse_opts.cljs$core$IFn$_invoke$arity$2(db,pattern);
})():null),datascript$query$pull_$_iter__55160(cljs.core.rest(s__55161__$2)));
}
} else {
return null;
}
break;
}
}),null,null));
});
return iter__5523__auto__(find_elements);
})();
var iter__5523__auto__ \x3d (function datascript$query$pull_$_iter__55164(s__55165){
return (new cljs.core.LazySeq(null,(function (){
var s__55165__$1 \x3d s__55165;
while(true){
var temp__5804__auto__ \x3d cljs.core.seq(s__55165__$1);
if(temp__5804__auto__){
var s__55165__$2 \x3d temp__5804__auto__;
if(cljs.core.chunked_seq_QMARK_(s__55165__$2)){
var c__5521__auto__ \x3d cljs.core.chunk_first(s__55165__$2);
var size__5522__auto__ \x3d cljs.core.count(c__5521__auto__);
var b__55167 \x3d cljs.core.chunk_buffer(size__5522__auto__);
if((function (){var i__55166 \x3d (0);
while(true){
if((i__55166 \x3c size__5522__auto__)){
var tuple \x3d cljs.core._nth(c__5521__auto__,i__55166);
cljs.core.chunk_append(b__55167,cljs.core.mapv.cljs$core$IFn$_invoke$arity$3(((function (i__55166,tuple,c__5521__auto__,size__5522__auto__,b__55167,s__55165__$2,temp__5804__auto__,resolved){
return (function (parsed_opts,el){
if(cljs.core.truth_(parsed_opts)){
return datascript.pull_api.pull_impl(parsed_opts,el);
} else {
return el;
}
});})(i__55166,tuple,c__5521__auto__,size__5522__auto__,b__55167,s__55165__$2,temp__5804__auto__,resolved))
,resolved,tuple));

var G__55440 \x3d (i__55166 + (1));
i__55166 \x3d G__55440;
continue;
} else {
return true;
}
break;
}
})()){
return cljs.core.chunk_cons(cljs.core.chunk(b__55167),datascript$query$pull_$_iter__55164(cljs.core.chunk_rest(s__55165__$2)));
} else {
return cljs.core.chunk_cons(cljs.core.chunk(b__55167),null);
}
} else {
var tuple \x3d cljs.core.first(s__55165__$2);
return cljs.core.cons(cljs.core.mapv.cljs$core$IFn$_invoke$arity$3(((function (tuple,s__55165__$2,temp__5804__auto__,resolved){
return (function (parsed_opts,el){
if(cljs.core.truth_(parsed_opts)){
return datascript.pull_api.pull_impl(parsed_opts,el);
} else {
return el;
}
});})(tuple,s__55165__$2,temp__5804__auto__,resolved))
,resolved,tuple),datascript$query$pull_$_iter__55164(cljs.core.rest(s__55165__$2)));
}
} else {
return null;
}
break;
}
}),null,null));
});
return iter__5523__auto__(resultset);
});
datascript.query.q \x3d (function datascript$query$q(var_args){
var args__5775__auto__ \x3d [];
var len__5769__auto___55441 \x3d arguments.length;
var i__5770__auto___55442 \x3d (0);
while(true){
if((i__5770__auto___55442 \x3c len__5769__auto___55441)){
args__5775__auto__.push((arguments[i__5770__auto___55442]));

var G__55443 \x3d (i__5770__auto___55442 + (1));
i__5770__auto___55442 \x3d G__55443;
continue;
} else {
}
break;
}

var argseq__5776__auto__ \x3d ((((1) \x3c args__5775__auto__.length))?(new cljs.core.IndexedSeq(args__5775__auto__.slice((1)),(0),null)):null);
return datascript.query.q.cljs$core$IFn$_invoke$arity$variadic((arguments[(0)]),argseq__5776__auto__);
});

(datascript.query.q.cljs$core$IFn$_invoke$arity$variadic \x3d (function (q,inputs){
var parsed_q \x3d datascript.lru._get(datascript.query._STAR_query_cache_STAR_,q,(function (){
return datascript.parser.parse_query(q);
}));
var find \x3d new cljs.core.Keyword(null,\x22qfind\x22,\x22qfind\x22,1529332972).cljs$core$IFn$_invoke$arity$1(parsed_q);
var find_elements \x3d datascript.parser.find_elements(find);
var find_vars \x3d datascript.parser.find_vars(find);
var result_arity \x3d cljs.core.count(find_elements);
var with$ \x3d new cljs.core.Keyword(null,\x22qwith\x22,\x22qwith\x22,-45809392).cljs$core$IFn$_invoke$arity$1(parsed_q);
var all_vars \x3d cljs.core.concat.cljs$core$IFn$_invoke$arity$2(find_vars,cljs.core.map.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22symbol\x22,\x22symbol\x22,-1038572696),with$));
var q__$1 \x3d (function (){var G__55173 \x3d q;
if(cljs.core.sequential_QMARK_(q)){
return datascript.parser.query__GT_map(G__55173);
} else {
return G__55173;
}
})();
var wheres \x3d new cljs.core.Keyword(null,\x22where\x22,\x22where\x22,-2044795965).cljs$core$IFn$_invoke$arity$1(q__$1);
var context \x3d datascript.query.resolve_ins((new datascript.query.Context(cljs.core.PersistentVector.EMPTY,cljs.core.PersistentArrayMap.EMPTY,cljs.core.PersistentArrayMap.EMPTY,null,null,null)),new cljs.core.Keyword(null,\x22qin\x22,\x22qin\x22,1372651151).cljs$core$IFn$_invoke$arity$1(parsed_q),inputs);
var resultset \x3d datascript.query.collect(datascript.query._q(context,wheres),all_vars);
var G__55174 \x3d resultset;
var G__55174__$1 \x3d (cljs.core.truth_(new cljs.core.Keyword(null,\x22with\x22,\x22with\x22,-1536296876).cljs$core$IFn$_invoke$arity$1(q__$1))?cljs.core.mapv.cljs$core$IFn$_invoke$arity$2((function (p1__55169_SHARP_){
return cljs.core.vec(cljs.core.subvec.cljs$core$IFn$_invoke$arity$3(p1__55169_SHARP_,(0),result_arity));
}),G__55174):G__55174);
var G__55174__$2 \x3d (cljs.core.truth_(cljs.core.some(datascript.parser.aggregate_QMARK_,find_elements))?datascript.query.aggregate(find_elements,context,G__55174__$1):G__55174__$1);
var G__55174__$3 \x3d (cljs.core.truth_(cljs.core.some(datascript.parser.pull_QMARK_,find_elements))?datascript.query.pull(find_elements,context,G__55174__$2):G__55174__$2);
return datascript.query._post_process(find,new cljs.core.Keyword(null,\x22qreturn-map\x22,\x22qreturn-map\x22,1841215994).cljs$core$IFn$_invoke$arity$1(parsed_q),G__55174__$3);

}));

(datascript.query.q.cljs$lang$maxFixedArity \x3d (1));

/** @this {Function} */
(datascript.query.q.cljs$lang$applyTo \x3d (function (seq55170){
var G__55171 \x3d cljs.core.first(seq55170);
var seq55170__$1 \x3d cljs.core.next(seq55170);
var self__5754__auto__ \x3d this;
return self__5754__auto__.cljs$core$IFn$_invoke$arity$variadic(G__55171,seq55170__$1);
}));

");
SHADOW_ENV.evalLoad("datascript.core.js", true , "goog.provide(\x27datascript.core\x27);
datascript.core.tx0 \x3d (536870912);
/**
 * Retrieves an entity by its id from database. Entities are lazy map-like structures to navigate DataScript database content.
 * 
 *           For `eid` pass entity id or lookup attr:
 *           
 *               (entity db 1)
 *               (entity db [:unique-attr :value])
 *          
 *           If entity does not exist, `nil` is returned:
 * 
 *               (entity db 100500) ; \x3d\x3e nil
 * 
 *           Creating an entity by id is very cheap, almost no-op, as attr access is on-demand:
 * 
 *               (entity db 1) ; \x3d\x3e {:db/id 1}
 * 
 *           Entity attributes can be lazily accessed through key lookups:
 *           
 *               (:attr (entity db 1)) ; \x3d\x3e :value
 *               (get (entity db 1) :attr) ; \x3d\x3e :value
 * 
 *           Cardinality many attributes are returned sequences:
 * 
 *               (:attrs (entity db 1)) ; \x3d\x3e [:v1 :v2 :v3]
 * 
 *           Reference attributes are returned as another entities:
 * 
 *               (:ref (entity db 1)) ; \x3d\x3e {:db/id 2}
 *               (:ns/ref (entity db 1)) ; \x3d\x3e {:db/id 2}
 * 
 *           References can be walked backwards by prepending `_` to name part of an attribute:
 * 
 *               (:_ref (entity db 2)) ; \x3d\x3e [{:db/id 1}]
 *               (:ns/_ref (entity db 2)) ; \x3d\x3e [{:db/id 1}]
 *           
 *           Reverse reference lookup returns sequence of entities unless attribute is marked as `:db/isComponent`:
 * 
 *               (:_component-ref (entity db 2)) ; \x3d\x3e {:db/id 1}
 * 
 *           Entity gotchas:
 *             
 *           - Entities print as map, but are not exactly maps (they have compatible get interface though).
 *           - Entities are effectively immutable \u201cviews\u201d into a particular version of a database.
 *           - Entities retain reference to the whole database.
 *           - You can\u2019t change database through entities, only read.
 *           - Creating an entity by id is very cheap, almost no-op (attributes are looked up on demand).
 *           - Comparing entities just compares their ids. Be careful when comparing entities taken from different dbs or from different versions of the same db.
 *           - Accessed entity attributes are cached on entity itself (except backward references).
 *           - When printing, only cached attributes (the ones you have accessed before) are printed. See [[touch]].
 */
datascript.core.entity \x3d datascript.impl.entity.entity;
/**
 * Given lookup ref `[unique-attr value]`, returns numberic entity id.
 * 
 *           If entity does not exist, returns `nil`.
 * 
 *           For numeric `eid` returns `eid` itself (does not check for entity existence in that case).
 */
datascript.core.entid \x3d datascript.db.entid;
/**
 * Returns a db that entity was created from.
 */
datascript.core.entity_db \x3d (function datascript$core$entity_db(entity){
if(datascript.impl.entity.entity_QMARK_(entity)){
} else {
throw (new Error(\x22Assert failed: (de/entity? entity)\x22));
}

return entity.db;
});
/**
 * Forces all entity attributes to be eagerly fetched and cached. Only usable for debug output.
 * 
 *           Usage:
 * 
 *           ```
 *           (entity db 1) ; \x3d\x3e {:db/id 1}
 *           (touch (entity db 1)) ; \x3d\x3e {:db/id 1, :dislikes [:pie], :likes [:pizza]}
 *           ```
 */
datascript.core.touch \x3d datascript.impl.entity.touch;
/**
 * Fetches data from database using recursive declarative description. See [docs.datomic.com/on-prem/pull.html](https://docs.datomic.com/on-prem/pull.html).
 * 
 *           Unlike [[entity]], returns plain Clojure map (not lazy).
 * 
 *           Usage:
 * 
 *               (pull db [:db/id, :name, :likes, {:friends [:db/id :name]}] 1)
 *               ; \x3d\x3e {:db/id   1,
 *               ;     :name    \x22Ivan\x22
 *               ;     :likes   [:pizza]
 *               ;     :friends [{:db/id 2, :name \x22Oleg\x22}]}
 */
datascript.core.pull \x3d datascript.pull_api.pull;
/**
 * Same as [[pull]], but accepts sequence of ids and returns sequence of maps.
 * 
 *           Usage:
 * 
 *           ```
 *           (pull-many db [:db/id :name] [1 2])
 *           ; \x3d\x3e [{:db/id 1, :name \x22Ivan\x22}
 *           ;     {:db/id 2, :name \x22Oleg\x22}]
 *           ```
 */
datascript.core.pull_many \x3d datascript.pull_api.pull_many;
/**
 * Executes a datalog query. See [docs.datomic.com/on-prem/query.html](https://docs.datomic.com/on-prem/query.html).
 * 
 *        Usage:
 *        
 *        ```
 *        (q \x27[:find ?value
 *             :where [_ :likes ?value]]
 *           db)
 *        ; \x3d\x3e #{[\x22fries\x22] [\x22candy\x22] [\x22pie\x22] [\x22pizza\x22]}
 *        ```
 */
datascript.core.q \x3d datascript.query.q;
/**
 * Creates an empty database with an optional schema.
 * 
 *           Usage:
 *           
 *           ```
 *           (empty-db) ; \x3d\x3e #datascript/DB {:schema {}, :datoms []}
 *   
 *           (empty-db {:likes {:db/cardinality :db.cardinality/many}})
 *           ; \x3d\x3e #datascript/DB {:schema {:likes {:db/cardinality :db.cardinality/many}}
 *           ;                    :datoms []}
 *           ```
 */
datascript.core.empty_db \x3d datascript.db.empty_db;
/**
 * Returns `true` if the given value is an immutable database, `false` otherwise.
 */
datascript.core.db_QMARK_ \x3d datascript.db.db_QMARK_;
/**
 * Low-level fn to create raw datoms.
 * 
 *           Optionally with transaction id (number) and `added` flag (`true` for addition, `false` for retraction).
 * 
 *           See also [[init-db]].
 */
datascript.core.datom \x3d datascript.db.datom;
/**
 * Returns `true` if the given value is a datom, `false` otherwise.
 */
datascript.core.datom_QMARK_ \x3d datascript.db.datom_QMARK_;
/**
 * Low-level fn for creating database quickly from a trusted sequence of datoms.
 * 
 *           Does no validation on inputs, so `datoms` must be well-formed and match schema.
 * 
 *           Used internally in db (de)serialization. See also [[datom]].
 */
datascript.core.init_db \x3d datascript.db.init_db;
/**
 * Converts db into a data structure (not string!) that can be fed to serializer
 *           of your choice (e.g. `js/JSON.stringify` in CLJS, `cheshire.core/generate-string`
 *           or `jsonista.core/write-value-as-string` in CLJ).
 * 
 *           On JVM, `serializable` holds a global lock that prevents any two serializations
 *           to run in parallel (an implementation constraint, be aware).
 * 
 *           Options:
 * 
 *           `:freeze-fn` Non-primitive values will be serialized using this. Optional.
 *           `pr-str` by default.
 */
datascript.core.serializable \x3d datascript.serialize.serializable;
/**
 * Creates db from a data structure (not string!) produced by serializable.
 * 
 *           Opts:
 * 
 *           `:thaw-fn` Non-primitive values will be deserialized using this.
 *           Must match :freeze-fn from serializable. Optional. `clojure.edn/read-string`
 *           by default.
 */
datascript.core.from_serializable \x3d datascript.serialize.from_serializable;
/**
 * Returns a schema of a database.
 */
datascript.core.schema \x3d datascript.db._schema;
/**
 * Returns `true` if this database was filtered using [[filter]], `false` otherwise.
 */
datascript.core.is_filtered \x3d (function datascript$core$is_filtered(x){
return (x instanceof datascript.db.FilteredDB);
});
/**
 * Returns a view over database that has same interface but only includes datoms for which the `(pred db datom)` is true. Can be applied multiple times.
 * 
 * Filtered DB gotchas:
 * 
 * - All operations on filtered database are proxied to original DB, then filter pred is applied.
 * - Not cached. You pay filter penalty every time.
 * - Supports entities, pull, queries, index access.
 * - Does not support [[with]] and [[db-with]].
 */
datascript.core.filter \x3d (function datascript$core$filter(db,pred){
if(datascript.db.db_QMARK_(db)){
} else {
throw (new Error(\x22Assert failed: (db/db? db)\x22));
}

if(datascript.core.is_filtered(db)){
var fdb \x3d db;
var orig_pred \x3d fdb.pred;
var orig_db \x3d fdb.unfiltered_db;
return (new datascript.db.FilteredDB(orig_db,(function (p1__55196_SHARP_){
var and__5043__auto__ \x3d (orig_pred.cljs$core$IFn$_invoke$arity$1 ? orig_pred.cljs$core$IFn$_invoke$arity$1(p1__55196_SHARP_) : orig_pred.call(null,p1__55196_SHARP_));
if(cljs.core.truth_(and__5043__auto__)){
return (pred.cljs$core$IFn$_invoke$arity$2 ? pred.cljs$core$IFn$_invoke$arity$2(orig_db,p1__55196_SHARP_) : pred.call(null,orig_db,p1__55196_SHARP_));
} else {
return and__5043__auto__;
}
}),cljs.core.atom.cljs$core$IFn$_invoke$arity$1((0)),null,null,null));
} else {
return (new datascript.db.FilteredDB(db,(function (p1__55197_SHARP_){
return (pred.cljs$core$IFn$_invoke$arity$2 ? pred.cljs$core$IFn$_invoke$arity$2(db,p1__55197_SHARP_) : pred.call(null,db,p1__55197_SHARP_));
}),cljs.core.atom.cljs$core$IFn$_invoke$arity$1((0)),null,null,null));
}
});
/**
 * Same as [[transact!]], but applies to an immutable database value. Returns transaction report (see [[transact!]]).
 */
datascript.core.with$ \x3d (function datascript$core$with(var_args){
var G__55201 \x3d arguments.length;
switch (G__55201) {
case 2:
return datascript.core.with$.cljs$core$IFn$_invoke$arity$2((arguments[(0)]),(arguments[(1)]));

break;
case 3:
return datascript.core.with$.cljs$core$IFn$_invoke$arity$3((arguments[(0)]),(arguments[(1)]),(arguments[(2)]));

break;
default:
throw (new Error([\x22Invalid arity: \x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1(arguments.length)].join(\x27\x27)));

}
});

(datascript.core.with$.cljs$core$IFn$_invoke$arity$2 \x3d (function (db,tx_data){
return datascript.core.with$.cljs$core$IFn$_invoke$arity$3(db,tx_data,null);
}));

(datascript.core.with$.cljs$core$IFn$_invoke$arity$3 \x3d (function (db,tx_data,tx_meta){
if(datascript.db.db_QMARK_(db)){
} else {
throw (new Error(\x22Assert failed: (db/db? db)\x22));
}

if(datascript.core.is_filtered(db)){
throw cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2(\x22Filtered DB cannot be modified\x22,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,\x22error\x22,\x22error\x22,-978969032),new cljs.core.Keyword(\x22transaction\x22,\x22filtered\x22,\x22transaction/filtered\x22,1699706605)], null));
} else {
return datascript.db.transact_tx_data(datascript.db.map__GT_TxReport(new cljs.core.PersistentArrayMap(null, 5, [new cljs.core.Keyword(null,\x22db-before\x22,\x22db-before\x22,-553691536),db,new cljs.core.Keyword(null,\x22db-after\x22,\x22db-after\x22,-571884666),db,new cljs.core.Keyword(null,\x22tx-data\x22,\x22tx-data\x22,934159761),cljs.core.PersistentVector.EMPTY,new cljs.core.Keyword(null,\x22tempids\x22,\x22tempids\x22,1767509089),cljs.core.PersistentArrayMap.EMPTY,new cljs.core.Keyword(null,\x22tx-meta\x22,\x22tx-meta\x22,1159283194),tx_meta], null)),tx_data);
}
}));

(datascript.core.with$.cljs$lang$maxFixedArity \x3d 3);

/**
 * Applies transaction to an immutable db value, returning new immutable db value. Same as `(:db-after (with db tx-data))`.
 */
datascript.core.db_with \x3d (function datascript$core$db_with(db,tx_data){
if(datascript.db.db_QMARK_(db)){
} else {
throw (new Error(\x22Assert failed: (db/db? db)\x22));
}

return new cljs.core.Keyword(null,\x22db-after\x22,\x22db-after\x22,-571884666).cljs$core$IFn$_invoke$arity$1(datascript.core.with$.cljs$core$IFn$_invoke$arity$2(db,tx_data));
});
/**
 * Index lookup. Returns a sequence of datoms (lazy iterator over actual DB index) which components (e, a, v) match passed arguments.
 * 
 * Datoms are sorted in index sort order. Possible `index` values are: `:eavt`, `:aevt`, `:avet`.
 * 
 * Usage:
 * 
 *     ; find all datoms for entity id \x3d\x3d 1 (any attrs and values)
 *     ; sort by attribute, then value
 *     (datoms db :eavt 1)
 *     ; \x3d\x3e (#datascript/Datom [1 :friends 2]
 *     ;     #datascript/Datom [1 :likes \x22fries\x22]
 *     ;     #datascript/Datom [1 :likes \x22pizza\x22]
 *     ;     #datascript/Datom [1 :name \x22Ivan\x22])
 *   
 *     ; find all datoms for entity id \x3d\x3d 1 and attribute \x3d\x3d :likes (any values)
 *     ; sorted by value
 *     (datoms db :eavt 1 :likes)
 *     ; \x3d\x3e (#datascript/Datom [1 :likes \x22fries\x22]
 *     ;     #datascript/Datom [1 :likes \x22pizza\x22])
 *     
 *     ; find all datoms for entity id \x3d\x3d 1, attribute \x3d\x3d :likes and value \x3d\x3d \x22pizza\x22
 *     (datoms db :eavt 1 :likes \x22pizza\x22)
 *     ; \x3d\x3e (#datascript/Datom [1 :likes \x22pizza\x22])
 *   
 *     ; find all datoms for attribute \x3d\x3d :likes (any entity ids and values)
 *     ; sorted by entity id, then value
 *     (datoms db :aevt :likes)
 *     ; \x3d\x3e (#datascript/Datom [1 :likes \x22fries\x22]
 *     ;     #datascript/Datom [1 :likes \x22pizza\x22]
 *     ;     #datascript/Datom [2 :likes \x22candy\x22]
 *     ;     #datascript/Datom [2 :likes \x22pie\x22]
 *     ;     #datascript/Datom [2 :likes \x22pizza\x22])
 *   
 *     ; find all datoms that have attribute \x3d\x3d `:likes` and value \x3d\x3d `\x22pizza\x22` (any entity id)
 *     ; `:likes` must be a unique attr, reference or marked as `:db/index true`
 *     (datoms db :avet :likes \x22pizza\x22)
 *     ; \x3d\x3e (#datascript/Datom [1 :likes \x22pizza\x22]
 *     ;     #datascript/Datom [2 :likes \x22pizza\x22])
 *   
 *     ; find all datoms sorted by entity id, then attribute, then value
 *     (datoms db :eavt) ; \x3d\x3e (...)
 * 
 * Useful patterns:
 * 
 *     ; get all values of :db.cardinality/many attribute
 *     (-\x3e\x3e (datoms db :eavt eid attr) (map :v))
 *   
 *     ; lookup entity ids by attribute value
 *     (-\x3e\x3e (datoms db :avet attr value) (map :e))
 *   
 *     ; find all entities with a specific attribute
 *     (-\x3e\x3e (datoms db :aevt attr) (map :e))
 *   
 *     ; find \u201csingleton\u201d entity by its attr
 *     (-\x3e\x3e (datoms db :aevt attr) first :e)
 *   
 *     ; find N entities with lowest attr value (e.g. 10 earliest posts)
 *     (-\x3e\x3e (datoms db :avet attr) (take N))
 *   
 *     ; find N entities with highest attr value (e.g. 10 latest posts)
 *     (-\x3e\x3e (datoms db :avet attr) (reverse) (take N))
 * 
 * Gotchas:
 * 
 * - Index lookup is usually more efficient than doing a query with a single clause.
 * - Resulting iterator is calculated in constant time and small constant memory overhead.
 * - Iterator supports efficient `first`, `next`, `reverse`, `seq` and is itself a sequence.
 * - Will not return datoms that are not part of the index (e.g. attributes with no `:db/index` in schema when querying `:avet` index).
 *   - `:eavt` and `:aevt` contain all datoms.
 *   - `:avet` only contains datoms for references, `:db/unique` and `:db/index` attributes.
 */
datascript.core.datoms \x3d (function datascript$core$datoms(var_args){
var G__55212 \x3d arguments.length;
switch (G__55212) {
case 2:
return datascript.core.datoms.cljs$core$IFn$_invoke$arity$2((arguments[(0)]),(arguments[(1)]));

break;
case 3:
return datascript.core.datoms.cljs$core$IFn$_invoke$arity$3((arguments[(0)]),(arguments[(1)]),(arguments[(2)]));

break;
case 4:
return datascript.core.datoms.cljs$core$IFn$_invoke$arity$4((arguments[(0)]),(arguments[(1)]),(arguments[(2)]),(arguments[(3)]));

break;
case 5:
return datascript.core.datoms.cljs$core$IFn$_invoke$arity$5((arguments[(0)]),(arguments[(1)]),(arguments[(2)]),(arguments[(3)]),(arguments[(4)]));

break;
case 6:
return datascript.core.datoms.cljs$core$IFn$_invoke$arity$6((arguments[(0)]),(arguments[(1)]),(arguments[(2)]),(arguments[(3)]),(arguments[(4)]),(arguments[(5)]));

break;
default:
throw (new Error([\x22Invalid arity: \x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1(arguments.length)].join(\x27\x27)));

}
});

(datascript.core.datoms.cljs$core$IFn$_invoke$arity$2 \x3d (function (db,index){
if(datascript.db.db_QMARK_(db)){
} else {
throw (new Error(\x22Assert failed: (db/db? db)\x22));
}

return datascript.db._datoms(db,index,cljs.core.PersistentVector.EMPTY);
}));

(datascript.core.datoms.cljs$core$IFn$_invoke$arity$3 \x3d (function (db,index,c1){
if(datascript.db.db_QMARK_(db)){
} else {
throw (new Error(\x22Assert failed: (db/db? db)\x22));
}

return datascript.db._datoms(db,index,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [c1], null));
}));

(datascript.core.datoms.cljs$core$IFn$_invoke$arity$4 \x3d (function (db,index,c1,c2){
if(datascript.db.db_QMARK_(db)){
} else {
throw (new Error(\x22Assert failed: (db/db? db)\x22));
}

return datascript.db._datoms(db,index,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [c1,c2], null));
}));

(datascript.core.datoms.cljs$core$IFn$_invoke$arity$5 \x3d (function (db,index,c1,c2,c3){
if(datascript.db.db_QMARK_(db)){
} else {
throw (new Error(\x22Assert failed: (db/db? db)\x22));
}

return datascript.db._datoms(db,index,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [c1,c2,c3], null));
}));

(datascript.core.datoms.cljs$core$IFn$_invoke$arity$6 \x3d (function (db,index,c1,c2,c3,c4){
if(datascript.db.db_QMARK_(db)){
} else {
throw (new Error(\x22Assert failed: (db/db? db)\x22));
}

return datascript.db._datoms(db,index,new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [c1,c2,c3,c4], null));
}));

(datascript.core.datoms.cljs$lang$maxFixedArity \x3d 6);

/**
 * Similar to [[datoms]], but will return datoms starting from specified components and including rest of the database until the end of the index.
 * 
 * If no datom matches passed arguments exactly, iterator will start from first datom that could be considered \u201cgreater\u201d in index order.
 * 
 * Usage:
 * 
 *     (seek-datoms db :eavt 1)
 *     ; \x3d\x3e (#datascript/Datom [1 :friends 2]
 *     ;     #datascript/Datom [1 :likes \x22fries\x22]
 *     ;     #datascript/Datom [1 :likes \x22pizza\x22]
 *     ;     #datascript/Datom [1 :name \x22Ivan\x22]
 *     ;     #datascript/Datom [2 :likes \x22candy\x22]
 *     ;     #datascript/Datom [2 :likes \x22pie\x22]
 *     ;     #datascript/Datom [2 :likes \x22pizza\x22])
 * 
 *     (seek-datoms db :eavt 1 :name)
 *     ; \x3d\x3e (#datascript/Datom [1 :name \x22Ivan\x22]
 *     ;     #datascript/Datom [2 :likes \x22candy\x22]
 *     ;     #datascript/Datom [2 :likes \x22pie\x22]
 *     ;     #datascript/Datom [2 :likes \x22pizza\x22])
 *   
 *     (seek-datoms db :eavt 2) 
 *     ; \x3d\x3e (#datascript/Datom [2 :likes \x22candy\x22]
 *     ;     #datascript/Datom [2 :likes \x22pie\x22]
 *     ;     #datascript/Datom [2 :likes \x22pizza\x22])
 *   
 *     ; no datom [2 :likes \x22fish\x22], so starts with one immediately following such in index
 *     (seek-datoms db :eavt 2 :likes \x22fish\x22)
 *     ; \x3d\x3e (#datascript/Datom [2 :likes \x22pie\x22]
 *     ;     #datascript/Datom [2 :likes \x22pizza\x22])
 */
datascript.core.seek_datoms \x3d (function datascript$core$seek_datoms(var_args){
var G__55242 \x3d arguments.length;
switch (G__55242) {
case 2:
return datascript.core.seek_datoms.cljs$core$IFn$_invoke$arity$2((arguments[(0)]),(arguments[(1)]));

break;
case 3:
return datascript.core.seek_datoms.cljs$core$IFn$_invoke$arity$3((arguments[(0)]),(arguments[(1)]),(arguments[(2)]));

break;
case 4:
return datascript.core.seek_datoms.cljs$core$IFn$_invoke$arity$4((arguments[(0)]),(arguments[(1)]),(arguments[(2)]),(arguments[(3)]));

break;
case 5:
return datascript.core.seek_datoms.cljs$core$IFn$_invoke$arity$5((arguments[(0)]),(arguments[(1)]),(arguments[(2)]),(arguments[(3)]),(arguments[(4)]));

break;
case 6:
return datascript.core.seek_datoms.cljs$core$IFn$_invoke$arity$6((arguments[(0)]),(arguments[(1)]),(arguments[(2)]),(arguments[(3)]),(arguments[(4)]),(arguments[(5)]));

break;
default:
throw (new Error([\x22Invalid arity: \x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1(arguments.length)].join(\x27\x27)));

}
});

(datascript.core.seek_datoms.cljs$core$IFn$_invoke$arity$2 \x3d (function (db,index){
if(datascript.db.db_QMARK_(db)){
} else {
throw (new Error(\x22Assert failed: (db/db? db)\x22));
}

return datascript.db._seek_datoms(db,index,cljs.core.PersistentVector.EMPTY);
}));

(datascript.core.seek_datoms.cljs$core$IFn$_invoke$arity$3 \x3d (function (db,index,c1){
if(datascript.db.db_QMARK_(db)){
} else {
throw (new Error(\x22Assert failed: (db/db? db)\x22));
}

return datascript.db._seek_datoms(db,index,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [c1], null));
}));

(datascript.core.seek_datoms.cljs$core$IFn$_invoke$arity$4 \x3d (function (db,index,c1,c2){
if(datascript.db.db_QMARK_(db)){
} else {
throw (new Error(\x22Assert failed: (db/db? db)\x22));
}

return datascript.db._seek_datoms(db,index,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [c1,c2], null));
}));

(datascript.core.seek_datoms.cljs$core$IFn$_invoke$arity$5 \x3d (function (db,index,c1,c2,c3){
if(datascript.db.db_QMARK_(db)){
} else {
throw (new Error(\x22Assert failed: (db/db? db)\x22));
}

return datascript.db._seek_datoms(db,index,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [c1,c2,c3], null));
}));

(datascript.core.seek_datoms.cljs$core$IFn$_invoke$arity$6 \x3d (function (db,index,c1,c2,c3,c4){
if(datascript.db.db_QMARK_(db)){
} else {
throw (new Error(\x22Assert failed: (db/db? db)\x22));
}

return datascript.db._seek_datoms(db,index,new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [c1,c2,c3,c4], null));
}));

(datascript.core.seek_datoms.cljs$lang$maxFixedArity \x3d 6);

/**
 * Same as [[seek-datoms]], but goes backwards until the beginning of the index.
 */
datascript.core.rseek_datoms \x3d (function datascript$core$rseek_datoms(var_args){
var G__55271 \x3d arguments.length;
switch (G__55271) {
case 2:
return datascript.core.rseek_datoms.cljs$core$IFn$_invoke$arity$2((arguments[(0)]),(arguments[(1)]));

break;
case 3:
return datascript.core.rseek_datoms.cljs$core$IFn$_invoke$arity$3((arguments[(0)]),(arguments[(1)]),(arguments[(2)]));

break;
case 4:
return datascript.core.rseek_datoms.cljs$core$IFn$_invoke$arity$4((arguments[(0)]),(arguments[(1)]),(arguments[(2)]),(arguments[(3)]));

break;
case 5:
return datascript.core.rseek_datoms.cljs$core$IFn$_invoke$arity$5((arguments[(0)]),(arguments[(1)]),(arguments[(2)]),(arguments[(3)]),(arguments[(4)]));

break;
case 6:
return datascript.core.rseek_datoms.cljs$core$IFn$_invoke$arity$6((arguments[(0)]),(arguments[(1)]),(arguments[(2)]),(arguments[(3)]),(arguments[(4)]),(arguments[(5)]));

break;
default:
throw (new Error([\x22Invalid arity: \x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1(arguments.length)].join(\x27\x27)));

}
});

(datascript.core.rseek_datoms.cljs$core$IFn$_invoke$arity$2 \x3d (function (db,index){
if(datascript.db.db_QMARK_(db)){
} else {
throw (new Error(\x22Assert failed: (db/db? db)\x22));
}

return datascript.db._rseek_datoms(db,index,cljs.core.PersistentVector.EMPTY);
}));

(datascript.core.rseek_datoms.cljs$core$IFn$_invoke$arity$3 \x3d (function (db,index,c1){
if(datascript.db.db_QMARK_(db)){
} else {
throw (new Error(\x22Assert failed: (db/db? db)\x22));
}

return datascript.db._rseek_datoms(db,index,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [c1], null));
}));

(datascript.core.rseek_datoms.cljs$core$IFn$_invoke$arity$4 \x3d (function (db,index,c1,c2){
if(datascript.db.db_QMARK_(db)){
} else {
throw (new Error(\x22Assert failed: (db/db? db)\x22));
}

return datascript.db._rseek_datoms(db,index,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [c1,c2], null));
}));

(datascript.core.rseek_datoms.cljs$core$IFn$_invoke$arity$5 \x3d (function (db,index,c1,c2,c3){
if(datascript.db.db_QMARK_(db)){
} else {
throw (new Error(\x22Assert failed: (db/db? db)\x22));
}

return datascript.db._rseek_datoms(db,index,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [c1,c2,c3], null));
}));

(datascript.core.rseek_datoms.cljs$core$IFn$_invoke$arity$6 \x3d (function (db,index,c1,c2,c3,c4){
if(datascript.db.db_QMARK_(db)){
} else {
throw (new Error(\x22Assert failed: (db/db? db)\x22));
}

return datascript.db._rseek_datoms(db,index,new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [c1,c2,c3,c4], null));
}));

(datascript.core.rseek_datoms.cljs$lang$maxFixedArity \x3d 6);

/**
 * Returns part of `:avet` index between `[_ attr start]` and `[_ attr end]` in AVET sort order.
 *   
 * Same properties as [[datoms]].
 * 
 * `attr` must be a reference, unique attribute or marked as `:db/index true`.
 * 
 * Usage:
 * 
 *     (index-range db :likes \x22a\x22 \x22zzzzzzzzz\x22)
 *     ; \x3d\x3e (#datascript/Datom [2 :likes \x22candy\x22]
 *     ;     #datascript/Datom [1 :likes \x22fries\x22]
 *     ;     #datascript/Datom [2 :likes \x22pie\x22]
 *     ;     #datascript/Datom [1 :likes \x22pizza\x22]
 *     ;     #datascript/Datom [2 :likes \x22pizza\x22])
 *      
 *     (index-range db :likes \x22egg\x22 \x22pineapple\x22)
 *     ; \x3d\x3e (#datascript/Datom [1 :likes \x22fries\x22]
 *     ;     #datascript/Datom [2 :likes \x22pie\x22])
 *         
 * Useful patterns:
 *   
 *     ; find all entities with age in a specific range (inclusive)
 *     (-\x3e\x3e (index-range db :age 18 60) (map :e))
 */
datascript.core.index_range \x3d (function datascript$core$index_range(db,attr,start,end){
if(datascript.db.db_QMARK_(db)){
} else {
throw (new Error(\x22Assert failed: (db/db? db)\x22));
}

return datascript.db._index_range(db,attr,start,end);
});
/**
 * Returns `true` if this is a connection to a DataScript db, `false` otherwise.
 */
datascript.core.conn_QMARK_ \x3d (function datascript$core$conn_QMARK_(conn){
var and__5043__auto__ \x3d (((!((conn \x3d\x3d null))))?(((((conn.cljs$lang$protocol_mask$partition0$ \x26 (32768))) || ((cljs.core.PROTOCOL_SENTINEL \x3d\x3d\x3d conn.cljs$core$IDeref$))))?true:(((!conn.cljs$lang$protocol_mask$partition0$))?cljs.core.native_satisfies_QMARK_(cljs.core.IDeref,conn):false)):cljs.core.native_satisfies_QMARK_(cljs.core.IDeref,conn));
if(and__5043__auto__){
return datascript.db.db_QMARK_(cljs.core.deref(conn));
} else {
return and__5043__auto__;
}
});
/**
 * Creates a mutable reference to a given immutable database. See [[create-conn]].
 */
datascript.core.conn_from_db \x3d (function datascript$core$conn_from_db(db){
return cljs.core.atom.cljs$core$IFn$_invoke$arity$variadic(db,cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,\x22meta\x22,\x22meta\x22,1499536964),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,\x22listeners\x22,\x22listeners\x22,394544445),cljs.core.atom.cljs$core$IFn$_invoke$arity$1(cljs.core.PersistentArrayMap.EMPTY)], null)], 0));
});
/**
 * Creates an empty DB and a mutable reference to it. See [[create-conn]].
 */
datascript.core.conn_from_datoms \x3d (function datascript$core$conn_from_datoms(var_args){
var G__55275 \x3d arguments.length;
switch (G__55275) {
case 1:
return datascript.core.conn_from_datoms.cljs$core$IFn$_invoke$arity$1((arguments[(0)]));

break;
case 2:
return datascript.core.conn_from_datoms.cljs$core$IFn$_invoke$arity$2((arguments[(0)]),(arguments[(1)]));

break;
default:
throw (new Error([\x22Invalid arity: \x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1(arguments.length)].join(\x27\x27)));

}
});

(datascript.core.conn_from_datoms.cljs$core$IFn$_invoke$arity$1 \x3d (function (datoms){
return datascript.core.conn_from_db((datascript.core.init_db.cljs$core$IFn$_invoke$arity$1 ? datascript.core.init_db.cljs$core$IFn$_invoke$arity$1(datoms) : datascript.core.init_db.call(null,datoms)));
}));

(datascript.core.conn_from_datoms.cljs$core$IFn$_invoke$arity$2 \x3d (function (datoms,schema){
return datascript.core.conn_from_db((datascript.core.init_db.cljs$core$IFn$_invoke$arity$2 ? datascript.core.init_db.cljs$core$IFn$_invoke$arity$2(datoms,schema) : datascript.core.init_db.call(null,datoms,schema)));
}));

(datascript.core.conn_from_datoms.cljs$lang$maxFixedArity \x3d 2);

/**
 * Creates a mutable reference (a \u201cconnection\u201d) to an empty immutable database.
 * 
 * Connections are lightweight in-memory structures (~atoms) with direct support of transaction listeners ([[listen!]], [[unlisten!]]) and other handy DataScript APIs ([[transact!]], [[reset-conn!]], [[db]]).
 * 
 * To access underlying immutable DB value, deref: `@conn`.
 */
datascript.core.create_conn \x3d (function datascript$core$create_conn(var_args){
var G__55279 \x3d arguments.length;
switch (G__55279) {
case 0:
return datascript.core.create_conn.cljs$core$IFn$_invoke$arity$0();

break;
case 1:
return datascript.core.create_conn.cljs$core$IFn$_invoke$arity$1((arguments[(0)]));

break;
default:
throw (new Error([\x22Invalid arity: \x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1(arguments.length)].join(\x27\x27)));

}
});

(datascript.core.create_conn.cljs$core$IFn$_invoke$arity$0 \x3d (function (){
return datascript.core.conn_from_db((datascript.core.empty_db.cljs$core$IFn$_invoke$arity$0 ? datascript.core.empty_db.cljs$core$IFn$_invoke$arity$0() : datascript.core.empty_db.call(null)));
}));

(datascript.core.create_conn.cljs$core$IFn$_invoke$arity$1 \x3d (function (schema){
return datascript.core.conn_from_db((datascript.core.empty_db.cljs$core$IFn$_invoke$arity$1 ? datascript.core.empty_db.cljs$core$IFn$_invoke$arity$1(schema) : datascript.core.empty_db.call(null,schema)));
}));

(datascript.core.create_conn.cljs$lang$maxFixedArity \x3d 1);

datascript.core._transact_BANG_ \x3d (function datascript$core$_transact_BANG_(conn,tx_data,tx_meta){
if(datascript.core.conn_QMARK_(conn)){
} else {
throw (new Error(\x22Assert failed: (conn? conn)\x22));
}

var report \x3d cljs.core.atom.cljs$core$IFn$_invoke$arity$1(null);
cljs.core.swap_BANG_.cljs$core$IFn$_invoke$arity$2(conn,(function (db){
var r \x3d datascript.core.with$.cljs$core$IFn$_invoke$arity$3(db,tx_data,tx_meta);
cljs.core.reset_BANG_(report,r);

return new cljs.core.Keyword(null,\x22db-after\x22,\x22db-after\x22,-571884666).cljs$core$IFn$_invoke$arity$1(r);
}));

return cljs.core.deref(report);
});
/**
 * Applies transaction the underlying database value and atomically updates connection reference to point to the result of that transaction, new db value.
 *   
 * Returns transaction report, a map:
 * 
 *     { :db-before ...       ; db value before transaction
 *       :db-after  ...       ; db value after transaction
 *       :tx-data   [...]     ; plain datoms that were added/retracted from db-before
 *       :tempids   {...}     ; map of tempid from tx-data \x3d\x3e assigned entid in db-after
 *       :tx-meta   tx-meta } ; the exact value you passed as `tx-meta`
 * 
 *   Note! `conn` will be updated in-place and is not returned from [[transact!]].
 *   
 *   Usage:
 * 
 *    ; add a single datom to an existing entity (1)
 *    (transact! conn [[:db/add 1 :name \x22Ivan\x22]])
 *   
 *    ; retract a single datom
 *    (transact! conn [[:db/retract 1 :name \x22Ivan\x22]])
 *   
 *    ; retract single entity attribute
 *    (transact! conn [[:db.fn/retractAttribute 1 :name]])
 *   
 *    ; ... or equivalently (since Datomic changed its API to support this):
 *    (transact! conn [[:db/retract 1 :name]])
 *    
 *    ; retract all entity attributes (effectively deletes entity)
 *    (transact! conn [[:db.fn/retractEntity 1]])
 *   
 *    ; create a new entity (`-1`, as any other negative value, is a tempid
 *    ; that will be replaced with DataScript to a next unused eid)
 *    (transact! conn [[:db/add -1 :name \x22Ivan\x22]])
 *   
 *    ; check assigned id (here `*1` is a result returned from previous `transact!` call)
 *    (def report *1)
 *    (:tempids report) ; \x3d\x3e {-1 296}
 *   
 *    ; check actual datoms inserted
 *    (:tx-data report) ; \x3d\x3e [#datascript/Datom [296 :name \x22Ivan\x22]]
 *   
 *    ; tempid can also be a string
 *    (transact! conn [[:db/add \x22ivan\x22 :name \x22Ivan\x22]])
 *    (:tempids *1) ; \x3d\x3e {\x22ivan\x22 297}
 *   
 *    ; reference another entity (must exist)
 *    (transact! conn [[:db/add -1 :friend 296]])
 *   
 *    ; create an entity and set multiple attributes (in a single transaction
 *    ; equal tempids will be replaced with the same yet unused entid)
 *    (transact! conn [[:db/add -1 :name \x22Ivan\x22]
 *                     [:db/add -1 :likes \x22fries\x22]
 *                     [:db/add -1 :likes \x22pizza\x22]
 *                     [:db/add -1 :friend 296]])
 *   
 *    ; create an entity and set multiple attributes (alternative map form)
 *    (transact! conn [{:db/id  -1
 *                      :name   \x22Ivan\x22
 *                      :likes  [\x22fries\x22 \x22pizza\x22]
 *                      :friend 296}])
 *    
 *    ; update an entity (alternative map form). Can\u2019t retract attributes in
 *    ; map form. For cardinality many attrs, value (fish in this example)
 *    ; will be added to the list of existing values
 *    (transact! conn [{:db/id  296
 *                      :name   \x22Oleg\x22
 *                      :likes  [\x22fish\x22]}])
 * 
 *    ; ref attributes can be specified as nested map, that will create nested entity as well
 *    (transact! conn [{:db/id  -1
 *                      :name   \x22Oleg\x22
 *                      :friend {:db/id -2
 *                               :name \x22Sergey\x22}}])
 *                               
 *    ; reverse attribute name can be used if you want created entity to become
 *    ; a value in another entity reference
 *    (transact! conn [{:db/id  -1
 *                      :name   \x22Oleg\x22
 *                      :_friend 296}])
 *    ; equivalent to
 *    (transact! conn [{:db/id  -1, :name   \x22Oleg\x22}
 *                     {:db/id 296, :friend -1}])
 *    ; equivalent to
 *    (transact! conn [[:db/add  -1 :name   \x22Oleg\x22]
 *                     [:db/add 296 :friend -1]])
 */
datascript.core.transact_BANG_ \x3d (function datascript$core$transact_BANG_(var_args){
var G__55283 \x3d arguments.length;
switch (G__55283) {
case 2:
return datascript.core.transact_BANG_.cljs$core$IFn$_invoke$arity$2((arguments[(0)]),(arguments[(1)]));

break;
case 3:
return datascript.core.transact_BANG_.cljs$core$IFn$_invoke$arity$3((arguments[(0)]),(arguments[(1)]),(arguments[(2)]));

break;
default:
throw (new Error([\x22Invalid arity: \x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1(arguments.length)].join(\x27\x27)));

}
});

(datascript.core.transact_BANG_.cljs$core$IFn$_invoke$arity$2 \x3d (function (conn,tx_data){
return datascript.core.transact_BANG_.cljs$core$IFn$_invoke$arity$3(conn,tx_data,null);
}));

(datascript.core.transact_BANG_.cljs$core$IFn$_invoke$arity$3 \x3d (function (conn,tx_data,tx_meta){
if(datascript.core.conn_QMARK_(conn)){
} else {
throw (new Error(\x22Assert failed: (conn? conn)\x22));
}

var report \x3d datascript.core._transact_BANG_(conn,tx_data,tx_meta);
var seq__55284_55447 \x3d cljs.core.seq((function (){var G__55301 \x3d new cljs.core.Keyword(null,\x22listeners\x22,\x22listeners\x22,394544445).cljs$core$IFn$_invoke$arity$1(cljs.core.meta(conn));
if((G__55301 \x3d\x3d null)){
return null;
} else {
return cljs.core.deref(G__55301);
}
})());
var chunk__55285_55448 \x3d null;
var count__55286_55449 \x3d (0);
var i__55287_55450 \x3d (0);
while(true){
if((i__55287_55450 \x3c count__55286_55449)){
var vec__55305_55451 \x3d chunk__55285_55448.cljs$core$IIndexed$_nth$arity$2(null,i__55287_55450);
var __55452 \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__55305_55451,(0),null);
var callback_55453 \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__55305_55451,(1),null);
(callback_55453.cljs$core$IFn$_invoke$arity$1 ? callback_55453.cljs$core$IFn$_invoke$arity$1(report) : callback_55453.call(null,report));


var G__55454 \x3d seq__55284_55447;
var G__55455 \x3d chunk__55285_55448;
var G__55456 \x3d count__55286_55449;
var G__55457 \x3d (i__55287_55450 + (1));
seq__55284_55447 \x3d G__55454;
chunk__55285_55448 \x3d G__55455;
count__55286_55449 \x3d G__55456;
i__55287_55450 \x3d G__55457;
continue;
} else {
var temp__5804__auto___55458 \x3d cljs.core.seq(seq__55284_55447);
if(temp__5804__auto___55458){
var seq__55284_55459__$1 \x3d temp__5804__auto___55458;
if(cljs.core.chunked_seq_QMARK_(seq__55284_55459__$1)){
var c__5568__auto___55460 \x3d cljs.core.chunk_first(seq__55284_55459__$1);
var G__55461 \x3d cljs.core.chunk_rest(seq__55284_55459__$1);
var G__55462 \x3d c__5568__auto___55460;
var G__55463 \x3d cljs.core.count(c__5568__auto___55460);
var G__55464 \x3d (0);
seq__55284_55447 \x3d G__55461;
chunk__55285_55448 \x3d G__55462;
count__55286_55449 \x3d G__55463;
i__55287_55450 \x3d G__55464;
continue;
} else {
var vec__55316_55465 \x3d cljs.core.first(seq__55284_55459__$1);
var __55466 \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__55316_55465,(0),null);
var callback_55467 \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__55316_55465,(1),null);
(callback_55467.cljs$core$IFn$_invoke$arity$1 ? callback_55467.cljs$core$IFn$_invoke$arity$1(report) : callback_55467.call(null,report));


var G__55468 \x3d cljs.core.next(seq__55284_55459__$1);
var G__55469 \x3d null;
var G__55470 \x3d (0);
var G__55471 \x3d (0);
seq__55284_55447 \x3d G__55468;
chunk__55285_55448 \x3d G__55469;
count__55286_55449 \x3d G__55470;
i__55287_55450 \x3d G__55471;
continue;
}
} else {
}
}
break;
}

return report;
}));

(datascript.core.transact_BANG_.cljs$lang$maxFixedArity \x3d 3);

/**
 * Forces underlying `conn` value to become `db`. Will generate a tx-report that will remove everything from old value and insert everything from the new one.
 */
datascript.core.reset_conn_BANG_ \x3d (function datascript$core$reset_conn_BANG_(var_args){
var G__55328 \x3d arguments.length;
switch (G__55328) {
case 2:
return datascript.core.reset_conn_BANG_.cljs$core$IFn$_invoke$arity$2((arguments[(0)]),(arguments[(1)]));

break;
case 3:
return datascript.core.reset_conn_BANG_.cljs$core$IFn$_invoke$arity$3((arguments[(0)]),(arguments[(1)]),(arguments[(2)]));

break;
default:
throw (new Error([\x22Invalid arity: \x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1(arguments.length)].join(\x27\x27)));

}
});

(datascript.core.reset_conn_BANG_.cljs$core$IFn$_invoke$arity$2 \x3d (function (conn,db){
return datascript.core.reset_conn_BANG_.cljs$core$IFn$_invoke$arity$3(conn,db,null);
}));

(datascript.core.reset_conn_BANG_.cljs$core$IFn$_invoke$arity$3 \x3d (function (conn,db,tx_meta){
var report \x3d datascript.db.map__GT_TxReport(new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,\x22db-before\x22,\x22db-before\x22,-553691536),cljs.core.deref(conn),new cljs.core.Keyword(null,\x22db-after\x22,\x22db-after\x22,-571884666),db,new cljs.core.Keyword(null,\x22tx-data\x22,\x22tx-data\x22,934159761),cljs.core.concat.cljs$core$IFn$_invoke$arity$2(cljs.core.map.cljs$core$IFn$_invoke$arity$2((function (p1__55326_SHARP_){
return cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(p1__55326_SHARP_,new cljs.core.Keyword(null,\x22added\x22,\x22added\x22,2057651688),false);
}),datascript.core.datoms.cljs$core$IFn$_invoke$arity$2(cljs.core.deref(conn),new cljs.core.Keyword(null,\x22eavt\x22,\x22eavt\x22,-666437073))),datascript.core.datoms.cljs$core$IFn$_invoke$arity$2(db,new cljs.core.Keyword(null,\x22eavt\x22,\x22eavt\x22,-666437073))),new cljs.core.Keyword(null,\x22tx-meta\x22,\x22tx-meta\x22,1159283194),tx_meta], null));
cljs.core.reset_BANG_(conn,db);

var seq__55329_55473 \x3d cljs.core.seq((function (){var G__55342 \x3d new cljs.core.Keyword(null,\x22listeners\x22,\x22listeners\x22,394544445).cljs$core$IFn$_invoke$arity$1(cljs.core.meta(conn));
if((G__55342 \x3d\x3d null)){
return null;
} else {
return cljs.core.deref(G__55342);
}
})());
var chunk__55330_55474 \x3d null;
var count__55331_55475 \x3d (0);
var i__55332_55476 \x3d (0);
while(true){
if((i__55332_55476 \x3c count__55331_55475)){
var vec__55343_55477 \x3d chunk__55330_55474.cljs$core$IIndexed$_nth$arity$2(null,i__55332_55476);
var __55478 \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__55343_55477,(0),null);
var callback_55479 \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__55343_55477,(1),null);
(callback_55479.cljs$core$IFn$_invoke$arity$1 ? callback_55479.cljs$core$IFn$_invoke$arity$1(report) : callback_55479.call(null,report));


var G__55480 \x3d seq__55329_55473;
var G__55481 \x3d chunk__55330_55474;
var G__55482 \x3d count__55331_55475;
var G__55483 \x3d (i__55332_55476 + (1));
seq__55329_55473 \x3d G__55480;
chunk__55330_55474 \x3d G__55481;
count__55331_55475 \x3d G__55482;
i__55332_55476 \x3d G__55483;
continue;
} else {
var temp__5804__auto___55484 \x3d cljs.core.seq(seq__55329_55473);
if(temp__5804__auto___55484){
var seq__55329_55485__$1 \x3d temp__5804__auto___55484;
if(cljs.core.chunked_seq_QMARK_(seq__55329_55485__$1)){
var c__5568__auto___55486 \x3d cljs.core.chunk_first(seq__55329_55485__$1);
var G__55487 \x3d cljs.core.chunk_rest(seq__55329_55485__$1);
var G__55488 \x3d c__5568__auto___55486;
var G__55489 \x3d cljs.core.count(c__5568__auto___55486);
var G__55490 \x3d (0);
seq__55329_55473 \x3d G__55487;
chunk__55330_55474 \x3d G__55488;
count__55331_55475 \x3d G__55489;
i__55332_55476 \x3d G__55490;
continue;
} else {
var vec__55347_55491 \x3d cljs.core.first(seq__55329_55485__$1);
var __55492 \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__55347_55491,(0),null);
var callback_55493 \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__55347_55491,(1),null);
(callback_55493.cljs$core$IFn$_invoke$arity$1 ? callback_55493.cljs$core$IFn$_invoke$arity$1(report) : callback_55493.call(null,report));


var G__55494 \x3d cljs.core.next(seq__55329_55485__$1);
var G__55495 \x3d null;
var G__55496 \x3d (0);
var G__55497 \x3d (0);
seq__55329_55473 \x3d G__55494;
chunk__55330_55474 \x3d G__55495;
count__55331_55475 \x3d G__55496;
i__55332_55476 \x3d G__55497;
continue;
}
} else {
}
}
break;
}

return db;
}));

(datascript.core.reset_conn_BANG_.cljs$lang$maxFixedArity \x3d 3);

datascript.core.atom_QMARK_ \x3d (function datascript$core$atom_QMARK_(a){
return (a instanceof cljs.core.Atom);
});
/**
 * Listen for changes on the given connection. Whenever a transaction is applied to the database via [[transact!]], the callback is called
 * with the transaction report. `key` is any opaque unique value.
 * 
 * Idempotent. Calling [[listen!]] with the same key twice will override old callback with the new value.
 * 
 * Returns the key under which this listener is registered. See also [[unlisten!]].
 */
datascript.core.listen_BANG_ \x3d (function datascript$core$listen_BANG_(var_args){
var G__55351 \x3d arguments.length;
switch (G__55351) {
case 2:
return datascript.core.listen_BANG_.cljs$core$IFn$_invoke$arity$2((arguments[(0)]),(arguments[(1)]));

break;
case 3:
return datascript.core.listen_BANG_.cljs$core$IFn$_invoke$arity$3((arguments[(0)]),(arguments[(1)]),(arguments[(2)]));

break;
default:
throw (new Error([\x22Invalid arity: \x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1(arguments.length)].join(\x27\x27)));

}
});

(datascript.core.listen_BANG_.cljs$core$IFn$_invoke$arity$2 \x3d (function (conn,callback){
return datascript.core.listen_BANG_.cljs$core$IFn$_invoke$arity$3(conn,cljs.core.rand.cljs$core$IFn$_invoke$arity$0(),callback);
}));

(datascript.core.listen_BANG_.cljs$core$IFn$_invoke$arity$3 \x3d (function (conn,key,callback){
if(datascript.core.conn_QMARK_(conn)){
} else {
throw (new Error(\x22Assert failed: (conn? conn)\x22));
}

if(datascript.core.atom_QMARK_(new cljs.core.Keyword(null,\x22listeners\x22,\x22listeners\x22,394544445).cljs$core$IFn$_invoke$arity$1(cljs.core.meta(conn)))){
} else {
throw (new Error(\x22Assert failed: (atom? (:listeners (meta conn)))\x22));
}

cljs.core.swap_BANG_.cljs$core$IFn$_invoke$arity$4(new cljs.core.Keyword(null,\x22listeners\x22,\x22listeners\x22,394544445).cljs$core$IFn$_invoke$arity$1(cljs.core.meta(conn)),cljs.core.assoc,key,callback);

return key;
}));

(datascript.core.listen_BANG_.cljs$lang$maxFixedArity \x3d 3);

/**
 * Removes registered listener from connection. See also [[listen!]].
 */
datascript.core.unlisten_BANG_ \x3d (function datascript$core$unlisten_BANG_(conn,key){
if(datascript.core.conn_QMARK_(conn)){
} else {
throw (new Error(\x22Assert failed: (conn? conn)\x22));
}

if(datascript.core.atom_QMARK_(new cljs.core.Keyword(null,\x22listeners\x22,\x22listeners\x22,394544445).cljs$core$IFn$_invoke$arity$1(cljs.core.meta(conn)))){
} else {
throw (new Error(\x22Assert failed: (atom? (:listeners (meta conn)))\x22));
}

return cljs.core.swap_BANG_.cljs$core$IFn$_invoke$arity$3(new cljs.core.Keyword(null,\x22listeners\x22,\x22listeners\x22,394544445).cljs$core$IFn$_invoke$arity$1(cljs.core.meta(conn)),cljs.core.dissoc,key);
});
/**
 * Data readers for EDN readers. In CLJS they\u2019re registered automatically. In CLJ, if `data_readers.clj` do not work, you can always do
 * 
 *           ```
 *           (clojure.edn/read-string {:readers data-readers} \x22...\x22)
 *           ```
 */
datascript.core.data_readers \x3d new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Symbol(\x22datascript\x22,\x22Datom\x22,\x22datascript/Datom\x22,-901340080,null),datascript.db.datom_from_reader,new cljs.core.Symbol(\x22datascript\x22,\x22DB\x22,\x22datascript/DB\x22,-487332776,null),datascript.db.db_from_reader], null);
var seq__55353_55499 \x3d cljs.core.seq(datascript.core.data_readers);
var chunk__55354_55500 \x3d null;
var count__55355_55501 \x3d (0);
var i__55356_55502 \x3d (0);
while(true){
if((i__55356_55502 \x3c count__55355_55501)){
var vec__55364_55503 \x3d chunk__55354_55500.cljs$core$IIndexed$_nth$arity$2(null,i__55356_55502);
var tag_55504 \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__55364_55503,(0),null);
var cb_55505 \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__55364_55503,(1),null);
cljs.reader.register_tag_parser_BANG_(tag_55504,cb_55505);


var G__55506 \x3d seq__55353_55499;
var G__55507 \x3d chunk__55354_55500;
var G__55508 \x3d count__55355_55501;
var G__55509 \x3d (i__55356_55502 + (1));
seq__55353_55499 \x3d G__55506;
chunk__55354_55500 \x3d G__55507;
count__55355_55501 \x3d G__55508;
i__55356_55502 \x3d G__55509;
continue;
} else {
var temp__5804__auto___55510 \x3d cljs.core.seq(seq__55353_55499);
if(temp__5804__auto___55510){
var seq__55353_55511__$1 \x3d temp__5804__auto___55510;
if(cljs.core.chunked_seq_QMARK_(seq__55353_55511__$1)){
var c__5568__auto___55512 \x3d cljs.core.chunk_first(seq__55353_55511__$1);
var G__55513 \x3d cljs.core.chunk_rest(seq__55353_55511__$1);
var G__55514 \x3d c__5568__auto___55512;
var G__55515 \x3d cljs.core.count(c__5568__auto___55512);
var G__55516 \x3d (0);
seq__55353_55499 \x3d G__55513;
chunk__55354_55500 \x3d G__55514;
count__55355_55501 \x3d G__55515;
i__55356_55502 \x3d G__55516;
continue;
} else {
var vec__55367_55517 \x3d cljs.core.first(seq__55353_55511__$1);
var tag_55518 \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__55367_55517,(0),null);
var cb_55519 \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__55367_55517,(1),null);
cljs.reader.register_tag_parser_BANG_(tag_55518,cb_55519);


var G__55520 \x3d cljs.core.next(seq__55353_55511__$1);
var G__55521 \x3d null;
var G__55522 \x3d (0);
var G__55523 \x3d (0);
seq__55353_55499 \x3d G__55520;
chunk__55354_55500 \x3d G__55521;
count__55355_55501 \x3d G__55522;
i__55356_55502 \x3d G__55523;
continue;
}
} else {
}
}
break;
}
datascript.core.last_tempid \x3d cljs.core.atom.cljs$core$IFn$_invoke$arity$1((-1000000));
/**
 * Allocates and returns an unique temporary id (a negative integer). Ignores `part`. Returns `x` if it is specified.
 *   
 * Exists for Datomic API compatibility. Prefer using negative integers directly if possible.
 */
datascript.core.tempid \x3d (function datascript$core$tempid(var_args){
var G__55371 \x3d arguments.length;
switch (G__55371) {
case 1:
return datascript.core.tempid.cljs$core$IFn$_invoke$arity$1((arguments[(0)]));

break;
case 2:
return datascript.core.tempid.cljs$core$IFn$_invoke$arity$2((arguments[(0)]),(arguments[(1)]));

break;
default:
throw (new Error([\x22Invalid arity: \x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1(arguments.length)].join(\x27\x27)));

}
});

(datascript.core.tempid.cljs$core$IFn$_invoke$arity$1 \x3d (function (part){
if(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(part,new cljs.core.Keyword(\x22db.part\x22,\x22tx\x22,\x22db.part/tx\x22,-1480923213))){
return new cljs.core.Keyword(\x22db\x22,\x22current-tx\x22,\x22db/current-tx\x22,1600722132);
} else {
return cljs.core.swap_BANG_.cljs$core$IFn$_invoke$arity$2(datascript.core.last_tempid,cljs.core.dec);
}
}));

(datascript.core.tempid.cljs$core$IFn$_invoke$arity$2 \x3d (function (part,x){
if(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(part,new cljs.core.Keyword(\x22db.part\x22,\x22tx\x22,\x22db.part/tx\x22,-1480923213))){
return new cljs.core.Keyword(\x22db\x22,\x22current-tx\x22,\x22db/current-tx\x22,1600722132);
} else {
return x;
}
}));

(datascript.core.tempid.cljs$lang$maxFixedArity \x3d 2);

/**
 * Does a lookup in tempids map, returning an entity id that tempid was resolved to.
 * 
 * Exists for Datomic API compatibility. Prefer using map lookup directly if possible.
 */
datascript.core.resolve_tempid \x3d (function datascript$core$resolve_tempid(_db,tempids,tempid){
return cljs.core.get.cljs$core$IFn$_invoke$arity$2(tempids,tempid);
});
/**
 * Returns the underlying immutable database value from a connection.
 * 
 * Exists for Datomic API compatibility. Prefer using `@conn` directly if possible.
 */
datascript.core.db \x3d (function datascript$core$db(conn){
if(datascript.core.conn_QMARK_(conn)){
} else {
throw (new Error(\x22Assert failed: (conn? conn)\x22));
}

return cljs.core.deref(conn);
});
/**
 * Same as [[transact!]], but returns an immediately realized future.
 *   
 * Exists for Datomic API compatibility. Prefer using [[transact!]] if possible.
 */
datascript.core.transact \x3d (function datascript$core$transact(var_args){
var G__55381 \x3d arguments.length;
switch (G__55381) {
case 2:
return datascript.core.transact.cljs$core$IFn$_invoke$arity$2((arguments[(0)]),(arguments[(1)]));

break;
case 3:
return datascript.core.transact.cljs$core$IFn$_invoke$arity$3((arguments[(0)]),(arguments[(1)]),(arguments[(2)]));

break;
default:
throw (new Error([\x22Invalid arity: \x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1(arguments.length)].join(\x27\x27)));

}
});

(datascript.core.transact.cljs$core$IFn$_invoke$arity$2 \x3d (function (conn,tx_data){
return datascript.core.transact.cljs$core$IFn$_invoke$arity$3(conn,tx_data,null);
}));

(datascript.core.transact.cljs$core$IFn$_invoke$arity$3 \x3d (function (conn,tx_data,tx_meta){
if(datascript.core.conn_QMARK_(conn)){
} else {
throw (new Error(\x22Assert failed: (conn? conn)\x22));
}

var res \x3d datascript.core.transact_BANG_.cljs$core$IFn$_invoke$arity$3(conn,tx_data,tx_meta);
if((typeof datascript !\x3d\x3d \x27undefined\x27) \x26\x26 (typeof datascript.core !\x3d\x3d \x27undefined\x27) \x26\x26 (typeof datascript.core.t_datascript$core55383 !\x3d\x3d \x27undefined\x27)){
} else {

/**
* @constructor
 * @implements {cljs.core.IDerefWithTimeout}
 * @implements {cljs.core.IPending}
 * @implements {cljs.core.IMeta}
 * @implements {cljs.core.IDeref}
 * @implements {cljs.core.IWithMeta}
*/
datascript.core.t_datascript$core55383 \x3d (function (conn,tx_data,tx_meta,res,meta55384){
this.conn \x3d conn;
this.tx_data \x3d tx_data;
this.tx_meta \x3d tx_meta;
this.res \x3d res;
this.meta55384 \x3d meta55384;
this.cljs$lang$protocol_mask$partition0$ \x3d 491520;
this.cljs$lang$protocol_mask$partition1$ \x3d 1;
});
(datascript.core.t_datascript$core55383.prototype.cljs$core$IWithMeta$_with_meta$arity$2 \x3d (function (_55385,meta55384__$1){
var self__ \x3d this;
var _55385__$1 \x3d this;
return (new datascript.core.t_datascript$core55383(self__.conn,self__.tx_data,self__.tx_meta,self__.res,meta55384__$1));
}));

(datascript.core.t_datascript$core55383.prototype.cljs$core$IMeta$_meta$arity$1 \x3d (function (_55385){
var self__ \x3d this;
var _55385__$1 \x3d this;
return self__.meta55384;
}));

(datascript.core.t_datascript$core55383.prototype.cljs$core$IDeref$_deref$arity$1 \x3d (function (_){
var self__ \x3d this;
var ___$1 \x3d this;
return self__.res;
}));

(datascript.core.t_datascript$core55383.prototype.cljs$core$IDerefWithTimeout$_deref_with_timeout$arity$3 \x3d (function (_,___$1,___$2){
var self__ \x3d this;
var ___$3 \x3d this;
return self__.res;
}));

(datascript.core.t_datascript$core55383.prototype.cljs$core$IPending$_realized_QMARK_$arity$1 \x3d (function (_){
var self__ \x3d this;
var ___$1 \x3d this;
return true;
}));

(datascript.core.t_datascript$core55383.getBasis \x3d (function (){
return new cljs.core.PersistentVector(null, 5, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22conn\x22,\x22conn\x22,1918841190,null),new cljs.core.Symbol(null,\x22tx-data\x22,\x22tx-data\x22,-1720276008,null),new cljs.core.Symbol(null,\x22tx-meta\x22,\x22tx-meta\x22,-1495152575,null),new cljs.core.Symbol(null,\x22res\x22,\x22res\x22,245523648,null),new cljs.core.Symbol(null,\x22meta55384\x22,\x22meta55384\x22,1650976741,null)], null);
}));

(datascript.core.t_datascript$core55383.cljs$lang$type \x3d true);

(datascript.core.t_datascript$core55383.cljs$lang$ctorStr \x3d \x22datascript.core/t_datascript$core55383\x22);

(datascript.core.t_datascript$core55383.cljs$lang$ctorPrWriter \x3d (function (this__5330__auto__,writer__5331__auto__,opt__5332__auto__){
return cljs.core._write(writer__5331__auto__,\x22datascript.core/t_datascript$core55383\x22);
}));

/**
 * Positional factory function for datascript.core/t_datascript$core55383.
 */
datascript.core.__GT_t_datascript$core55383 \x3d (function datascript$core$__GT_t_datascript$core55383(conn__$1,tx_data__$1,tx_meta__$1,res__$1,meta55384){
return (new datascript.core.t_datascript$core55383(conn__$1,tx_data__$1,tx_meta__$1,res__$1,meta55384));
});

}

return (new datascript.core.t_datascript$core55383(conn,tx_data,tx_meta,res,cljs.core.PersistentArrayMap.EMPTY));
}));

(datascript.core.transact.cljs$lang$maxFixedArity \x3d 3);

datascript.core.future_call \x3d (function datascript$core$future_call(f){
var res \x3d cljs.core.atom.cljs$core$IFn$_invoke$arity$1(null);
var realized \x3d cljs.core.atom.cljs$core$IFn$_invoke$arity$1(false);
setTimeout((function (){
cljs.core.reset_BANG_(res,(f.cljs$core$IFn$_invoke$arity$0 ? f.cljs$core$IFn$_invoke$arity$0() : f.call(null)));

return cljs.core.reset_BANG_(realized,true);
}),(0));

if((typeof datascript !\x3d\x3d \x27undefined\x27) \x26\x26 (typeof datascript.core !\x3d\x3d \x27undefined\x27) \x26\x26 (typeof datascript.core.t_datascript$core55397 !\x3d\x3d \x27undefined\x27)){
} else {

/**
* @constructor
 * @implements {cljs.core.IDerefWithTimeout}
 * @implements {cljs.core.IPending}
 * @implements {cljs.core.IMeta}
 * @implements {cljs.core.IDeref}
 * @implements {cljs.core.IWithMeta}
*/
datascript.core.t_datascript$core55397 \x3d (function (f,res,realized,meta55398){
this.f \x3d f;
this.res \x3d res;
this.realized \x3d realized;
this.meta55398 \x3d meta55398;
this.cljs$lang$protocol_mask$partition0$ \x3d 491520;
this.cljs$lang$protocol_mask$partition1$ \x3d 1;
});
(datascript.core.t_datascript$core55397.prototype.cljs$core$IWithMeta$_with_meta$arity$2 \x3d (function (_55399,meta55398__$1){
var self__ \x3d this;
var _55399__$1 \x3d this;
return (new datascript.core.t_datascript$core55397(self__.f,self__.res,self__.realized,meta55398__$1));
}));

(datascript.core.t_datascript$core55397.prototype.cljs$core$IMeta$_meta$arity$1 \x3d (function (_55399){
var self__ \x3d this;
var _55399__$1 \x3d this;
return self__.meta55398;
}));

(datascript.core.t_datascript$core55397.prototype.cljs$core$IDeref$_deref$arity$1 \x3d (function (_){
var self__ \x3d this;
var ___$1 \x3d this;
return cljs.core.deref(self__.res);
}));

(datascript.core.t_datascript$core55397.prototype.cljs$core$IDerefWithTimeout$_deref_with_timeout$arity$3 \x3d (function (_,___$1,timeout_val){
var self__ \x3d this;
var ___$2 \x3d this;
if(cljs.core.truth_(cljs.core.deref(self__.realized))){
return cljs.core.deref(self__.res);
} else {
return timeout_val;
}
}));

(datascript.core.t_datascript$core55397.prototype.cljs$core$IPending$_realized_QMARK_$arity$1 \x3d (function (_){
var self__ \x3d this;
var ___$1 \x3d this;
return cljs.core.deref(self__.realized);
}));

(datascript.core.t_datascript$core55397.getBasis \x3d (function (){
return new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22f\x22,\x22f\x22,43394975,null),new cljs.core.Symbol(null,\x22res\x22,\x22res\x22,245523648,null),new cljs.core.Symbol(null,\x22realized\x22,\x22realized\x22,1487343404,null),new cljs.core.Symbol(null,\x22meta55398\x22,\x22meta55398\x22,2130197988,null)], null);
}));

(datascript.core.t_datascript$core55397.cljs$lang$type \x3d true);

(datascript.core.t_datascript$core55397.cljs$lang$ctorStr \x3d \x22datascript.core/t_datascript$core55397\x22);

(datascript.core.t_datascript$core55397.cljs$lang$ctorPrWriter \x3d (function (this__5330__auto__,writer__5331__auto__,opt__5332__auto__){
return cljs.core._write(writer__5331__auto__,\x22datascript.core/t_datascript$core55397\x22);
}));

/**
 * Positional factory function for datascript.core/t_datascript$core55397.
 */
datascript.core.__GT_t_datascript$core55397 \x3d (function datascript$core$future_call_$___GT_t_datascript$core55397(f__$1,res__$1,realized__$1,meta55398){
return (new datascript.core.t_datascript$core55397(f__$1,res__$1,realized__$1,meta55398));
});

}

return (new datascript.core.t_datascript$core55397(f,res,realized,cljs.core.PersistentArrayMap.EMPTY));
});
/**
 * In CLJ, calls [[transact!]] on a future thread pool, returning immediately.
 *   
 * In CLJS, just calls [[transact!]] and returns a realized future.
 */
datascript.core.transact_async \x3d (function datascript$core$transact_async(var_args){
var G__55410 \x3d arguments.length;
switch (G__55410) {
case 2:
return datascript.core.transact_async.cljs$core$IFn$_invoke$arity$2((arguments[(0)]),(arguments[(1)]));

break;
case 3:
return datascript.core.transact_async.cljs$core$IFn$_invoke$arity$3((arguments[(0)]),(arguments[(1)]),(arguments[(2)]));

break;
default:
throw (new Error([\x22Invalid arity: \x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1(arguments.length)].join(\x27\x27)));

}
});

(datascript.core.transact_async.cljs$core$IFn$_invoke$arity$2 \x3d (function (conn,tx_data){
return datascript.core.transact_async.cljs$core$IFn$_invoke$arity$3(conn,tx_data,null);
}));

(datascript.core.transact_async.cljs$core$IFn$_invoke$arity$3 \x3d (function (conn,tx_data,tx_meta){
if(datascript.core.conn_QMARK_(conn)){
} else {
throw (new Error(\x22Assert failed: (conn? conn)\x22));
}

return datascript.core.future_call((function (){
return datascript.core.transact_BANG_.cljs$core$IFn$_invoke$arity$3(conn,tx_data,tx_meta);
}));
}));

(datascript.core.transact_async.cljs$lang$maxFixedArity \x3d 3);

datascript.core.rand_bits \x3d (function datascript$core$rand_bits(pow){
return cljs.core.rand_int(((1) \x3c\x3c pow));
});
datascript.core.to_hex_string \x3d (function datascript$core$to_hex_string(n,l){
var s \x3d n.toString((16));
var c \x3d cljs.core.count(s);
if((c \x3e l)){
return cljs.core.subs.cljs$core$IFn$_invoke$arity$3(s,(0),l);
} else {
if((c \x3c l)){
return [cljs.core.str.cljs$core$IFn$_invoke$arity$1(cljs.core.apply.cljs$core$IFn$_invoke$arity$2(cljs.core.str,cljs.core.repeat.cljs$core$IFn$_invoke$arity$2((l - c),\x220\x22))),cljs.core.str.cljs$core$IFn$_invoke$arity$1(s)].join(\x27\x27);
} else {
return s;

}
}
});
/**
 * Generates a UUID that grow with time. Such UUIDs will always go to the end  of the index and that will minimize insertions in the middle.
 *   
 * Consist of 64 bits of current UNIX timestamp (in seconds) and 64 random bits (2^64 different unique values per second).
 */
datascript.core.squuid \x3d (function datascript$core$squuid(var_args){
var G__55412 \x3d arguments.length;
switch (G__55412) {
case 0:
return datascript.core.squuid.cljs$core$IFn$_invoke$arity$0();

break;
case 1:
return datascript.core.squuid.cljs$core$IFn$_invoke$arity$1((arguments[(0)]));

break;
default:
throw (new Error([\x22Invalid arity: \x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1(arguments.length)].join(\x27\x27)));

}
});

(datascript.core.squuid.cljs$core$IFn$_invoke$arity$0 \x3d (function (){
return datascript.core.squuid.cljs$core$IFn$_invoke$arity$1((new Date()).getTime());
}));

(datascript.core.squuid.cljs$core$IFn$_invoke$arity$1 \x3d (function (msec){
return cljs.core.uuid([cljs.core.str.cljs$core$IFn$_invoke$arity$1(datascript.core.to_hex_string(((msec / (1000)) | (0)),(8))),\x22-\x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1(datascript.core.to_hex_string(datascript.core.rand_bits((16)),(4))),\x22-\x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1(datascript.core.to_hex_string(((datascript.core.rand_bits((16)) \x26 (4095)) | (16384)),(4))),\x22-\x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1(datascript.core.to_hex_string(((datascript.core.rand_bits((16)) \x26 (16383)) | (32768)),(4))),\x22-\x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1(datascript.core.to_hex_string(datascript.core.rand_bits((16)),(4))),cljs.core.str.cljs$core$IFn$_invoke$arity$1(datascript.core.to_hex_string(datascript.core.rand_bits((16)),(4))),cljs.core.str.cljs$core$IFn$_invoke$arity$1(datascript.core.to_hex_string(datascript.core.rand_bits((16)),(4)))].join(\x27\x27));
}));

(datascript.core.squuid.cljs$lang$maxFixedArity \x3d 1);

/**
 * Returns time that was used in [[squuid]] call, in milliseconds, rounded to the closest second.
 */
datascript.core.squuid_time_millis \x3d (function datascript$core$squuid_time_millis(uuid){
return (parseInt(cljs.core.subs.cljs$core$IFn$_invoke$arity$3(cljs.core.str.cljs$core$IFn$_invoke$arity$1(uuid),(0),(8)),(16)) * (1000));
});
");
SHADOW_ENV.evalLoad("sci.configs.tonsky.datascript.js", true , "goog.provide(\x27sci.configs.tonsky.datascript\x27);
sci.configs.tonsky.datascript.core_ns \x3d sci.core.create_ns.cljs$core$IFn$_invoke$arity$2(new cljs.core.Symbol(null,\x22datascript.core\x22,\x22datascript.core\x22,-1034255346,null),null);
sci.configs.tonsky.datascript.db_ns \x3d sci.core.create_ns.cljs$core$IFn$_invoke$arity$2(new cljs.core.Symbol(null,\x22datascript.db\x22,\x22datascript.db\x22,-444456104,null),null);
sci.configs.tonsky.datascript.core_namespace \x3d cljs.core.PersistentHashMap.fromArrays([new cljs.core.Symbol(null,\x22with\x22,\x22with\x22,104234651,null),new cljs.core.Symbol(null,\x22pull-many\x22,\x22pull-many\x22,1857679657,null),new cljs.core.Symbol(null,\x22entity\x22,\x22entity\x22,1189561251,null),new cljs.core.Symbol(null,\x22q\x22,\x22q\x22,-1965434072,null),new cljs.core.Symbol(null,\x22listen!\x22,\x22listen!\x22,-115577950,null),new cljs.core.Symbol(null,\x22datom\x22,\x22datom\x22,1268975437,null),new cljs.core.Symbol(null,\x22db-with\x22,\x22db-with\x22,233242042,null),new cljs.core.Symbol(null,\x22index-range\x22,\x22index-range\x22,1044940937,null),new cljs.core.Symbol(null,\x22conn-from-db\x22,\x22conn-from-db\x22,-184109372,null),new cljs.core.Symbol(null,\x22reset-conn!\x22,\x22reset-conn!\x22,1315177148,null),new cljs.core.Symbol(null,\x22transact!\x22,\x22transact!\x22,817805717,null),new cljs.core.Symbol(null,\x22squuid\x22,\x22squuid\x22,-1898207797,null),new cljs.core.Symbol(null,\x22db\x22,\x22db\x22,-1661185010,null),new cljs.core.Symbol(null,\x22serializable\x22,\x22serializable\x22,1941609404,null),new cljs.core.Symbol(null,\x22conn-from-datoms\x22,\x22conn-from-datoms\x22,-1502002909,null),new cljs.core.Symbol(null,\x22from-serializable\x22,\x22from-serializable\x22,945516427,null),new cljs.core.Symbol(null,\x22empty-db\x22,\x22empty-db\x22,1486862004,null),new cljs.core.Symbol(null,\x22init-db\x22,\x22init-db\x22,-1059254491,null),new cljs.core.Symbol(null,\x22touch\x22,\x22touch\x22,-1158163300,null),new cljs.core.Symbol(null,\x22tx0\x22,\x22tx0\x22,-4656209,null),new cljs.core.Symbol(null,\x22filter\x22,\x22filter\x22,691993593,null),new cljs.core.Symbol(null,\x22datoms\x22,\x22datoms\x22,1349657093,null),new cljs.core.Symbol(null,\x22pull\x22,\x22pull\x22,779986722,null),new cljs.core.Symbol(null,\x22create-conn\x22,\x22create-conn\x22,2071410861,null)],[(function (){var ns__46341__auto__ \x3d sci.configs.tonsky.datascript.core_ns;
var var__46342__auto__ \x3d new cljs.core.Var(function(){return datascript.core.with$;},new cljs.core.Symbol(\x22datascript.core\x22,\x22with\x22,\x22datascript.core/with\x22,-1124098173,null),cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),new cljs.core.Keyword(null,\x22file\x22,\x22file\x22,-1269645878),new cljs.core.Keyword(null,\x22end-column\x22,\x22end-column\x22,1425389514),new cljs.core.Keyword(null,\x22top-fn\x22,\x22top-fn\x22,-2056129173),new cljs.core.Keyword(null,\x22column\x22,\x22column\x22,2078222095),new cljs.core.Keyword(null,\x22line\x22,\x22line\x22,212345235),new cljs.core.Keyword(null,\x22end-line\x22,\x22end-line\x22,1837326455),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22test\x22,\x22test\x22,577538877)],[new cljs.core.Symbol(null,\x22datascript.core\x22,\x22datascript.core\x22,-1034255346,null),new cljs.core.Symbol(null,\x22with\x22,\x22with\x22,104234651,null),\x22datascript/core.cljc\x22,11,new cljs.core.PersistentArrayMap(null, 6, [new cljs.core.Keyword(null,\x22variadic?\x22,\x22variadic?\x22,584179762),false,new cljs.core.Keyword(null,\x22fixed-arity\x22,\x22fixed-arity\x22,1586445869),3,new cljs.core.Keyword(null,\x22max-fixed-arity\x22,\x22max-fixed-arity\x22,-690205543),3,new cljs.core.Keyword(null,\x22method-params\x22,\x22method-params\x22,-980792179),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22db\x22,\x22db\x22,-1661185010,null),new cljs.core.Symbol(null,\x22tx-data\x22,\x22tx-data\x22,-1720276008,null)], null),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22db\x22,\x22db\x22,-1661185010,null),new cljs.core.Symbol(null,\x22tx-data\x22,\x22tx-data\x22,-1720276008,null),new cljs.core.Symbol(null,\x22tx-meta\x22,\x22tx-meta\x22,-1495152575,null)], null)], null),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),cljs.core.list(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22db\x22,\x22db\x22,-1661185010,null),new cljs.core.Symbol(null,\x22tx-data\x22,\x22tx-data\x22,-1720276008,null)], null),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22db\x22,\x22db\x22,-1661185010,null),new cljs.core.Symbol(null,\x22tx-data\x22,\x22tx-data\x22,-1720276008,null),new cljs.core.Symbol(null,\x22tx-meta\x22,\x22tx-meta\x22,-1495152575,null)], null)),new cljs.core.Keyword(null,\x22arglists-meta\x22,\x22arglists-meta\x22,1944829838),cljs.core.list(null,null)], null),1,256,256,cljs.core.list(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22db\x22,\x22db\x22,-1661185010,null),new cljs.core.Symbol(null,\x22tx-data\x22,\x22tx-data\x22,-1720276008,null)], null),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22db\x22,\x22db\x22,-1661185010,null),new cljs.core.Symbol(null,\x22tx-data\x22,\x22tx-data\x22,-1720276008,null),new cljs.core.Symbol(null,\x22tx-meta\x22,\x22tx-meta\x22,-1495152575,null)], null)),\x22Same as [[transact!]], but applies to an immutable database value. Returns transaction report (see [[transact!]]).\x22,(cljs.core.truth_(datascript.core.with$)?datascript.core.with$.cljs$lang$test:null)]));
var val__46343__auto__ \x3d cljs.core.deref(var__46342__auto__);
var m__46344__auto__ \x3d cljs.core.meta(var__46342__auto__);
var name__46345__auto__ \x3d (function (){var or__5045__auto__ \x3d null;
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})();
var new_m__46346__auto__ \x3d new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),ns__46341__auto__,new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),name__46345__auto__,new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754).cljs$core$IFn$_invoke$arity$1(m__46344__auto__),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891).cljs$core$IFn$_invoke$arity$1(m__46344__auto__)], null);
if(cljs.core.truth_(new cljs.core.Keyword(null,\x22dynamic\x22,\x22dynamic\x22,704819571).cljs$core$IFn$_invoke$arity$1(m__46344__auto__))){
return sci.core.new_dynamic_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
if(cljs.core.truth_((function (){var or__5045__auto__ \x3d new cljs.core.Keyword(null,\x22macro\x22,\x22macro\x22,-867863404).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(\x22sci\x22,\x22macro\x22,\x22sci/macro\x22,-868536151).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})())){
return sci.core.new_macro_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
return sci.core.new_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);

}
}
})(),(function (){var ns__46341__auto__ \x3d sci.configs.tonsky.datascript.core_ns;
var var__46342__auto__ \x3d new cljs.core.Var(function(){return datascript.core.pull_many;},new cljs.core.Symbol(\x22datascript.core\x22,\x22pull-many\x22,\x22datascript.core/pull-many\x22,394351057,null),cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),new cljs.core.Keyword(null,\x22file\x22,\x22file\x22,-1269645878),new cljs.core.Keyword(null,\x22end-column\x22,\x22end-column\x22,1425389514),new cljs.core.Keyword(null,\x22column\x22,\x22column\x22,2078222095),new cljs.core.Keyword(null,\x22line\x22,\x22line\x22,212345235),new cljs.core.Keyword(null,\x22end-line\x22,\x22end-line\x22,1837326455),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22test\x22,\x22test\x22,577538877)],[new cljs.core.Symbol(null,\x22datascript.core\x22,\x22datascript.core\x22,-1034255346,null),new cljs.core.Symbol(null,\x22pull-many\x22,\x22pull-many\x22,1857679657,null),\x22datascript/core.cljc\x22,12,1,120,130,cljs.core.List.EMPTY,\x22Same as [[pull]], but accepts sequence of ids and returns sequence of maps.\
\
             Usage:\
\
             ```\
             (pull-many db [:db/id :name] [1 2])\
             ; \x3d\x3e [{:db/id 1, :name \\\x22Ivan\\\x22}\
             ;     {:db/id 2, :name \\\x22Oleg\\\x22}]\
             ```\x22,(cljs.core.truth_(datascript.core.pull_many)?datascript.core.pull_many.cljs$lang$test:null)]));
var val__46343__auto__ \x3d cljs.core.deref(var__46342__auto__);
var m__46344__auto__ \x3d cljs.core.meta(var__46342__auto__);
var name__46345__auto__ \x3d (function (){var or__5045__auto__ \x3d null;
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})();
var new_m__46346__auto__ \x3d new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),ns__46341__auto__,new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),name__46345__auto__,new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754).cljs$core$IFn$_invoke$arity$1(m__46344__auto__),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891).cljs$core$IFn$_invoke$arity$1(m__46344__auto__)], null);
if(cljs.core.truth_(new cljs.core.Keyword(null,\x22dynamic\x22,\x22dynamic\x22,704819571).cljs$core$IFn$_invoke$arity$1(m__46344__auto__))){
return sci.core.new_dynamic_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
if(cljs.core.truth_((function (){var or__5045__auto__ \x3d new cljs.core.Keyword(null,\x22macro\x22,\x22macro\x22,-867863404).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(\x22sci\x22,\x22macro\x22,\x22sci/macro\x22,-868536151).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})())){
return sci.core.new_macro_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
return sci.core.new_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);

}
}
})(),(function (){var ns__46341__auto__ \x3d sci.configs.tonsky.datascript.core_ns;
var var__46342__auto__ \x3d new cljs.core.Var(function(){return datascript.core.entity;},new cljs.core.Symbol(\x22datascript.core\x22,\x22entity\x22,\x22datascript.core/entity\x22,-1406213973,null),cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),new cljs.core.Keyword(null,\x22file\x22,\x22file\x22,-1269645878),new cljs.core.Keyword(null,\x22end-column\x22,\x22end-column\x22,1425389514),new cljs.core.Keyword(null,\x22column\x22,\x22column\x22,2078222095),new cljs.core.Keyword(null,\x22line\x22,\x22line\x22,212345235),new cljs.core.Keyword(null,\x22end-line\x22,\x22end-line\x22,1837326455),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22test\x22,\x22test\x22,577538877)],[new cljs.core.Symbol(null,\x22datascript.core\x22,\x22datascript.core\x22,-1034255346,null),new cljs.core.Symbol(null,\x22entity\x22,\x22entity\x22,1189561251,null),\x22datascript/core.cljc\x22,9,1,23,72,cljs.core.List.EMPTY,\x22Retrieves an entity by its id from database. Entities are lazy map-like structures to navigate DataScript database content.\
\
             For `eid` pass entity id or lookup attr:\
             \
                 (entity db 1)\
                 (entity db [:unique-attr :value])\
            \
             If entity does not exist, `nil` is returned:\
\
                 (entity db 100500) ; \x3d\x3e nil\
\
             Creating an entity by id is very cheap, almost no-op, as attr access is on-demand:\
\
                 (entity db 1) ; \x3d\x3e {:db/id 1}\
\
             Entity attributes can be lazily accessed through key lookups:\
             \
                 (:attr (entity db 1)) ; \x3d\x3e :value\
                 (get (entity db 1) :attr) ; \x3d\x3e :value\
\
             Cardinality many attributes are returned sequences:\
\
                 (:attrs (entity db 1)) ; \x3d\x3e [:v1 :v2 :v3]\
\
             Reference attributes are returned as another entities:\
\
                 (:ref (entity db 1)) ; \x3d\x3e {:db/id 2}\
                 (:ns/ref (entity db 1)) ; \x3d\x3e {:db/id 2}\
\
             References can be walked backwards by prepending `_` to name part of an attribute:\
\
                 (:_ref (entity db 2)) ; \x3d\x3e [{:db/id 1}]\
                 (:ns/_ref (entity db 2)) ; \x3d\x3e [{:db/id 1}]\
             \
             Reverse reference lookup returns sequence of entities unless attribute is marked as `:db/isComponent`:\
\
                 (:_component-ref (entity db 2)) ; \x3d\x3e {:db/id 1}\
\
             Entity gotchas:\
               \
             - Entities print as map, but are not exactly maps (they have compatible get interface though).\
             - Entities are effectively immutable \\u201Cviews\\u201D into a particular version of a database.\
             - Entities retain reference to the whole database.\
             - You can\\u2019t change database through entities, only read.\
             - Creating an entity by id is very cheap, almost no-op (attributes are looked up on demand).\
             - Comparing entities just compares their ids. Be careful when comparing entities taken from different dbs or from different versions of the same db.\
             - Accessed entity attributes are cached on entity itself (except backward references).\
             - When printing, only cached attributes (the ones you have accessed before) are printed. See [[touch]].\x22,(cljs.core.truth_(datascript.core.entity)?datascript.core.entity.cljs$lang$test:null)]));
var val__46343__auto__ \x3d cljs.core.deref(var__46342__auto__);
var m__46344__auto__ \x3d cljs.core.meta(var__46342__auto__);
var name__46345__auto__ \x3d (function (){var or__5045__auto__ \x3d null;
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})();
var new_m__46346__auto__ \x3d new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),ns__46341__auto__,new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),name__46345__auto__,new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754).cljs$core$IFn$_invoke$arity$1(m__46344__auto__),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891).cljs$core$IFn$_invoke$arity$1(m__46344__auto__)], null);
if(cljs.core.truth_(new cljs.core.Keyword(null,\x22dynamic\x22,\x22dynamic\x22,704819571).cljs$core$IFn$_invoke$arity$1(m__46344__auto__))){
return sci.core.new_dynamic_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
if(cljs.core.truth_((function (){var or__5045__auto__ \x3d new cljs.core.Keyword(null,\x22macro\x22,\x22macro\x22,-867863404).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(\x22sci\x22,\x22macro\x22,\x22sci/macro\x22,-868536151).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})())){
return sci.core.new_macro_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
return sci.core.new_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);

}
}
})(),(function (){var ns__46341__auto__ \x3d sci.configs.tonsky.datascript.core_ns;
var var__46342__auto__ \x3d new cljs.core.Var(function(){return datascript.core.q;},new cljs.core.Symbol(\x22datascript.core\x22,\x22q\x22,\x22datascript.core/q\x22,2106686416,null),cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),new cljs.core.Keyword(null,\x22file\x22,\x22file\x22,-1269645878),new cljs.core.Keyword(null,\x22end-column\x22,\x22end-column\x22,1425389514),new cljs.core.Keyword(null,\x22column\x22,\x22column\x22,2078222095),new cljs.core.Keyword(null,\x22line\x22,\x22line\x22,212345235),new cljs.core.Keyword(null,\x22end-line\x22,\x22end-line\x22,1837326455),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22test\x22,\x22test\x22,577538877)],[new cljs.core.Symbol(null,\x22datascript.core\x22,\x22datascript.core\x22,-1034255346,null),new cljs.core.Symbol(null,\x22q\x22,\x22q\x22,-1965434072,null),\x22datascript/core.cljc\x22,4,1,135,147,cljs.core.List.EMPTY,\x22Executes a datalog query. See [docs.datomic.com/on-prem/query.html](https://docs.datomic.com/on-prem/query.html).\
\
          Usage:\
          \
          ```\
          (q \x27[:find ?value\
               :where [_ :likes ?value]]\
             db)\
          ; \x3d\x3e #{[\\\x22fries\\\x22] [\\\x22candy\\\x22] [\\\x22pie\\\x22] [\\\x22pizza\\\x22]}\
          ```\x22,(cljs.core.truth_(datascript.core.q)?datascript.core.q.cljs$lang$test:null)]));
var val__46343__auto__ \x3d cljs.core.deref(var__46342__auto__);
var m__46344__auto__ \x3d cljs.core.meta(var__46342__auto__);
var name__46345__auto__ \x3d (function (){var or__5045__auto__ \x3d null;
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})();
var new_m__46346__auto__ \x3d new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),ns__46341__auto__,new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),name__46345__auto__,new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754).cljs$core$IFn$_invoke$arity$1(m__46344__auto__),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891).cljs$core$IFn$_invoke$arity$1(m__46344__auto__)], null);
if(cljs.core.truth_(new cljs.core.Keyword(null,\x22dynamic\x22,\x22dynamic\x22,704819571).cljs$core$IFn$_invoke$arity$1(m__46344__auto__))){
return sci.core.new_dynamic_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
if(cljs.core.truth_((function (){var or__5045__auto__ \x3d new cljs.core.Keyword(null,\x22macro\x22,\x22macro\x22,-867863404).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(\x22sci\x22,\x22macro\x22,\x22sci/macro\x22,-868536151).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})())){
return sci.core.new_macro_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
return sci.core.new_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);

}
}
})(),(function (){var ns__46341__auto__ \x3d sci.configs.tonsky.datascript.core_ns;
var var__46342__auto__ \x3d new cljs.core.Var(function(){return datascript.core.listen_BANG_;},new cljs.core.Symbol(\x22datascript.core\x22,\x22listen!\x22,\x22datascript.core/listen!\x22,1659161258,null),cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),new cljs.core.Keyword(null,\x22file\x22,\x22file\x22,-1269645878),new cljs.core.Keyword(null,\x22end-column\x22,\x22end-column\x22,1425389514),new cljs.core.Keyword(null,\x22top-fn\x22,\x22top-fn\x22,-2056129173),new cljs.core.Keyword(null,\x22column\x22,\x22column\x22,2078222095),new cljs.core.Keyword(null,\x22line\x22,\x22line\x22,212345235),new cljs.core.Keyword(null,\x22end-line\x22,\x22end-line\x22,1837326455),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22test\x22,\x22test\x22,577538877)],[new cljs.core.Symbol(null,\x22datascript.core\x22,\x22datascript.core\x22,-1034255346,null),new cljs.core.Symbol(null,\x22listen!\x22,\x22listen!\x22,-115577950,null),\x22datascript/core.cljc\x22,14,new cljs.core.PersistentArrayMap(null, 6, [new cljs.core.Keyword(null,\x22variadic?\x22,\x22variadic?\x22,584179762),false,new cljs.core.Keyword(null,\x22fixed-arity\x22,\x22fixed-arity\x22,1586445869),3,new cljs.core.Keyword(null,\x22max-fixed-arity\x22,\x22max-fixed-arity\x22,-690205543),3,new cljs.core.Keyword(null,\x22method-params\x22,\x22method-params\x22,-980792179),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22conn\x22,\x22conn\x22,1918841190,null),new cljs.core.Symbol(null,\x22callback\x22,\x22callback\x22,935395299,null)], null),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22conn\x22,\x22conn\x22,1918841190,null),new cljs.core.Symbol(null,\x22key\x22,\x22key\x22,124488940,null),new cljs.core.Symbol(null,\x22callback\x22,\x22callback\x22,935395299,null)], null)], null),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),cljs.core.list(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22conn\x22,\x22conn\x22,1918841190,null),new cljs.core.Symbol(null,\x22callback\x22,\x22callback\x22,935395299,null)], null),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22conn\x22,\x22conn\x22,1918841190,null),new cljs.core.Symbol(null,\x22key\x22,\x22key\x22,124488940,null),new cljs.core.Symbol(null,\x22callback\x22,\x22callback\x22,935395299,null)], null)),new cljs.core.Keyword(null,\x22arglists-meta\x22,\x22arglists-meta\x22,1944829838),cljs.core.list(null,null)], null),1,592,592,cljs.core.list(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22conn\x22,\x22conn\x22,1918841190,null),new cljs.core.Symbol(null,\x22callback\x22,\x22callback\x22,935395299,null)], null),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22conn\x22,\x22conn\x22,1918841190,null),new cljs.core.Symbol(null,\x22key\x22,\x22key\x22,124488940,null),new cljs.core.Symbol(null,\x22callback\x22,\x22callback\x22,935395299,null)], null)),\x22Listen for changes on the given connection. Whenever a transaction is applied to the database via [[transact!]], the callback is called\
   with the transaction report. `key` is any opaque unique value.\
   \
   Idempotent. Calling [[listen!]] with the same key twice will override old callback with the new value.\
   \
   Returns the key under which this listener is registered. See also [[unlisten!]].\x22,(cljs.core.truth_(datascript.core.listen_BANG_)?datascript.core.listen_BANG_.cljs$lang$test:null)]));
var val__46343__auto__ \x3d cljs.core.deref(var__46342__auto__);
var m__46344__auto__ \x3d cljs.core.meta(var__46342__auto__);
var name__46345__auto__ \x3d (function (){var or__5045__auto__ \x3d null;
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})();
var new_m__46346__auto__ \x3d new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),ns__46341__auto__,new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),name__46345__auto__,new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754).cljs$core$IFn$_invoke$arity$1(m__46344__auto__),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891).cljs$core$IFn$_invoke$arity$1(m__46344__auto__)], null);
if(cljs.core.truth_(new cljs.core.Keyword(null,\x22dynamic\x22,\x22dynamic\x22,704819571).cljs$core$IFn$_invoke$arity$1(m__46344__auto__))){
return sci.core.new_dynamic_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
if(cljs.core.truth_((function (){var or__5045__auto__ \x3d new cljs.core.Keyword(null,\x22macro\x22,\x22macro\x22,-867863404).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(\x22sci\x22,\x22macro\x22,\x22sci/macro\x22,-868536151).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})())){
return sci.core.new_macro_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
return sci.core.new_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);

}
}
})(),(function (){var ns__46341__auto__ \x3d sci.configs.tonsky.datascript.core_ns;
var var__46342__auto__ \x3d new cljs.core.Var(function(){return datascript.core.datom;},new cljs.core.Symbol(\x22datascript.core\x22,\x22datom\x22,\x22datascript.core/datom\x22,-1596234155,null),cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),new cljs.core.Keyword(null,\x22file\x22,\x22file\x22,-1269645878),new cljs.core.Keyword(null,\x22end-column\x22,\x22end-column\x22,1425389514),new cljs.core.Keyword(null,\x22column\x22,\x22column\x22,2078222095),new cljs.core.Keyword(null,\x22line\x22,\x22line\x22,212345235),new cljs.core.Keyword(null,\x22end-line\x22,\x22end-line\x22,1837326455),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22test\x22,\x22test\x22,577538877)],[new cljs.core.Symbol(null,\x22datascript.core\x22,\x22datascript.core\x22,-1034255346,null),new cljs.core.Symbol(null,\x22datom\x22,\x22datom\x22,1268975437,null),\x22datascript/core.cljc\x22,8,1,172,178,cljs.core.List.EMPTY,\x22Low-level fn to create raw datoms.\
\
             Optionally with transaction id (number) and `added` flag (`true` for addition, `false` for retraction).\
\
             See also [[init-db]].\x22,(cljs.core.truth_(datascript.core.datom)?datascript.core.datom.cljs$lang$test:null)]));
var val__46343__auto__ \x3d cljs.core.deref(var__46342__auto__);
var m__46344__auto__ \x3d cljs.core.meta(var__46342__auto__);
var name__46345__auto__ \x3d (function (){var or__5045__auto__ \x3d null;
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})();
var new_m__46346__auto__ \x3d new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),ns__46341__auto__,new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),name__46345__auto__,new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754).cljs$core$IFn$_invoke$arity$1(m__46344__auto__),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891).cljs$core$IFn$_invoke$arity$1(m__46344__auto__)], null);
if(cljs.core.truth_(new cljs.core.Keyword(null,\x22dynamic\x22,\x22dynamic\x22,704819571).cljs$core$IFn$_invoke$arity$1(m__46344__auto__))){
return sci.core.new_dynamic_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
if(cljs.core.truth_((function (){var or__5045__auto__ \x3d new cljs.core.Keyword(null,\x22macro\x22,\x22macro\x22,-867863404).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(\x22sci\x22,\x22macro\x22,\x22sci/macro\x22,-868536151).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})())){
return sci.core.new_macro_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
return sci.core.new_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);

}
}
})(),(function (){var ns__46341__auto__ \x3d sci.configs.tonsky.datascript.core_ns;
var var__46342__auto__ \x3d new cljs.core.Var(function(){return datascript.core.db_with;},new cljs.core.Symbol(\x22datascript.core\x22,\x22db-with\x22,\x22datascript.core/db-with\x22,-1263574350,null),cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),new cljs.core.Keyword(null,\x22file\x22,\x22file\x22,-1269645878),new cljs.core.Keyword(null,\x22end-column\x22,\x22end-column\x22,1425389514),new cljs.core.Keyword(null,\x22column\x22,\x22column\x22,2078222095),new cljs.core.Keyword(null,\x22line\x22,\x22line\x22,212345235),new cljs.core.Keyword(null,\x22end-line\x22,\x22end-line\x22,1837326455),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22test\x22,\x22test\x22,577538877)],[new cljs.core.Symbol(null,\x22datascript.core\x22,\x22datascript.core\x22,-1034255346,null),new cljs.core.Symbol(null,\x22db-with\x22,\x22db-with\x22,233242042,null),\x22datascript/core.cljc\x22,14,1,271,271,cljs.core.list(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22db\x22,\x22db\x22,-1661185010,null),new cljs.core.Symbol(null,\x22tx-data\x22,\x22tx-data\x22,-1720276008,null)], null)),\x22Applies transaction to an immutable db value, returning new immutable db value. Same as `(:db-after (with db tx-data))`.\x22,(cljs.core.truth_(datascript.core.db_with)?datascript.core.db_with.cljs$lang$test:null)]));
var val__46343__auto__ \x3d cljs.core.deref(var__46342__auto__);
var m__46344__auto__ \x3d cljs.core.meta(var__46342__auto__);
var name__46345__auto__ \x3d (function (){var or__5045__auto__ \x3d null;
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})();
var new_m__46346__auto__ \x3d new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),ns__46341__auto__,new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),name__46345__auto__,new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754).cljs$core$IFn$_invoke$arity$1(m__46344__auto__),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891).cljs$core$IFn$_invoke$arity$1(m__46344__auto__)], null);
if(cljs.core.truth_(new cljs.core.Keyword(null,\x22dynamic\x22,\x22dynamic\x22,704819571).cljs$core$IFn$_invoke$arity$1(m__46344__auto__))){
return sci.core.new_dynamic_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
if(cljs.core.truth_((function (){var or__5045__auto__ \x3d new cljs.core.Keyword(null,\x22macro\x22,\x22macro\x22,-867863404).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(\x22sci\x22,\x22macro\x22,\x22sci/macro\x22,-868536151).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})())){
return sci.core.new_macro_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
return sci.core.new_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);

}
}
})(),(function (){var ns__46341__auto__ \x3d sci.configs.tonsky.datascript.core_ns;
var var__46342__auto__ \x3d new cljs.core.Var(function(){return datascript.core.index_range;},new cljs.core.Symbol(\x22datascript.core\x22,\x22index-range\x22,\x22datascript.core/index-range\x22,-1484576383,null),cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),new cljs.core.Keyword(null,\x22file\x22,\x22file\x22,-1269645878),new cljs.core.Keyword(null,\x22end-column\x22,\x22end-column\x22,1425389514),new cljs.core.Keyword(null,\x22column\x22,\x22column\x22,2078222095),new cljs.core.Keyword(null,\x22line\x22,\x22line\x22,212345235),new cljs.core.Keyword(null,\x22end-line\x22,\x22end-line\x22,1837326455),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22test\x22,\x22test\x22,577538877)],[new cljs.core.Symbol(null,\x22datascript.core\x22,\x22datascript.core\x22,-1034255346,null),new cljs.core.Symbol(null,\x22index-range\x22,\x22index-range\x22,1044940937,null),\x22datascript/core.cljc\x22,18,1,405,405,cljs.core.list(new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22db\x22,\x22db\x22,-1661185010,null),new cljs.core.Symbol(null,\x22attr\x22,\x22attr\x22,1036399174,null),new cljs.core.Symbol(null,\x22start\x22,\x22start\x22,1285322546,null),new cljs.core.Symbol(null,\x22end\x22,\x22end\x22,1372345569,null)], null)),\x22Returns part of `:avet` index between `[_ attr start]` and `[_ attr end]` in AVET sort order.\
  \
   Same properties as [[datoms]].\
   \
   `attr` must be a reference, unique attribute or marked as `:db/index true`.\
   \
   Usage:\
\
       (index-range db :likes \\\x22a\\\x22 \\\x22zzzzzzzzz\\\x22)\
       ; \x3d\x3e (#datascript/Datom [2 :likes \\\x22candy\\\x22]\
       ;     #datascript/Datom [1 :likes \\\x22fries\\\x22]\
       ;     #datascript/Datom [2 :likes \\\x22pie\\\x22]\
       ;     #datascript/Datom [1 :likes \\\x22pizza\\\x22]\
       ;     #datascript/Datom [2 :likes \\\x22pizza\\\x22])\
        \
       (index-range db :likes \\\x22egg\\\x22 \\\x22pineapple\\\x22)\
       ; \x3d\x3e (#datascript/Datom [1 :likes \\\x22fries\\\x22]\
       ;     #datascript/Datom [2 :likes \\\x22pie\\\x22])\
           \
   Useful patterns:\
     \
       ; find all entities with age in a specific range (inclusive)\
       (-\x3e\x3e (index-range db :age 18 60) (map :e))\x22,(cljs.core.truth_(datascript.core.index_range)?datascript.core.index_range.cljs$lang$test:null)]));
var val__46343__auto__ \x3d cljs.core.deref(var__46342__auto__);
var m__46344__auto__ \x3d cljs.core.meta(var__46342__auto__);
var name__46345__auto__ \x3d (function (){var or__5045__auto__ \x3d null;
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})();
var new_m__46346__auto__ \x3d new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),ns__46341__auto__,new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),name__46345__auto__,new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754).cljs$core$IFn$_invoke$arity$1(m__46344__auto__),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891).cljs$core$IFn$_invoke$arity$1(m__46344__auto__)], null);
if(cljs.core.truth_(new cljs.core.Keyword(null,\x22dynamic\x22,\x22dynamic\x22,704819571).cljs$core$IFn$_invoke$arity$1(m__46344__auto__))){
return sci.core.new_dynamic_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
if(cljs.core.truth_((function (){var or__5045__auto__ \x3d new cljs.core.Keyword(null,\x22macro\x22,\x22macro\x22,-867863404).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(\x22sci\x22,\x22macro\x22,\x22sci/macro\x22,-868536151).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})())){
return sci.core.new_macro_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
return sci.core.new_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);

}
}
})(),(function (){var ns__46341__auto__ \x3d sci.configs.tonsky.datascript.core_ns;
var var__46342__auto__ \x3d new cljs.core.Var(function(){return datascript.core.conn_from_db;},new cljs.core.Symbol(\x22datascript.core\x22,\x22conn-from-db\x22,\x22datascript.core/conn-from-db\x22,1590561228,null),cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),new cljs.core.Keyword(null,\x22file\x22,\x22file\x22,-1269645878),new cljs.core.Keyword(null,\x22end-column\x22,\x22end-column\x22,1425389514),new cljs.core.Keyword(null,\x22column\x22,\x22column\x22,2078222095),new cljs.core.Keyword(null,\x22line\x22,\x22line\x22,212345235),new cljs.core.Keyword(null,\x22end-line\x22,\x22end-line\x22,1837326455),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22test\x22,\x22test\x22,577538877)],[new cljs.core.Symbol(null,\x22datascript.core\x22,\x22datascript.core\x22,-1034255346,null),new cljs.core.Symbol(null,\x22conn-from-db\x22,\x22conn-from-db\x22,-184109372,null),\x22datascript/core.cljc\x22,19,1,444,444,cljs.core.list(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22db\x22,\x22db\x22,-1661185010,null)], null)),\x22Creates a mutable reference to a given immutable database. See [[create-conn]].\x22,(cljs.core.truth_(datascript.core.conn_from_db)?datascript.core.conn_from_db.cljs$lang$test:null)]));
var val__46343__auto__ \x3d cljs.core.deref(var__46342__auto__);
var m__46344__auto__ \x3d cljs.core.meta(var__46342__auto__);
var name__46345__auto__ \x3d (function (){var or__5045__auto__ \x3d null;
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})();
var new_m__46346__auto__ \x3d new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),ns__46341__auto__,new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),name__46345__auto__,new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754).cljs$core$IFn$_invoke$arity$1(m__46344__auto__),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891).cljs$core$IFn$_invoke$arity$1(m__46344__auto__)], null);
if(cljs.core.truth_(new cljs.core.Keyword(null,\x22dynamic\x22,\x22dynamic\x22,704819571).cljs$core$IFn$_invoke$arity$1(m__46344__auto__))){
return sci.core.new_dynamic_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
if(cljs.core.truth_((function (){var or__5045__auto__ \x3d new cljs.core.Keyword(null,\x22macro\x22,\x22macro\x22,-867863404).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(\x22sci\x22,\x22macro\x22,\x22sci/macro\x22,-868536151).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})())){
return sci.core.new_macro_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
return sci.core.new_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);

}
}
})(),(function (){var ns__46341__auto__ \x3d sci.configs.tonsky.datascript.core_ns;
var var__46342__auto__ \x3d new cljs.core.Var(function(){return datascript.core.reset_conn_BANG_;},new cljs.core.Symbol(\x22datascript.core\x22,\x22reset-conn!\x22,\x22datascript.core/reset-conn!\x22,-458464444,null),cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),new cljs.core.Keyword(null,\x22file\x22,\x22file\x22,-1269645878),new cljs.core.Keyword(null,\x22end-column\x22,\x22end-column\x22,1425389514),new cljs.core.Keyword(null,\x22top-fn\x22,\x22top-fn\x22,-2056129173),new cljs.core.Keyword(null,\x22column\x22,\x22column\x22,2078222095),new cljs.core.Keyword(null,\x22line\x22,\x22line\x22,212345235),new cljs.core.Keyword(null,\x22end-line\x22,\x22end-line\x22,1837326455),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22test\x22,\x22test\x22,577538877)],[new cljs.core.Symbol(null,\x22datascript.core\x22,\x22datascript.core\x22,-1034255346,null),new cljs.core.Symbol(null,\x22reset-conn!\x22,\x22reset-conn!\x22,1315177148,null),\x22datascript/core.cljc\x22,18,new cljs.core.PersistentArrayMap(null, 6, [new cljs.core.Keyword(null,\x22variadic?\x22,\x22variadic?\x22,584179762),false,new cljs.core.Keyword(null,\x22fixed-arity\x22,\x22fixed-arity\x22,1586445869),3,new cljs.core.Keyword(null,\x22max-fixed-arity\x22,\x22max-fixed-arity\x22,-690205543),3,new cljs.core.Keyword(null,\x22method-params\x22,\x22method-params\x22,-980792179),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22conn\x22,\x22conn\x22,1918841190,null),new cljs.core.Symbol(null,\x22db\x22,\x22db\x22,-1661185010,null)], null),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22conn\x22,\x22conn\x22,1918841190,null),new cljs.core.Symbol(null,\x22db\x22,\x22db\x22,-1661185010,null),new cljs.core.Symbol(null,\x22tx-meta\x22,\x22tx-meta\x22,-1495152575,null)], null)], null),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),cljs.core.list(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22conn\x22,\x22conn\x22,1918841190,null),new cljs.core.Symbol(null,\x22db\x22,\x22db\x22,-1661185010,null)], null),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22conn\x22,\x22conn\x22,1918841190,null),new cljs.core.Symbol(null,\x22db\x22,\x22db\x22,-1661185010,null),new cljs.core.Symbol(null,\x22tx-meta\x22,\x22tx-meta\x22,-1495152575,null)], null)),new cljs.core.Keyword(null,\x22arglists-meta\x22,\x22arglists-meta\x22,1944829838),cljs.core.list(null,null)], null),1,570,570,cljs.core.list(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22conn\x22,\x22conn\x22,1918841190,null),new cljs.core.Symbol(null,\x22db\x22,\x22db\x22,-1661185010,null)], null),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22conn\x22,\x22conn\x22,1918841190,null),new cljs.core.Symbol(null,\x22db\x22,\x22db\x22,-1661185010,null),new cljs.core.Symbol(null,\x22tx-meta\x22,\x22tx-meta\x22,-1495152575,null)], null)),\x22Forces underlying `conn` value to become `db`. Will generate a tx-report that will remove everything from old value and insert everything from the new one.\x22,(cljs.core.truth_(datascript.core.reset_conn_BANG_)?datascript.core.reset_conn_BANG_.cljs$lang$test:null)]));
var val__46343__auto__ \x3d cljs.core.deref(var__46342__auto__);
var m__46344__auto__ \x3d cljs.core.meta(var__46342__auto__);
var name__46345__auto__ \x3d (function (){var or__5045__auto__ \x3d null;
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})();
var new_m__46346__auto__ \x3d new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),ns__46341__auto__,new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),name__46345__auto__,new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754).cljs$core$IFn$_invoke$arity$1(m__46344__auto__),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891).cljs$core$IFn$_invoke$arity$1(m__46344__auto__)], null);
if(cljs.core.truth_(new cljs.core.Keyword(null,\x22dynamic\x22,\x22dynamic\x22,704819571).cljs$core$IFn$_invoke$arity$1(m__46344__auto__))){
return sci.core.new_dynamic_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
if(cljs.core.truth_((function (){var or__5045__auto__ \x3d new cljs.core.Keyword(null,\x22macro\x22,\x22macro\x22,-867863404).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(\x22sci\x22,\x22macro\x22,\x22sci/macro\x22,-868536151).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})())){
return sci.core.new_macro_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
return sci.core.new_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);

}
}
})(),(function (){var ns__46341__auto__ \x3d sci.configs.tonsky.datascript.core_ns;
var var__46342__auto__ \x3d new cljs.core.Var(function(){return datascript.core.transact_BANG_;},new cljs.core.Symbol(\x22datascript.core\x22,\x22transact!\x22,\x22datascript.core/transact!\x22,1506351773,null),cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),new cljs.core.Keyword(null,\x22file\x22,\x22file\x22,-1269645878),new cljs.core.Keyword(null,\x22end-column\x22,\x22end-column\x22,1425389514),new cljs.core.Keyword(null,\x22top-fn\x22,\x22top-fn\x22,-2056129173),new cljs.core.Keyword(null,\x22column\x22,\x22column\x22,2078222095),new cljs.core.Keyword(null,\x22line\x22,\x22line\x22,212345235),new cljs.core.Keyword(null,\x22end-line\x22,\x22end-line\x22,1837326455),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22test\x22,\x22test\x22,577538877)],[new cljs.core.Symbol(null,\x22datascript.core\x22,\x22datascript.core\x22,-1034255346,null),new cljs.core.Symbol(null,\x22transact!\x22,\x22transact!\x22,817805717,null),\x22datascript/core.cljc\x22,16,new cljs.core.PersistentArrayMap(null, 6, [new cljs.core.Keyword(null,\x22variadic?\x22,\x22variadic?\x22,584179762),false,new cljs.core.Keyword(null,\x22fixed-arity\x22,\x22fixed-arity\x22,1586445869),3,new cljs.core.Keyword(null,\x22max-fixed-arity\x22,\x22max-fixed-arity\x22,-690205543),3,new cljs.core.Keyword(null,\x22method-params\x22,\x22method-params\x22,-980792179),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22conn\x22,\x22conn\x22,1918841190,null),new cljs.core.Symbol(null,\x22tx-data\x22,\x22tx-data\x22,-1720276008,null)], null),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22conn\x22,\x22conn\x22,1918841190,null),new cljs.core.Symbol(null,\x22tx-data\x22,\x22tx-data\x22,-1720276008,null),new cljs.core.Symbol(null,\x22tx-meta\x22,\x22tx-meta\x22,-1495152575,null)], null)], null),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),cljs.core.list(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22conn\x22,\x22conn\x22,1918841190,null),new cljs.core.Symbol(null,\x22tx-data\x22,\x22tx-data\x22,-1720276008,null)], null),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22conn\x22,\x22conn\x22,1918841190,null),new cljs.core.Symbol(null,\x22tx-data\x22,\x22tx-data\x22,-1720276008,null),new cljs.core.Symbol(null,\x22tx-meta\x22,\x22tx-meta\x22,-1495152575,null)], null)),new cljs.core.Keyword(null,\x22arglists-meta\x22,\x22arglists-meta\x22,1944829838),cljs.core.list(null,null)], null),1,476,476,cljs.core.list(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22conn\x22,\x22conn\x22,1918841190,null),new cljs.core.Symbol(null,\x22tx-data\x22,\x22tx-data\x22,-1720276008,null)], null),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22conn\x22,\x22conn\x22,1918841190,null),new cljs.core.Symbol(null,\x22tx-data\x22,\x22tx-data\x22,-1720276008,null),new cljs.core.Symbol(null,\x22tx-meta\x22,\x22tx-meta\x22,-1495152575,null)], null)),\x22Applies transaction the underlying database value and atomically updates connection reference to point to the result of that transaction, new db value.\
  \
   Returns transaction report, a map:\
\
       { :db-before ...       ; db value before transaction\
         :db-after  ...       ; db value after transaction\
         :tx-data   [...]     ; plain datoms that were added/retracted from db-before\
         :tempids   {...}     ; map of tempid from tx-data \x3d\x3e assigned entid in db-after\
         :tx-meta   tx-meta } ; the exact value you passed as `tx-meta`\
\
  Note! `conn` will be updated in-place and is not returned from [[transact!]].\
  \
  Usage:\
\
      ; add a single datom to an existing entity (1)\
      (transact! conn [[:db/add 1 :name \\\x22Ivan\\\x22]])\
  \
      ; retract a single datom\
      (transact! conn [[:db/retract 1 :name \\\x22Ivan\\\x22]])\
  \
      ; retract single entity attribute\
      (transact! conn [[:db.fn/retractAttribute 1 :name]])\
  \
      ; ... or equivalently (since Datomic changed its API to support this):\
      (transact! conn [[:db/retract 1 :name]])\
      \
      ; retract all entity attributes (effectively deletes entity)\
      (transact! conn [[:db.fn/retractEntity 1]])\
  \
      ; create a new entity (`-1`, as any other negative value, is a tempid\
      ; that will be replaced with DataScript to a next unused eid)\
      (transact! conn [[:db/add -1 :name \\\x22Ivan\\\x22]])\
  \
      ; check assigned id (here `*1` is a result returned from previous `transact!` call)\
      (def report *1)\
      (:tempids report) ; \x3d\x3e {-1 296}\
  \
      ; check actual datoms inserted\
      (:tx-data report) ; \x3d\x3e [#datascript/Datom [296 :name \\\x22Ivan\\\x22]]\
  \
      ; tempid can also be a string\
      (transact! conn [[:db/add \\\x22ivan\\\x22 :name \\\x22Ivan\\\x22]])\
      (:tempids *1) ; \x3d\x3e {\\\x22ivan\\\x22 297}\
  \
      ; reference another entity (must exist)\
      (transact! conn [[:db/add -1 :friend 296]])\
  \
      ; create an entity and set multiple attributes (in a single transaction\
      ; equal tempids will be replaced with the same yet unused entid)\
      (transact! conn [[:db/add -1 :name \\\x22Ivan\\\x22]\
                       [:db/add -1 :likes \\\x22fries\\\x22]\
                       [:db/add -1 :likes \\\x22pizza\\\x22]\
                       [:db/add -1 :friend 296]])\
  \
      ; create an entity and set multiple attributes (alternative map form)\
      (transact! conn [{:db/id  -1\
                        :name   \\\x22Ivan\\\x22\
                        :likes  [\\\x22fries\\\x22 \\\x22pizza\\\x22]\
                        :friend 296}])\
      \
      ; update an entity (alternative map form). Can\\u2019t retract attributes in\
      ; map form. For cardinality many attrs, value (fish in this example)\
      ; will be added to the list of existing values\
      (transact! conn [{:db/id  296\
                        :name   \\\x22Oleg\\\x22\
                        :likes  [\\\x22fish\\\x22]}])\
\
      ; ref attributes can be specified as nested map, that will create nested entity as well\
      (transact! conn [{:db/id  -1\
                        :name   \\\x22Oleg\\\x22\
                        :friend {:db/id -2\
                                 :name \\\x22Sergey\\\x22}}])\
                                 \
      ; reverse attribute name can be used if you want created entity to become\
      ; a value in another entity reference\
      (transact! conn [{:db/id  -1\
                        :name   \\\x22Oleg\\\x22\
                        :_friend 296}])\
      ; equivalent to\
      (transact! conn [{:db/id  -1, :name   \\\x22Oleg\\\x22}\
                       {:db/id 296, :friend -1}])\
      ; equivalent to\
      (transact! conn [[:db/add  -1 :name   \\\x22Oleg\\\x22]\
                       [:db/add 296 :friend -1]])\x22,(cljs.core.truth_(datascript.core.transact_BANG_)?datascript.core.transact_BANG_.cljs$lang$test:null)]));
var val__46343__auto__ \x3d cljs.core.deref(var__46342__auto__);
var m__46344__auto__ \x3d cljs.core.meta(var__46342__auto__);
var name__46345__auto__ \x3d (function (){var or__5045__auto__ \x3d null;
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})();
var new_m__46346__auto__ \x3d new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),ns__46341__auto__,new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),name__46345__auto__,new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754).cljs$core$IFn$_invoke$arity$1(m__46344__auto__),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891).cljs$core$IFn$_invoke$arity$1(m__46344__auto__)], null);
if(cljs.core.truth_(new cljs.core.Keyword(null,\x22dynamic\x22,\x22dynamic\x22,704819571).cljs$core$IFn$_invoke$arity$1(m__46344__auto__))){
return sci.core.new_dynamic_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
if(cljs.core.truth_((function (){var or__5045__auto__ \x3d new cljs.core.Keyword(null,\x22macro\x22,\x22macro\x22,-867863404).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(\x22sci\x22,\x22macro\x22,\x22sci/macro\x22,-868536151).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})())){
return sci.core.new_macro_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
return sci.core.new_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);

}
}
})(),(function (){var ns__46341__auto__ \x3d sci.configs.tonsky.datascript.core_ns;
var var__46342__auto__ \x3d new cljs.core.Var(function(){return datascript.core.squuid;},new cljs.core.Symbol(\x22datascript.core\x22,\x22squuid\x22,\x22datascript.core/squuid\x22,-408746813,null),cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),new cljs.core.Keyword(null,\x22file\x22,\x22file\x22,-1269645878),new cljs.core.Keyword(null,\x22end-column\x22,\x22end-column\x22,1425389514),new cljs.core.Keyword(null,\x22top-fn\x22,\x22top-fn\x22,-2056129173),new cljs.core.Keyword(null,\x22column\x22,\x22column\x22,2078222095),new cljs.core.Keyword(null,\x22line\x22,\x22line\x22,212345235),new cljs.core.Keyword(null,\x22end-line\x22,\x22end-line\x22,1837326455),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22test\x22,\x22test\x22,577538877)],[new cljs.core.Symbol(null,\x22datascript.core\x22,\x22datascript.core\x22,-1034255346,null),new cljs.core.Symbol(null,\x22squuid\x22,\x22squuid\x22,-1898207797,null),\x22datascript/core.cljc\x22,13,new cljs.core.PersistentArrayMap(null, 6, [new cljs.core.Keyword(null,\x22variadic?\x22,\x22variadic?\x22,584179762),false,new cljs.core.Keyword(null,\x22fixed-arity\x22,\x22fixed-arity\x22,1586445869),1,new cljs.core.Keyword(null,\x22max-fixed-arity\x22,\x22max-fixed-arity\x22,-690205543),1,new cljs.core.Keyword(null,\x22method-params\x22,\x22method-params\x22,-980792179),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.PersistentVector.EMPTY,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22msec\x22,\x22msec\x22,-1372914914,null)], null)], null),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),cljs.core.list(cljs.core.PersistentVector.EMPTY,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22msec\x22,\x22msec\x22,-1372914914,null)], null)),new cljs.core.Keyword(null,\x22arglists-meta\x22,\x22arglists-meta\x22,1944829838),cljs.core.list(null,null)], null),1,728,728,cljs.core.list(cljs.core.PersistentVector.EMPTY,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22msec\x22,\x22msec\x22,-1372914914,null)], null)),\x22Generates a UUID that grow with time. Such UUIDs will always go to the end  of the index and that will minimize insertions in the middle.\
  \
   Consist of 64 bits of current UNIX timestamp (in seconds) and 64 random bits (2^64 different unique values per second).\x22,(cljs.core.truth_(datascript.core.squuid)?datascript.core.squuid.cljs$lang$test:null)]));
var val__46343__auto__ \x3d cljs.core.deref(var__46342__auto__);
var m__46344__auto__ \x3d cljs.core.meta(var__46342__auto__);
var name__46345__auto__ \x3d (function (){var or__5045__auto__ \x3d null;
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})();
var new_m__46346__auto__ \x3d new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),ns__46341__auto__,new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),name__46345__auto__,new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754).cljs$core$IFn$_invoke$arity$1(m__46344__auto__),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891).cljs$core$IFn$_invoke$arity$1(m__46344__auto__)], null);
if(cljs.core.truth_(new cljs.core.Keyword(null,\x22dynamic\x22,\x22dynamic\x22,704819571).cljs$core$IFn$_invoke$arity$1(m__46344__auto__))){
return sci.core.new_dynamic_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
if(cljs.core.truth_((function (){var or__5045__auto__ \x3d new cljs.core.Keyword(null,\x22macro\x22,\x22macro\x22,-867863404).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(\x22sci\x22,\x22macro\x22,\x22sci/macro\x22,-868536151).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})())){
return sci.core.new_macro_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
return sci.core.new_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);

}
}
})(),(function (){var ns__46341__auto__ \x3d sci.configs.tonsky.datascript.core_ns;
var var__46342__auto__ \x3d new cljs.core.Var(function(){return datascript.core.db;},new cljs.core.Symbol(\x22datascript.core\x22,\x22db\x22,\x22datascript.core/db\x22,667170070,null),cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),new cljs.core.Keyword(null,\x22file\x22,\x22file\x22,-1269645878),new cljs.core.Keyword(null,\x22end-column\x22,\x22end-column\x22,1425389514),new cljs.core.Keyword(null,\x22column\x22,\x22column\x22,2078222095),new cljs.core.Keyword(null,\x22line\x22,\x22line\x22,212345235),new cljs.core.Keyword(null,\x22end-line\x22,\x22end-line\x22,1837326455),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22test\x22,\x22test\x22,577538877)],[new cljs.core.Symbol(null,\x22datascript.core\x22,\x22datascript.core\x22,-1034255346,null),new cljs.core.Symbol(null,\x22db\x22,\x22db\x22,-1661185010,null),\x22datascript/core.cljc\x22,9,1,654,654,cljs.core.list(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22conn\x22,\x22conn\x22,1918841190,null)], null)),\x22Returns the underlying immutable database value from a connection.\
   \
   Exists for Datomic API compatibility. Prefer using `@conn` directly if possible.\x22,(cljs.core.truth_(datascript.core.db)?datascript.core.db.cljs$lang$test:null)]));
var val__46343__auto__ \x3d cljs.core.deref(var__46342__auto__);
var m__46344__auto__ \x3d cljs.core.meta(var__46342__auto__);
var name__46345__auto__ \x3d (function (){var or__5045__auto__ \x3d null;
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})();
var new_m__46346__auto__ \x3d new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),ns__46341__auto__,new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),name__46345__auto__,new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754).cljs$core$IFn$_invoke$arity$1(m__46344__auto__),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891).cljs$core$IFn$_invoke$arity$1(m__46344__auto__)], null);
if(cljs.core.truth_(new cljs.core.Keyword(null,\x22dynamic\x22,\x22dynamic\x22,704819571).cljs$core$IFn$_invoke$arity$1(m__46344__auto__))){
return sci.core.new_dynamic_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
if(cljs.core.truth_((function (){var or__5045__auto__ \x3d new cljs.core.Keyword(null,\x22macro\x22,\x22macro\x22,-867863404).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(\x22sci\x22,\x22macro\x22,\x22sci/macro\x22,-868536151).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})())){
return sci.core.new_macro_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
return sci.core.new_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);

}
}
})(),(function (){var ns__46341__auto__ \x3d sci.configs.tonsky.datascript.core_ns;
var var__46342__auto__ \x3d new cljs.core.Var(function(){return datascript.core.serializable;},new cljs.core.Symbol(\x22datascript.core\x22,\x22serializable\x22,\x22datascript.core/serializable\x22,-630048076,null),cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),new cljs.core.Keyword(null,\x22file\x22,\x22file\x22,-1269645878),new cljs.core.Keyword(null,\x22end-column\x22,\x22end-column\x22,1425389514),new cljs.core.Keyword(null,\x22column\x22,\x22column\x22,2078222095),new cljs.core.Keyword(null,\x22line\x22,\x22line\x22,212345235),new cljs.core.Keyword(null,\x22end-line\x22,\x22end-line\x22,1837326455),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22test\x22,\x22test\x22,577538877)],[new cljs.core.Symbol(null,\x22datascript.core\x22,\x22datascript.core\x22,-1034255346,null),new cljs.core.Symbol(null,\x22serializable\x22,\x22serializable\x22,1941609404,null),\x22datascript/core.cljc\x22,15,1,195,207,cljs.core.List.EMPTY,\x22Converts db into a data structure (not string!) that can be fed to serializer\
             of your choice (e.g. `js/JSON.stringify` in CLJS, `cheshire.core/generate-string`\
             or `jsonista.core/write-value-as-string` in CLJ).\
\
             On JVM, `serializable` holds a global lock that prevents any two serializations\
             to run in parallel (an implementation constraint, be aware).\
\
             Options:\
\
             `:freeze-fn` Non-primitive values will be serialized using this. Optional.\
             `pr-str` by default.\x22,(cljs.core.truth_(datascript.core.serializable)?datascript.core.serializable.cljs$lang$test:null)]));
var val__46343__auto__ \x3d cljs.core.deref(var__46342__auto__);
var m__46344__auto__ \x3d cljs.core.meta(var__46342__auto__);
var name__46345__auto__ \x3d (function (){var or__5045__auto__ \x3d null;
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})();
var new_m__46346__auto__ \x3d new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),ns__46341__auto__,new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),name__46345__auto__,new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754).cljs$core$IFn$_invoke$arity$1(m__46344__auto__),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891).cljs$core$IFn$_invoke$arity$1(m__46344__auto__)], null);
if(cljs.core.truth_(new cljs.core.Keyword(null,\x22dynamic\x22,\x22dynamic\x22,704819571).cljs$core$IFn$_invoke$arity$1(m__46344__auto__))){
return sci.core.new_dynamic_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
if(cljs.core.truth_((function (){var or__5045__auto__ \x3d new cljs.core.Keyword(null,\x22macro\x22,\x22macro\x22,-867863404).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(\x22sci\x22,\x22macro\x22,\x22sci/macro\x22,-868536151).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})())){
return sci.core.new_macro_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
return sci.core.new_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);

}
}
})(),(function (){var ns__46341__auto__ \x3d sci.configs.tonsky.datascript.core_ns;
var var__46342__auto__ \x3d new cljs.core.Var(function(){return datascript.core.conn_from_datoms;},new cljs.core.Symbol(\x22datascript.core\x22,\x22conn-from-datoms\x22,\x22datascript.core/conn-from-datoms\x22,253878827,null),cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),new cljs.core.Keyword(null,\x22file\x22,\x22file\x22,-1269645878),new cljs.core.Keyword(null,\x22end-column\x22,\x22end-column\x22,1425389514),new cljs.core.Keyword(null,\x22top-fn\x22,\x22top-fn\x22,-2056129173),new cljs.core.Keyword(null,\x22column\x22,\x22column\x22,2078222095),new cljs.core.Keyword(null,\x22line\x22,\x22line\x22,212345235),new cljs.core.Keyword(null,\x22end-line\x22,\x22end-line\x22,1837326455),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22test\x22,\x22test\x22,577538877)],[new cljs.core.Symbol(null,\x22datascript.core\x22,\x22datascript.core\x22,-1034255346,null),new cljs.core.Symbol(null,\x22conn-from-datoms\x22,\x22conn-from-datoms\x22,-1502002909,null),\x22datascript/core.cljc\x22,23,new cljs.core.PersistentArrayMap(null, 6, [new cljs.core.Keyword(null,\x22variadic?\x22,\x22variadic?\x22,584179762),false,new cljs.core.Keyword(null,\x22fixed-arity\x22,\x22fixed-arity\x22,1586445869),2,new cljs.core.Keyword(null,\x22max-fixed-arity\x22,\x22max-fixed-arity\x22,-690205543),2,new cljs.core.Keyword(null,\x22method-params\x22,\x22method-params\x22,-980792179),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22datoms\x22,\x22datoms\x22,1349657093,null)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22datoms\x22,\x22datoms\x22,1349657093,null),new cljs.core.Symbol(null,\x22schema\x22,\x22schema\x22,58529736,null)], null)], null),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),cljs.core.list(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22datoms\x22,\x22datoms\x22,1349657093,null)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22datoms\x22,\x22datoms\x22,1349657093,null),new cljs.core.Symbol(null,\x22schema\x22,\x22schema\x22,58529736,null)], null)),new cljs.core.Keyword(null,\x22arglists-meta\x22,\x22arglists-meta\x22,1944829838),cljs.core.list(null,null)], null),1,450,450,cljs.core.list(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22datoms\x22,\x22datoms\x22,1349657093,null)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22datoms\x22,\x22datoms\x22,1349657093,null),new cljs.core.Symbol(null,\x22schema\x22,\x22schema\x22,58529736,null)], null)),\x22Creates an empty DB and a mutable reference to it. See [[create-conn]].\x22,(cljs.core.truth_(datascript.core.conn_from_datoms)?datascript.core.conn_from_datoms.cljs$lang$test:null)]));
var val__46343__auto__ \x3d cljs.core.deref(var__46342__auto__);
var m__46344__auto__ \x3d cljs.core.meta(var__46342__auto__);
var name__46345__auto__ \x3d (function (){var or__5045__auto__ \x3d null;
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})();
var new_m__46346__auto__ \x3d new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),ns__46341__auto__,new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),name__46345__auto__,new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754).cljs$core$IFn$_invoke$arity$1(m__46344__auto__),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891).cljs$core$IFn$_invoke$arity$1(m__46344__auto__)], null);
if(cljs.core.truth_(new cljs.core.Keyword(null,\x22dynamic\x22,\x22dynamic\x22,704819571).cljs$core$IFn$_invoke$arity$1(m__46344__auto__))){
return sci.core.new_dynamic_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
if(cljs.core.truth_((function (){var or__5045__auto__ \x3d new cljs.core.Keyword(null,\x22macro\x22,\x22macro\x22,-867863404).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(\x22sci\x22,\x22macro\x22,\x22sci/macro\x22,-868536151).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})())){
return sci.core.new_macro_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
return sci.core.new_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);

}
}
})(),(function (){var ns__46341__auto__ \x3d sci.configs.tonsky.datascript.core_ns;
var var__46342__auto__ \x3d new cljs.core.Var(function(){return datascript.core.from_serializable;},new cljs.core.Symbol(\x22datascript.core\x22,\x22from-serializable\x22,\x22datascript.core/from-serializable\x22,-1560031101,null),cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),new cljs.core.Keyword(null,\x22file\x22,\x22file\x22,-1269645878),new cljs.core.Keyword(null,\x22end-column\x22,\x22end-column\x22,1425389514),new cljs.core.Keyword(null,\x22column\x22,\x22column\x22,2078222095),new cljs.core.Keyword(null,\x22line\x22,\x22line\x22,212345235),new cljs.core.Keyword(null,\x22end-line\x22,\x22end-line\x22,1837326455),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22test\x22,\x22test\x22,577538877)],[new cljs.core.Symbol(null,\x22datascript.core\x22,\x22datascript.core\x22,-1034255346,null),new cljs.core.Symbol(null,\x22from-serializable\x22,\x22from-serializable\x22,945516427,null),\x22datascript/core.cljc\x22,20,1,210,218,cljs.core.List.EMPTY,\x22Creates db from a data structure (not string!) produced by serializable.\
\
             Opts:\
\
             `:thaw-fn` Non-primitive values will be deserialized using this.\
             Must match :freeze-fn from serializable. Optional. `clojure.edn/read-string`\
             by default.\x22,(cljs.core.truth_(datascript.core.from_serializable)?datascript.core.from_serializable.cljs$lang$test:null)]));
var val__46343__auto__ \x3d cljs.core.deref(var__46342__auto__);
var m__46344__auto__ \x3d cljs.core.meta(var__46342__auto__);
var name__46345__auto__ \x3d (function (){var or__5045__auto__ \x3d null;
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})();
var new_m__46346__auto__ \x3d new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),ns__46341__auto__,new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),name__46345__auto__,new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754).cljs$core$IFn$_invoke$arity$1(m__46344__auto__),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891).cljs$core$IFn$_invoke$arity$1(m__46344__auto__)], null);
if(cljs.core.truth_(new cljs.core.Keyword(null,\x22dynamic\x22,\x22dynamic\x22,704819571).cljs$core$IFn$_invoke$arity$1(m__46344__auto__))){
return sci.core.new_dynamic_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
if(cljs.core.truth_((function (){var or__5045__auto__ \x3d new cljs.core.Keyword(null,\x22macro\x22,\x22macro\x22,-867863404).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(\x22sci\x22,\x22macro\x22,\x22sci/macro\x22,-868536151).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})())){
return sci.core.new_macro_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
return sci.core.new_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);

}
}
})(),(function (){var ns__46341__auto__ \x3d sci.configs.tonsky.datascript.core_ns;
var var__46342__auto__ \x3d new cljs.core.Var(function(){return datascript.core.empty_db;},new cljs.core.Symbol(\x22datascript.core\x22,\x22empty-db\x22,\x22datascript.core/empty-db\x22,-807971396,null),cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),new cljs.core.Keyword(null,\x22file\x22,\x22file\x22,-1269645878),new cljs.core.Keyword(null,\x22end-column\x22,\x22end-column\x22,1425389514),new cljs.core.Keyword(null,\x22column\x22,\x22column\x22,2078222095),new cljs.core.Keyword(null,\x22line\x22,\x22line\x22,212345235),new cljs.core.Keyword(null,\x22end-line\x22,\x22end-line\x22,1837326455),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22test\x22,\x22test\x22,577538877)],[new cljs.core.Symbol(null,\x22datascript.core\x22,\x22datascript.core\x22,-1034255346,null),new cljs.core.Symbol(null,\x22empty-db\x22,\x22empty-db\x22,1486862004,null),\x22datascript/core.cljc\x22,11,1,152,164,cljs.core.List.EMPTY,\x22Creates an empty database with an optional schema.\
\
             Usage:\
             \
             ```\
             (empty-db) ; \x3d\x3e #datascript/DB {:schema {}, :datoms []}\
  \
             (empty-db {:likes {:db/cardinality :db.cardinality/many}})\
             ; \x3d\x3e #datascript/DB {:schema {:likes {:db/cardinality :db.cardinality/many}}\
             ;                    :datoms []}\
             ```\x22,(cljs.core.truth_(datascript.core.empty_db)?datascript.core.empty_db.cljs$lang$test:null)]));
var val__46343__auto__ \x3d cljs.core.deref(var__46342__auto__);
var m__46344__auto__ \x3d cljs.core.meta(var__46342__auto__);
var name__46345__auto__ \x3d (function (){var or__5045__auto__ \x3d null;
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})();
var new_m__46346__auto__ \x3d new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),ns__46341__auto__,new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),name__46345__auto__,new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754).cljs$core$IFn$_invoke$arity$1(m__46344__auto__),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891).cljs$core$IFn$_invoke$arity$1(m__46344__auto__)], null);
if(cljs.core.truth_(new cljs.core.Keyword(null,\x22dynamic\x22,\x22dynamic\x22,704819571).cljs$core$IFn$_invoke$arity$1(m__46344__auto__))){
return sci.core.new_dynamic_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
if(cljs.core.truth_((function (){var or__5045__auto__ \x3d new cljs.core.Keyword(null,\x22macro\x22,\x22macro\x22,-867863404).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(\x22sci\x22,\x22macro\x22,\x22sci/macro\x22,-868536151).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})())){
return sci.core.new_macro_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
return sci.core.new_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);

}
}
})(),(function (){var ns__46341__auto__ \x3d sci.configs.tonsky.datascript.core_ns;
var var__46342__auto__ \x3d new cljs.core.Var(function(){return datascript.core.init_db;},new cljs.core.Symbol(\x22datascript.core\x22,\x22init-db\x22,\x22datascript.core/init-db\x22,1493526573,null),cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),new cljs.core.Keyword(null,\x22file\x22,\x22file\x22,-1269645878),new cljs.core.Keyword(null,\x22end-column\x22,\x22end-column\x22,1425389514),new cljs.core.Keyword(null,\x22column\x22,\x22column\x22,2078222095),new cljs.core.Keyword(null,\x22line\x22,\x22line\x22,212345235),new cljs.core.Keyword(null,\x22end-line\x22,\x22end-line\x22,1837326455),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22test\x22,\x22test\x22,577538877)],[new cljs.core.Symbol(null,\x22datascript.core\x22,\x22datascript.core\x22,-1034255346,null),new cljs.core.Symbol(null,\x22init-db\x22,\x22init-db\x22,-1059254491,null),\x22datascript/core.cljc\x22,10,1,186,192,cljs.core.List.EMPTY,\x22Low-level fn for creating database quickly from a trusted sequence of datoms.\
\
             Does no validation on inputs, so `datoms` must be well-formed and match schema.\
\
             Used internally in db (de)serialization. See also [[datom]].\x22,(cljs.core.truth_(datascript.core.init_db)?datascript.core.init_db.cljs$lang$test:null)]));
var val__46343__auto__ \x3d cljs.core.deref(var__46342__auto__);
var m__46344__auto__ \x3d cljs.core.meta(var__46342__auto__);
var name__46345__auto__ \x3d (function (){var or__5045__auto__ \x3d null;
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})();
var new_m__46346__auto__ \x3d new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),ns__46341__auto__,new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),name__46345__auto__,new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754).cljs$core$IFn$_invoke$arity$1(m__46344__auto__),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891).cljs$core$IFn$_invoke$arity$1(m__46344__auto__)], null);
if(cljs.core.truth_(new cljs.core.Keyword(null,\x22dynamic\x22,\x22dynamic\x22,704819571).cljs$core$IFn$_invoke$arity$1(m__46344__auto__))){
return sci.core.new_dynamic_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
if(cljs.core.truth_((function (){var or__5045__auto__ \x3d new cljs.core.Keyword(null,\x22macro\x22,\x22macro\x22,-867863404).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(\x22sci\x22,\x22macro\x22,\x22sci/macro\x22,-868536151).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})())){
return sci.core.new_macro_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
return sci.core.new_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);

}
}
})(),(function (){var ns__46341__auto__ \x3d sci.configs.tonsky.datascript.core_ns;
var var__46342__auto__ \x3d new cljs.core.Var(function(){return datascript.core.touch;},new cljs.core.Symbol(\x22datascript.core\x22,\x22touch\x22,\x22datascript.core/touch\x22,632058772,null),cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),new cljs.core.Keyword(null,\x22file\x22,\x22file\x22,-1269645878),new cljs.core.Keyword(null,\x22end-column\x22,\x22end-column\x22,1425389514),new cljs.core.Keyword(null,\x22column\x22,\x22column\x22,2078222095),new cljs.core.Keyword(null,\x22line\x22,\x22line\x22,212345235),new cljs.core.Keyword(null,\x22end-line\x22,\x22end-line\x22,1837326455),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22test\x22,\x22test\x22,577538877)],[new cljs.core.Symbol(null,\x22datascript.core\x22,\x22datascript.core\x22,-1034255346,null),new cljs.core.Symbol(null,\x22touch\x22,\x22touch\x22,-1158163300,null),\x22datascript/core.cljc\x22,8,1,91,100,cljs.core.List.EMPTY,\x22Forces all entity attributes to be eagerly fetched and cached. Only usable for debug output.\
\
             Usage:\
\
             ```\
             (entity db 1) ; \x3d\x3e {:db/id 1}\
             (touch (entity db 1)) ; \x3d\x3e {:db/id 1, :dislikes [:pie], :likes [:pizza]}\
             ```\x22,(cljs.core.truth_(datascript.core.touch)?datascript.core.touch.cljs$lang$test:null)]));
var val__46343__auto__ \x3d cljs.core.deref(var__46342__auto__);
var m__46344__auto__ \x3d cljs.core.meta(var__46342__auto__);
var name__46345__auto__ \x3d (function (){var or__5045__auto__ \x3d null;
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})();
var new_m__46346__auto__ \x3d new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),ns__46341__auto__,new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),name__46345__auto__,new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754).cljs$core$IFn$_invoke$arity$1(m__46344__auto__),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891).cljs$core$IFn$_invoke$arity$1(m__46344__auto__)], null);
if(cljs.core.truth_(new cljs.core.Keyword(null,\x22dynamic\x22,\x22dynamic\x22,704819571).cljs$core$IFn$_invoke$arity$1(m__46344__auto__))){
return sci.core.new_dynamic_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
if(cljs.core.truth_((function (){var or__5045__auto__ \x3d new cljs.core.Keyword(null,\x22macro\x22,\x22macro\x22,-867863404).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(\x22sci\x22,\x22macro\x22,\x22sci/macro\x22,-868536151).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})())){
return sci.core.new_macro_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
return sci.core.new_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);

}
}
})(),(function (){var ns__46341__auto__ \x3d sci.configs.tonsky.datascript.core_ns;
var var__46342__auto__ \x3d new cljs.core.Var(function(){return datascript.core.tx0;},new cljs.core.Symbol(\x22datascript.core\x22,\x22tx0\x22,\x22datascript.core/tx0\x22,1432817831,null),cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,\x22no-doc\x22,\x22no-doc\x22,1559921891),new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),new cljs.core.Keyword(null,\x22file\x22,\x22file\x22,-1269645878),new cljs.core.Keyword(null,\x22end-column\x22,\x22end-column\x22,1425389514),new cljs.core.Keyword(null,\x22column\x22,\x22column\x22,2078222095),new cljs.core.Keyword(null,\x22const\x22,\x22const\x22,1709929842),new cljs.core.Keyword(null,\x22line\x22,\x22line\x22,212345235),new cljs.core.Keyword(null,\x22end-line\x22,\x22end-line\x22,1837326455),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22test\x22,\x22test\x22,577538877)],[true,new cljs.core.Symbol(null,\x22datascript.core\x22,\x22datascript.core\x22,-1034255346,null),new cljs.core.Symbol(null,\x22tx0\x22,\x22tx0\x22,-4656209,null),\x22datascript/core.cljc\x22,26,1,true,18,18,cljs.core.List.EMPTY,null,(cljs.core.truth_(datascript.core.tx0)?datascript.core.tx0.cljs$lang$test:null)]));
var val__46343__auto__ \x3d cljs.core.deref(var__46342__auto__);
var m__46344__auto__ \x3d cljs.core.meta(var__46342__auto__);
var name__46345__auto__ \x3d (function (){var or__5045__auto__ \x3d null;
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})();
var new_m__46346__auto__ \x3d new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),ns__46341__auto__,new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),name__46345__auto__,new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754).cljs$core$IFn$_invoke$arity$1(m__46344__auto__),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891).cljs$core$IFn$_invoke$arity$1(m__46344__auto__)], null);
if(cljs.core.truth_(new cljs.core.Keyword(null,\x22dynamic\x22,\x22dynamic\x22,704819571).cljs$core$IFn$_invoke$arity$1(m__46344__auto__))){
return sci.core.new_dynamic_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
if(cljs.core.truth_((function (){var or__5045__auto__ \x3d new cljs.core.Keyword(null,\x22macro\x22,\x22macro\x22,-867863404).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(\x22sci\x22,\x22macro\x22,\x22sci/macro\x22,-868536151).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})())){
return sci.core.new_macro_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
return sci.core.new_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);

}
}
})(),(function (){var ns__46341__auto__ \x3d sci.configs.tonsky.datascript.core_ns;
var var__46342__auto__ \x3d new cljs.core.Var(function(){return datascript.core.filter;},new cljs.core.Symbol(\x22datascript.core\x22,\x22filter\x22,\x22datascript.core/filter\x22,-1276765471,null),cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),new cljs.core.Keyword(null,\x22file\x22,\x22file\x22,-1269645878),new cljs.core.Keyword(null,\x22end-column\x22,\x22end-column\x22,1425389514),new cljs.core.Keyword(null,\x22column\x22,\x22column\x22,2078222095),new cljs.core.Keyword(null,\x22line\x22,\x22line\x22,212345235),new cljs.core.Keyword(null,\x22end-line\x22,\x22end-line\x22,1837326455),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22test\x22,\x22test\x22,577538877)],[new cljs.core.Symbol(null,\x22datascript.core\x22,\x22datascript.core\x22,-1034255346,null),new cljs.core.Symbol(null,\x22filter\x22,\x22filter\x22,691993593,null),\x22datascript/core.cljc\x22,13,1,235,235,cljs.core.list(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22db\x22,\x22db\x22,-1661185010,null),new cljs.core.Symbol(null,\x22pred\x22,\x22pred\x22,-727012372,null)], null)),\x22Returns a view over database that has same interface but only includes datoms for which the `(pred db datom)` is true. Can be applied multiple times.\
   \
   Filtered DB gotchas:\
\
   - All operations on filtered database are proxied to original DB, then filter pred is applied.\
   - Not cached. You pay filter penalty every time.\
   - Supports entities, pull, queries, index access.\
   - Does not support [[with]] and [[db-with]].\x22,(cljs.core.truth_(datascript.core.filter)?datascript.core.filter.cljs$lang$test:null)]));
var val__46343__auto__ \x3d cljs.core.deref(var__46342__auto__);
var m__46344__auto__ \x3d cljs.core.meta(var__46342__auto__);
var name__46345__auto__ \x3d (function (){var or__5045__auto__ \x3d null;
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})();
var new_m__46346__auto__ \x3d new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),ns__46341__auto__,new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),name__46345__auto__,new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754).cljs$core$IFn$_invoke$arity$1(m__46344__auto__),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891).cljs$core$IFn$_invoke$arity$1(m__46344__auto__)], null);
if(cljs.core.truth_(new cljs.core.Keyword(null,\x22dynamic\x22,\x22dynamic\x22,704819571).cljs$core$IFn$_invoke$arity$1(m__46344__auto__))){
return sci.core.new_dynamic_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
if(cljs.core.truth_((function (){var or__5045__auto__ \x3d new cljs.core.Keyword(null,\x22macro\x22,\x22macro\x22,-867863404).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(\x22sci\x22,\x22macro\x22,\x22sci/macro\x22,-868536151).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})())){
return sci.core.new_macro_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
return sci.core.new_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);

}
}
})(),(function (){var ns__46341__auto__ \x3d sci.configs.tonsky.datascript.core_ns;
var var__46342__auto__ \x3d new cljs.core.Var(function(){return datascript.core.datoms;},new cljs.core.Symbol(\x22datascript.core\x22,\x22datoms\x22,\x22datascript.core/datoms\x22,961250077,null),cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),new cljs.core.Keyword(null,\x22file\x22,\x22file\x22,-1269645878),new cljs.core.Keyword(null,\x22end-column\x22,\x22end-column\x22,1425389514),new cljs.core.Keyword(null,\x22top-fn\x22,\x22top-fn\x22,-2056129173),new cljs.core.Keyword(null,\x22column\x22,\x22column\x22,2078222095),new cljs.core.Keyword(null,\x22line\x22,\x22line\x22,212345235),new cljs.core.Keyword(null,\x22end-line\x22,\x22end-line\x22,1837326455),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22test\x22,\x22test\x22,577538877)],[new cljs.core.Symbol(null,\x22datascript.core\x22,\x22datascript.core\x22,-1034255346,null),new cljs.core.Symbol(null,\x22datoms\x22,\x22datoms\x22,1349657093,null),\x22datascript/core.cljc\x22,13,new cljs.core.PersistentArrayMap(null, 6, [new cljs.core.Keyword(null,\x22variadic?\x22,\x22variadic?\x22,584179762),false,new cljs.core.Keyword(null,\x22fixed-arity\x22,\x22fixed-arity\x22,1586445869),6,new cljs.core.Keyword(null,\x22max-fixed-arity\x22,\x22max-fixed-arity\x22,-690205543),6,new cljs.core.Keyword(null,\x22method-params\x22,\x22method-params\x22,-980792179),new cljs.core.PersistentVector(null, 5, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22db\x22,\x22db\x22,-1661185010,null),new cljs.core.Symbol(null,\x22index\x22,\x22index\x22,108845612,null)], null),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22db\x22,\x22db\x22,-1661185010,null),new cljs.core.Symbol(null,\x22index\x22,\x22index\x22,108845612,null),new cljs.core.Symbol(null,\x22c1\x22,\x22c1\x22,-1521904966,null)], null),new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22db\x22,\x22db\x22,-1661185010,null),new cljs.core.Symbol(null,\x22index\x22,\x22index\x22,108845612,null),new cljs.core.Symbol(null,\x22c1\x22,\x22c1\x22,-1521904966,null),new cljs.core.Symbol(null,\x22c2\x22,\x22c2\x22,78651156,null)], null),new cljs.core.PersistentVector(null, 5, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22db\x22,\x22db\x22,-1661185010,null),new cljs.core.Symbol(null,\x22index\x22,\x22index\x22,108845612,null),new cljs.core.Symbol(null,\x22c1\x22,\x22c1\x22,-1521904966,null),new cljs.core.Symbol(null,\x22c2\x22,\x22c2\x22,78651156,null),new cljs.core.Symbol(null,\x22c3\x22,\x22c3\x22,468715789,null)], null),new cljs.core.PersistentVector(null, 6, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22db\x22,\x22db\x22,-1661185010,null),new cljs.core.Symbol(null,\x22index\x22,\x22index\x22,108845612,null),new cljs.core.Symbol(null,\x22c1\x22,\x22c1\x22,-1521904966,null),new cljs.core.Symbol(null,\x22c2\x22,\x22c2\x22,78651156,null),new cljs.core.Symbol(null,\x22c3\x22,\x22c3\x22,468715789,null),new cljs.core.Symbol(null,\x22c4\x22,\x22c4\x22,-1626390159,null)], null)], null),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),cljs.core.list(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22db\x22,\x22db\x22,-1661185010,null),new cljs.core.Symbol(null,\x22index\x22,\x22index\x22,108845612,null)], null),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22db\x22,\x22db\x22,-1661185010,null),new cljs.core.Symbol(null,\x22index\x22,\x22index\x22,108845612,null),new cljs.core.Symbol(null,\x22c1\x22,\x22c1\x22,-1521904966,null)], null),new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22db\x22,\x22db\x22,-1661185010,null),new cljs.core.Symbol(null,\x22index\x22,\x22index\x22,108845612,null),new cljs.core.Symbol(null,\x22c1\x22,\x22c1\x22,-1521904966,null),new cljs.core.Symbol(null,\x22c2\x22,\x22c2\x22,78651156,null)], null),new cljs.core.PersistentVector(null, 5, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22db\x22,\x22db\x22,-1661185010,null),new cljs.core.Symbol(null,\x22index\x22,\x22index\x22,108845612,null),new cljs.core.Symbol(null,\x22c1\x22,\x22c1\x22,-1521904966,null),new cljs.core.Symbol(null,\x22c2\x22,\x22c2\x22,78651156,null),new cljs.core.Symbol(null,\x22c3\x22,\x22c3\x22,468715789,null)], null),new cljs.core.PersistentVector(null, 6, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22db\x22,\x22db\x22,-1661185010,null),new cljs.core.Symbol(null,\x22index\x22,\x22index\x22,108845612,null),new cljs.core.Symbol(null,\x22c1\x22,\x22c1\x22,-1521904966,null),new cljs.core.Symbol(null,\x22c2\x22,\x22c2\x22,78651156,null),new cljs.core.Symbol(null,\x22c3\x22,\x22c3\x22,468715789,null),new cljs.core.Symbol(null,\x22c4\x22,\x22c4\x22,-1626390159,null)], null)),new cljs.core.Keyword(null,\x22arglists-meta\x22,\x22arglists-meta\x22,1944829838),cljs.core.list(null,null,null,null,null)], null),1,280,280,cljs.core.list(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22db\x22,\x22db\x22,-1661185010,null),new cljs.core.Symbol(null,\x22index\x22,\x22index\x22,108845612,null)], null),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22db\x22,\x22db\x22,-1661185010,null),new cljs.core.Symbol(null,\x22index\x22,\x22index\x22,108845612,null),new cljs.core.Symbol(null,\x22c1\x22,\x22c1\x22,-1521904966,null)], null),new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22db\x22,\x22db\x22,-1661185010,null),new cljs.core.Symbol(null,\x22index\x22,\x22index\x22,108845612,null),new cljs.core.Symbol(null,\x22c1\x22,\x22c1\x22,-1521904966,null),new cljs.core.Symbol(null,\x22c2\x22,\x22c2\x22,78651156,null)], null),new cljs.core.PersistentVector(null, 5, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22db\x22,\x22db\x22,-1661185010,null),new cljs.core.Symbol(null,\x22index\x22,\x22index\x22,108845612,null),new cljs.core.Symbol(null,\x22c1\x22,\x22c1\x22,-1521904966,null),new cljs.core.Symbol(null,\x22c2\x22,\x22c2\x22,78651156,null),new cljs.core.Symbol(null,\x22c3\x22,\x22c3\x22,468715789,null)], null),new cljs.core.PersistentVector(null, 6, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22db\x22,\x22db\x22,-1661185010,null),new cljs.core.Symbol(null,\x22index\x22,\x22index\x22,108845612,null),new cljs.core.Symbol(null,\x22c1\x22,\x22c1\x22,-1521904966,null),new cljs.core.Symbol(null,\x22c2\x22,\x22c2\x22,78651156,null),new cljs.core.Symbol(null,\x22c3\x22,\x22c3\x22,468715789,null),new cljs.core.Symbol(null,\x22c4\x22,\x22c4\x22,-1626390159,null)], null)),\x22Index lookup. Returns a sequence of datoms (lazy iterator over actual DB index) which components (e, a, v) match passed arguments.\
\
   Datoms are sorted in index sort order. Possible `index` values are: `:eavt`, `:aevt`, `:avet`.\
\
   Usage:\
\
       ; find all datoms for entity id \x3d\x3d 1 (any attrs and values)\
       ; sort by attribute, then value\
       (datoms db :eavt 1)\
       ; \x3d\x3e (#datascript/Datom [1 :friends 2]\
       ;     #datascript/Datom [1 :likes \\\x22fries\\\x22]\
       ;     #datascript/Datom [1 :likes \\\x22pizza\\\x22]\
       ;     #datascript/Datom [1 :name \\\x22Ivan\\\x22])\
  \
       ; find all datoms for entity id \x3d\x3d 1 and attribute \x3d\x3d :likes (any values)\
       ; sorted by value\
       (datoms db :eavt 1 :likes)\
       ; \x3d\x3e (#datascript/Datom [1 :likes \\\x22fries\\\x22]\
       ;     #datascript/Datom [1 :likes \\\x22pizza\\\x22])\
       \
       ; find all datoms for entity id \x3d\x3d 1, attribute \x3d\x3d :likes and value \x3d\x3d \\\x22pizza\\\x22\
       (datoms db :eavt 1 :likes \\\x22pizza\\\x22)\
       ; \x3d\x3e (#datascript/Datom [1 :likes \\\x22pizza\\\x22])\
  \
       ; find all datoms for attribute \x3d\x3d :likes (any entity ids and values)\
       ; sorted by entity id, then value\
       (datoms db :aevt :likes)\
       ; \x3d\x3e (#datascript/Datom [1 :likes \\\x22fries\\\x22]\
       ;     #datascript/Datom [1 :likes \\\x22pizza\\\x22]\
       ;     #datascript/Datom [2 :likes \\\x22candy\\\x22]\
       ;     #datascript/Datom [2 :likes \\\x22pie\\\x22]\
       ;     #datascript/Datom [2 :likes \\\x22pizza\\\x22])\
  \
       ; find all datoms that have attribute \x3d\x3d `:likes` and value \x3d\x3d `\\\x22pizza\\\x22` (any entity id)\
       ; `:likes` must be a unique attr, reference or marked as `:db/index true`\
       (datoms db :avet :likes \\\x22pizza\\\x22)\
       ; \x3d\x3e (#datascript/Datom [1 :likes \\\x22pizza\\\x22]\
       ;     #datascript/Datom [2 :likes \\\x22pizza\\\x22])\
  \
       ; find all datoms sorted by entity id, then attribute, then value\
       (datoms db :eavt) ; \x3d\x3e (...)\
\
   Useful patterns:\
\
       ; get all values of :db.cardinality/many attribute\
       (-\x3e\x3e (datoms db :eavt eid attr) (map :v))\
  \
       ; lookup entity ids by attribute value\
       (-\x3e\x3e (datoms db :avet attr value) (map :e))\
  \
       ; find all entities with a specific attribute\
       (-\x3e\x3e (datoms db :aevt attr) (map :e))\
  \
       ; find \\u201Csingleton\\u201D entity by its attr\
       (-\x3e\x3e (datoms db :aevt attr) first :e)\
  \
       ; find N entities with lowest attr value (e.g. 10 earliest posts)\
       (-\x3e\x3e (datoms db :avet attr) (take N))\
  \
       ; find N entities with highest attr value (e.g. 10 latest posts)\
       (-\x3e\x3e (datoms db :avet attr) (reverse) (take N))\
\
   Gotchas:\
   \
   - Index lookup is usually more efficient than doing a query with a single clause.\
   - Resulting iterator is calculated in constant time and small constant memory overhead.\
   - Iterator supports efficient `first`, `next`, `reverse`, `seq` and is itself a sequence.\
   - Will not return datoms that are not part of the index (e.g. attributes with no `:db/index` in schema when querying `:avet` index).\
     - `:eavt` and `:aevt` contain all datoms.\
     - `:avet` only contains datoms for references, `:db/unique` and `:db/index` attributes.\x22,(cljs.core.truth_(datascript.core.datoms)?datascript.core.datoms.cljs$lang$test:null)]));
var val__46343__auto__ \x3d cljs.core.deref(var__46342__auto__);
var m__46344__auto__ \x3d cljs.core.meta(var__46342__auto__);
var name__46345__auto__ \x3d (function (){var or__5045__auto__ \x3d null;
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})();
var new_m__46346__auto__ \x3d new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),ns__46341__auto__,new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),name__46345__auto__,new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754).cljs$core$IFn$_invoke$arity$1(m__46344__auto__),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891).cljs$core$IFn$_invoke$arity$1(m__46344__auto__)], null);
if(cljs.core.truth_(new cljs.core.Keyword(null,\x22dynamic\x22,\x22dynamic\x22,704819571).cljs$core$IFn$_invoke$arity$1(m__46344__auto__))){
return sci.core.new_dynamic_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
if(cljs.core.truth_((function (){var or__5045__auto__ \x3d new cljs.core.Keyword(null,\x22macro\x22,\x22macro\x22,-867863404).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(\x22sci\x22,\x22macro\x22,\x22sci/macro\x22,-868536151).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})())){
return sci.core.new_macro_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
return sci.core.new_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);

}
}
})(),(function (){var ns__46341__auto__ \x3d sci.configs.tonsky.datascript.core_ns;
var var__46342__auto__ \x3d new cljs.core.Var(function(){return datascript.core.pull;},new cljs.core.Symbol(\x22datascript.core\x22,\x22pull\x22,\x22datascript.core/pull\x22,-1213970902,null),cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),new cljs.core.Keyword(null,\x22file\x22,\x22file\x22,-1269645878),new cljs.core.Keyword(null,\x22end-column\x22,\x22end-column\x22,1425389514),new cljs.core.Keyword(null,\x22column\x22,\x22column\x22,2078222095),new cljs.core.Keyword(null,\x22line\x22,\x22line\x22,212345235),new cljs.core.Keyword(null,\x22end-line\x22,\x22end-line\x22,1837326455),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22test\x22,\x22test\x22,577538877)],[new cljs.core.Symbol(null,\x22datascript.core\x22,\x22datascript.core\x22,-1034255346,null),new cljs.core.Symbol(null,\x22pull\x22,\x22pull\x22,779986722,null),\x22datascript/core.cljc\x22,7,1,105,117,cljs.core.List.EMPTY,\x22Fetches data from database using recursive declarative description. See [docs.datomic.com/on-prem/pull.html](https://docs.datomic.com/on-prem/pull.html).\
\
             Unlike [[entity]], returns plain Clojure map (not lazy).\
\
             Usage:\
\
                 (pull db [:db/id, :name, :likes, {:friends [:db/id :name]}] 1)\
                 ; \x3d\x3e {:db/id   1,\
                 ;     :name    \\\x22Ivan\\\x22\
                 ;     :likes   [:pizza]\
                 ;     :friends [{:db/id 2, :name \\\x22Oleg\\\x22}]}\x22,(cljs.core.truth_(datascript.core.pull)?datascript.core.pull.cljs$lang$test:null)]));
var val__46343__auto__ \x3d cljs.core.deref(var__46342__auto__);
var m__46344__auto__ \x3d cljs.core.meta(var__46342__auto__);
var name__46345__auto__ \x3d (function (){var or__5045__auto__ \x3d null;
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})();
var new_m__46346__auto__ \x3d new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),ns__46341__auto__,new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),name__46345__auto__,new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754).cljs$core$IFn$_invoke$arity$1(m__46344__auto__),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891).cljs$core$IFn$_invoke$arity$1(m__46344__auto__)], null);
if(cljs.core.truth_(new cljs.core.Keyword(null,\x22dynamic\x22,\x22dynamic\x22,704819571).cljs$core$IFn$_invoke$arity$1(m__46344__auto__))){
return sci.core.new_dynamic_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
if(cljs.core.truth_((function (){var or__5045__auto__ \x3d new cljs.core.Keyword(null,\x22macro\x22,\x22macro\x22,-867863404).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(\x22sci\x22,\x22macro\x22,\x22sci/macro\x22,-868536151).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})())){
return sci.core.new_macro_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
return sci.core.new_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);

}
}
})(),(function (){var ns__46341__auto__ \x3d sci.configs.tonsky.datascript.core_ns;
var var__46342__auto__ \x3d new cljs.core.Var(function(){return datascript.core.create_conn;},new cljs.core.Symbol(\x22datascript.core\x22,\x22create-conn\x22,\x22datascript.core/create-conn\x22,-768042587,null),cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),new cljs.core.Keyword(null,\x22file\x22,\x22file\x22,-1269645878),new cljs.core.Keyword(null,\x22end-column\x22,\x22end-column\x22,1425389514),new cljs.core.Keyword(null,\x22top-fn\x22,\x22top-fn\x22,-2056129173),new cljs.core.Keyword(null,\x22column\x22,\x22column\x22,2078222095),new cljs.core.Keyword(null,\x22line\x22,\x22line\x22,212345235),new cljs.core.Keyword(null,\x22end-line\x22,\x22end-line\x22,1837326455),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22test\x22,\x22test\x22,577538877)],[new cljs.core.Symbol(null,\x22datascript.core\x22,\x22datascript.core\x22,-1034255346,null),new cljs.core.Symbol(null,\x22create-conn\x22,\x22create-conn\x22,2071410861,null),\x22datascript/core.cljc\x22,18,new cljs.core.PersistentArrayMap(null, 6, [new cljs.core.Keyword(null,\x22variadic?\x22,\x22variadic?\x22,584179762),false,new cljs.core.Keyword(null,\x22fixed-arity\x22,\x22fixed-arity\x22,1586445869),1,new cljs.core.Keyword(null,\x22max-fixed-arity\x22,\x22max-fixed-arity\x22,-690205543),1,new cljs.core.Keyword(null,\x22method-params\x22,\x22method-params\x22,-980792179),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.PersistentVector.EMPTY,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22schema\x22,\x22schema\x22,58529736,null)], null)], null),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),cljs.core.list(cljs.core.PersistentVector.EMPTY,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22schema\x22,\x22schema\x22,58529736,null)], null)),new cljs.core.Keyword(null,\x22arglists-meta\x22,\x22arglists-meta\x22,1944829838),cljs.core.list(null,null)], null),1,456,456,cljs.core.list(cljs.core.PersistentVector.EMPTY,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22schema\x22,\x22schema\x22,58529736,null)], null)),\x22Creates a mutable reference (a \\u201Cconnection\\u201D) to an empty immutable database.\
\
   Connections are lightweight in-memory structures (~atoms) with direct support of transaction listeners ([[listen!]], [[unlisten!]]) and other handy DataScript APIs ([[transact!]], [[reset-conn!]], [[db]]).\
\
   To access underlying immutable DB value, deref: `@conn`.\x22,(cljs.core.truth_(datascript.core.create_conn)?datascript.core.create_conn.cljs$lang$test:null)]));
var val__46343__auto__ \x3d cljs.core.deref(var__46342__auto__);
var m__46344__auto__ \x3d cljs.core.meta(var__46342__auto__);
var name__46345__auto__ \x3d (function (){var or__5045__auto__ \x3d null;
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})();
var new_m__46346__auto__ \x3d new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),ns__46341__auto__,new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),name__46345__auto__,new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754).cljs$core$IFn$_invoke$arity$1(m__46344__auto__),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891).cljs$core$IFn$_invoke$arity$1(m__46344__auto__)], null);
if(cljs.core.truth_(new cljs.core.Keyword(null,\x22dynamic\x22,\x22dynamic\x22,704819571).cljs$core$IFn$_invoke$arity$1(m__46344__auto__))){
return sci.core.new_dynamic_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
if(cljs.core.truth_((function (){var or__5045__auto__ \x3d new cljs.core.Keyword(null,\x22macro\x22,\x22macro\x22,-867863404).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(\x22sci\x22,\x22macro\x22,\x22sci/macro\x22,-868536151).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})())){
return sci.core.new_macro_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
return sci.core.new_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);

}
}
})()]);
sci.configs.tonsky.datascript.db_namespace \x3d new cljs.core.PersistentArrayMap(null, 7, [new cljs.core.Symbol(null,\x22db-from-reader\x22,\x22db-from-reader\x22,1527469533,null),(function (){var ns__46341__auto__ \x3d sci.configs.tonsky.datascript.db_ns;
var var__46342__auto__ \x3d new cljs.core.Var(function(){return datascript.db.db_from_reader;},new cljs.core.Symbol(\x22datascript.db\x22,\x22db-from-reader\x22,\x22datascript.db/db-from-reader\x22,266573302,null),cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),new cljs.core.Keyword(null,\x22file\x22,\x22file\x22,-1269645878),new cljs.core.Keyword(null,\x22end-column\x22,\x22end-column\x22,1425389514),new cljs.core.Keyword(null,\x22column\x22,\x22column\x22,2078222095),new cljs.core.Keyword(null,\x22line\x22,\x22line\x22,212345235),new cljs.core.Keyword(null,\x22end-line\x22,\x22end-line\x22,1837326455),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22test\x22,\x22test\x22,577538877)],[new cljs.core.Symbol(null,\x22datascript.db\x22,\x22datascript.db\x22,-444456104,null),new cljs.core.Symbol(null,\x22db-from-reader\x22,\x22db-from-reader\x22,1527469533,null),\x22datascript/db.cljc\x22,21,1,885,885,cljs.core.list(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,\x22keys\x22,\x22keys\x22,1068423698),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22schema\x22,\x22schema\x22,58529736,null),new cljs.core.Symbol(null,\x22datoms\x22,\x22datoms\x22,1349657093,null)], null)], null)], null)),null,(cljs.core.truth_(datascript.db.db_from_reader)?datascript.db.db_from_reader.cljs$lang$test:null)]));
var val__46343__auto__ \x3d cljs.core.deref(var__46342__auto__);
var m__46344__auto__ \x3d cljs.core.meta(var__46342__auto__);
var name__46345__auto__ \x3d (function (){var or__5045__auto__ \x3d null;
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})();
var new_m__46346__auto__ \x3d new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),ns__46341__auto__,new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),name__46345__auto__,new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754).cljs$core$IFn$_invoke$arity$1(m__46344__auto__),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891).cljs$core$IFn$_invoke$arity$1(m__46344__auto__)], null);
if(cljs.core.truth_(new cljs.core.Keyword(null,\x22dynamic\x22,\x22dynamic\x22,704819571).cljs$core$IFn$_invoke$arity$1(m__46344__auto__))){
return sci.core.new_dynamic_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
if(cljs.core.truth_((function (){var or__5045__auto__ \x3d new cljs.core.Keyword(null,\x22macro\x22,\x22macro\x22,-867863404).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(\x22sci\x22,\x22macro\x22,\x22sci/macro\x22,-868536151).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})())){
return sci.core.new_macro_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
return sci.core.new_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);

}
}
})(),new cljs.core.Symbol(null,\x22datom-from-reader\x22,\x22datom-from-reader\x22,1334075127,null),(function (){var ns__46341__auto__ \x3d sci.configs.tonsky.datascript.db_ns;
var var__46342__auto__ \x3d new cljs.core.Var(function(){return datascript.db.datom_from_reader;},new cljs.core.Symbol(\x22datascript.db\x22,\x22datom-from-reader\x22,\x22datascript.db/datom-from-reader\x22,2070683374,null),cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),new cljs.core.Keyword(null,\x22file\x22,\x22file\x22,-1269645878),new cljs.core.Keyword(null,\x22end-column\x22,\x22end-column\x22,1425389514),new cljs.core.Keyword(null,\x22column\x22,\x22column\x22,2078222095),new cljs.core.Keyword(null,\x22line\x22,\x22line\x22,212345235),new cljs.core.Keyword(null,\x22end-line\x22,\x22end-line\x22,1837326455),new cljs.core.Keyword(null,\x22tag\x22,\x22tag\x22,-1290361223),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22test\x22,\x22test\x22,577538877)],[new cljs.core.Symbol(null,\x22datascript.db\x22,\x22datascript.db\x22,-444456104,null),new cljs.core.Symbol(null,\x22datom-from-reader\x22,\x22datom-from-reader\x22,1334075127,null),\x22datascript/db.cljc\x22,31,1,297,297,new cljs.core.Symbol(null,\x22Datom\x22,\x22Datom\x22,1208901035,null),cljs.core.list(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22vec\x22,\x22vec\x22,982683596,null)], null)),null,(cljs.core.truth_(datascript.db.datom_from_reader)?datascript.db.datom_from_reader.cljs$lang$test:null)]));
var val__46343__auto__ \x3d cljs.core.deref(var__46342__auto__);
var m__46344__auto__ \x3d cljs.core.meta(var__46342__auto__);
var name__46345__auto__ \x3d (function (){var or__5045__auto__ \x3d null;
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})();
var new_m__46346__auto__ \x3d new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),ns__46341__auto__,new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),name__46345__auto__,new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754).cljs$core$IFn$_invoke$arity$1(m__46344__auto__),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891).cljs$core$IFn$_invoke$arity$1(m__46344__auto__)], null);
if(cljs.core.truth_(new cljs.core.Keyword(null,\x22dynamic\x22,\x22dynamic\x22,704819571).cljs$core$IFn$_invoke$arity$1(m__46344__auto__))){
return sci.core.new_dynamic_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
if(cljs.core.truth_((function (){var or__5045__auto__ \x3d new cljs.core.Keyword(null,\x22macro\x22,\x22macro\x22,-867863404).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(\x22sci\x22,\x22macro\x22,\x22sci/macro\x22,-868536151).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})())){
return sci.core.new_macro_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
return sci.core.new_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);

}
}
})(),new cljs.core.Symbol(null,\x22datom-added\x22,\x22datom-added\x22,-363961980,null),(function (){var ns__46341__auto__ \x3d sci.configs.tonsky.datascript.db_ns;
var var__46342__auto__ \x3d new cljs.core.Var(function(){return datascript.db.datom_added;},new cljs.core.Symbol(\x22datascript.db\x22,\x22datom-added\x22,\x22datascript.db/datom-added\x22,-560586371,null),cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,\x22protocol\x22,\x22protocol\x22,652470118),new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),new cljs.core.Keyword(null,\x22file\x22,\x22file\x22,-1269645878),new cljs.core.Keyword(null,\x22end-column\x22,\x22end-column\x22,1425389514),new cljs.core.Keyword(null,\x22column\x22,\x22column\x22,2078222095),new cljs.core.Keyword(null,\x22line\x22,\x22line\x22,212345235),new cljs.core.Keyword(null,\x22end-line\x22,\x22end-line\x22,1837326455),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22test\x22,\x22test\x22,577538877)],[new cljs.core.Symbol(\x22datascript.db\x22,\x22IDatom\x22,\x22datascript.db/IDatom\x22,293960966,null),new cljs.core.Symbol(null,\x22datascript.db\x22,\x22datascript.db\x22,-444456104,null),new cljs.core.Symbol(null,\x22datom-added\x22,\x22datom-added\x22,-363961980,null),\x22datascript/db.cljc\x22,15,1,154,156,cljs.core.list(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22this\x22,\x22this\x22,1028897902,null)], null)),null,(cljs.core.truth_(datascript.db.datom_added)?datascript.db.datom_added.cljs$lang$test:null)]));
var val__46343__auto__ \x3d cljs.core.deref(var__46342__auto__);
var m__46344__auto__ \x3d cljs.core.meta(var__46342__auto__);
var name__46345__auto__ \x3d (function (){var or__5045__auto__ \x3d null;
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})();
var new_m__46346__auto__ \x3d new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),ns__46341__auto__,new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),name__46345__auto__,new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754).cljs$core$IFn$_invoke$arity$1(m__46344__auto__),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891).cljs$core$IFn$_invoke$arity$1(m__46344__auto__)], null);
if(cljs.core.truth_(new cljs.core.Keyword(null,\x22dynamic\x22,\x22dynamic\x22,704819571).cljs$core$IFn$_invoke$arity$1(m__46344__auto__))){
return sci.core.new_dynamic_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
if(cljs.core.truth_((function (){var or__5045__auto__ \x3d new cljs.core.Keyword(null,\x22macro\x22,\x22macro\x22,-867863404).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(\x22sci\x22,\x22macro\x22,\x22sci/macro\x22,-868536151).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})())){
return sci.core.new_macro_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
return sci.core.new_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);

}
}
})(),new cljs.core.Symbol(null,\x22datom-tx\x22,\x22datom-tx\x22,1349109608,null),(function (){var ns__46341__auto__ \x3d sci.configs.tonsky.datascript.db_ns;
var var__46342__auto__ \x3d new cljs.core.Var(function(){return datascript.db.datom_tx;},new cljs.core.Symbol(\x22datascript.db\x22,\x22datom-tx\x22,\x22datascript.db/datom-tx\x22,2084964209,null),cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,\x22protocol\x22,\x22protocol\x22,652470118),new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),new cljs.core.Keyword(null,\x22file\x22,\x22file\x22,-1269645878),new cljs.core.Keyword(null,\x22end-column\x22,\x22end-column\x22,1425389514),new cljs.core.Keyword(null,\x22column\x22,\x22column\x22,2078222095),new cljs.core.Keyword(null,\x22line\x22,\x22line\x22,212345235),new cljs.core.Keyword(null,\x22end-line\x22,\x22end-line\x22,1837326455),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22test\x22,\x22test\x22,577538877)],[new cljs.core.Symbol(\x22datascript.db\x22,\x22IDatom\x22,\x22datascript.db/IDatom\x22,293960966,null),new cljs.core.Symbol(null,\x22datascript.db\x22,\x22datascript.db\x22,-444456104,null),new cljs.core.Symbol(null,\x22datom-tx\x22,\x22datom-tx\x22,1349109608,null),\x22datascript/db.cljc\x22,12,1,154,155,cljs.core.list(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22this\x22,\x22this\x22,1028897902,null)], null)),null,(cljs.core.truth_(datascript.db.datom_tx)?datascript.db.datom_tx.cljs$lang$test:null)]));
var val__46343__auto__ \x3d cljs.core.deref(var__46342__auto__);
var m__46344__auto__ \x3d cljs.core.meta(var__46342__auto__);
var name__46345__auto__ \x3d (function (){var or__5045__auto__ \x3d null;
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})();
var new_m__46346__auto__ \x3d new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),ns__46341__auto__,new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),name__46345__auto__,new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754).cljs$core$IFn$_invoke$arity$1(m__46344__auto__),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891).cljs$core$IFn$_invoke$arity$1(m__46344__auto__)], null);
if(cljs.core.truth_(new cljs.core.Keyword(null,\x22dynamic\x22,\x22dynamic\x22,704819571).cljs$core$IFn$_invoke$arity$1(m__46344__auto__))){
return sci.core.new_dynamic_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
if(cljs.core.truth_((function (){var or__5045__auto__ \x3d new cljs.core.Keyword(null,\x22macro\x22,\x22macro\x22,-867863404).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(\x22sci\x22,\x22macro\x22,\x22sci/macro\x22,-868536151).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})())){
return sci.core.new_macro_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
return sci.core.new_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);

}
}
})(),new cljs.core.Symbol(null,\x22datom\x22,\x22datom\x22,1268975437,null),(function (){var ns__46341__auto__ \x3d sci.configs.tonsky.datascript.db_ns;
var var__46342__auto__ \x3d new cljs.core.Var(function(){return datascript.db.datom;},new cljs.core.Symbol(\x22datascript.db\x22,\x22datom\x22,\x22datascript.db/datom\x22,399198004,null),cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),new cljs.core.Keyword(null,\x22file\x22,\x22file\x22,-1269645878),new cljs.core.Keyword(null,\x22end-column\x22,\x22end-column\x22,1425389514),new cljs.core.Keyword(null,\x22top-fn\x22,\x22top-fn\x22,-2056129173),new cljs.core.Keyword(null,\x22column\x22,\x22column\x22,2078222095),new cljs.core.Keyword(null,\x22line\x22,\x22line\x22,212345235),new cljs.core.Keyword(null,\x22end-line\x22,\x22end-line\x22,1837326455),new cljs.core.Keyword(null,\x22tag\x22,\x22tag\x22,-1290361223),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22test\x22,\x22test\x22,577538877)],[new cljs.core.Symbol(null,\x22datascript.db\x22,\x22datascript.db\x22,-444456104,null),new cljs.core.Symbol(null,\x22datom\x22,\x22datom\x22,1268975437,null),\x22datascript/db.cljc\x22,19,new cljs.core.PersistentArrayMap(null, 6, [new cljs.core.Keyword(null,\x22variadic?\x22,\x22variadic?\x22,584179762),false,new cljs.core.Keyword(null,\x22fixed-arity\x22,\x22fixed-arity\x22,1586445869),5,new cljs.core.Keyword(null,\x22max-fixed-arity\x22,\x22max-fixed-arity\x22,-690205543),5,new cljs.core.Keyword(null,\x22method-params\x22,\x22method-params\x22,-980792179),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22e\x22,\x22e\x22,-1273166571,null),new cljs.core.Symbol(null,\x22a\x22,\x22a\x22,-482876059,null),new cljs.core.Symbol(null,\x22v\x22,\x22v\x22,1661996586,null)], null),new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22e\x22,\x22e\x22,-1273166571,null),new cljs.core.Symbol(null,\x22a\x22,\x22a\x22,-482876059,null),new cljs.core.Symbol(null,\x22v\x22,\x22v\x22,1661996586,null),new cljs.core.Symbol(null,\x22tx\x22,\x22tx\x22,2107161945,null)], null),new cljs.core.PersistentVector(null, 5, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22e\x22,\x22e\x22,-1273166571,null),new cljs.core.Symbol(null,\x22a\x22,\x22a\x22,-482876059,null),new cljs.core.Symbol(null,\x22v\x22,\x22v\x22,1661996586,null),new cljs.core.Symbol(null,\x22tx\x22,\x22tx\x22,2107161945,null),new cljs.core.Symbol(null,\x22added\x22,\x22added\x22,-596784081,null)], null)], null),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),cljs.core.list(new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22e\x22,\x22e\x22,-1273166571,null),new cljs.core.Symbol(null,\x22a\x22,\x22a\x22,-482876059,null),new cljs.core.Symbol(null,\x22v\x22,\x22v\x22,1661996586,null)], null),new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22e\x22,\x22e\x22,-1273166571,null),new cljs.core.Symbol(null,\x22a\x22,\x22a\x22,-482876059,null),new cljs.core.Symbol(null,\x22v\x22,\x22v\x22,1661996586,null),new cljs.core.Symbol(null,\x22tx\x22,\x22tx\x22,2107161945,null)], null),new cljs.core.PersistentVector(null, 5, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22e\x22,\x22e\x22,-1273166571,null),new cljs.core.Symbol(null,\x22a\x22,\x22a\x22,-482876059,null),new cljs.core.Symbol(null,\x22v\x22,\x22v\x22,1661996586,null),new cljs.core.Symbol(null,\x22tx\x22,\x22tx\x22,2107161945,null),new cljs.core.Symbol(null,\x22added\x22,\x22added\x22,-596784081,null)], null)),new cljs.core.Keyword(null,\x22arglists-meta\x22,\x22arglists-meta\x22,1944829838),cljs.core.list(null,null,null)], null),1,233,233,new cljs.core.Symbol(null,\x22Datom\x22,\x22Datom\x22,1208901035,null),cljs.core.list(new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22e\x22,\x22e\x22,-1273166571,null),new cljs.core.Symbol(null,\x22a\x22,\x22a\x22,-482876059,null),new cljs.core.Symbol(null,\x22v\x22,\x22v\x22,1661996586,null)], null),new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22e\x22,\x22e\x22,-1273166571,null),new cljs.core.Symbol(null,\x22a\x22,\x22a\x22,-482876059,null),new cljs.core.Symbol(null,\x22v\x22,\x22v\x22,1661996586,null),new cljs.core.Symbol(null,\x22tx\x22,\x22tx\x22,2107161945,null)], null),new cljs.core.PersistentVector(null, 5, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22e\x22,\x22e\x22,-1273166571,null),new cljs.core.Symbol(null,\x22a\x22,\x22a\x22,-482876059,null),new cljs.core.Symbol(null,\x22v\x22,\x22v\x22,1661996586,null),new cljs.core.Symbol(null,\x22tx\x22,\x22tx\x22,2107161945,null),new cljs.core.Symbol(null,\x22added\x22,\x22added\x22,-596784081,null)], null)),null,(cljs.core.truth_(datascript.db.datom)?datascript.db.datom.cljs$lang$test:null)]));
var val__46343__auto__ \x3d cljs.core.deref(var__46342__auto__);
var m__46344__auto__ \x3d cljs.core.meta(var__46342__auto__);
var name__46345__auto__ \x3d (function (){var or__5045__auto__ \x3d null;
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})();
var new_m__46346__auto__ \x3d new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),ns__46341__auto__,new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),name__46345__auto__,new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754).cljs$core$IFn$_invoke$arity$1(m__46344__auto__),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891).cljs$core$IFn$_invoke$arity$1(m__46344__auto__)], null);
if(cljs.core.truth_(new cljs.core.Keyword(null,\x22dynamic\x22,\x22dynamic\x22,704819571).cljs$core$IFn$_invoke$arity$1(m__46344__auto__))){
return sci.core.new_dynamic_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
if(cljs.core.truth_((function (){var or__5045__auto__ \x3d new cljs.core.Keyword(null,\x22macro\x22,\x22macro\x22,-867863404).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(\x22sci\x22,\x22macro\x22,\x22sci/macro\x22,-868536151).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})())){
return sci.core.new_macro_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
return sci.core.new_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);

}
}
})(),new cljs.core.Symbol(null,\x22DB\x22,\x22DB\x22,1622874957,null),(function (){var ns__46341__auto__ \x3d sci.configs.tonsky.datascript.db_ns;
var var__46342__auto__ \x3d new cljs.core.Var(function(){return datascript.db.DB;},new cljs.core.Symbol(\x22datascript.db\x22,\x22DB\x22,\x22datascript.db/DB\x22,348347258,null),new cljs.core.PersistentArrayMap(null, 8, [new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),new cljs.core.Symbol(null,\x22datascript.db\x22,\x22datascript.db\x22,-444456104,null),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),null,new cljs.core.Keyword(null,\x22file\x22,\x22file\x22,-1269645878),\x22datascript/db.cljc\x22,new cljs.core.Keyword(null,\x22line\x22,\x22line\x22,212345235),499,new cljs.core.Keyword(null,\x22column\x22,\x22column\x22,2078222095),22,new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),new cljs.core.Symbol(null,\x22DB\x22,\x22DB\x22,1622874957,null),new cljs.core.Keyword(null,\x22test\x22,\x22test\x22,577538877),(cljs.core.truth_(datascript.db.DB)?datascript.db.DB.cljs$lang$test:null),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),cljs.core.List.EMPTY], null));
var val__46343__auto__ \x3d cljs.core.deref(var__46342__auto__);
var m__46344__auto__ \x3d cljs.core.meta(var__46342__auto__);
var name__46345__auto__ \x3d (function (){var or__5045__auto__ \x3d null;
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})();
var new_m__46346__auto__ \x3d new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),ns__46341__auto__,new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),name__46345__auto__,new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754).cljs$core$IFn$_invoke$arity$1(m__46344__auto__),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891).cljs$core$IFn$_invoke$arity$1(m__46344__auto__)], null);
if(cljs.core.truth_(new cljs.core.Keyword(null,\x22dynamic\x22,\x22dynamic\x22,704819571).cljs$core$IFn$_invoke$arity$1(m__46344__auto__))){
return sci.core.new_dynamic_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
if(cljs.core.truth_((function (){var or__5045__auto__ \x3d new cljs.core.Keyword(null,\x22macro\x22,\x22macro\x22,-867863404).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(\x22sci\x22,\x22macro\x22,\x22sci/macro\x22,-868536151).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})())){
return sci.core.new_macro_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
return sci.core.new_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);

}
}
})(),new cljs.core.Symbol(null,\x22Datom\x22,\x22Datom\x22,1208901035,null),(function (){var ns__46341__auto__ \x3d sci.configs.tonsky.datascript.db_ns;
var var__46342__auto__ \x3d new cljs.core.Var(function(){return datascript.db.Datom;},new cljs.core.Symbol(\x22datascript.db\x22,\x22Datom\x22,\x22datascript.db/Datom\x22,1951800754,null),new cljs.core.PersistentArrayMap(null, 8, [new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),new cljs.core.Symbol(null,\x22datascript.db\x22,\x22datascript.db\x22,-444456104,null),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),null,new cljs.core.Keyword(null,\x22file\x22,\x22file\x22,-1269645878),\x22datascript/db.cljc\x22,new cljs.core.Keyword(null,\x22line\x22,\x22line\x22,212345235),160,new cljs.core.Keyword(null,\x22column\x22,\x22column\x22,2078222095),10,new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),new cljs.core.Symbol(null,\x22Datom\x22,\x22Datom\x22,1208901035,null),new cljs.core.Keyword(null,\x22test\x22,\x22test\x22,577538877),(cljs.core.truth_(datascript.db.Datom)?datascript.db.Datom.cljs$lang$test:null),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),cljs.core.List.EMPTY], null));
var val__46343__auto__ \x3d cljs.core.deref(var__46342__auto__);
var m__46344__auto__ \x3d cljs.core.meta(var__46342__auto__);
var name__46345__auto__ \x3d (function (){var or__5045__auto__ \x3d null;
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})();
var new_m__46346__auto__ \x3d new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,\x22ns\x22,\x22ns\x22,441598760),ns__46341__auto__,new cljs.core.Keyword(null,\x22name\x22,\x22name\x22,1843675177),name__46345__auto__,new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754),new cljs.core.Keyword(null,\x22arglists\x22,\x22arglists\x22,1661989754).cljs$core$IFn$_invoke$arity$1(m__46344__auto__),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891),new cljs.core.Keyword(null,\x22doc\x22,\x22doc\x22,1913296891).cljs$core$IFn$_invoke$arity$1(m__46344__auto__)], null);
if(cljs.core.truth_(new cljs.core.Keyword(null,\x22dynamic\x22,\x22dynamic\x22,704819571).cljs$core$IFn$_invoke$arity$1(m__46344__auto__))){
return sci.core.new_dynamic_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
if(cljs.core.truth_((function (){var or__5045__auto__ \x3d new cljs.core.Keyword(null,\x22macro\x22,\x22macro\x22,-867863404).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
if(cljs.core.truth_(or__5045__auto__)){
return or__5045__auto__;
} else {
return new cljs.core.Keyword(\x22sci\x22,\x22macro\x22,\x22sci/macro\x22,-868536151).cljs$core$IFn$_invoke$arity$1(m__46344__auto__);
}
})())){
return sci.core.new_macro_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);
} else {
return sci.core.new_var.cljs$core$IFn$_invoke$arity$3(name__46345__auto__,val__46343__auto__,new_m__46346__auto__);

}
}
})()], null);
sci.configs.tonsky.datascript.namespaces \x3d new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Symbol(null,\x22datascript.core\x22,\x22datascript.core\x22,-1034255346,null),sci.configs.tonsky.datascript.core_namespace,new cljs.core.Symbol(null,\x22datascript.db\x22,\x22datascript.db\x22,-444456104,null),sci.configs.tonsky.datascript.db_namespace], null);
sci.configs.tonsky.datascript.config \x3d new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,\x22namespaces\x22,\x22namespaces\x22,-1444157469),sci.configs.tonsky.datascript.namespaces], null);
");
SHADOW_ENV.evalLoad("scittle.datascript.js", true , "goog.provide(\x27scittle.datascript\x27);
scittle.datascript.init \x3d (function scittle$datascript$init(){
return scittle.core.register_plugin_BANG_(new cljs.core.Keyword(\x22scittle.datascript\x22,\x22datascript\x22,\x22scittle.datascript/datascript\x22,-2101343946),sci.configs.tonsky.datascript.config);
});
");
SHADOW_ENV.evalLoad("shadow.module.scittle.datascript.append.js", false , "
shadow.cljs.devtools.client.env.module_loaded(\x27scittle.datascript\x27);

try { scittle.datascript.init(); } catch (e) { console.error(\x22An error occurred when calling (scittle.datascript/init)\x22); throw(e); };
SHADOW_ENV.setLoaded(\x22datascript.lru.js\x22);
SHADOW_ENV.setLoaded(\x22me.tonsky.persistent_sorted_set.arrays.js\x22);
SHADOW_ENV.setLoaded(\x22me.tonsky.persistent_sorted_set.js\x22);
SHADOW_ENV.setLoaded(\x22datascript.db.js\x22);
SHADOW_ENV.setLoaded(\x22datascript.impl.entity.js\x22);
SHADOW_ENV.setLoaded(\x22datascript.built_ins.js\x22);
SHADOW_ENV.setLoaded(\x22datascript.pull_parser.js\x22);
SHADOW_ENV.setLoaded(\x22datascript.pull_api.js\x22);
SHADOW_ENV.setLoaded(\x22datascript.serialize.js\x22);
SHADOW_ENV.setLoaded(\x22datascript.parser.js\x22);
SHADOW_ENV.setLoaded(\x22datascript.query.js\x22);
SHADOW_ENV.setLoaded(\x22datascript.core.js\x22);
SHADOW_ENV.setLoaded(\x22sci.configs.tonsky.datascript.js\x22);
SHADOW_ENV.setLoaded(\x22scittle.datascript.js\x22);
SHADOW_ENV.setLoaded(\x22shadow.module.scittle.datascript.append.js\x22);");