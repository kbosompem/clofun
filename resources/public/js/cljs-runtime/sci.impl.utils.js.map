{"version":3,"sources":["sci/impl/utils.cljc"],"mappings":"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","names":["cljs.core.derive","sci.impl.utils/constant?","x","cljs.core/Keyword","cljs.core/boolean?","js/RegExp","sci.impl.utils/*top-level-location*","var_args","G__39329","sci.impl.utils/throw-error-with-location","js/Error","msg","iobj","sci.impl.utils.throw_error_with_location","data","map__39330","cljs.core/--destructure-map","line","cljs.core.get","column","file","cljs.core/deref","sci.impl.utils/current-file","cljs.core/meta","cljs.core.ex_info","cljs.core.merge","or__5045__auto__","sci.impl.utils/*in-try*","sci.impl.utils/macro?","f","temp__5808__auto__","m","sci.impl.utils/allowed-append","cljs.core.symbol","sci.impl.utils/demunge","s","cljs.core/demunge","G__39340","sci.impl.utils/rethrow-with-location-of-node","ctx","e","raw-node","sci.impl.utils.rethrow_with_location_of_node","_bindings","in-try","cljs.core/keyword-identical?","stack","sci.impl.types/stack","env","id","d","cljs.core/ex-data","st","temp__5804__auto__","cljs.core/volatile!","cljs.core/-vreset!","cljs.core/-deref","cljs.core.conj","wrapping-sci-error?","and__5043__auto__","cljs.core.isa_QMARK_","map__39345","ex-msg","G__39346","cljs.core/last","phase","new-exception","new-d","G__39347","cljs.core.assoc","sci.impl.utils/iobj?","obj","cljs.core/PROTOCOL_SENTINEL","args__5775__auto__","len__5769__auto__","i__5770__auto__","argseq__5776__auto__","cljs.core/IndexedSeq","sci.impl.utils/vary-meta*","seq39349","G__39350","cljs.core/first","cljs.core/next","G__39351","self__5754__auto__","args","cljs.core.apply","cljs.core/vary-meta","sci.impl.utils/strip-core-ns","sym","G__39360","cljs.core/namespace","cljs.core/name","sci.impl.utils/allowed-loop","sci.impl.utils/allowed-recur","sci.impl.utils/var-unbound","js/Object","sci.impl.utils/namespace-object","ns-sym","create?","attr-map","env*","ns-map","cljs.core.get_in","ns-obj","sci.lang/->Namespace","cljs.core.swap_BANG_","cljs.core/assoc-in","sci.impl.utils/set-namespace!","sci.impl.types/setVal","sci.impl.utils/current-ns","sci.impl.utils/eval-form-state","sci.impl.utils/eval-require-state","sci.impl.utils/eval-use-state","sci.impl.utils/eval-resolve-state","sci.impl.utils/eval-refer-state","sci.impl.utils/macroexpand*","sci.impl.utils/macroexpand-1*","sci.impl.utils/eval-string*","sci.impl.utils/lookup","sci.impl.utils/analyze","sci.impl.utils/eval","sci-ctx","form","fexpr__39369","sci.impl.utils/split-when","pred","coll","cljs.core/complement","cljs.core/LazySeq","cljs.core/seq","fst","run","cljs.core/cons","cljs.core.take_while","G__39375","G__39376","cljs.core.drop","cljs.core/count","sci.impl.utils/ana-macros","sci.impl.utils/maybe-destructured","params","body","cljs.core/every?","cljs.core/symbol?","new-params","cljs.core/with-meta","lets","cljs.core.sequence","cljs.core.concat","cljs.core/List","cljs.core/Symbol","gparam","cljs.core.gensym","sci.impl.utils/unqualify-symbol","sci.impl.vars/unqualify-symbol","G__39378","sci.impl.utils/make-stack","expr-meta","sci.impl.utils.make_stack","special?","G__39379","sci.impl.utils/log","seq39380","self__5755__auto__","xs","js/console","clojure.string.join","G__39382","sci.impl.utils/dynamic-var","name","sci.impl.utils.dynamic_var","init-val","meta","sci.lang/Var","sci.impl.utils/user-ns","sci.impl.utils/clojure-core-ns","sci.impl.utils/current-ns-name","sci.impl.types/getName","G__39384","sci.impl.utils/new-var","G__39385","sci.impl.utils.new_var","sci.impl.vars/unbind","ctx?","sci.impl.utils/var?","sci.impl.utils/namespace?","sci.lang/Namespace"],"sourcesContent":["(ns sci.impl.utils\n  {:no-doc true}\n  (:refer-clojure :exclude [eval demunge var?])\n  (:require [clojure.string :as str]\n            [sci.impl.macros :as macros]\n            [sci.impl.types :as t]\n            [sci.impl.vars :as vars]\n            [sci.lang :as lang])\n  #?(:cljs (:require-macros [sci.impl.utils :refer [kw-identical? dotimes+]])))\n\n#?(:clj (set! *warn-on-reflection* true))\n\n(derive :sci.error/realized-beyond-max :sci/error)\n(derive :sci.error/parse :sci/error)\n\n(defn constant? [x]\n  (or (nil? x)\n      (number? x)\n      (string? x)\n      (keyword? x)\n      (boolean? x)\n      #?(:clj\n         (instance? java.util.regex.Pattern x)\n         :cljs\n         (instance? js/RegExp x))))\n\n(defmacro kw-identical? [k v]\n  (macros/?\n   :clj `(identical? ~k ~v)\n   :cljs `(cljs.core/keyword-identical? ~k ~v)))\n\n(declare current-file current-ns)\n\n(def ^:dynamic *top-level-location* nil)\n\n(defn throw-error-with-location\n  ([msg iobj] (throw-error-with-location msg iobj {}))\n  ([msg iobj data]\n   (let [{:keys [:line :column :file]\n          :or {file @current-file}} (meta iobj)]\n     (throw (ex-info msg (merge {:type :sci/error\n                                 :line (or line (:line *top-level-location*))\n                                 :column (or column (:column *top-level-location*))\n                                 :file file} data))))))\n\n(def ^:dynamic *in-try* false)\n\n(defn macro? [f]\n  (when-some [m (meta f)]\n    (or (:sci/macro m)\n        (:macro m))))\n\n#?(:cljs\n   (def allowed-append \"used for allowing interop in with-out-str\"\n     (symbol \"append\")))\n\n(defn demunge [s]\n  #?(:clj (clojure.lang.Compiler/demunge s)\n     :cljs (cljs.core/demunge s)))\n\n#?(:clj\n   (defn rewrite-ex-msg [ex-msg env fm]\n     (when ex-msg\n       (if-let [[_ printed-fn] (re-matches #\"Wrong number of args \\(\\d+\\) passed to: (.*)\" ex-msg)]\n         (let [fn-pat #\"(sci\\.impl\\.)?fns/fun/arity-([0-9])+--\\d+\"\n               [fn-match prefix arity] (re-find fn-pat ex-msg)\n               friendly-name (when arity (str \"function of arity \" arity))]\n           (if (:name fm)\n             (let [ns (symbol (str (:ns fm)))\n                   var-name (:name fm)\n                   var (get-in @env [:namespaces ns var-name])\n                   fstr (when var (let [varf (if (instance? clojure.lang.IDeref var)\n                                               (deref var)\n                                               var)\n                                        varf (or\n                                              ;; resolve macro inner fn for comparison\n                                              (some-> varf meta :sci.impl/inner-fn)\n                                              varf)\n                                        fstr (clojure.lang.Compiler/demunge (str varf))\n                                        fstr (first (str/split fstr #\"@\"))\n                                        fstr (if prefix\n                                               fstr\n                                               (str/replace fstr #\"^sci\\.impl\\.\" \"\"))]\n                                    fstr))]\n               (cond (and fstr printed-fn (= fstr printed-fn))\n                     (str/replace ex-msg printed-fn\n                                  (str (:ns fm) \"/\" (:name fm)))\n                     friendly-name (str/replace ex-msg fn-match friendly-name)\n                     :else ex-msg))\n             ex-msg))\n         ex-msg))))\n\n(defn rethrow-with-location-of-node\n  ([ctx ^Throwable e raw-node] (rethrow-with-location-of-node ctx (:bindings ctx) e raw-node))\n  ([ctx _bindings ^Throwable e raw-node]\n   (if (let [in-try #?(:clj (or *in-try*\n                                (not= (:main-thread-id ctx)\n                                      (.getId (Thread/currentThread))))\n                       :cljs *in-try*)]\n         (if (kw-identical? in-try :sci/error)\n           ;; preserve location information\n           false\n           in-try))\n     ;; we are inside a try/catch, do not preserve error location\n     (throw e)\n     (let [stack (t/stack raw-node)\n           #?@(:clj [fm (:sci.impl/f-meta stack)])\n           env (:env ctx)\n           id (:id ctx)\n           d (ex-data e)\n           st (or (when-let [st (:sci.impl/callstack d)]\n                    st)\n                  (volatile! '()))]\n       (when stack\n         (vswap! st conj stack))\n       (let [d (ex-data e)\n               ;; st (:sci.impl/callstack d)\n             wrapping-sci-error? (and (isa? (:type d) :sci/error)\n                                      (:sci.impl/callstack d))]\n         (if wrapping-sci-error?\n           (throw e)\n           (let [ex-msg #?(:clj (.getMessage e)\n                           :cljs (.-message e))\n                 {:keys [:line :column :file]}\n                 (or stack\n                     (some-> env deref\n                             :sci.impl/callstack (get id)\n                             deref last meta)\n                     #_(meta node))]\n             (if (and line column)\n               (let [ex-msg #?(:clj (rewrite-ex-msg ex-msg env fm)\n                               :cljs ex-msg)\n                     phase (:phase d)\n                     new-exception\n                     (let [new-d (cond-> {:type :sci/error\n                                          :line line\n                                          :column column\n                                          :message ex-msg\n                                          :sci.impl/callstack st\n                                          :file file}\n                                   phase (assoc :phase phase))]\n                       (ex-info ex-msg new-d e))]\n                 (throw new-exception))\n               (throw e)))))))))\n\n(defn- iobj? [obj]\n  (and #?(:clj (instance? clojure.lang.IObj obj)\n          :cljs (implements? IWithMeta obj))\n       (meta obj)))\n\n(defn vary-meta*\n  \"Only adds metadata to obj if d is not nil and if obj already has meta\"\n  [obj f & args]\n  (if (iobj? obj)\n    (apply vary-meta obj f args)\n    obj))\n\n(defn strip-core-ns [sym]\n  (case (namespace sym)\n    (\"clojure.core\" \"cljs.core\") (symbol (name sym))\n    sym))\n\n(def allowed-loop (symbol \"loop\"))\n(def allowed-recur (symbol \"recur\"))\n(def var-unbound #?(:clj (Object.)\n                    :cljs (js/Object.)))\n\n(defn namespace-object\n  \"Fetches namespaces from env if it exists. Else, if `create?`,\n  produces one regardless of the existince of the namespace in env and\n  adds it to env before returning it.\"\n  [env ns-sym create? attr-map]\n  (let [env* @env\n        ns-map (get-in env* [:namespaces ns-sym])]\n    (or (:obj ns-map)\n        (when (or ns-map create?)\n          (let [ns-obj (lang/->Namespace ns-sym attr-map)]\n            (swap! env assoc-in [:namespaces ns-sym :obj] ns-obj)\n            ns-obj)))))\n\n(defn set-namespace! [ctx ns-sym attr-map]\n  (let [env (:env ctx)\n        attr-map (merge (meta ns-sym) attr-map)\n        ns-obj (namespace-object env ns-sym true attr-map)]\n    (t/setVal current-ns ns-obj)))\n\n(def eval-form-state (volatile! nil))\n(def eval-require-state (volatile! nil))\n(def eval-use-state (volatile! nil))\n(def eval-resolve-state (volatile! nil))\n(def eval-refer-state (volatile! nil))\n(def macroexpand* (volatile! nil))\n(def macroexpand-1* (volatile! nil))\n(def eval-string* (volatile! nil))\n(def lookup (volatile! nil))\n(def analyze (volatile! nil))\n\n(defn eval [sci-ctx form]\n  (@eval-form-state sci-ctx form))\n\n(defn split-when\n  \"Like partition-by but splits collection only when `pred` returns\n  a truthy value. E.g. `(split-when odd? [1 2 3 4 5]) => ((1 2) (3 4) (5))`\"\n  [pred coll]\n  (let [f (complement pred)]\n    (lazy-seq\n     (when-let [s (seq coll)]\n       (let [fst (first s)\n             run (cons fst (take-while f (next s)))]\n         (cons run (split-when pred (lazy-seq (drop (count run) s)))))))))\n\n(def ana-macros\n  '#{do if and or fn fn* def defn\n     lazy-seq case try defmacro\n     expand-dot* expand-constructor new . import in-ns ns var\n     set! resolve})\n\n(defn maybe-destructured\n  [params body]\n  (if (every? symbol? params)\n    {:params params\n     :body body}\n    (loop [params params\n           new-params (with-meta [] (meta params))\n           lets []]\n      (if params\n        (if (symbol? (first params))\n          (recur (next params) (conj new-params (first params)) lets)\n          (let [gparam (gensym \"p__\")]\n            (recur (next params) (conj new-params gparam)\n                   (-> lets (conj (first params)) (conj gparam)))))\n        {:params new-params\n         :body [`(let ~lets\n                   ~@body)]}))))\n\n(def unqualify-symbol vars/unqualify-symbol)\n\n(defn make-stack\n  ([expr-meta] (make-stack expr-meta false))\n  ([expr-meta special?]\n   (cond-> (assoc expr-meta\n                  :ns @current-ns\n                  :file @current-file)\n     special? (assoc :special true))))\n\n(defn log [& xs]\n  #?(:clj (.println System/err (str/join \" \" xs))\n     :cljs (.log js/console (str/join \" \" xs))))\n\n(defn dynamic-var\n  ([name]\n   (dynamic-var name nil (meta name)))\n  ([name init-val]\n   (dynamic-var name init-val (meta name)))\n  ([name init-val meta]\n   (let [meta (assoc meta :dynamic true :name (unqualify-symbol name))]\n     (sci.lang.Var. init-val name meta false false nil))))\n\n;; foundational namespaces\n(def user-ns (lang/->Namespace 'user nil))\n\n(def clojure-core-ns (lang/->Namespace 'clojure.core nil))\n\n(def current-file\n  (dynamic-var '*file* nil\n               {:doc \"The path of the file being evaluated, as a String.\\n\\n  When there is no file, e.g. in the REPL, the value is not defined.\"\n                :ns clojure-core-ns}))\n\n(def current-ns\n  (dynamic-var '*ns* user-ns\n               {:ns clojure-core-ns\n                :doc \"A sci.lang.Namespace object representing the current namespace.\"}))\n\n(defn current-ns-name []\n  (t/getName @current-ns))\n\n(defn new-var\n  \"Returns a new sci var.\"\n  ([name] (doto (new-var name nil nil false)\n            (vars/unbind)))\n  ([name init-val] (new-var name init-val (meta name) false))\n  ([name init-val meta] (new-var name init-val meta false))\n  ([name init-val meta ctx?] (sci.lang.Var. init-val name (assoc meta :name (unqualify-symbol name)) false ctx? nil)))\n\n(defn var? [x]\n  (instance? sci.lang.Var x))\n\n(defn namespace? [x]\n  (instance? #?(:clj sci.lang.Namespace\n                :cljs sci.lang/Namespace) x))\n\n(defmacro dotimes+ [n body]\n  `(do (dotimes [i# ~(dec n)]\n         ~body)\n       ~body))\n"]}