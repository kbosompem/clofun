{
"version":3,
"file":"promesa.impl.promise.js",
"lineCount":311,
"mappings":"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",
"sources":["promesa/impl/promise.js"],
"sourcesContent":["\"use strict\";\n\ngoog.provide(\"promesa.impl.promise\");\ngoog.provide(\"promesa.impl.promise.PromiseImpl\");\ngoog.provide(\"promesa.impl.promise.CancellationError\");\n\ngoog.scope(function() {\n  const self = promesa.impl.promise;\n  const root = goog.global;\n\n  const PENDING = Symbol(\"state/pending\");\n  const RESOLVED = Symbol(\"state/resolved\");\n  const REJECTED = Symbol(\"state/rejected\");\n\n  const QUEUE = Symbol(\"queue\");\n  const STATE = Symbol(\"state\");\n  const VALUE = Symbol(\"value\");\n\n  const RESOLVE_TYPE_FLATTEN = Symbol(\"resolve-type/flatten\");\n  const RESOLVE_TYPE_BIND = Symbol(\"resolve-type/bind\");\n  const RESOLVE_TYPE_MAP = Symbol(\"resolve-type/map\");\n\n  const defaultResolveMapHandler = (v) => v;\n  const defaultResolveBindHandler = (v) => self.resolved(v);\n  const defaultRejectHandler = (c) => {throw c;};\n\n  class CancellationError extends Error {}\n\n  class PromiseImpl {\n    constructor (val) {\n      this[QUEUE] = [];\n      this[STATE] = PENDING;\n      this[VALUE] = undefined;\n\n      if (val !== undefined) {\n        transition(this, RESOLVED, val);\n      }\n    }\n\n    get state () {\n      return this[STATE];\n    }\n\n    get value () {\n      return this[VALUE];\n    }\n\n    then (resolve, reject) {\n      const deferred = new PromiseImpl();\n\n      this[QUEUE].push({\n        type: RESOLVE_TYPE_FLATTEN,\n        resolve: resolve ?? defaultResolveMapHandler,\n        reject: reject ?? defaultRejectHandler,\n        complete: completeDeferredFn(deferred)\n      });\n\n      // console.log(\"then\",\n      //             \"uid:\", goog.getUid(this),\n      //             \"return-uid:\", goog.getUid(deferred),\n      //             \"state:\", this[STATE],\n      //             \"value:\", fmtValue(this[VALUE]));\n\n      process(this);\n      return deferred;\n    }\n\n    catch (reject) {\n      return this.then(null, reject);\n    }\n\n    finally (f) {\n      this[QUEUE].push({\n        type: RESOLVE_TYPE_FLATTEN,\n        resolve: (value) => f(),\n        reject: (cause) => f(),\n        complete: (value, cause) => null\n      });\n\n      return this;\n    }\n\n    fmap (resolve, reject) {\n      const deferred = new PromiseImpl();\n\n      this[QUEUE].push({\n        type: RESOLVE_TYPE_MAP,\n        resolve: resolve ?? defaultResolveMapHandler,\n        reject: reject ?? defaultRejectHandler,\n        complete: completeDeferredFn(deferred)\n      });\n\n      // console.log(\"fmap\",\n      //             \"uid:\", goog.getUid(this),\n      //             \"return-uid:\", goog.getUid(deferred),\n      //             \"state:\", this[STATE],\n      //             \"value:\", fmtValue(this[VALUE]));\n\n      process(this);\n      return deferred;\n    }\n\n    fbind (resolve, reject) {\n      const deferred = new PromiseImpl();\n\n      this[QUEUE].push({\n        type: RESOLVE_TYPE_BIND,\n        resolve: resolve ?? defaultResolveBindHandler,\n        reject: reject ?? defaultRejectHandler,\n        complete: completeDeferredFn(deferred)\n      });\n\n      // console.log(\"fbind\",\n      //             \"uid:\", goog.getUid(this),\n      //             \"return-uid:\", goog.getUid(deferred),\n      //             \"state:\", this[STATE],\n      //             \"value:\", fmtValue(this[VALUE]));\n\n      process(this);\n      return deferred;\n    }\n\n    handle (fn, resolveType) {\n      resolveType = resolveType ?? RESOLVE_TYPE_MAP;\n\n      this[QUEUE].push({\n        type: resolveType,\n        resolve: defaultResolveMapHandler,\n        reject: defaultRejectHandler,\n        complete: fn\n      });\n\n      process(this);\n    }\n\n    // Deferred Methods\n\n    resolve(value) {\n      if (this[STATE] === PENDING) {\n        // console.log(\":: [deferred:resolve]\",\n        //             \"uid:\", goog.getUid(this),\n        //             \"value:\", fmtValue(value));\n\n        transition(this, RESOLVED, value);\n      }\n      return null;\n    }\n\n    reject(cause) {\n      if (this[STATE] === PENDING) {\n        // console.log(\":: [deferred:reject]\",\n        //             \"uid:\", goog.getUid(this),\n        //             \"value:\", fmtValue(cause));\n        transition(this, REJECTED, cause);\n      }\n      return null;\n    }\n\n    isPending() {\n      const state = this[STATE];\n      return state === PENDING;\n    }\n\n    isResolved() {\n      const state = this[STATE];\n      return state === RESOLVED;\n    }\n\n    isRejected() {\n      const state = this[STATE];\n      return state === REJECTED;\n    }\n\n    isCancelled() {\n      const state = this[STATE];\n      const value = this[VALUE];\n      return (state === REJECTED && isCancellationError(value));\n    }\n\n    cancel() {\n      this.reject(new CancellationError(\"promise cancelled\"));\n    }\n  }\n\n  const nextTick = (() => {\n    if (typeof root.Promise === \"function\") {\n      const resolved = Promise.resolve(null);\n      return function queueMicrotaskWithPromise(f, p) {\n        resolved.then(() => f(p));\n      };\n    } else if (typeof root.setImmediate === \"function\") {\n      return root.setImmediate;\n    } else if (typeof root.setTimeout === \"function\") {\n      return (f, p) => root.setTimeout(f, 0, p);\n    } else {\n      // console.error(\"No nextTick. How we gonna do this?\");\n      return (f, p) => f.call(this, p);\n    }\n  })();\n\n  function isCancellationError(v) {\n    return v instanceof CancellationError;\n  }\n\n  function fmtValue (o) {\n    if (isThenable(o)) {\n      return `<PROMISE:${goog.getUid(o)}>`;\n    } else if (o instanceof Error) {\n      return `<EXCEPTION:'${o.message}'>`;\n    } else if (o === null || o === undefined) {\n      return `${o}`;\n    } else if (typeof o === \"function\") {\n      return `<FN:${goog.getUid(o)}>`;\n    } else {\n      return `${o.toString()}`;\n    }\n  }\n\n  function isSome(o) {\n    return o !== null && o !== undefined;\n  }\n\n  function isFunction (o) {\n    return typeof o === \"function\";\n  }\n\n  function isThenable (o) {\n    if (goog.isObject(o)) {\n      const thenFn = o.then;\n      return isFunction(thenFn);\n    } else {\n      return false;\n    }\n  }\n\n  function constantly(v) {\n    return () => v;\n  }\n\n  function identity (v) {\n    return v;\n  }\n\n  function isPromiseImpl (v) {\n    return v instanceof PromiseImpl;\n  }\n\n  function completeDeferredFn(deferred) {\n    return (value, cause) => {\n      if (cause) {\n        deferred.reject(cause);\n      } else {\n        deferred.resolve(value);\n      }\n    };\n  }\n\n  function process(p) {\n    if (p[STATE] === PENDING) return;\n    nextTick(processNextTick, p);\n    return p;\n  }\n\n  function processNextTick(p) {\n    if (p[QUEUE].length === 0) return;\n\n    const state = p[STATE];\n    const value = p[VALUE];\n    let task, rvalue, rcause;\n\n    // console.log(\":: process:\",\n    //             \"uid:\", goog.getUid(p),\n    //             \"queue size:\", p[QUEUE].length,\n    //             \"state:\", p[STATE],\n    //             \"value:\", fmtValue(p[VALUE]));\n\n    while (p[QUEUE].length) {\n      task = p[QUEUE].shift();\n\n      // console.log(\":: process-task:\",\n      //             \"deferred-uid:\", task.deferred ? goog.getUid(task.deferred) : null,\n      //             \"type:\", task.type);\n\n      try {\n        if (state === RESOLVED) {\n          rvalue = task.resolve(value)\n        } else if (state === REJECTED) {\n          rvalue = task.reject(value)\n        } else {\n          rcause = new TypeError(\"invalid state\");\n        }\n      } catch (e) {\n        rcause = e;\n      }\n\n      resolveTask(task, rvalue, rcause);\n    }\n  }\n\n  function resolveTask(task, value, cause) {\n\n    if (task.complete === undefined) return;\n\n    if (cause) {\n      task.complete(null, cause);\n    } else {\n      if (task.type === RESOLVE_TYPE_MAP) {\n        // console.trace(task);\n        task.complete(value, null);\n      } else if (task.type === RESOLVE_TYPE_FLATTEN) {\n        if (isPromiseImpl(value)) {\n          value.handle((v, c) => {\n            resolveTask(task, v, c);\n          });\n        } else if (isThenable(value)) {\n          value.then((v) => {\n            resolveTask(task, v, null);\n          }, (c) => {\n            resolveTask(task, null, c);\n          });\n        } else {\n          task.complete(value, null);\n        }\n      } else if (task.type === RESOLVE_TYPE_BIND) {\n        if (isPromiseImpl(value)) {\n          value.handle((v, c) => {\n            task.complete(v, c);\n          });\n        } else if (isThenable(value)) {\n          value.then((v) => {\n            task.complete(v, null);\n          }, (c) => {\n            task.complete(null, c);\n          });\n        } else {\n          task.complete(null, new TypeError(\"expected thenable\"));\n        }\n      } else {\n        task.complete(null, new TypeError(\"internal: invalid resolve type\"));\n      }\n    }\n  }\n\n  function transition(p, state, value) {\n    // console.log(\">> transition\",\n    //             \"uid:\", goog.getUid(p),\n    //             \"from-state:\", p[STATE],\n    //             \"to-state:\", state,\n    //             \"value:\", fmtValue(value),\n    //             \"queue:\", p[QUEUE].length);\n\n    if (p[STATE] === state ||\n        p[STATE] !== PENDING) {\n      return;\n    }\n\n    p[STATE] = state;\n    p[VALUE] = value;\n\n    return processNextTick(p);\n  }\n\n  self.PromiseImpl = PromiseImpl;\n  self.CancellationError = CancellationError;\n  self.isCancellationError = isCancellationError;\n\n  self.deferred = () => {\n    return new PromiseImpl();\n  };\n\n  const NULL_PROMISE = new PromiseImpl(null);\n\n  self.resolved = function resolved (value) {\n    if (value === null) {\n      return NULL_PROMISE;\n    } else {\n      const p = new PromiseImpl();\n      p[STATE] = RESOLVED;\n      p[VALUE] = value;\n      // console.log(\"++ [resolved]\", \"uid:\", goog.getUid(p), \"value:\", value);\n\n      return p;\n    }\n  };\n\n  self.rejected = function rejected (reason) {\n    const p = new PromiseImpl();\n    p[STATE] = REJECTED;\n    p[VALUE] = reason;\n\n    // console.log(\"++ [rejected]\", \"uid:\", goog.getUid(p), \"value:\", fmtValue(reason));\n\n    return p;\n  };\n\n  self.all = function all (promises) {\n    return promises.reduce((acc, p) => {\n      return acc.then((results) => {\n        return self.coerce(p).fmap((v) => {\n          results.push(v);\n          return results;\n        });\n      });\n    }, self.resolved([]));\n  };\n\n  self.coerce = function coerce (promise) {\n    if (promise instanceof PromiseImpl) {\n      return promise;\n    } else if (isThenable(promise)) {\n      const deferred = self.deferred();\n      promise.then((v) => {\n        deferred.resolve(v);\n      }, (c) => {\n        deferred.reject(c);\n      });\n      return deferred;\n    } else if (promise instanceof Error) {\n      return self.rejected(promise);\n    } else {\n      return self.resolved(promise);\n    }\n  };\n\n  self.race = function race (promises) {\n    const deferred = self.deferred();\n\n    promises.forEach((p) => {\n      self.coerce(p).handle((v, c) => {\n        if (c) {\n          deferred.reject(c);\n        } else {\n          deferred.resolve(v);\n        }\n      });\n    });\n\n    return deferred;\n  };\n\n  self.nextTick = nextTick;\n\n  self.PENDING = PENDING;\n  self.RESOLVED = RESOLVED;\n  self.REJECTED = REJECTED;\n});\n"],
"names":["goog","provide","scope","self","promesa","impl","promise","root","global","PENDING","Symbol","RESOLVED","REJECTED","QUEUE","STATE","VALUE","RESOLVE_TYPE_FLATTEN","RESOLVE_TYPE_BIND","RESOLVE_TYPE_MAP","defaultResolveMapHandler","v","defaultResolveBindHandler","resolved","defaultRejectHandler","c","CancellationError","Error","PromiseImpl","constructor","val","undefined","transition","then","resolve","reject","deferred","push","type","complete","completeDeferredFn","process","catch","finally","f","value","cause","fmap","fbind","handle","fn","resolveType","isPending","state","isResolved","isRejected","isCancelled","isCancellationError","cancel","nextTick","Promise","queueMicrotaskWithPromise","p","setImmediate","setTimeout","call","fmtValue","o","isThenable","getUid","message","toString","isSome","isFunction","isObject","thenFn","constantly","identity","isPromiseImpl","processNextTick","length","task","rvalue","rcause","shift","TypeError","e","resolveTask","self.deferred","NULL_PROMISE","self.resolved","rejected","self.rejected","reason","all","self.all","promises","reduce","acc","results","coerce","self.coerce","race","self.race","forEach"]
}
